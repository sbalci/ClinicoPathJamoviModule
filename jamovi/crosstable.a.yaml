---
name:  crosstable
title: Cross Tables
menuGroup: ExplorationT2
menuSubgroup: ClinicoPath Comparisons
version: '0.0.32'
jas: '1.2'

description:
    main: |
        Function for making Cross Tables with multiple table styles.

        Currently implemented features:
        - Multiple table styles (arsenal, finalfit, gtsummary, NEJM, Lancet, hmisc)
        - Automatic test selection (chi-square, Fisher's exact, t-test, ANOVA)
        - Stratified analysis (Mantel-Haenszel, Breslow-Day)
        - Multiple testing correction (Bonferroni, Holm, Benjamini-Hochberg, Benjamini-Yekutieli)
        - Variable name safety (special characters, spaces)
        - Data quality validation warnings

        Note: Advanced features (pairwise comparisons, effect sizes, residual analysis,
        correspondence analysis) are planned but not yet available.
    R:
        dontrun: true
        usage: |
            # Example usage:
            # dat <- as.data.frame(your_data)
            # ClinicoPathDescriptives::crosstable(
            #   data = dat,
            #   vars = vars(YourRowVariable),
            #   group = "YourGroupingVariable",
            #   sty = "finalfit",
            #   excl = TRUE,
            #   cont = "mean",
            #   pcat = "chisq"
            # )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.
    - name: vars
      title: Dependent Variable(s)
      type: Variables
      description: >
            The variable(s) that will appear as rows in the cross table.
    - name: group
      title: Grouping Variable
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      description: >
            The variable that will appear as columns (groups) in the table.
    - name: sty
      title: Table Style
      type: List
      options:
        - title: arsenal
          name: arsenal
        - title: finalfit
          name: finalfit
        - title: gtsummary
          name: gtsummary
        - title: NEJM
          name: nejm
        - title: Lancet
          name: lancet
        - title: hmisc
          name: hmisc
      default: nejm
    - name: excl
      title: Exclude Missing (NA)
      type: Bool
      default: false
      description:
          R: >
            Exclude rows with missing values.
    - name: cont
      title: Mean vs Median
      type: List
      options:
        - title: mean
          name: mean
        - title: median
          name: median
      default: mean
    - name: pcat
      title: ChiSq vs Fisher
      type: List
      options:
        - title: chisq
          name: chisq
        - title: fisher
          name: fisher
      default: chisq

    # Stratified Analysis Options (non-breaking additions)
    - name: stratify
      title: Stratification Variable (Optional)
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      default: NULL
      description: >
            Variable for stratified analysis (Mantel-Haenszel test).
            Controls for confounding when comparing groups across strata.

    - name: mantel_haenszel
      title: Mantel-Haenszel Test
      type: Bool
      default: false
      description: >
            Perform Mantel-Haenszel chi-square test for stratified 2x2 tables.
            Tests association between row and column variables controlling for stratification.
            Provides common odds ratio estimate across strata.

    - name: breslow_day
      title: Breslow-Day Homogeneity Test
      type: Bool
      default: false
      description: >
            Test whether odds ratios are homogeneous across strata.
            Only applicable when Mantel-Haenszel test is enabled.

    # - name: pairwise
    #   title: Pairwise comparisons
    #   type: Bool
    #   default: false
    #   description: >
    #         Perform all pairwise comparisons between groups when there are more than 2 groups.
    - name: p_adjust
      title: P-value adjustment method
      type: List
      options:
        - title: None
          name: none
        - title: Bonferroni
          name: bonferroni
        - title: Holm
          name: holm
        - title: Benjamini-Hochberg (FDR)
          name: BH
        - title: Benjamini-Yekutieli
          name: BY
      default: none
      description: >
            Method for adjusting p-values for multiple comparisons across variables

    # Advanced Post-hoc Testing Options
    # - name: posthoc_method
    #   title: Post-hoc Analysis Method
    #   type: List
    #   options:
    #     - title: None
    #       name: none
    #     - title: Standardized Residuals
    #       name: standardized_residuals
    #     - title: Adjusted Standardized Residuals
    #       name: adjusted_residuals
    #     - title: CramÃ©r's V
    #       name: cramers_v
    #     - title: Phi Coefficient
    #       name: phi_coefficient
    #     - title: Freeman-Halton Extension
    #       name: freeman_halton
    #   default: none
    #   description: >
    #         Advanced post-hoc analysis methods for categorical associations

    # - name: effect_size_measures
    #   title: Calculate Effect Size Measures
    #   type: Bool
    #   default: false
    #   description: >
    #         Calculate comprehensive effect size measures for categorical associations

    # - name: residual_analysis
    #   title: Perform Residual Analysis
    #   type: Bool
    #   default: false
    #   description: >
    #         Analyze standardized and adjusted residuals for cell contributions

    # - name: mosaic_plot
    #   title: Generate Mosaic Plot
    #   type: Bool
    #   default: false
    #   description: >
    #         Generate mosaic plot for visualizing association patterns

    # - name: correspondence_analysis
    #   title: Perform Correspondence Analysis
    #   type: Bool
    #   default: false
    #   description: >
    #         Perform correspondence analysis for dimensional reduction

    # - name: exact_tests
    #   title: Use Exact Tests When Appropriate
    #   type: Bool
    #   default: true
    #   description: >
    #         Use exact statistical tests for small sample sizes or sparse tables

    # - name: confidence_level
    #   title: Confidence Level for Intervals
    #   type: Number
    #   min: 0.80
    #   max: 0.99
    #   default: 0.95
    #   description: >
    #         Confidence level for effect size confidence intervals

    # - name: simulation_based
    #   title: Use Simulation-Based Tests
    #   type: Bool
    #   default: false
    #   description: >
    #         Use Monte Carlo simulation for p-values when exact computation is not feasible

    # - name: monte_carlo_replicates
    #   title: Monte Carlo Replicates
    #   type: Integer
    #   min: 1000
    #   max: 100000
    #   default: 10000
    #   description: >
    #         Number of Monte Carlo replicates for simulation-based tests

...
