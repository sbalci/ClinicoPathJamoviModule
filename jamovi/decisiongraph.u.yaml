title: Decision Tree Graph
name: decisiongraph
jus: '3.0'
stage: 0
compilerMode: tame
children:
  # ==========================================
  # TREE CONFIGURATION
  # ==========================================
  - type: CollapseBox
    label: "Tree Configuration"
    margin: normal
    collapsed: false
    children:
      - type: Label
        label: "Select the type of decision analysis to perform"
        children:
          - type: Label
            label: "üí° Simple: Basic decision tree with costs and probabilities"
          - type: Label
            label: "üîÑ Markov: Long-term health state modeling with cycles"
          - type: Label
            label: "üí∞ Cost-Effectiveness: Economic evaluation with ICER analysis"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: treeType
            label: "Tree Type"
          - type: ComboBox
            name: clinicalPreset
            label: "Clinical Analysis Preset"

  # ==========================================
  # DATA INPUTS
  # ==========================================
  - type: CollapseBox
    label: "Data Variables"
    margin: normal
    collapsed: false
    children:
      - type: Label
        label: "Define the key variables for your decision analysis"
      - type: VariableSupplier
        persistentItems: false
        stretchFactor: 1
        children:
          - type: TargetLayoutBox
            label: "Decision Nodes (Treatment Options)"
            children:
              - type: VariablesListBox
                name: decisions
                isTarget: true
          - type: TargetLayoutBox
            label: "Probability Variables"
            children:
              - type: VariablesListBox
                name: probabilities
                isTarget: true
          - type: TargetLayoutBox
            label: "Cost Variables"
            children:
              - type: VariablesListBox
                name: costs
                isTarget: true
          - type: TargetLayoutBox
            label: "Utility/Effectiveness Variables"
            children:
              - type: VariablesListBox
                name: utilities
                isTarget: true
          - type: TargetLayoutBox
            label: "Outcome Variables"
            children:
              - type: VariablesListBox
                name: outcomes
                isTarget: true

  # ==========================================
  # MARKOV MODEL SPECIFIC OPTIONS
  # ==========================================
  - type: CollapseBox
    label: "Markov Model Configuration"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Configure health states and transitions for Markov modeling"
        children:
          - type: Label
            label: "üè• Health States: Define possible patient states (Healthy, Sick, Dead)"
          - type: Label
            label: "üîÄ Transitions: Probabilities of moving between states"
      - type: VariableSupplier
        persistentItems: false
        stretchFactor: 1
        children:
          - type: TargetLayoutBox
            label: "Health States"
            children:
              - type: VariablesListBox
                name: healthStates
                isTarget: true
          - type: TargetLayoutBox
            label: "Transition Probabilities"
            children:
              - type: VariablesListBox
                name: transitionProbs
                isTarget: true
          - type: TargetLayoutBox
            label: "Tunnel States (Optional)"
            children:
              - type: VariablesListBox
                name: tunnelStates
                isTarget: true
          - type: TargetLayoutBox
            label: "Age-Specific Transitions (Optional)"
            children:
              - type: VariablesListBox
                name: ageSpecificTransitions
                isTarget: true
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: cycleLength
            format: number
            label: "Cycle Length (years)"
            enable: (treeType:markov)
          - type: TextBox
            name: timeHorizon
            format: number
            label: "Time Horizon (years)"
            enable: (treeType:markov)
          - type: TextBox
            name: discountRate
            format: number
            label: "Annual Discount Rate (0-0.2)"
            enable: (treeType:markov)
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: markovAdvanced
            label: "Enable Advanced Markov Features"
            enable: (treeType:markov)
          - type: CheckBox
            name: timeVaryingTransitions
            label: "Time-Varying Transition Probabilities"
            enable: (markovAdvanced)
          - type: CheckBox
            name: cycleCorrection
            label: "Half-Cycle Correction"
            enable: (treeType:markov)
          - type: CheckBox
            name: cohortTrace
            label: "Generate Cohort Trace Analysis"
            enable: (treeType:markov)

  # ==========================================
  # COST-EFFECTIVENESS ANALYSIS
  # ==========================================
  - type: CollapseBox
    label: "Cost-Effectiveness Analysis"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Configure economic evaluation parameters"
        children:
          - type: Label
            label: "üíµ NMB: Net Monetary Benefit using willingness-to-pay threshold"
          - type: Label
            label: "üìä ICER: Incremental Cost-Effectiveness Ratio analysis"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: calculateNMB
            label: "Calculate Net Monetary Benefit"
            enable: (treeType:costeffectiveness)
          - type: TextBox
            name: willingnessToPay
            format: number
            label: "Willingness to Pay Threshold ($/QALY)"
            enable: (calculateNMB)
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: incrementalAnalysis
            label: "Incremental Cost-Effectiveness Analysis (ICER)"
            enable: (treeType:costeffectiveness)
          - type: CheckBox
            name: dominanceAnalysis
            label: "Identify Dominated Strategies"
            enable: (incrementalAnalysis)
          - type: CheckBox
            name: icer_confidence_intervals
            label: "ICER Confidence Intervals"
            enable: (incrementalAnalysis)

  # ==========================================
  # SENSITIVITY ANALYSIS
  # ==========================================
  - type: CollapseBox
    label: "Sensitivity Analysis"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Assess robustness of results to parameter uncertainty"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: sensitivityAnalysis
            label: "One-Way Sensitivity Analysis"
          - type: CheckBox
            name: tornado
            label: "Create Tornado Diagram"
            enable: (sensitivityAnalysis)
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: probabilisticAnalysis
            label: "Probabilistic Sensitivity Analysis (PSA)"
          - type: TextBox
            name: numSimulations
            format: number
            label: "Number of Monte Carlo Simulations"
            enable: (probabilisticAnalysis)
          - type: ComboBox
            name: psa_distributions
            label: "Parameter Distribution Type"
            enable: (probabilisticAnalysis)
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: psa_advanced_outputs
            label: "Advanced PSA Outputs (CEAC, EVPI)"
            enable: (probabilisticAnalysis)
          - type: TextBox
            name: ceacThresholds
            format: string
            label: "CEAC Thresholds (min,max,step)"
            enable: (psa_advanced_outputs)
          - type: CheckBox
            name: correlatedParameters
            label: "Account for Parameter Correlations"
            enable: (probabilisticAnalysis)
      - type: VariableSupplier
        persistentItems: false
        stretchFactor: 1
        children:
          - type: TargetLayoutBox
            label: "Correlation Matrix Variables"
            children:
              - type: VariablesListBox
                name: correlationMatrix
                isTarget: true

  # ==========================================
  # ADVANCED ANALYSES
  # ==========================================
  - type: CollapseBox
    label: "Advanced Analyses"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Additional economic evaluation methods"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: valueOfInformation
            label: "Value of Information Analysis (EVPI)"
          - type: CheckBox
            name: budgetImpactAnalysis
            label: "Budget Impact Analysis"
      - type: VariableSupplier
        persistentItems: false
        stretchFactor: 1
        children:
          - type: TargetLayoutBox
            label: "EVPI Analysis Parameters"
            children:
              - type: VariablesListBox
                name: evpi_parameters
                isTarget: true
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: targetPopulationSize
            format: number
            label: "Target Population Size"
            enable: (budgetImpactAnalysis)
          - type: TextBox
            name: marketPenetration
            format: number
            label: "Market Penetration Rate (0-1)"
            enable: (budgetImpactAnalysis)
          - type: TextBox
            name: cohortSize
            format: number
            label: "Starting Cohort Size"
            enable: (budgetImpactAnalysis)

  # ==========================================
  # VISUALIZATION OPTIONS
  # ==========================================
  - type: CollapseBox
    label: "Visualization Settings"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Customize the appearance of your decision tree"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: layout
            label: "Tree Layout"
          - type: ComboBox
            name: colorScheme
            label: "Color Scheme"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: nodeShapes
            label: "Different Shapes for Node Types"
          - type: CheckBox
            name: nodeLabels
            label: "Show Node Labels"
          - type: CheckBox
            name: branchLabels
            label: "Show Branch Labels"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: showProbabilities
            label: "Display Probabilities on Branches"
          - type: CheckBox
            name: showCosts
            label: "Display Costs at Terminal Nodes"
          - type: CheckBox
            name: showUtilities
            label: "Display Utilities/Effectiveness"

  # ==========================================
  # OUTPUT OPTIONS
  # ==========================================
  - type: CollapseBox
    label: "Output Tables and Reports"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Select which results to display"
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: calculateExpectedValues
            label: "Calculate Expected Values"
          - type: CheckBox
            name: summaryTable
            label: "Expected Values Summary Table"
          - type: CheckBox
            name: decisionComparison
            label: "Decision Comparison Table"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: chanceNodeMethod
            label: "Chance Node Calculation Method"
          - type: CheckBox
            name: riskAdjustment
            label: "Apply Risk Adjustment"

  # ==========================================
  # PERFORMANCE SETTINGS
  # ==========================================
  - type: CollapseBox
    label: "Performance Settings"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Optimize analysis speed and memory usage"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: performanceMode
            label: "Performance Mode"
          - type: CheckBox
            name: memoryOptimization
            label: "Memory Optimization"
          - type: CheckBox
            name: parallelProcessing
            label: "Parallel Processing"