---
name: clinicalvalidationinteractive
title: Interactive Clinical Model Validation
menuGroup: meddecideExtraT
menuSubgroup: Clinical Decision Support
menuSubtitle: Interactive validation with real-time parameter optimization
version: '0.0.31'
jas: '1.2'

description:
    main: |
        Interactive clinical prediction model validation with real-time parameter 
        validation, intelligent defaults, and guided workflows. Features automatic 
        parameter correction, clinical scenario presets, and dynamic threshold 
        optimization for medical research and diagnostic applications.
    R:
        dontrun: false
        usage: |
            # Interactive clinical validation with presets
            clinical_validation_interactive(
                data = clinical_data,
                outcome = "diagnosis",
                predictors = c("biomarker1", "biomarker2", "age"),
                clinical_preset = "diagnostic_biomarker",
                auto_optimize = TRUE
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame for clinical model validation.

    # Core variables
    - name: outcome
      title: Outcome Variable
      type: Variable
      suggested: [ordinal, nominal]
      permitted: [factor]

    - name: outcomeLevel
      title: Positive/Disease Level
      type: Level
      variable: (outcome)

    - name: predictors
      title: Predictor Variables
      type: Variables
      suggested: [continuous, ordinal, nominal]
      permitted: [numeric, factor]

    - name: time_variable
      title: Time Variable (for survival models)
      type: Variable
      suggested: [continuous]
      permitted: [numeric]
      default: null

    # Clinical preset system
    - name: clinical_preset
      title: Clinical Scenario Preset
      type: List
      options:
        - title: "Custom Configuration"
          name: custom
        - title: "Diagnostic Biomarker Study"
          name: diagnostic_biomarker
        - title: "Cancer Screening Test"
          name: cancer_screening
        - title: "Cardiovascular Risk Score"
          name: cardiovascular_risk
        - title: "Infectious Disease Diagnosis"
          name: infectious_disease
        - title: "Surgical Risk Assessment"
          name: surgical_risk
        - title: "Treatment Response Prediction"
          name: treatment_response
        - title: "Histological Classification"
          name: histological_classification
      default: custom

    # Model specification with intelligent defaults
    - name: model_type
      title: Model Type
      type: List
      options:
        - title: "Logistic Regression"
          name: logistic
        - title: "Cox Proportional Hazards"
          name: cox
        - title: "Random Forest"
          name: random_forest
        - title: "Support Vector Machine"
          name: svm
        - title: "Linear Discriminant Analysis"
          name: lda
      default: logistic

    # Validation methods with dynamic parameters
    - name: validation_method
      title: Validation Method
      type: List
      options:
        - title: "Bootstrap Validation"
          name: bootstrap
        - title: "K-Fold Cross-Validation"
          name: cross_validation
        - title: "Repeated Cross-Validation"
          name: repeated_cv
        - title: "Hold-Out Validation"
          name: holdout
        - title: "Time-Split Validation"
          name: time_split
      default: bootstrap

    # Dynamic validation parameters
    - name: bootstrap_samples
      title: Bootstrap Samples
      type: Integer
      default: 1000
      min: 100
      max: 5000

    - name: cv_folds
      title: Cross-Validation Folds
      type: Integer
      default: 10
      min: 3
      max: 20

    - name: cv_repeats
      title: CV Repeats
      type: Integer
      default: 3
      min: 1
      max: 10

    - name: holdout_proportion
      title: Hold-Out Test Proportion
      type: Number
      default: 0.25
      min: 0.1
      max: 0.4

    - name: stratified_sampling
      title: Stratified Sampling
      type: Bool
      default: true

    # Clinical context with intelligent parameter adjustment
    - name: clinical_context
      title: Clinical Application
      type: List
      options:
        - title: "Diagnostic Testing"
          name: diagnosis
        - title: "Disease Screening"
          name: screening
        - title: "Prognostic Modeling"
          name: prognosis
        - title: "Treatment Response"
          name: treatment
        - title: "Risk Stratification"
          name: risk
        - title: "Histological Classification"
          name: histological
      default: diagnosis

    # Prevalence with real-time PPV/NPV updates
    - name: prevalence_adjustment
      title: Adjust for Disease Prevalence
      type: Bool
      default: false

    - name: population_prevalence
      title: Population Prevalence (%)
      type: Number
      default: 10
      min: 0.1
      max: 50

    # Cost matrix with intelligent defaults
    - name: cost_matrix
      title: Clinical Cost Matrix
      type: List
      options:
        - title: "Equal Costs"
          name: equal
        - title: "Conservative Screening (avoid FN)"
          name: screening
        - title: "Conservative Diagnosis (avoid FP)"
          name: diagnosis
        - title: "Custom Matrix"
          name: custom
      default: equal

    - name: fn_fp_cost_ratio
      title: FN:FP Cost Ratio
      type: Number
      default: 2.0
      min: 0.1
      max: 10.0

    # Performance thresholds with validation
    - name: min_sensitivity
      title: Minimum Required Sensitivity
      type: Number
      default: 0.80
      min: 0.50
      max: 0.99

    - name: min_specificity
      title: Minimum Required Specificity
      type: Number
      default: 0.80
      min: 0.50
      max: 0.99

    - name: min_ppv
      title: Minimum Required PPV
      type: Number
      default: 0.70
      min: 0.50
      max: 0.99

    - name: min_npv
      title: Minimum Required NPV
      type: Number
      default: 0.90
      min: 0.50
      max: 0.99

    # Auto-optimization features
    - name: auto_optimize_threshold
      title: Auto-Optimize Decision Threshold
      type: Bool
      default: false

    - name: optimization_metric
      title: Optimization Metric
      type: List
      options:
        - title: "Youden Index (Sens + Spec - 1)"
          name: youden
        - title: "Clinical Utility (Cost-Weighted)"
          name: utility
        - title: "F1 Score"
          name: f1
        - title: "Matthews Correlation"
          name: mcc
        - title: "Custom Clinical Score"
          name: custom
      default: youden

    # Performance metrics
    - name: performance_metrics
      title: Performance Metrics to Report
      type: List
      options:
        - title: "All Standard Metrics"
          name: all
        - title: "Clinical Decision Metrics"
          name: clinical
        - title: "Discrimination Only"
          name: discrimination
        - title: "Calibration Only"
          name: calibration
      default: all

    - name: confidence_level
      title: Confidence Level
      type: Number
      default: 0.95
      min: 0.80
      max: 0.99

    # Real-time feedback options
    - name: show_realtime_metrics
      title: Show Real-Time Metric Updates
      type: Bool
      default: true

    - name: show_parameter_warnings
      title: Show Parameter Validation Warnings
      type: Bool
      default: true

    - name: show_clinical_guidance
      title: Show Clinical Decision Guidance
      type: Bool
      default: true

    # Output options
    - name: show_model_summary
      title: Show Model Summary
      type: Bool
      default: true

    - name: show_performance_table
      title: Show Performance Metrics Table
      type: Bool
      default: true

    - name: show_calibration_plot
      title: Show Calibration Plot
      type: Bool
      default: true

    - name: show_roc_curve
      title: Show ROC Curve
      type: Bool
      default: true

    - name: show_threshold_optimization
      title: Show Threshold Optimization Plot
      type: Bool
      default: false

    - name: show_clinical_interpretation
      title: Show Clinical Guidelines
      type: Bool
      default: true

    # Advanced options
    - name: missing_data_handling
      title: Missing Data Handling
      type: List
      options:
        - title: "Complete Cases Only"
          name: complete_cases
        - title: "Multiple Imputation"
          name: imputation
        - title: "Missing Indicator Method"
          name: indicator
      default: complete_cases

    # Reproducibility
    - name: set_seed
      title: Set Random Seed
      type: Bool
      default: true

    - name: seed_value
      title: Random Seed Value
      type: Integer
      default: 42
      min: 1
      max: 999999
