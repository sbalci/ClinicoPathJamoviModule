---
name: decisioncompare
title: Compare Medical Decision Tests
jrs: '1.1'

items:
    - name: text1
      title: Original Data
      type: Preformatted
      visible: false # (od)

    - name: text2
      title: Original Data
      type: Html
      visible: false (od)

    # Tables for Test 1
    - name: cTable1
      title: 'Test 1 - Recoded Data'
      type: Table
      visible: (!is.null(test1) && test1 != "")
      rows: 0
      columns:
        - name: newtest
          title: ''
          type: text
        - name: GP
          title: 'Gold Positive'
          type: number
        - name: GN
          title: 'Gold Negative'
          type: number
        - name: Total
          title: 'Total'
          type: number

    - name: epirTable1
      title: 'Test 1 - Confidence Intervals'
      type: Table
      visible: (ci && !is.null(test1) && test1 != "")
      rows: 0
      columns:
        - name: statsnames
          title: "Decision Statistics"
          type: text
        - name: est
          title: "Estimate"
          type: number
          format: pc
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc

    # Tables for Test 2
    - name: cTable2
      title: 'Test 2 - Recoded Data'
      type: Table
      visible: (!is.null(test2) && test2 != "")
      rows: 0
      columns:
        - name: newtest
          title: ''
          type: text
        - name: GP
          title: 'Gold Positive'
          type: number
        - name: GN
          title: 'Gold Negative'
          type: number
        - name: Total
          title: 'Total'
          type: number

    - name: epirTable2
      title: 'Test 2 - Confidence Intervals'
      type: Table
      visible: (ci && !is.null(test2) && test2 != "")
      rows: 0
      columns:
        - name: statsnames
          title: "Decision Statistics"
          type: text
        - name: est
          title: "Estimate"
          type: number
          format: pc
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc

    # Tables for Test 3
    - name: cTable3
      title: 'Test 3 - Recoded Data'
      type: Table
      visible: (!is.null(test3) && test3 != "")
      rows: 0
      columns:
        - name: newtest
          title: ''
          type: text
        - name: GP
          title: 'Gold Positive'
          type: number
        - name: GN
          title: 'Gold Negative'
          type: number
        - name: Total
          title: 'Total'
          type: number

    - name: epirTable3
      title: 'Test 3 - Confidence Intervals'
      type: Table
      visible: (ci && !is.null(test3) && test3 != "")
      rows: 0
      columns:
        - name: statsnames
          title: "Decision Statistics"
          type: text
        - name: est
          title: "Estimate"
          type: number
          format: pc
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc

    # Comparison table
    - name: comparisonTable
      title: 'Decision Test Comparison'
      type: Table
      rows: 0
      columns:
        - name: test
          title: 'Test'
          type: text
        - name: Sens
          title: 'Sensitivity'
          type: number
          format: pc
        - name: Spec
          title: 'Specificity'
          type: number
          format: pc
        - name: AccurT
          title: 'Accuracy'
          type: number
          format: pc
        - name: PPV
          title: 'Positive Predictive Value'
          type: number
          format: pc
        - name: NPV
          title: 'Negative Predictive Value'
          type: number
          format: pc
        - name: LRP
          title: 'Positive Likelihood Ratio'
          type: number
        - name: LRN
          title: 'Negative Likelihood Ratio'
          type: number
      clearWith:
          - pp
          - pprob

    # Statistical Comparison Tables
    - name: mcnemarTable
      title: "Statistical Comparison of Test Accuracy"
      type: Table
      visible: (statComp)
      rows: 0
      notes:
        note: >
          For 2 tests: McNemar's test compares diagnostic CORRECTNESS (agreement with gold standard) between paired tests.
          For 3+ tests: Cochran's Q test provides an overall test, followed by pairwise McNemar's tests with Holm-Bonferroni correction for multiple comparisons.
          Tests examine discordant pairs (cases where one test is correct and the other is wrong relative to the gold standard) to determine if differences in accuracy are statistically significant.
      columns:
        - name: comparison
          title: 'Comparison'
          type: text
        - name: stat
          title: "Chi-squared"
          type: number
        - name: df
          title: 'df'
          type: integer
        - name: p
          title: 'p-value'
          type: number
          format: zto,pvalue
        - name: interpretation
          title: 'Clinical Interpretation'
          type: text

    - name: diffTable
      title: 'Differences with 95% Confidence Intervals'
      type: Table
      visible: (statComp)
      rows: 0
      columns:
        - name: comparison
          title: 'Comparison'
          type: text
        - name: metric
          title: 'Metric'
          type: text
        - name: diff
          title: 'Difference'
          type: number
          format: pc
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc

    # Plot
    - name: plot1
      title: 'Test Comparison'
      type: Image
      width: 600
      height: 450
      renderFun: .plot1
      requiresData: true
      visible: (plot)
      clearWith:
          - plot
      refs:
          - ggplot2

    # Radar Plot
    - name: plotRadar
      title: 'Radar Plot Comparison'
      type: Image
      width: 600
      height: 600
      renderFun: .plotRadar
      requiresData: true
      visible: (radarplot)
      clearWith:
          - radarplot
      refs:
          - ggplot2

    # Summary Report
    - name: summaryReport
      title: 'Summary'
      type: Html
      visible: (statComp && showSummary)

    # Report Sentence
    - name: reportSentence
      title: 'Manuscript-Ready Report'
      type: Html
      visible: (statComp && showReportSentence)

    # Explanations and Glossary
    - name: explanationsContent
      title: 'Statistical Explanations & Glossary'
      type: Html
      visible: (showExplanations)

    # Clinical Report
    - name: clinicalReport
      title: 'Clinical Summary & Report Templates'
      type: Html
      visible: true

    # About This Analysis
    - name: aboutAnalysis
      title: 'About This Analysis'
      type: Html
      visible: true

    # Notice outputs converted to HTML to avoid serialization errors
    - name: notices
      title: 'Important Information'
      type: Html
      clearWith:
          - gold
          - goldPositive
          - test1
          - test1Positive
          - test2
          - test2Positive
          - test3
          - test3Positive
          - pp
          - pprob
          - ci
          - excludeIndeterminate
          - statComp

refs:
    - DiagnosticTests
    - ClinicoPathJamoviModule
    - epiR

...
