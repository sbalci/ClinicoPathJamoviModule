---
name: clinicalvalidation
title: Clinical Model Validation Suite
menuGroup: meddecideD
menuSubgroup: Clinical Decision Support
menuSubtitle: Comprehensive validation for clinical prediction models
version: '0.0.31'
jas: '1.2'

description:
    main: |
        Comprehensive validation suite for clinical prediction models including 
        bootstrap validation, cross-validation, model calibration assessment, 
        and clinical performance evaluation designed for medical research and 
        diagnostic test evaluation.
    R:
        dontrun: false
        usage: |
            # Clinical model validation with bootstrap
            clinical_validation(
                data = clinical_data,
                outcome = "diagnosis",
                predictors = c("biomarker1", "biomarker2", "age", "gender"),
                model_type = "logistic",
                validation_method = "bootstrap",
                bootstrap_samples = 1000,
                clinical_context = "diagnosis"
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame for clinical model validation.

    # Core variables
    - name: outcome
      title: Outcome Variable
      type: Variable
      suggested: [ordinal, nominal]
      permitted: [factor]

    - name: outcomeLevel
      title: Positive/Disease Level
      type: Level
      variable: (outcome)

    - name: predictors
      title: Predictor Variables
      type: Variables
      suggested: [continuous, ordinal, nominal]
      permitted: [numeric, factor]

    - name: time_variable
      title: Time Variable (for survival models)
      type: Variable
      suggested: [continuous]
      permitted: [numeric]
      default: null

    # Model specification
    - name: model_type
      title: Model Type
      type: List
      options:
        - title: "Logistic Regression"
          name: logistic
        - title: "Cox Proportional Hazards"
          name: cox
        - title: "Random Forest"
          name: random_forest
        - title: "Support Vector Machine"
          name: svm
        - title: "Linear Discriminant Analysis"
          name: lda
      default: logistic

    - name: model_formula
      title: Custom Model Formula
      type: String
      default: ""

    # Validation methods
    - name: validation_method
      title: Validation Method
      type: List
      options:
        - title: "Bootstrap Validation"
          name: bootstrap
        - title: "K-Fold Cross-Validation"
          name: cross_validation
        - title: "Repeated Cross-Validation"
          name: repeated_cv
        - title: "Hold-Out Validation"
          name: holdout
        - title: "Time-Split Validation"
          name: time_split
      default: bootstrap

    - name: bootstrap_samples
      title: Bootstrap Samples
      type: Integer
      default: 1000
      min: 100
      max: 5000

    - name: cv_folds
      title: Cross-Validation Folds
      type: Integer
      default: 10
      min: 3
      max: 20

    - name: cv_repeats
      title: CV Repeats
      type: Integer
      default: 3
      min: 1
      max: 10

    - name: holdout_proportion
      title: Hold-Out Test Proportion
      type: Number
      default: 0.25
      min: 0.1
      max: 0.4

    - name: stratified_sampling
      title: Stratified Sampling
      type: Bool
      default: true

    # Clinical context and interpretation
    - name: clinical_context
      title: Clinical Application
      type: List
      options:
        - title: "Diagnostic Testing"
          name: diagnosis
        - title: "Disease Screening"
          name: screening
        - title: "Prognostic Modeling"
          name: prognosis
        - title: "Treatment Response"
          name: treatment
        - title: "Risk Stratification"
          name: risk
        - title: "Histological Classification"
          name: histological
      default: diagnosis

    - name: prevalence_adjustment
      title: Adjust for Disease Prevalence
      type: Bool
      default: false

    - name: population_prevalence
      title: Population Prevalence (%)
      type: Number
      default: 10
      min: 0.1
      max: 50

    - name: cost_matrix
      title: Clinical Cost Matrix
      type: List
      options:
        - title: "Equal Costs"
          name: equal
        - title: "Conservative Screening (avoid FN)"
          name: screening
        - title: "Conservative Diagnosis (avoid FP)"
          name: diagnosis
        - title: "Custom Matrix"
          name: custom
      default: equal

    - name: fn_fp_cost_ratio
      title: FN:FP Cost Ratio
      type: Number
      default: 2.0
      min: 0.1
      max: 10.0

    # Performance metrics
    - name: performance_metrics
      title: Performance Metrics to Report
      type: List
      options:
        - title: "All Standard Metrics"
          name: all
        - title: "Clinical Decision Metrics"
          name: clinical
        - title: "Discrimination Only"
          name: discrimination
        - title: "Calibration Only"
          name: calibration
      default: all

    - name: confidence_level
      title: Confidence Level
      type: Number
      default: 0.95
      min: 0.80
      max: 0.99

    # Calibration assessment
    - name: calibration_method
      title: Calibration Assessment
      type: List
      options:
        - title: "Hosmer-Lemeshow"
          name: hosmer_lemeshow
        - title: "Brier Score"
          name: brier
        - title: "Calibration Plot"
          name: plot
        - title: "All Methods"
          name: all
      default: all

    - name: calibration_bins
      title: Calibration Plot Bins
      type: Integer
      default: 10
      min: 5
      max: 20

    # Model comparison
    - name: compare_models
      title: Compare Multiple Models
      type: Bool
      default: false

    - name: comparison_models
      title: Models to Compare
      type: List
      options:
        - title: "Logistic vs. Random Forest"
          name: logistic_rf
        - title: "All Classification Models"
          name: all_classification
        - title: "Cox vs. Random Survival Forest"
          name: cox_rsf
        - title: "Custom Selection"
          name: custom
      default: logistic_rf

    # Output options
    - name: show_model_summary
      title: Show Model Summary
      type: Bool
      default: true

    - name: show_performance_table
      title: Show Performance Metrics Table
      type: Bool
      default: true

    - name: show_calibration_plot
      title: Show Calibration Plot
      type: Bool
      default: true

    - name: show_roc_curve
      title: Show ROC Curve
      type: Bool
      default: true

    - name: show_validation_curves
      title: Show Validation Learning Curves
      type: Bool
      default: false

    - name: show_residual_plots
      title: Show Model Residual Plots
      type: Bool
      default: false

    - name: show_clinical_interpretation
      title: Show Clinical Guidelines
      type: Bool
      default: true

    - name: export_results
      title: Export Validation Results
      type: Bool
      default: false

    - name: detailed_bootstrap
      title: Detailed Bootstrap Analysis
      type: Bool
      default: false

    # Advanced options
    - name: missing_data_handling
      title: Missing Data Handling
      type: List
      options:
        - title: "Complete Cases Only"
          name: complete_cases
        - title: "Multiple Imputation"
          name: imputation
        - title: "Missing Indicator Method"
          name: indicator
      default: complete_cases

    - name: imputation_methods
      title: Imputation Methods
      type: Integer
      default: 5
      min: 3
      max: 10

    - name: parallel_processing
      title: Use Parallel Processing
      type: Bool
      default: false

    - name: n_cores
      title: Number of CPU Cores
      type: Integer
      default: 2
      min: 1
      max: 8

    # Reproducibility
    - name: set_seed
      title: Set Random Seed
      type: Bool
      default: true

    - name: seed_value
      title: Random Seed Value
      type: Integer
      default: 42
      min: 1
      max: 999999
