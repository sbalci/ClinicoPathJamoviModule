---
name: jjoncoplot
title: Genomic Landscape Visualization
menuGroup: OncoPathT
menuSubgroup: 'Molecular Pathology Plots'
menuSubtitle: 'Oncoplot, Mutation Landscape, Clinical Annotations'
version: '0.0.1'
jas: '1.2'

description:
    main: Creates oncoplots (mutation landscapes) to visualize genomic alterations across genes and samples with optional clinical annotations.
    R:
        dontrun: true
        usage: |
            data <- data.frame(
                SampleID = paste0("S", 1:10),
                TP53 = c(1, 0, 1, 0, 1, 0, 0, 1, 0, 1),
                KRAS = c(0, 1, 0, 1, 0, 1, 1, 0, 1, 0),
                PIK3CA = c(1, 1, 0, 0, 1, 0, 1, 1, 0, 0)
            )
            jjoncoplot(
                data = data,
                sampleVar = "SampleID",
                geneVars = c("TP53", "KRAS", "PIK3CA")
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.
          jamovi: >
            The data as a data frame containing mutation information.

    - name: sampleVar
      title: Sample ID Variable
      type: Variable
      suggested: [nominal, id]
      permitted: [numeric, factor, id]
      description:
          R: >
            Variable containing sample identifiers.
          jamovi: >
            Variable containing sample identifiers (e.g., patient IDs, sample names).

    - name: geneVars
      title: Gene Variables
      type: Variables
      suggested: [nominal, ordinal]
      permitted: [numeric, factor]
      description:
          R: >
            Variables representing genes or mutations (0/1 or categorical values).
          jamovi: >
            Select gene variables representing mutations or alterations. Use 0/1 coding where 1 = mutated, 0 = wild-type.

    - name: clinicalVars
      title: Clinical Variables
      type: Variables
      suggested: [nominal, ordinal, continuous]
      permitted: [numeric, factor]
      default: NULL
      description:
          R: >
            Optional clinical variables for annotation (e.g., age, stage, treatment).
          jamovi: >
            Optional clinical variables to display as annotations (e.g., age, stage, treatment response).

    - name: mutationTypeVar
      title: Mutation Type Variable
      type: Variable
      suggested: [nominal]
      permitted: [factor]
      default: NULL
      description:
          R: >
            Variable containing mutation type information (e.g., SNV, CNV, Fusion).
          jamovi: >
            Select variable with mutation types to enable colored mutation coding.

    - name: clinicalPreset
      title: Clinical Analysis Type
      type: List
      options:
        - title: Custom Analysis
          name: custom
        - title: Tumor Profiling (Top genes, TMB)
          name: tumor_profiling
        - title: Biomarker Discovery (All genes, co-occurrence)
          name: biomarker_discovery
        - title: Therapeutic Targets (Actionable genes)
          name: therapeutic_targets
        - title: Pathway Analysis (Co-occurrence patterns)
          name: pathway_analysis
      default: custom
      description:
          R: >
            Predefined clinical analysis configurations optimized for specific research goals.
          jamovi: >
            Choose a clinical analysis preset optimized for your research question, or select Custom for manual configuration.

    - name: plotType
      title: Plot Type
      type: List
      options:
        - title: Classic Oncoplot (Mutation matrix)
          name: oncoplot
        - title: Gene Frequency Plot (Mutation rates)
          name: frequency
        - title: Co-occurrence Plot (Gene interactions)
          name: cooccurrence
      default: oncoplot
      description:
          R: >
            Type of genomic visualization to generate.
          jamovi: >
            â€¢ Oncoplot: Visual mutation matrix showing which genes are mutated in which samples
            â€¢ Frequency: Bar chart of mutation rates per gene (identifies most frequently altered genes)  
            â€¢ Co-occurrence: Heatmap showing which genes tend to be mutated together or exclusively

    - name: topn
      title: Top N Genes to Display  
      type: Number
      default: 10
      min: 3
      max: 50
      description:
          R: >
            Number of most frequently mutated genes to display.
          jamovi: >
            ðŸ“Š Number of most frequently mutated genes to include in analysis. 
            Clinical guidance: 10-20 genes typical for tumor profiling, 3-5 for focused therapeutic targets.

    - name: genesToInclude
      title: Specific Genes to Include
      type: String
      default: ""
      description:
          R: >
            Comma-separated list of specific genes to include (overrides topn).
          jamovi: >
            ðŸŽ¯ Focus on specific genes of clinical interest (e.g., "TP53,KRAS,PIK3CA,EGFR").
            Example therapeutic targets: BRAF, EGFR, ALK, ROS1, NTRK, IDH1, IDH2.

    - name: genesToIgnore
      title: Genes to Exclude
      type: String
      default: ""
      description:
          R: >
            Comma-separated list of genes to exclude from analysis.
          jamovi: >
            Comma-separated gene names to exclude from the oncoplot.

    - name: maxSamples
      title: Maximum Samples to Display
      type: Number
      default: 50
      min: 10
      max: 500
      description:
          R: >
            Maximum number of samples to display.
          jamovi: >
            Maximum number of samples to display in the oncoplot.

    - name: sortBy
      title: Sort Samples By
      type: List
      options:
        - title: Hierarchical (ggoncoplot)
          name: hierarchical
        - title: Mutation Count
          name: mutation_count
        - title: Sample ID
          name: sample_id
        - title: Clinical Variable
          name: clinical
      default: hierarchical
      description:
          R: >
            Method for sorting samples in the plot.
          jamovi: >
            Choose sample sorting method. Hierarchical uses ggoncoplot's base-2 scoring algorithm.

    - name: colorScheme
      title: Color Scheme
      type: List
      options:
        - title: Default (Color-blind safe)
          name: default
        - title: Mutation Type (Multi-color)
          name: mutation_type
        - title: Clinical (Blue-green scale)
          name: clinical
        - title: Viridis (Color-blind safe)
          name: viridis
        - title: High Contrast (Accessibility)
          name: high_contrast
      default: default
      description:
          R: >
            Color scheme for the oncoplot visualization.
          jamovi: >
            ðŸŽ¨ Choose color scheme for mutations. Color-blind safe options recommended for publications and presentations.

    - name: showMutationLoad
      title: Show Mutation Load
      type: Bool
      default: false
      description:
          R: >
            Display mutation load bar plot alongside oncoplot.
          jamovi: >
            Display mutation burden for each sample as a side bar plot.

    - name: showGeneFreq
      title: Show Gene Frequency
      type: Bool
      default: false
      description:
          R: >
            Display gene mutation frequency alongside oncoplot.
          jamovi: >
            Display mutation frequency for each gene as a side bar plot (ggoncoplot style).

    - name: drawMarginalPlots
      title: Draw Integrated Marginal Plots
      type: Bool
      default: false
      description:
          R: >
            Integrate gene frequency and TMB plots as margins of the main oncoplot.
          jamovi: >
            Create ggoncoplot-style integrated marginal plots (gene frequencies + TMB) alongside main oncoplot.

    - name: showTMB
      title: Show Tumor Mutation Burden (TMB)
      type: Bool
      default: false
      description:
          R: >
            Display tumor mutation burden (TMB) bar plot.
          jamovi: >
            ðŸ§¬ Display total mutations per sample. High TMB (>10-20 mutations/Mb) may predict immunotherapy response in many cancer types.

    - name: log10TransformTMB
      title: Log10 Transform TMB
      type: Bool
      default: true
      description:
          R: >
            Apply log10 transformation to TMB values for better visualization.
          jamovi: >
            Apply log10 transformation to TMB values (recommended for datasets with hypermutators).

    - name: showClinicalAnnotation
      title: Show Clinical Annotations
      type: Bool
      default: false
      description:
          R: >
            Display clinical annotations as heatmap.
          jamovi: >
            Display clinical variables as annotation tracks.

    - name: plotWidth
      title: Plot Width
      type: Number
      default: 800
      min: 400
      max: 1600
      description:
          R: >
            Width of the plot in pixels.
          jamovi: >
            Width of the plot in pixels.

    - name: plotHeight
      title: Plot Height
      type: Number
      default: 600
      min: 300
      max: 1200
      description:
          R: >
            Height of the plot in pixels.
          jamovi: >
            Height of the plot in pixels.

    - name: fontSize
      title: Font Size
      type: Number
      default: 10
      min: 6
      max: 16
      description:
          R: >
            Font size for plot labels.
          jamovi: >
            Font size for gene and sample labels.

    - name: showLegend
      title: Show Legend
      type: Bool
      default: false
      description:
          R: >
            Display plot legend.
          jamovi: >
            Display legend explaining mutation types and colors.

...