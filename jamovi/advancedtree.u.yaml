title: Advanced Decision Tree Analysis
name: advancedtree
jus: '3.0'
stage: 0
compilerMode: tame

children:
  # Variable Selection
  - type: VariableSupplier
    persistentItems: false
    stretchFactor: 1
    children:
      - type: TargetLayoutBox
        label: Target Variable
        children:
          - type: VariablesListBox
            name: target
            maxItemCount: 1
            isTarget: true
      - type: TargetLayoutBox
        label: Continuous Predictors
        children:
          - type: VariablesListBox
            name: vars
            isTarget: true
            height: small
      - type: TargetLayoutBox
        label: Categorical Predictors
        children:
          - type: VariablesListBox
            name: facs
            isTarget: true
            height: small

  # Model Settings Section
  - type: CollapseBox
    label: Model Settings
    collapsed: false
    children:
      - type: LayoutBox
        children:
          - type: LevelSelector
            name: targetLevel
            label: Positive Class
      - type: LayoutBox
        children:
          - type: ComboBox
            name: algorithm
            label: Algorithm
      - type: LayoutBox
        children:
          - type: ComboBox
            name: validation
            label: Validation Method
      - type: LayoutBox
        children:
          - type: TextBox
            name: test_split
            label: Test Split (%)
            format: number
            enable: (validation:holdout)
      - type: LayoutBox
        children:
          - type: TextBox
            name: cv_folds
            label: Number of Folds
            format: number
            enable: (validation:cv)

  # Tree Parameters Section
  - type: CollapseBox
    label: Tree Parameters
    collapsed: true
    children:
      - type: LayoutBox
        children:
          - type: TextBox
            name: max_depth
            label: Maximum Depth
            format: number
      - type: LayoutBox
        children:
          - type: TextBox
            name: min_samples_split
            label: Min Samples to Split
            format: number
      - type: LayoutBox
        children:
          - type: TextBox
            name: min_samples_leaf
            label: Min Samples per Leaf
            format: number
      - type: LayoutBox
        children:
          - type: TextBox
            name: n_estimators
            label: Number of Trees
            format: number
            enable: (algorithm:randomforest || algorithm:extratrees || algorithm:xgboost)
      - type: LayoutBox
        children:
          - type: TextBox
            name: learning_rate
            label: Learning Rate
            format: number
            enable: (algorithm:xgboost)

  # Output Options Section
  - type: CollapseBox
    label: Output Options
    collapsed: false
    children:
      - type: Label
        label: Basic Outputs
        children:
          - type: CheckBox
            name: show_tree_plot
            label: Decision Tree Plot
          - type: CheckBox
            name: show_importance_plot
            label: Feature Importance
          - type: CheckBox
            name: show_performance_metrics
            label: Performance Metrics
          - type: CheckBox
            name: show_confusion_matrix
            label: Confusion Matrix
      - type: Label
        label: Advanced Outputs
        margin: large
        children:
          - type: CheckBox
            name: show_roc_curve
            label: ROC Curve
          - type: CheckBox
            name: show_validation_curves
            label: Validation Curves
          - type: CheckBox
            name: show_calibration_plot
            label: Calibration Plot

  # Advanced Options Section
  - type: CollapseBox
    label: Advanced Options
    collapsed: true
    children:
      - type: LayoutBox
        children:
          - type: CheckBox
            name: handle_imbalance
            label: Handle Class Imbalance
      - type: LayoutBox
        children:
          - type: ComboBox
            name: imbalance_method
            label: Imbalance Method
            enable: (handle_imbalance)
      - type: LayoutBox
        children:
          - type: CheckBox
            name: feature_selection
            label: Automatic Feature Selection
      - type: LayoutBox
        children:
          - type: ComboBox
            name: importance_method
            label: Importance Method
      - type: LayoutBox
        children:
          - type: CheckBox
            name: hyperparameter_tuning
            label: Hyperparameter Tuning
      - type: LayoutBox
        children:
          - type: ComboBox
            name: tuning_method
            label: Tuning Method
            enable: (hyperparameter_tuning)
      - type: LayoutBox
        children:
          - type: CheckBox
            name: bootstrap_confidence
            label: Bootstrap Confidence Intervals
      - type: LayoutBox
        children:
          - type: TextBox
            name: n_bootstrap
            label: Bootstrap Samples
            format: number
            enable: (bootstrap_confidence)

  # Interpretability Options Section
  - type: CollapseBox
    label: Interpretability
    collapsed: true
    children:
      - type: LayoutBox
        children:
          - type: CheckBox
            name: interpretability
            label: Enable Interpretability Analysis
      - type: LayoutBox
        children:
          - type: CheckBox
            name: shap_analysis
            label: SHAP Values
            enable: (interpretability)
      - type: LayoutBox
        children:
          - type: CheckBox
            name: partial_dependence
            label: Partial Dependence Plots
            enable: (interpretability)
      - type: LayoutBox
        children:
          - type: CheckBox
            name: interaction_analysis
            label: Feature Interactions
            enable: (interpretability)

  # Clinical Settings Section
  - type: CollapseBox
    label: Clinical Settings
    collapsed: true
    children:
      - type: LayoutBox
        children:
          - type: ComboBox
            name: clinical_context
            label: Clinical Context
      - type: LayoutBox
        children:
          - type: CheckBox
            name: cost_sensitive_thresholds
            label: Cost-Sensitive Analysis
      - type: LayoutBox
        children:
          - type: TextBox
            name: fn_fp_ratio
            label: False Negative/Positive Cost Ratio
            format: number
            enable: (cost_sensitive_thresholds)
      - type: LayoutBox
        children:
          - type: ComboBox
            name: missing_data_handling
            label: Missing Data Handling
      - type: LayoutBox
        children:
          - type: CheckBox
            name: export_model
            label: Export Model