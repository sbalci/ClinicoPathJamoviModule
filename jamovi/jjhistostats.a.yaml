---
name:  jjhistostats
title: Histogram
menuGroup: JJStatsPlotT2
menuSubgroup: Distribution
# menuSubtitle: Histogram
version: '0.0.32'
jas: '1.2'


description:
    main: |
        'Wrapper Function for ggstatsplot::gghistostats and
        ggstatsplot::grouped_gghistostats to generate Histogram.'
    R:
        dontrun: true
        usage: |
            # Load test data
            data(jjhistostats_test_data)
            
            # Basic histogram
            jjhistostats(
              data = jjhistostats_test_data,
              dep = "age_years",
              typestatistics = "parametric"
            )
            
            # Multiple histograms
            jjhistostats(
              data = jjhistostats_test_data,
              dep = c("age_years", "tumor_size_mm", "bmi"),
              centralityline = TRUE,
              resultssubtitle = TRUE
            )
            
            # Grouped histogram by disease stage
            jjhistostats(
              data = jjhistostats_test_data,
              dep = "psa_level",
              grvar = "disease_stage",
              typestatistics = "nonparametric",
              changebinwidth = TRUE,
              binwidth = 2.0
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.

    - name: dep
      title: Variables
      type: Variables
      suggested: [ continuous ]
      permitted: [ numeric ]
      description:
          R: >
            One or more continuous numeric variables for which histograms will be
            created. Multiple variables will be displayed in separate panels.
          ui: >
            Select continuous variables to analyze (e.g., age, tumor size, biomarker levels, 
            lab values). Each variable will show its distribution shape and statistical properties.

    - name: grvar
      title: 'Split By (Optional)'
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      description:
          R: >
            Optional grouping variable to create separate histograms for each
            level of this variable (grouped analysis).
          ui: >
            Optional: Compare distributions between groups (e.g., treatment arms, 
            disease stages, patient subtypes). Creates separate histograms for each group.

# Data ----


# Analysis ----


    - name: typestatistics
      title: 'Type of Statistic'
      type: List
      options:
        - title: Parametric (t-test, normal distribution)
          name: parametric
        - title: Nonparametric (Mann-Whitney, no distribution assumption)
          name: nonparametric
        - title: Robust (trimmed mean, outlier-resistant)
          name: robust
        - title: Bayes (Bayesian inference)
          name: bayes
      default: parametric
      description:
          R: >
            Type of statistical test for normality assessment. 'parametric' uses
            Shapiro-Wilk test, 'nonparametric' uses Anderson-Darling test,
            'robust' uses robust normality tests, 'bayes' provides Bayesian analysis.
          ui: >
            Choose statistical approach: Parametric (best for normally distributed lab values like cholesterol), 
            Nonparametric (for skewed data or ordinal scales like tumor grades), 
            Robust (when outliers are present), Bayes (for uncertainty quantification).



# Plot ----


    - name: centralityline
      title: Centrality Line
      type: Bool
      default: false
      description:
          R: >
            Whether to display a vertical line indicating the measure of central
            tendency (mean for parametric, median for nonparametric).
          ui: >
            Show a vertical line at the center of the distribution (mean or median). 
            Helpful for comparing typical values across groups or identifying distribution shifts.

    - name: changebinwidth
      title: Change Bin Width
      type: Bool
      default: false
      description:
          R: >
            Whether to manually specify the bin width. If FALSE, automatic
            bin width calculation will be used.
          ui: >
            Enable to manually control histogram resolution. Useful for fine-tuning 
            visualization of biomarker ranges or lab value distributions.

    - name: binwidth
      title: Bin Width (Default is max(x) - min(x) / sqrt(N))
      type: Number
      default: 1.1
      description:
          R: >
            Manual bin width for histogram. Only used when changebinwidth is TRUE.
            Smaller values create more bins, larger values create fewer bins.




    - name: resultssubtitle
      title: Statistical Results
      type: Bool
      default: false
      description:
          R: >
            Whether to display statistical test results as subtitle in the plot,
            including normality test results and descriptive statistics.
          ui: >
            Show statistical results directly on the plot (normality tests, descriptive statistics). 
            Helpful for quick interpretation without switching between tabs.
    
    - name: showInterpretation
      title: Show Clinical Interpretation
      type: Bool
      default: false
      description:
          R: >
            Generate clinical interpretation of histogram results including distribution shape, 
            normality assessment, and practical implications for clinical data.
          ui: >
            Generate plain-language interpretation of results including what the distribution 
            shape means for your clinical data and recommendations for further analysis.

    - name: clinicalPreset
      title: Clinical Analysis Preset
      type: List
      options:
        - title: Custom (manual settings)
          name: custom
        - title: Lab Values Analysis (parametric, centrality line)
          name: lab_values
        - title: Biomarker Distribution (nonparametric, robust)
          name: biomarkers
        - title: Patient Characteristics (age, BMI - parametric)
          name: patient_chars
        - title: Pathology Scores (ordinal, nonparametric)
          name: pathology_scores
      default: custom
      description:
          R: >
            Predefined configurations optimized for common clinical data types.
            Automatically sets appropriate statistical methods and visualization options.
          ui: >
            Choose a preset optimized for your data type. Each preset automatically configures 
            statistical methods and display options appropriate for that clinical context.

    - name: test.value
      title: Test Value
      type: Number
      default: 0
      description:
          R: >
            Value to compare the sample against in one-sample test. Default is 0.

    - name: conf.level
      title: Confidence Level
      type: Number
      default: 0.95
      min: 0
      max: 1
      description:
          R: >
            Confidence level for confidence intervals (between 0 and 1).

    - name: bf.message
      title: Bayes Factor Message
      type: Bool
      default: false
      description:
          R: >
            Whether to display Bayes Factor in the subtitle when using Bayesian analysis.

    - name: digits
      title: Decimal Places
      type: Integer
      default: 2
      min: 0
      max: 5
      description:
          R: >
            Number of decimal places for displaying statistics in the subtitle.

    - name: xlab
      title: X-axis Label
      type: String
      default: ''
      description:
          R: >
            Custom label for the x-axis. If empty, variable name will be used.

    - name: title
      title: Plot Title
      type: String
      default: ''
      description:
          R: >
            Title for the plot.

    - name: subtitle
      title: Plot Subtitle
      type: String
      default: ''
      description:
          R: >
            Subtitle for the plot (overrides statistical results if provided).

    - name: caption
      title: Plot Caption
      type: String
      default: ''
      description:
          R: >
            Caption text to display at the bottom of the plot.

    - name: centralitytype
      title: Centrality Type
      type: List
      options:
        - title: Default (follows test type)
          name: default
        - title: Parametric (Mean)
          name: parametric
        - title: Nonparametric (Median)
          name: nonparametric
        - title: Robust (Trimmed Mean)
          name: robust
        - title: Bayes (MAP Estimator)
          name: bayes
      default: default
      description:
          R: >
            Type of central tendency measure to display. 'Default' uses the
            appropriate measure based on the statistical test type selected.

# Histogram Aesthetics ----

    - name: binfill
      title: Bin Fill Color
      type: String
      default: 'skyblue'
      description:
          R: >
            Fill color for histogram bins.

    - name: bincolor
      title: Bin Border Color
      type: String
      default: 'black'
      description:
          R: >
            Border color for histogram bins.

    - name: binalpha
      title: Bin Transparency
      type: Number
      default: 0.7
      min: 0
      max: 1
      description:
          R: >
            Transparency level for histogram bins (0 = fully transparent, 1 = opaque).

# Centrality Line Aesthetics ----

    - name: centralitylinecolor
      title: Centrality Line Color
      type: String
      default: 'blue'
      description:
          R: >
            Color of the vertical centrality line.

    - name: centralitylinewidth
      title: Centrality Line Width
      type: Number
      default: 1
      min: 0.1
      max: 5
      description:
          R: >
            Width of the vertical centrality line.

    - name: centralitylinetype
      title: Centrality Line Type
      type: List
      options:
        - title: Solid
          name: solid
        - title: Dashed
          name: dashed
        - title: Dotted
          name: dotted
        - title: Dot-dash
          name: dotdash
        - title: Long dash
          name: longdash
        - title: Two dash
          name: twodash
      default: dashed
      description:
          R: >
            Line type for the vertical centrality line.

# Plot Size Configuration ----

    - name: plotwidth
      title: Plot Width
      type: Integer
      default: 600
      min: 300
      max: 1200
      description:
          R: >
            Width of each plot in pixels. Default is 600.

    - name: plotheight
      title: Plot Height
      type: Integer
      default: 450
      min: 300
      max: 800
      description:
          R: >
            Height of each plot in pixels. Default is 450.

    - name: addGGPubrPlot
      title: Add ggpubr Histogram
      type: Bool
      default: false
      description:
          R: >
            Add publication-ready histogram using ggpubr package.

    - name: ggpubrPalette
      title: ggpubr Fill Color
      type: String
      default: '#0073C2FF'
      description:
          R: >
            Fill color for ggpubr histogram (hex code).

    - name: ggpubrAddDensity
      title: Add Density Curve (ggpubr)
      type: Bool
      default: true
      description:
          R: >
            Add density curve overlay to ggpubr histogram.

    - name: ggpubrAddMean
      title: Add Mean Line (ggpubr)
      type: Bool
      default: false
      description:
          R: >
            Add vertical line at mean for ggpubr histogram.

    - name: addDistributionDiagnostics
      title: Add Distribution Diagnostic Plots
      type: Bool
      default: false
      description:
          R: >
            Add density plot, ECDF, and QQ plot for distribution assessment using ggpubr.

    - name: ggpubrDensityColor
      title: Density Plot Fill Color
      type: String
      default: '#0073C2FF'
      description:
          R: >
            Fill color for density plot (hex code).

    - name: ggpubrShowQQ
      title: Show QQ Plot
      type: Bool
      default: true
      description:
          R: >
            Show QQ plot for normality assessment.

    - name: ggpubrShowECDF
      title: Show ECDF Plot
      type: Bool
      default: true
      description:
          R: >
            Show empirical cumulative distribution function plot.


...

