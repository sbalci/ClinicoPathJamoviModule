---
name: ihcdiagnostic
title: IHC Diagnostic Analysis
menuGroup: OncoPathologyT2
menuSubgroup: IHC Analysis
menuTitle: Clinical Diagnostics
version: '1.0.0'
jas: '1.2'

description:
    main: >
        Diagnostic performance analysis and clinical classification using IHC markers.
        Designed for differential diagnosis and antibody panel optimization.
    R:
        dontrun: false
        usage: |
            data %>%
            ihcdiagnostic(
                markers = c("ER", "PR", "HER2", "Ki67"),
                diagnosis = "tumor_type",
                differentialDiagnosis = TRUE
            )

options:
    - name: data
      type: Data
      description:
          R: the data as a data frame

    - name: markers
      title: IHC Markers (antibodies/biomarkers)
      type: Variables
      suggested:
        - ordinal
        - nominal
        - continuous
      permitted:
        - factor
        - numeric
      description:
          R: >
            Select IHC marker variables (e.g., ER, PR, HER2, Ki67, CD markers).
            These can be percentage scores, H-scores, or categorical results.

    - name: diagnosis
      title: Known Diagnosis (gold standard)
      type: Variable
      suggested:
        - nominal
      permitted:
        - factor
      description:
          R: >
            Select the reference diagnosis variable (e.g., tumor type, grade, subtype).
            This is your gold standard for evaluating marker performance.

    - name: id
      title: Case/Patient ID (Optional)
      type: Variable
      suggested:
        - nominal
        - id
      permitted:
        - factor
        - numeric
      default: NULL
      description:
          R: >
            Optional case identifier for tracking individual results in differential diagnosis.
            Useful for matching predictions with actual diagnoses.

    - name: differentialDiagnosis
      title: Perform Differential Diagnosis
      type: Bool
      default: true
      description:
          R: >
            Predict diagnosis for each case based on IHC marker patterns.
            Uses clustering to classify cases into diagnostic groups.

    - name: antibodyOptimization
      title: Antibody Panel Optimization
      type: Bool
      default: false
      description:
          R: >
            Find the best combination of markers for diagnosis.
            Tests single markers and combinations to identify optimal panels.

    - name: calculateDiagnosticMetrics
      title: Calculate Diagnostic Metrics
      type: Bool
      default: true
      description:
          R: >
            Calculate sensitivity, specificity, PPV, NPV, and AUC for each marker.
            Essential for evaluating marker diagnostic performance.

    - name: clusterMethod
      title: Clustering Method
      type: List
      options:
        - name: hierarchical
          title: Hierarchical (groups similar cases together)
        - name: pam
          title: PAM/K-medoids (finds representative cases)
      default: hierarchical
      description:
          R: >
            Clustering method for differential diagnosis

    - name: cutpointMethod
      title: Cutpoint Selection
      type: List
      options:
        - name: optimal
          title: Optimal balance (Youden Index) - Recommended
        - name: clinical
          title: Clinical guidelines (marker-specific thresholds)
        - name: median
          title: Median split (50/50 division)
      default: optimal
      description:
          R: >
            Method for determining positive/negative cutpoints

    - name: confidenceLevel
      title: Confidence Level
      type: Number
      min: 0.80
      max: 0.99
      default: 0.95
      description:
          R: >
            Confidence level for performance metrics (0.95 = 95% confidence intervals).
            Higher values give wider, more conservative intervals.

    - name: crossValidation
      title: Cross-Validation
      type: Bool
      default: true
      description:
          R: >
            Use 5-fold cross-validation for more reliable performance estimates.
            Recommended for clinical validation but takes longer to compute.

    - name: minimumGroupSize
      title: Minimum Group Size
      type: Integer
      min: 5
      max: 50
      default: 10
      description:
          R: >
            Minimum number of cases required per diagnostic group.
            Groups with fewer cases will trigger a warning (recommend â‰¥10).

...