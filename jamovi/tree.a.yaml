---
name: tree
title: Medical Decision Tree Analysis
menuGroup: meddecideT
menuSubgroup: Clinical Decision Support
menuSubtitle: Advanced Clinical Decision Trees
version: '0.0.31'
jas: '1.2'

description:
    main: |
        Comprehensive decision tree analysis for medical research, pathology and oncology.
        Combines FFTrees (Fast-and-Frugal Trees) and enhanced CART algorithms for robust
        clinical decision support. Provides extensive validation, performance metrics,
        interpretability analysis, and clinical interpretation guidelines.
    R:
        dontrun: false
        usage: |
            # Example for cancer diagnosis with comprehensive analysis
            data(cancer_biomarkers)
            tree(
                data = cancer_biomarkers,
                vars = c("PSA", "age", "tumor_size"),
                facs = c("grade", "stage"),
                target = "diagnosis",
                targetLevel = "cancer",
                algorithm = "fftrees",
                validation = "cv",
                show_performance_metrics = TRUE,
                show_tree_plot = TRUE,
                interpretability = TRUE
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame containing clinical variables, biomarkers, 
            and patient outcomes for decision tree analysis.

    # Core variables
    - name: vars
      title: Continuous Clinical Variables
      type: Variables
      suggested: [continuous]
      permitted: [numeric]
      default: null
      description: >
                  Continuous variables such as biomarker levels, age, 
                  laboratory values, or quantitative pathological measurements.

    - name: facs
      title: Categorical Clinical Variables  
      type: Variables
      suggested: [ordinal, nominal]
      permitted: [factor]
      default: null
      description: >
                  Categorical variables such as tumor grade, stage, 
                  histological type, or patient demographics.

    - name: target
      title: Target Outcome
      type: Variable
      suggested: [ordinal, nominal]
      permitted: [factor]
      description: >
                  Primary outcome variable: disease status, treatment response, 
                  survival status, or diagnostic category.

    - name: targetLevel
      title: Disease/Positive Level
      type: Level
      variable: (target)
      description: >
                  Level representing disease presence, positive outcome, 
                  or event of interest for binary classification.

    # Algorithm selection
    - name: algorithm
      title: Decision Tree Algorithm
      type: List
      options:
        - title: "Enhanced CART (rpart)"
          name: rpart
        - title: "FFTrees (Fast-and-Frugal Trees)"
          name: fftrees
        - title: "C5.0 Classification Trees"
          name: c50
        - title: "Conditional Inference Trees (ctree)"
          name: ctree
        - title: "Model-based Trees (mob)"
          name: mob
        - title: "Random Forest"
          name: randomforest
        - title: "XGBoost"
          name: xgboost
        - title: "Ensemble (Multiple Methods)"
          name: ensemble
        - title: "Consensus Trees"
          name: consensus
      default: rpart
      description: >
                  Algorithm to use: rpart provides traditional CART with pruning;
                  FFTrees creates simple, interpretable trees for medical decisions;
                  C5.0 offers advanced classification with boosting;
                  ctree uses statistical tests for splits; mob combines trees with parametric models;
                  Random Forest uses ensemble of trees for high accuracy;
                  XGBoost provides gradient boosting for complex patterns.

    - name: tree_mode
      title: Analysis Mode
      type: List
      options:
        - title: "Classification (predict categories)"
          name: classification
        - title: "Regression (predict continuous)"
          name: regression
        - title: "Survival Analysis (censored regression)"
          name: survival
        - title: "Poisson (count data)"
          name: poisson
        - title: "Exponential Survival"
          name: exponential
      default: classification
      description: >
                  Type of prediction problem: classification for disease presence/absence,
                  regression for continuous biomarkers, survival for time-to-event analysis,
                  Poisson for count/rate data, exponential for survival with constant hazard.

    # Training/Validation setup
    - name: train
      title: Training/Validation Cohort
      type: Variable
      suggested: [ordinal, nominal]
      permitted: [factor]
      default: null
      description: >
                  Variable indicating training vs validation cohorts. 
                  If not provided, data will be split automatically.

    - name: trainLevel
      title: Training Cohort Level
      type: Level
      variable: (train)
      description: >
                  Level indicating the training/discovery cohort.

    - name: validation
      title: Validation Method
      type: List
      options:
        - title: "Use Training/Validation Variable"
          name: cohort
        - title: "K-Fold Cross-Validation"
          name: cv
        - title: "Bootstrap Validation"
          name: bootstrap
        - title: "Hold-Out Validation"
          name: holdout
        - title: "Time-Based Split"
          name: temporal
        - title: "Stratified K-Fold CV"
          name: stratified_cv
        - title: "Repeated CV"
          name: repeated_cv
      default: cohort
      description: >
                  Validation approach: cohort uses train variable if provided,
                  otherwise performs automatic splitting with selected method.
                  Stratified CV maintains class proportions, Repeated CV averages multiple runs.

    - name: consensus_validation
      title: Consensus Validation Approach
      type: Bool
      default: false
      description: >
                  Use multiple validation methods and consensus results.
                  Combines cross-validation, bootstrap, and holdout for robust estimates.

    - name: bootstrap_samples
      title: Bootstrap Sample Size
      type: Integer
      default: 100
      min: 50
      max: 1000
      description: >
                  Number of bootstrap samples for bootstrap validation.
                  More samples provide better estimates but increase computation time.

    - name: model_averaging
      title: Model Averaging
      type: Bool
      default: false
      description: >
                  Average predictions from multiple models for improved accuracy.
                  Combines different algorithms or parameter settings.

    - name: cv_folds
      title: Number of CV Folds
      type: Integer
      default: 5
      min: 3
      max: 10
      description: >
                  Number of folds for cross-validation. 5-fold provides good
                  balance between bias and variance for clinical datasets.

    - name: cv_repeats
      title: CV Repeats
      type: Integer
      default: 3
      min: 1
      max: 10
      description: >
                  Number of times to repeat cross-validation (for repeated CV).
                  More repeats provide more stable estimates but increase computation time.

    - name: stratified_sampling
      title: Stratified Sampling
      type: Bool
      default: true
      description: >
                  Maintain class proportions in train/test splits.
                  Recommended for imbalanced medical datasets.

    - name: data_split_method
      title: Data Splitting Strategy
      type: List
      options:
        - title: "Random Split"
          name: random
        - title: "Stratified Split (maintain class balance)"
          name: stratified
        - title: "Time-based Split (chronological)"
          name: temporal
        - title: "Balanced Split (equal class sizes)"
          name: balanced
      default: stratified
      description: >
                  Method for splitting data into train/test sets.
                  Stratified maintains original class proportions for clinical validity.

    - name: test_split
      title: Test Set Proportion
      type: Number
      default: 0.25
      min: 0.1
      max: 0.5
      description: >
                  Proportion of data reserved for testing (holdout validation).
                  Optimal ratio is 25% test / 75% train as recommended for decision trees.

    # Tree parameters
    - name: max_depth
      title: Maximum Tree Depth
      type: Integer
      default: 6
      min: 2
      max: 15
      description: >
                  Maximum depth of decision tree. Deeper trees capture
                  more interactions but may overfit. Clinical trees typically 2-8 levels.

    - name: min_samples_split
      title: Minimum Samples to Split
      type: Integer
      default: 20
      min: 2
      max: 100
      description: >
                  Minimum number of samples required to split a node.
                  Higher values prevent overfitting in clinical data.

    - name: min_samples_leaf
      title: Minimum Samples per Leaf
      type: Integer
      default: 10
      min: 1
      max: 50
      description: >
                  Minimum number of samples in leaf nodes. Important for
                  clinical validity - too few samples reduce reliability.

    - name: cost_complexity
      title: Cost Complexity (CP)
      type: Number
      default: 0.01
      min: 0.0001
      max: 0.5
      description: >
                  Cost complexity parameter (tidymodels: cost_complexity). Controls pruning - 
                  lower values create more complex trees. Corresponds to CP in rpart.

    - name: min_n
      title: Minimum Node Size (min_n)
      type: Integer
      default: 20
      min: 1
      max: 100
      description: >
                  Minimum number of data points in a node (tidymodels: min_n). 
                  Higher values prevent overfitting in clinical data.

    - name: tree_depth
      title: Tree Depth (tree_depth)
      type: Integer
      default: 6
      min: 1
      max: 20
      description: >
                  Maximum tree depth (tidymodels: tree_depth). Deeper trees capture 
                  more interactions but may overfit. Clinical trees typically 2-8 levels.

    - name: hyperparameter_tuning
      title: Hyperparameter Tuning
      type: Bool
      default: false
      description: >
                  Automatically optimize tree parameters using cross-validation.
                  Finds optimal complexity parameter and tree structure for best performance.

    - name: tuning_metric
      title: Tuning Optimization Metric
      type: List
      options:
        - title: "Balanced Accuracy"
          name: bacc
        - title: "Area Under Curve (AUC)"
          name: auc
        - title: "Sensitivity (Recall)"
          name: sens
        - title: "Specificity"
          name: spec
        - title: "F1 Score"
          name: f1
        - title: "Precision"
          name: prec
      default: bacc
      description: >
                  Metric to optimize during hyperparameter tuning.
                  Choose based on clinical priorities (e.g., sensitivity for screening).

    - name: kappa_analysis
      title: Cohen's Kappa Analysis
      type: Bool
      default: true
      description: >
                  Calculate Cohen's kappa statistic for agreement beyond chance.
                  Essential clinical metric for inter-rater reliability assessment.

    - name: advanced_metrics
      title: Advanced Clinical Metrics
      type: Bool
      default: false
      description: >
                  Calculate advanced metrics: Matthews correlation coefficient, 
                  Youden's J statistic, diagnostic odds ratio, and clinical utility index.

    - name: use_1se_rule
      title: Use 1-SE Rule for Tree Selection
      type: Bool
      default: true
      description: >
                  Apply 1-standard-error rule for selecting simpler models.
                  Chooses most parsimonious tree within 1 SE of optimal performance.

    - name: xerror_pruning
      title: Cross-validation Error Pruning
      type: Bool
      default: false
      description: >
                  Use cross-validation error (xerror) from CP table for optimal pruning.
                  Automatically selects CP value that minimizes xerror.

    - name: auto_prune
      title: Automatic Tree Pruning
      type: Bool
      default: false
      description: >
                  Automatically prune tree to optimal size based on cross-validation.
                  Prevents overfitting while maintaining predictive performance.

    - name: prune_method
      title: Pruning Selection Method
      type: List
      options:
        - title: "Minimum xerror"
          name: min_xerror
        - title: "1-SE rule"
          name: one_se
        - title: "Custom CP threshold"
          name: custom_cp
      default: one_se
      description: >
                  Method for selecting optimal tree size after cross-validation.
                  1-SE rule provides good balance between accuracy and simplicity.

    # Advanced rpart.control options
    - name: rpart_prior
      title: Prior Probabilities
      type: String
      default: ""
      description: >
                  Prior probabilities for each class (comma-separated). 
                  E.g., "0.3,0.7" for binary classification. Leave empty for data proportions.

    - name: rpart_loss_matrix
      title: Loss Matrix
      type: String
      default: ""
      description: >
                  Loss matrix for misclassification costs (comma-separated by rows).
                  E.g., "0,1,5,0" for 2x2 matrix. Leave empty for equal costs.

    - name: clinical_loss_preset
      title: Clinical Loss Matrix Presets
      type: List
      options:
        - title: "Equal costs (default)"
          name: equal
        - title: "Conservative screening (avoid false negatives)"
          name: screening
        - title: "Conservative diagnosis (avoid false positives)" 
          name: diagnosis
        - title: "Custom matrix"
          name: custom
      default: equal
      description: >
                  Pre-configured loss matrices for common clinical scenarios.
                  Screening: False negatives cost 5x more than false positives.
                  Diagnosis: False positives cost 3x more than false negatives.

    - name: enhanced_prior_probs
      title: Enhanced Prior Probabilities
      type: List
      options:
        - title: "Data proportions (default)"
          name: data
        - title: "Population prevalence"
          name: population
        - title: "Balanced classes"
          name: balanced
        - title: "Custom proportions"
          name: custom
      default: data
      description: >
                  Prior probability settings for different clinical contexts.
                  Population: Use external disease prevalence estimates.
                  Balanced: Equal priors regardless of sample sizes.

    - name: population_prevalence
      title: Population Disease Prevalence
      type: Number
      default: 0.1
      min: 0.001
      max: 0.999
      description: >
                  Expected disease prevalence in target population (0-1).
                  Used when enhanced_prior_probs = "population".

    - name: custom_prior_values
      title: Custom Prior Values
      type: String
      default: ""
      description: >
                  Custom prior probabilities (comma-separated, must sum to 1).
                  E.g., "0.2,0.3,0.5" for three-class problem.

    - name: rpart_split
      title: Splitting Criterion
      type: List
      options:
        - title: "Gini Index (default)"
          name: gini
        - title: "Information Gain"
          name: information
      default: gini
      description: >
                  Splitting criterion for classification trees.
                  Gini often works well; Information gain may be better for multi-class.

    - name: rpart_surrogate
      title: Use Surrogate Splits
      type: Bool
      default: true
      description: >
                  Use surrogate splits to handle missing values.
                  Finds backup splits that mimic primary split when data is missing.

    - name: rpart_usesurrogate
      title: Surrogate Usage Strategy
      type: List
      options:
        - title: "If helpful (0)"
          name: "0"
        - title: "Always when available (1)"
          name: "1"
        - title: "If majority is better (2)"
          name: "2"
      default: "2"
      description: >
                  How to use surrogate splits: 0=only if helpful, 1=always, 2=if better than majority.

    - name: rpart_maxsurrogate
      title: Maximum Surrogate Splits
      type: Integer
      default: 5
      min: 0
      max: 20
      description: >
                  Maximum number of surrogate splits to retain at each node.
                  More surrogates provide better missing data handling but increase complexity.

    - name: rpart_xval
      title: Cross-validation Folds
      type: Integer
      default: 10
      min: 0
      max: 20
      description: >
                  Number of cross-validation folds for CP table generation.
                  Set to 0 to skip cross-validation (faster but less reliable pruning).

    - name: rpart_maxcompete
      title: Maximum Competing Splits
      type: Integer
      default: 4
      min: 0
      max: 10
      description: >
                  Number of competing splits to save for each node.
                  Useful for understanding alternative splitting strategies.

    # Engine-specific options
    - name: c50_trials
      title: C5.0 Boosting Trials
      type: Integer
      default: 1
      min: 1
      max: 100
      description: >
                  Number of boosting iterations for C5.0 algorithm.
                  More trials improve accuracy but reduce interpretability.

    - name: c50_winnow
      title: C5.0 Winnowing
      type: Bool
      default: false
      description: >
                  Enable winnowing in C5.0 to remove irrelevant attributes.
                  Useful for high-dimensional clinical data.

    - name: ctree_mincriterion
      title: ctree Statistical Criterion
      type: Number
      default: 0.95
      min: 0.5
      max: 0.999
      description: >
                  Statistical criterion for ctree splits (1 - p-value threshold).
                  Higher values create simpler, more conservative trees.

    - name: rf_ntree
      title: Random Forest Trees
      type: Integer
      default: 500
      min: 50
      max: 2000
      description: >
                  Number of trees in random forest. More trees generally improve
                  performance but increase computation time.

    - name: rf_mtry
      title: Random Forest Variables per Split
      type: Integer
      default: 0
      min: 0
      max: 50
      description: >
                  Number of variables randomly sampled at each split.
                  0 = automatic selection (sqrt for classification, p/3 for regression).

    - name: xgb_nrounds
      title: XGBoost Rounds
      type: Integer
      default: 100
      min: 10
      max: 1000
      description: >
                  Number of boosting rounds for XGBoost.
                  More rounds can improve performance but risk overfitting.

    - name: xgb_eta
      title: XGBoost Learning Rate
      type: Number
      default: 0.3
      min: 0.01
      max: 1.0
      description: >
                  Learning rate for XGBoost. Lower values require more rounds
                  but can lead to better performance.

    # Reproducibility and Advanced Analysis
    - name: set_seed
      title: Set Random Seed
      type: Bool
      default: true
      description: >
                  Set random seed for reproducible results across runs.
                  Essential for clinical research reproducibility.

    - name: seed_value
      title: Random Seed Value
      type: Integer
      default: 42
      min: 1
      max: 999999
      description: >
                  Specific seed value for random number generation.
                  Use same value to reproduce exact results.

    - name: show_cp_table
      title: Show Complexity Parameter Table
      type: Bool
      default: false
      description: >
                  Display CP table showing tree complexity vs performance.
                  Helps understand pruning decisions and model selection.

    - name: show_variable_importance_detailed
      title: Show Detailed Variable Importance
      type: Bool
      default: false
      description: >
                  Display comprehensive variable importance analysis including
                  surrogate splits and interaction effects.

    # Medical-specific preprocessing
    - name: missing_data_method
      title: Missing Data Handling Method
      type: List
      options:
        - title: "Use rpart native handling (recommended)"
          name: native
        - title: "Median/Mode imputation by disease group"
          name: clinical_impute
        - title: "Multiple imputation (advanced)"
          name: multiple_impute
        - title: "Exclude cases with missing data"
          name: exclude
      default: native
      description: >
                  Method for handling missing clinical data. Native rpart handling 
                  uses surrogate splits, which is often optimal for clinical data.

    - name: balanceClasses
      title: Balance Disease Classes
      type: Bool
      default: false
      description: >
                  Balance classes to handle rare diseases or imbalanced outcomes. 
                  Recommended for disease prevalence <20%.

    - name: ensemble_method
      title: Ensemble Enhancement
      type: List
      options:
        - title: "Single Tree (no ensemble)"
          name: none
        - title: "Bootstrap Aggregating (Bagging)"
          name: bagging
        - title: "Random Forest"
          name: random_forest
      default: none
      description: >
                  Ensemble method to improve prediction accuracy and robustness.
                  Single trees are most interpretable; ensembles offer better performance.

    - name: n_trees
      title: Number of Trees (for ensemble)
      type: Integer
      default: 100
      min: 10
      max: 1000
      description: >
                  Number of trees in ensemble methods. More trees generally improve 
                  performance but increase computation time.

    # Feature analysis
    - name: feature_selection
      title: Automated Feature Selection
      type: Bool
      default: false
      description: >
                  Perform automated feature selection using advanced algorithms.
                  Helps identify most relevant clinical variables and biomarkers.

    - name: feature_selection_method
      title: Feature Selection Method
      type: List
      options:
        - title: "Tree-based Importance (rpart)"
          name: tree_importance
        - title: "Boruta Algorithm (all-relevant)"
          name: boruta
        - title: "Variable Importance (caret)"
          name: var_imp
      default: tree_importance
      description: >
                  Method for feature selection: Tree-based uses rpart importance;
                  Boruta identifies all-relevant features using permutation tests;
                  Variable Importance uses advanced metrics from caret package.

    - name: importance_method
      title: Feature Importance Method
      type: List
      options:
        - title: "Gini Importance"
          name: gini
        - title: "Permutation Importance"
          name: permutation
        - title: "SHAP Values"
          name: shap
      default: gini
      description: >
                  Method for calculating feature importance. Permutation and SHAP
                  provide more reliable importance for clinical interpretation.

    # Output options - Basic
    - name: show_tree_plot
      title: Show Decision Tree Visualization
      type: Bool
      default: true
      description: >
                  Display visual representation of the decision tree.
                  Shows decision paths and node information.

    - name: show_importance_plot
      title: Show Feature Importance Plot
      type: Bool
      default: true
      description: >
                  Display feature importance rankings. Critical for understanding
                  which clinical variables drive predictions.

    - name: show_performance_metrics
      title: Show Performance Metrics
      type: Bool
      default: true
      description: >
                  Display comprehensive performance evaluation including
                  accuracy, sensitivity, specificity, AUC, and clinical metrics.

    - name: show_confusion_matrix
      title: Show Confusion Matrix
      type: Bool
      default: true
      description: >
                  Display detailed confusion matrix with clinical interpretations.
                  Shows actual vs predicted classifications.

    # Output options - Advanced
    - name: show_roc_curve
      title: Show ROC Curve
      type: Bool
      default: true
      description: >
                  Display ROC curve analysis for binary classification.
                  Essential for clinical decision making and threshold selection.

    - name: show_validation_curves
      title: Show Validation Curves
      type: Bool
      default: false
      description: >
                  Display learning curves and validation performance.
                  Helps assess overfitting and training adequacy.

    - name: show_calibration_plot
      title: Show Calibration Plot
      type: Bool
      default: false
      description: >
                  Display probability calibration plot. Important for
                  clinical applications requiring reliable probability estimates.

    - name: showPartitionPlot
      title: Show Partition Plot (2D Variables Only)
      type: Bool
      default: false
      description: >
                  Display 2D decision boundary visualization using parttree. 
                  Requires exactly 2 continuous variables for optimal visualization.

    - name: show_cp_plot
      title: Show Complexity Parameter Plot
      type: Bool
      default: false
      description: >
                  Display CP plot showing cross-validation error vs tree complexity.
                  Essential for understanding optimal pruning levels.

    - name: tree_plot_style
      title: Tree Plot Style
      type: List
      options:
        - title: "Standard rpart.plot"
          name: standard
        - title: "Compact medical style"
          name: medical
        - title: "Detailed clinical style"
          name: clinical
        - title: "Uniform branch lengths"
          name: uniform
        - title: "Compressed layout"
          name: compressed
        - title: "Fancy presentation"
          name: fancy
      default: standard
      description: >
                  Visualization style optimized for different clinical audiences.
                  Medical: simplified for clinical staff; Clinical: detailed for researchers.
                  Uniform: equal branch lengths; Compressed: space-efficient; Fancy: publication-ready.

    - name: plot_branch_style
      title: Branch Style
      type: Number
      default: 0.2
      min: 0
      max: 1
      description: >
                  Branch drawing style (0-1). 0=angled branches, 1=straight lines.
                  Based on rpart vignette examples for publication-quality plots.

    - name: plot_margin
      title: Plot Margin
      type: Number
      default: 0.1
      min: 0
      max: 0.5
      description: >
                  White space margin around the tree plot.
                  Useful for fitting node labels and avoiding clipping.

    - name: show_node_statistics
      title: Show Node Statistics
      type: Bool
      default: false
      description: >
                  Display detailed statistics for each node including sample sizes,
                  purity measures, and class distributions.

    - name: probability_display
      title: Show Node Probabilities
      type: Bool
      default: true
      description: >
                  Display class probabilities in tree nodes for clinical interpretation.
                  Shows certainty levels for each prediction.

    - name: enhanced_node_info
      title: Enhanced Node Information
      type: List
      options:
        - title: "Basic (class only)"
          name: basic
        - title: "Standard (class + percentage)"
          name: standard
        - title: "Clinical (probabilities + confidence)"
          name: clinical
        - title: "Detailed (full statistics)"
          name: detailed
      default: clinical
      description: >
                  Level of information displayed in tree nodes.
                  Clinical mode optimized for medical decision making.

    # Interpretability options
    - name: interpretability
      title: Enhanced Interpretability Analysis
      type: Bool
      default: false
      description: >
                  Perform advanced interpretability analysis including
                  SHAP values, partial dependence plots, and interaction effects.

    - name: shap_analysis
      title: SHAP Value Analysis
      type: Bool
      default: false
      description: >
                  Calculate SHAP (SHapley Additive exPlanations) values for
                  individual prediction explanations. Powerful for clinical decision support.

    - name: partial_dependence
      title: Partial Dependence Plots
      type: Bool
      default: false
      description: >
                  Show how individual features affect predictions across
                  their value ranges. Helps understand clinical relationships.

    - name: interaction_analysis
      title: Feature Interaction Analysis
      type: Bool
      default: false
      description: >
                  Analyze interactions between clinical variables.
                  Important for understanding combined effects of biomarkers.

    # Clinical context and interpretation
    - name: clinical_context
      title: Clinical Context
      type: List
      options:
        - title: "General Diagnosis"
          name: diagnosis
        - title: "Cancer Screening"
          name: screening
        - title: "Cancer Staging"
          name: staging
        - title: "Prognosis Prediction"
          name: prognosis
        - title: "Treatment Response"
          name: treatment
        - title: "Biomarker Discovery"
          name: biomarker
        - title: "Risk Stratification"
          name: risk
      default: diagnosis
      description: >
                  Clinical application context. Affects performance thresholds,
                  interpretation guidelines, and visualization emphasis.

    - name: cost_sensitive_thresholds
      title: Cost-Sensitive Threshold Optimization
      type: Bool
      default: false
      description: >
                  Optimize decision thresholds considering clinical costs
                  of false positives vs false negatives.

    - name: fn_fp_ratio
      title: False Negative to False Positive Cost Ratio
      type: Number
      default: 1
      min: 0.1
      max: 10
      description: >
                  Relative cost of missing a positive case vs false alarm.
                  Screening (high ratio), confirmation tests (low ratio).

    - name: prevalenceAdjustment
      title: Adjust for Population Prevalence
      type: Bool
      default: false
      description: >
                  Adjust predictive values for expected disease prevalence 
                  in target population (different from study sample).

    - name: expectedPrevalence
      title: Expected Population Prevalence (%)
      type: Number
      default: 10
      min: 0.1
      max: 50
      description: >
                  Expected disease prevalence in target population for 
                  adjusted predictive value calculations.

    # Advanced validation and confidence
    - name: bootstrap_confidence
      title: Bootstrap Confidence Intervals
      type: Bool
      default: false
      description: >
                  Calculate bootstrap confidence intervals for performance
                  metrics. Provides uncertainty quantification for clinical reporting.

    - name: n_bootstrap
      title: Number of Bootstrap Samples
      type: Integer
      default: 1000
      min: 100
      max: 5000
      description: >
                  Number of bootstrap samples for confidence interval calculation.
                  More samples provide better estimates but increase computation time.

    - name: model_comparison
      title: Compare Multiple Algorithms
      type: Bool
      default: false
      description: >
                  Compare performance of multiple algorithms (FFTrees, CART, Logistic Regression).
                  Useful for selecting the best approach for your data.

    - name: modelComparisonMetric
      title: Comparison Metric
      type: List
      options:
        - title: "Balanced Accuracy"
          name: bacc
        - title: "AUC"
          name: auc
        - title: "Sensitivity"
          name: sens
        - title: "Specificity"
          name: spec
        - title: "F1 Score"
          name: f1
      default: bacc
      description: >
                  Primary metric for comparing algorithms. Choose based on
                  clinical priorities (sensitivity for screening, specificity for confirmation).

    # Export and reporting
    - name: export_model
      title: Export Trained Model
      type: Bool
      default: false
      description: >
                  Export the trained model for external use or deployment.
                  Useful for clinical decision support system integration.

    - name: exportPredictions
      title: Export Predictions
      type: Bool
      default: false
      description: >
                  Add predicted classifications and probabilities to the dataset
                  for further analysis or reporting.

    - name: show_clinical_interpretation
      title: Show Clinical Interpretation Guide
      type: Bool
      default: true
      description: >
                  Display comprehensive clinical interpretation guidelines
                  specific to the selected clinical context and results.

    # Model stability and robustness analysis
    - name: model_stability_analysis
      title: Model Stability Analysis
      type: Bool
      default: false
      description: >
                  Analyze model stability across bootstrap samples by examining
                  consistency of splits, variable selection, and predictions.

    - name: learning_curves
      title: Learning Curves Analysis
      type: Bool
      default: false
      description: >
                  Display learning curves showing performance vs training size.
                  Helps determine optimal sample size and detect overfitting.

    - name: outlier_analysis
      title: Outlier Detection and Analysis
      type: Bool
      default: false
      description: >
                  Identify influential observations and outliers that may
                  disproportionately affect tree structure and predictions.

    - name: prediction_intervals
      title: Prediction Confidence Intervals
      type: Bool
      default: false
      description: >
                  Calculate confidence intervals for individual predictions
                  using bootstrap or cross-validation methods.

    # Enhanced rpart prediction options
    - name: rpart_prediction_type
      title: Prediction Output Type
      type: List
      options:
        - title: "Class (default)"
          name: class
        - title: "Probabilities" 
          name: prob
        - title: "Vector (terminal node number)"
          name: vector
        - title: "Matrix (all prediction info)"
          name: matrix
      default: class
      description: >
                  Type of prediction output from rpart model.
                  Class: predicted category; Prob: class probabilities; Vector: node IDs.

    - name: show_rsq_plot
      title: R-squared Plot (Regression Trees)
      type: Bool
      default: false
      description: >
                  Show rsq.rpart() plot displaying R-squared vs tree size.
                  Useful for regression trees to assess explained variance.

    - name: competing_splits
      title: Show Competing Splits
      type: Bool
      default: false
      description: >
                  Display competing splits at each node showing alternative 
                  splitting criteria and their relative quality.

    - name: surrogate_splits
      title: Show Surrogate Splits
      type: Bool
      default: false
      description: >
                  Display surrogate splits used for missing data handling.
                  Shows backup splitting rules when primary variable is missing.

    - name: advanced_pruning
      title: Advanced Pruning Method
      type: List
      options:
        - title: "Standard Cost-Complexity (CP) Pruning"
          name: cp
        - title: "Reduced Error Pruning (REP)"
          name: rep
        - title: "Minimum Error Pruning (MEP)"
          name: mep
      default: cp
      description: >
                  Pruning method: CP uses cross-validation error, REP uses holdout validation,
                  MEP considers both error and tree size for optimal clinical interpretability.

    - name: pruning_validation_split
      title: Pruning Validation Split
      type: Number
      default: 0.2
      min: 0.1
      max: 0.4
      description: >
                  Proportion of data reserved for pruning validation (REP/MEP methods).
                  This is separate from the main test set.

    # Advanced Cost Complexity Pruning Options
    - name: cp_auto_selection
      title: Automatic CP Selection
      type: List
      options:
        - title: "Minimum xerror rule"
          name: min_xerror
        - title: "1-SE rule (recommended)"
          name: one_se_rule
        - title: "Manual CP value"
          name: manual
      default: one_se_rule
      description: >
                  Automatic selection of optimal complexity parameter from CV results.
                  1-SE rule selects simplest tree within one standard error of minimum.

    - name: cp_sequence_analysis
      title: Show CP Sequence Analysis
      type: Bool
      default: false
      description: >
                  Show detailed analysis of CP sequence with error rates and tree sizes.
                  Helps understand cost-complexity trade-offs.

    - name: xerror_detailed_analysis
      title: Detailed Cross-validation Error Analysis
      type: Bool
      default: false
      description: >
                  Show comprehensive xerror analysis with standard errors and confidence intervals.
                  Essential for understanding pruning decisions.

    - name: impurity_analysis
      title: Splitting Impurity Analysis
      type: Bool
      default: false
      description: >
                  Compare Gini index vs Information gain splitting criteria.
                  Shows impurity reduction at each split for method comparison.

    - name: recursive_partitioning_trace
      title: Show Recursive Partitioning Trace
      type: Bool
      default: false
      description: >
                  Display step-by-step tree construction process.
                  Shows how the algorithm selects splits recursively.

    # User-defined splitting functions (advanced)
    - name: use_custom_splitting
      title: Use Custom Splitting Functions
      type: Bool
      default: false
      description: >
                  Enable user-defined splitting functions for advanced customization.
                  Allows definition of custom init, eval, and split functions.

    - name: custom_splitting_method
      title: Custom Splitting Method
      type: List
      options:
        - title: "Custom Regression (anova-like)"
          name: custom_anova
        - title: "Custom Classification (class-like)"
          name: custom_class
        - title: "Custom Logistic Regression"
          name: custom_logistic
        - title: "User-defined Method"
          name: user_defined
      default: custom_anova
      description: >
                  Pre-defined custom splitting methods based on rpart vignette examples.
                  Custom methods provide enhanced splitting criteria for specific domains.

    - name: custom_splitting_validation
      title: Validate Custom Splitting Functions
      type: Bool
      default: true
      description: >
                  Validate custom splitting functions before use.
                  Ensures functions meet rpart requirements (init, eval, split components).

    # Ensemble and Advanced Modeling Options
    - name: ensemble_diversity
      title: Ensemble Diversity Enhancement
      type: Bool
      default: false
      description: >
                  Enhance ensemble diversity through parameter variation.
                  Creates diverse base learners for improved ensemble performance.

    - name: ensemble_size
      title: Ensemble Size
      type: Integer
      default: 10
      min: 3
      max: 50
      description: >
                  Number of base models in ensemble methods.
                  More models generally improve performance but increase computation.

    - name: weighted_voting
      title: Weighted Voting
      type: Bool
      default: false
      description: >
                  Use performance-weighted voting in ensemble methods.
                  Better models get higher weights in final predictions.

    - name: uncertainty_quantification
      title: Uncertainty Quantification
      type: Bool
      default: false
      description: >
                  Quantify prediction uncertainty for clinical decision support.
                  Provides confidence intervals and uncertainty estimates.

    # Performance Evaluation Enhancements
    - name: calibration_analysis
      title: Probability Calibration Analysis
      type: Bool
      default: false
      description: >
                  Analyze and display probability calibration for clinical reliability.
                  Essential for models providing probability estimates.

    - name: clinical_thresholds
      title: Clinical Decision Thresholds
      type: Bool
      default: false
      description: >
                  Optimize decision thresholds for clinical contexts.
                  Balances sensitivity and specificity based on clinical priorities.

    - name: threshold_optimization
      title: Threshold Optimization Method
      type: List
      options:
        - title: "Youden's J Statistic"
          name: youden
        - title: "F1 Score Optimization"
          name: f1
        - title: "Clinical Cost Minimization"
          name: cost
        - title: "Balanced Accuracy"
          name: balanced
      default: youden
      description: >
                  Method for optimizing classification thresholds.
                  Youden's J maximizes sensitivity + specificity - 1.

    - name: multi_threshold_analysis
      title: Multiple Threshold Analysis
      type: Bool
      default: false
      description: >
                  Analyze performance across multiple decision thresholds.
                  Shows trade-offs between sensitivity and specificity.

    - name: consensus_threshold
      title: Consensus Decision Threshold
      type: Number
      default: 0.6
      min: 0.5
      max: 1.0
      description: >
                  Minimum agreement threshold for consensus predictions.
                  Higher values require more model agreement for final decisions.

    - name: stability_threshold
      title: Stability Threshold
      type: Number
      default: 0.8
      min: 0.5
      max: 1.0
      description: >
                  Minimum stability coefficient for model acceptance.
                  Higher values indicate more consistent models across samples.

    # Advanced CART Pruning Methods
    - name: advanced_pruning_method
      title: Advanced Pruning Strategy
      type: List
      options:
        - title: "Standard Cost-Complexity Pruning"
          name: cost_complexity
        - title: "Pre-pruning (Early Stopping)"
          name: pre_pruning
        - title: "Post-pruning (Reduced Error)"
          name: post_pruning
        - title: "Pessimistic Error Pruning"
          name: pessimistic
        - title: "Critical Value Pruning"
          name: critical_value
      default: cost_complexity
      description: >
                  Advanced pruning method for optimal tree size.
                  Pre-pruning stops early, post-pruning removes branches afterward.

    - name: pre_pruning_threshold
      title: Pre-pruning Threshold
      type: Number
      default: 0.01
      min: 0.001
      max: 0.1
      description: >
                  Minimum improvement threshold for pre-pruning.
                  Higher values create simpler, more conservative trees.

    - name: post_pruning_validation_split
      title: Post-pruning Validation Split
      type: Number
      default: 0.2
      min: 0.1
      max: 0.4
      description: >
                  Proportion of training data reserved for post-pruning validation.
                  Used in reduced error pruning methods.

    # Random Forest Advanced Features
    - name: rf_feature_selection_method
      title: RF Feature Selection Method
      type: List
      options:
        - title: "Variable Importance Ranking"
          name: importance_ranking
        - title: "Permutation Importance"
          name: permutation
        - title: "Out-of-Bag Selection"
          name: oob_selection
        - title: "Boruta Algorithm"
          name: boruta
      default: importance_ranking
      description: >
                  Method for selecting important features in Random Forest.
                  Boruta finds all-relevant features using statistical tests.

    - name: rf_proximity_analysis
      title: RF Proximity Analysis
      type: Bool
      default: false
      description: >
                  Calculate proximity matrix for outlier detection and clustering.
                  Useful for understanding data structure in RF models.

    - name: rf_oob_detailed_analysis
      title: Detailed OOB Analysis
      type: Bool
      default: true
      description: >
                  Comprehensive out-of-bag error analysis with confidence intervals.
                  Provides unbiased performance estimates.

    # Algorithm Comparison and Benchmarking
    - name: algorithm_benchmarking
      title: Algorithm Benchmarking
      type: Bool
      default: false
      description: >
                  Compare tree performance against linear models and clustering.
                  Provides comprehensive algorithm comparison.

    - name: benchmark_algorithms
      title: Algorithms to Benchmark
      type: List
      options:
        - title: "Tree Algorithms Only"
          name: trees_only
        - title: "Trees vs Linear Models"
          name: trees_vs_linear
        - title: "Trees vs Clustering"
          name: trees_vs_clustering
        - title: "All Algorithm Types"
          name: comprehensive
      default: trees_only
      description: >
                  Scope of algorithm comparison analysis.
                  Comprehensive includes logistic regression and k-means.

    - name: performance_profiling
      title: Performance Profiling
      type: Bool
      default: false
      description: >
                  Profile algorithm performance including timing and memory usage.
                  Useful for production deployment decisions.

    # Advanced Tree Optimization
    - name: adaptive_complexity_parameter
      title: Adaptive Complexity Parameter
      type: Bool
      default: false
      description: >
                  Automatically adapt CP based on data characteristics.
                  Uses data-driven approach for optimal tree complexity.

    - name: dynamic_splitting_criteria
      title: Dynamic Splitting Criteria
      type: Bool
      default: false
      description: >
                  Use different splitting criteria at different tree levels.
                  Combines Gini and information gain adaptively.

    - name: tree_regularization_method
      title: Tree Regularization
      type: List
      options:
        - title: "No Regularization"
          name: none
        - title: "L1 Regularization (Lasso-style)"
          name: l1
        - title: "L2 Regularization (Ridge-style)"
          name: l2
        - title: "Minimum Description Length"
          name: mdl
      default: none
      description: >
                  Regularization method to prevent overfitting.
                  Different methods penalize complexity differently.

    - name: regularization_strength
      title: Regularization Strength
      type: Number
      default: 0.1
      min: 0.01
      max: 1.0
      description: >
                  Strength of regularization penalty.
                  Higher values create simpler trees.

    # Feature Engineering for Trees
    - name: automated_feature_engineering
      title: Automated Feature Engineering
      type: Bool
      default: false
      description: >
                  Automatically create interaction terms and transformations.
                  Can improve tree performance for complex relationships.

    - name: interaction_depth
      title: Interaction Term Depth
      type: Integer
      default: 2
      min: 2
      max: 3
      description: >
                  Maximum depth for automatic interaction terms.
                  2 = pairwise, 3 = three-way interactions.

    - name: polynomial_degree
      title: Polynomial Feature Degree
      type: Integer
      default: 2
      min: 2
      max: 3
      description: >
                  Degree of polynomial features to create.
                  Higher degrees capture more complex non-linearities.

    # Enhanced Tree Visualization (from rpart articles)
    - name: fancy_tree_plot
      title: Fancy Tree Visualization
      type: Bool
      default: false
      description: >
                  Use rattle's fancyRpartPlot for enhanced tree visualization.
                  Provides publication-quality tree diagrams.

    - name: tree_structure_analysis
      title: Tree Structure Analysis
      type: Bool
      default: false
      description: >
                  Detailed analysis of tree structure including node statistics,
                  split quality measures, and branch complexity metrics.

    - name: cp_selection_visualization
      title: CP Selection Visualization
      type: Bool
      default: false
      description: >
                  Visualize complexity parameter selection with xerror plots.
                  Shows cross-validation error vs tree complexity.

    # Advanced Evaluation Metrics (from articles)
    - name: f1_score_analysis
      title: F1 Score Analysis
      type: Bool
      default: false
      description: >
                  Calculate F1 scores for all classes with macro/micro averaging.
                  Essential for imbalanced classification problems.

    - name: learning_curve_analysis
      title: Learning Curve Analysis
      type: Bool
      default: false
      description: >
                  Generate learning curves showing performance vs sample size.
                  Identifies optimal training size and overfitting patterns.

    - name: residual_diagnostics
      title: Residual Diagnostics (Regression)
      type: Bool
      default: false
      description: >
                  Comprehensive residual analysis for regression trees.
                  Includes normality tests and homoscedasticity checks.

    # Tree Optimization (from articles)
    - name: hyperparameter_grid_search
      title: Hyperparameter Grid Search
      type: Bool
      default: false
      description: >
                  Systematic grid search over cp, maxdepth, minsplit, minbucket.
                  Finds optimal parameter combinations through exhaustive search.

    - name: cross_validation_optimization
      title: CV-based Optimization
      type: Bool
      default: false
      description: >
                  Use cross-validation for robust hyperparameter selection.
                  Prevents overfitting to specific train-test splits.

    - name: ensemble_optimization
      title: Ensemble Optimization
      type: Bool
      default: false
      description: >
                  Optimize ensemble parameters for improved performance.
                  Includes optimal ensemble size and diversity measures.

    # Missing Data Enhancement (from articles)
    - name: surrogate_split_analysis
      title: Surrogate Split Analysis
      type: Bool
      default: false
      description: >
                  Detailed analysis of surrogate splits for missing data handling.
                  Shows backup splitting rules and their effectiveness.

    - name: missing_pattern_analysis
      title: Missing Pattern Analysis
      type: Bool
      default: false
      description: >
                  Analyze patterns of missingness in the dataset.
                  Identifies MCAR, MAR, and MNAR mechanisms.

...
