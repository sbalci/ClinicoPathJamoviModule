title: Segmented Total Bar Charts
name: jjsegmentedtotalbar
jus: '3.0'
compilerMode: tame
children:
  - type: VariableSupplier
    suggested:
      - continuous
      - nominal
      - ordinal
    persistentItems: false
    stretchFactor: 1
    children:
      - type: TargetLayoutBox
        label: Category Variable (X-axis)
        children:
          - type: VariablesListBox
            name: x_var
            maxItemCount: 1
            isTarget: true
            itemDropBehaviour: overwrite
            label: Categories (e.g., Treatment Groups)
      - type: TargetLayoutBox
        label: Value Variable (Y-axis)
        children:
          - type: VariablesListBox
            name: y_var
            maxItemCount: 1
            isTarget: true
            itemDropBehaviour: overwrite
            label: Values (e.g., Patient Counts)
      - type: TargetLayoutBox
        label: Segment Variable (Fill)
        children:
          - type: VariablesListBox
            name: fill_var
            maxItemCount: 1
            isTarget: true
            itemDropBehaviour: overwrite
            label: Segments (e.g., Response Type)
      - type: TargetLayoutBox
        label: Panel Variable (Optional)
        children:
          - type: VariablesListBox
            name: facet_var
            maxItemCount: 1
            isTarget: true
            itemDropBehaviour: overwrite
            label: Optional Panels (e.g., by Site)
  - type: LayoutBox
    margin: large
    stretchFactor: 0
    children:
      - type: Label
        label: Segmented Total Bar Charts
        children:
          - type: Label
            label: >-
              Select variables and configure your analysis using the options
              below.
            margin: small
            style: list-inline
  - type: LayoutBox
    margin: large
    children:
      - type: CheckBox
        name: show_plot
  - type: CollapseBox
    label: Clinical Analysis Templates
    collapsed: false
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: analysis_preset
            label: Clinical Analysis Template
          - type: Label
            label: Choose a template for common clinical analyses.
            margin: small
            style: list-inline
  - type: CollapseBox
    label: Plot Selection
    collapsed: false
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: 'Select plots to display:'
            margin: small
  - type: CollapseBox
    label: Chart Options
    collapsed: false
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: chart_style
            label: Chart Style
          - type: ComboBox
            name: color_palette
            label: Color Palette
          - type: ComboBox
            name: orientation
            label: Bar Orientation
          - type: ComboBox
            name: sort_categories
            label: Sort Categories
  - type: CollapseBox
    label: Labels and Statistics
    collapsed: false
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: show_percentages
            label: Show Percentages
          - type: ComboBox
            name: percentage_format
            enable: (show_percentages)
            label: Percentage Format
          - type: CheckBox
            name: show_counts
            label: Show Raw Counts
          - type: TextBox
            name: label_threshold
            format: number
            suffix: '%'
            label: Min Segment Size for Labels
          - type: Label
            label: '⚠️ Requirements: Value Variable must be integer counts for valid Chi-square tests.'
            margin: small
            style: list-inline
          - type: CheckBox
            name: show_statistical_tests
            label: Statistical Tests (Chi-square)
          - type: TextBox
            name: confidence_level
            enable: (show_statistical_tests)
            format: number
            label: Confidence Level
  - type: LayoutBox
    margin: large
    children:
      - type: TextBox
        name: plot_title
        format: string
        label: Chart Title
  - type: LayoutBox
    margin: large
    children:
      - type: CheckBox
        name: showExplanations
  - type: CollapseBox
    label: Layout and Styling
    collapsed: true
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: legend_position
            label: Legend Position
          - type: TextBox
            name: bar_width
            format: number
            suffix: ''
            label: Bar Width
          - type: CheckBox
            name: add_outline
            label: Add Segment Outlines
          - type: ComboBox
            name: outline_color
            enable: (add_outline)
            label: Outline Color
  - type: LayoutBox
    margin: large
    children:
      - type: TextBox
        name: x_title
        format: string
        label: X-axis Title
  - type: CollapseBox
    label: Plot Dimensions
    collapsed: true
    stretchFactor: 0
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: plot_width
            format: number
            suffix: ' inches'
            label: Plot Width (inches)
          - type: TextBox
            name: plot_height
            format: number
            suffix: ' inches'
            label: Plot Height (inches)
          - type: CheckBox
            name: export_ready
            label: Export Ready
  - type: LayoutBox
    margin: large
    children:
      - type: TextBox
        name: y_title
        format: string
        label: Y-axis Title
  - type: LayoutBox
    margin: large
    children:
      - type: TextBox
        name: legend_title
        format: string
        label: Legend Title
