title: Advanced ROC Analysis
name: psychopdaROC
jus: '3.0'
stage: 0
compilerMode: tame
children:
  - type: VariableSupplier
    persistentItems: false
    stretchFactor: 1
    children:
      - type: TargetLayoutBox
        label: Test Variables
        children:
          - type: VariablesListBox
            name: dependentVars
            isTarget: true
      - type: TargetLayoutBox
        label: Class Variable (Gold Standard)
        children:
          - type: VariablesListBox
            name: classVar
            maxItemCount: 1
            isTarget: true
          - type: LevelSelector
            name: positiveClass
            label: Positive Class
            enable: (classVar)
      - type: TargetLayoutBox
        label: Group Variable (Optional)
        children:
          - type: VariablesListBox
            name: subGroup
            maxItemCount: 1
            isTarget: true
  - type: LayoutBox
    margin: normal
    children:
      - type: Label
        label: Analysis Configuration
      - type: ComboBox
        name: clinicalMode
        label: Analysis Level
      - type: ComboBox
        name: clinicalPreset
        label: Clinical Use Case
        enable: (clinicalMode:basic || clinicalMode:advanced)
  - type: CollapseBox
    label: Meta-Analysis (3+ Variables Required)
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: metaAnalysis
            label: Perform meta-analysis of AUC values
            enable: (dependentVars)
          - type: ComboBox
            name: metaAnalysisMethod
            label: Meta-analysis method
            enable: (metaAnalysis)
          - type: CheckBox
            name: heterogeneityTest
            label: Test for heterogeneity (Q-test, IÂ²)
            enable: (metaAnalysis)
          - type: CheckBox
            name: forestPlot
            label: Show forest plot
            enable: (metaAnalysis)
  - type: CollapseBox
    label: Fixed Sensitivity/Specificity Analysis
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: fixedSensSpecAnalysis
            label: Enable Fixed Sensitivity/Specificity Analysis
          - type: ComboBox
            name: fixedAnalysisType
            label: Analysis Type
            enable: (fixedSensSpecAnalysis)
          - type: TextBox
            name: fixedSensitivityValue
            format: number
            label: Target Sensitivity
            enable: (fixedSensSpecAnalysis && fixedAnalysisType:sensitivity)
          - type: TextBox
            name: fixedSpecificityValue
            format: number
            label: Target Specificity
            enable: (fixedSensSpecAnalysis && fixedAnalysisType:specificity)
          - type: ComboBox
            name: fixedInterpolation
            label: Interpolation Method
            enable: (fixedSensSpecAnalysis)
          - type: CheckBox
            name: showFixedROC
            label: Show Fixed Point ROC Curve
            enable: (fixedSensSpecAnalysis)
          - type: CheckBox
            name: showFixedExplanation
            label: Show Analysis Guide
            enable: (fixedSensSpecAnalysis)
  - type: CollapseBox
    label: Cutpoint Optimization
    margin: normal
    collapsed: false
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: method
            label: Cutpoint Method
          - type: ComboBox
            name: metric
            label: Optimization Metric
            enable: >-
              (!method:oc_manual && !method:oc_cost_ratio &&
              !method:oc_equal_sens_spec && !method:oc_closest_01)
          - type: ComboBox
            name: direction
            label: Classification Direction
          - type: TextBox
            name: specifyCutScore
            format: string
            enable: (method:oc_manual)
            label: Manual Cut Score
          - type: TextBox
            name: costratioFP
            format: number
            label: Cost Ratio (FP:FN)
            enable: (method:oc_cost_ratio)
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Advanced Settings
          - type: TextBox
            name: tol_metric
            format: number
            label: Metric Tolerance
            enable: >-
              (method:maximize_metric || method:minimize_metric ||
              method:maximize_loess_metric || method:minimize_loess_metric
              || method:maximize_spline_metric ||
              method:minimize_spline_metric)
          - type: ComboBox
            name: break_ties
            label: Tie Breaking Method
          - type: TextBox
            name: boot_runs
            format: number
            label: Bootstrap Iterations
            enable: (method:maximize_boot_metric || method:minimize_boot_metric)
  - type: CollapseBox
    label: Analysis Options
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: allObserved
            label: Show all observed cutpoints
          - type: CheckBox
            name: usePriorPrev
            label: Use prior prevalence
          - type: TextBox
            name: priorPrev
            format: number
            label: Prior prevalence value
            enable: (usePriorPrev)
  - type: CollapseBox
    label: Output Options
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: sensSpecTable
            label: Show confusion matrices
          - type: CheckBox
            name: showThresholdTable
            label: Show threshold table
          - type: TextBox
            name: maxThresholds
            format: number
            label: Maximum thresholds to display
            enable: (showThresholdTable)
          - type: CheckBox
            name: delongTest
            label: Compare AUCs (DeLong's test)
  - type: CollapseBox
    label: Visualization
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Basic Plot Settings
          - type: CheckBox
            name: plotROC
            label: Show ROC curves
          - type: CheckBox
            name: combinePlots
            label: Combine all curves in one plot
            enable: (plotROC)
          - type: CheckBox
            name: showOptimalPoint
            label: Show optimal cutpoint
            enable: (plotROC)
          - type: CheckBox
            name: directLabel
            label: Label curves directly
            enable: (plotROC && combinePlots)
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Plot Style
          - type: CheckBox
            name: cleanPlot
            label: Publication-quality plot
            enable: (plotROC)
          - type: ComboBox
            name: legendPosition
            label: Legend position
            enable: (plotROC && combinePlots && !directLabel)
          - type: CheckBox
            name: smoothing
            label: Apply LOESS smoothing
            enable: (plotROC)
          - type: CheckBox
            name: displaySE
            label: Show standard error bands
            enable: (plotROC && smoothing && !cleanPlot)
          - type: CheckBox
            name: interactiveROC
            label: Create interactive plot
            enable: (plotROC)
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Confidence Intervals
          - type: CheckBox
            name: showConfidenceBands
            label: Show confidence bands
            enable: (plotROC && !cleanPlot)
          - type: CheckBox
            name: quantileCIs
            label: Show CIs at quantiles
            enable: (plotROC && !cleanPlot)
          - type: TextBox
            name: quantiles
            format: string
            label: Quantile positions
            enable: (quantileCIs)
  - type: CollapseBox
    label: Additional Plots
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: showCriterionPlot
            label: Sensitivity/Specificity vs. Threshold
          - type: CheckBox
            name: showPrevalencePlot
            label: Predictive Values vs. Prevalence
          - type: CheckBox
            name: showDotPlot
            label: Test Values Distribution
          - type: CheckBox
            name: precisionRecallCurve
            label: Precision-Recall Curve
  - type: CollapseBox
    label: Advanced ROC Analysis
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Partial AUC
          - type: CheckBox
            name: partialAUC
            label: Calculate partial AUC
          - type: TextBox
            name: partialAUCfrom
            format: number
            label: From specificity
            enable: (partialAUC)
          - type: TextBox
            name: partialAUCto
            format: number
            label: To specificity
            enable: (partialAUC)
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: ROC Smoothing
          - type: ComboBox
            name: rocSmoothingMethod
            label: Smoothing method
          - type: CheckBox
            name: bootstrapCI
            label: Bootstrap confidence intervals
          - type: TextBox
            name: bootstrapReps
            format: number
            label: Bootstrap replications
            enable: (bootstrapCI)
  - type: CollapseBox
    label: Model Comparison
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: compareClassifiers
            label: Compare classifier performance
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: IDI and NRI Analysis
          - type: CheckBox
            name: calculateIDI
            label: Calculate IDI
          - type: CheckBox
            name: calculateNRI
            label: Calculate NRI
          - type: LevelSelector
            name: refVar
            label: Reference Variable
            enable: (calculateIDI || calculateNRI)
          - type: TextBox
            name: nriThresholds
            format: string
            label: NRI thresholds (comma-separated)
            enable: (calculateNRI)
          - type: TextBox
            name: idiNriBootRuns
            format: number
            label: Bootstrap iterations
            enable: (calculateIDI || calculateNRI)
          - type: LayoutBox
            margin: large
            children:
              - type: Label
                label: Statistical Analysis
              - type: CheckBox
                name: effectSizeAnalysis
                label: Effect Size Analysis
              - type: ComboBox
                name: effectSizeMethod
                label: Effect Size Method
                enable: (effectSizeAnalysis)
              - type: CheckBox
                name: powerAnalysis
                label: Statistical Power Analysis
              - type: ComboBox
                name: powerAnalysisType
                label: Power Analysis Type
                enable: (powerAnalysis)
              - type: TextBox
                name: expectedAUCDifference
                format: number
                label: Expected AUC Difference
                enable: (powerAnalysis)
              - type: TextBox
                name: targetPower
                format: number
                label: Target Power
                enable: (powerAnalysis)
              - type: TextBox
                name: significanceLevel
                format: number
                label: Significance Level
                enable: (powerAnalysis)
              - type: TextBox
                name: correlationROCs
                format: number
                label: ROC Correlation
                enable: (powerAnalysis)
  - type: CollapseBox
    label: Advanced Analysis
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: Advanced Metrics
          - type: CheckBox
            name: advancedMetrics
            label: Advanced Performance Metrics
          - type: Label
            label: Bayesian Analysis
          - type: CheckBox
            name: bayesianAnalysis
            label: Bayesian ROC Analysis
          - type: TextBox
            name: priorAUC
            format: number
            label: Prior AUC
            enable: (bayesianAnalysis)
          - type: TextBox
            name: priorPrecision
            format: number
            label: Prior Precision
            enable: (bayesianAnalysis)
          - type: Label
            label: Clinical Utility
          - type: CheckBox
            name: clinicalUtilityAnalysis
            label: Clinical Utility Analysis
          - type: TextBox
            name: treatmentThreshold
            format: string
            label: Treatment Threshold
            enable: (clinicalUtilityAnalysis)
          - type: TextBox
            name: harmBenefitRatio
            format: number
            label: Harm-Benefit Ratio
            enable: (clinicalUtilityAnalysis)
          - type: CheckBox
            name: interventionCost
            label: Intervention Cost Analysis
            enable: (clinicalUtilityAnalysis)
