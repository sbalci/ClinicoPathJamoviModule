title: Decision Panel Optimization
name: decisionpanel
jus: '3.0'
stage: 0
compilerMode: tame
children:
  # ==========================================
  # STEP 1: DATA INPUTS
  # ==========================================
  - type: CollapseBox
    label: Data Setup
    margin: normal
    collapsed: false
    children:
      - type: Label
        label: "Select diagnostic tests (lab values, imaging findings, clinical signs) and your gold standard reference"
        children:
          - type: Label
            label: "üí° Tip: Choose 2-5 complementary tests for optimal performance"
      - type: VariableSupplier
        persistentItems: false
        stretchFactor: 1
        children:
          - type: TargetLayoutBox
            label: "Primary Diagnostic Test"
            children:
              - type: VariablesListBox
                name: test1
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: test1Positive
                label: "Positive Result Level"
                enable: (test1)
          - type: TargetLayoutBox
            label: "Secondary Diagnostic Test"
            children:
              - type: VariablesListBox
                name: test2
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: test2Positive
                label: "Positive Result Level"
                enable: (test2)
          - type: TargetLayoutBox
            label: "Additional Test 3 (Optional)"
            children:
              - type: VariablesListBox
                name: test3
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: test3Positive
                label: "Positive Result Level"
                enable: (test3)
          - type: TargetLayoutBox
            label: "Additional Test 4 (Optional)"
            children:
              - type: VariablesListBox
                name: test4
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: test4Positive
                label: "Positive Result Level"
                enable: (test4)
          - type: TargetLayoutBox
            label: "Additional Test 5 (Optional)"
            children:
              - type: VariablesListBox
                name: test5
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: test5Positive
                label: "Positive Result Level"
                enable: (test5)
          - type: TargetLayoutBox
            label: "Gold Standard Reference"
            children:
              - type: VariablesListBox
                name: gold
                maxItemCount: 1
                isTarget: true
              - type: LevelSelector
                name: goldPositive
                label: "Disease/Condition Present Level"
                enable: (gold)
  
  # ==========================================
  # STEP 2: ANALYSIS STRATEGY
  # ==========================================
  - type: CollapseBox
    label: "Testing Strategy Configuration"
    margin: normal
    collapsed: false
    children:
      - type: Label
        label: "Choose how tests should be combined and evaluated"
        children:
          - type: Label
            label: "üîç Single: Each test evaluated independently"
          - type: Label
            label: "‚ö° Parallel: Tests performed simultaneously (any/all positive)"
          - type: Label  
            label: "üìã Sequential: Tests performed in order (stop when criteria met)"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: strategies
            label: "Testing Strategies to Evaluate"
          - type: TextBox
            name: maxTests
            format: number
            label: "Maximum Tests per Panel (2-5 recommended)"
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: "Parallel Testing Configuration"
            children:
              - type: ComboBox
                name: parallelRules
                label: "Decision Rule for Parallel Tests"
                enable: (strategies:parallel)
              - type: TextBox
                name: customThreshold
                format: number
                label: "Custom Threshold (number of positive tests needed)"
                enable: (parallelRules:custom)
      - type: LayoutBox
        margin: large
        children:
          - type: Label
            label: "Sequential Testing Configuration"
            children:
              - type: ComboBox
                name: sequentialStop
                label: "When to Stop Sequential Testing"
                enable: (strategies:sequential)
  
  # ==========================================
  # STEP 3: OPTIMIZATION CRITERIA
  # ==========================================
  - type: CollapseBox
    label: "Performance Optimization Settings"
    margin: normal
    collapsed: false
    children:
      - type: Label
        label: "Define what makes an optimal test panel for your clinical scenario"
        children:
          - type: Label
            label: "üéØ Accuracy: Overall correctness (recommended for balanced datasets)"
          - type: Label
            label: "üîç Sensitivity: Prioritize catching positive cases (screening)"
          - type: Label
            label: "‚úÖ Specificity: Prioritize avoiding false positives (confirmatory)"
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: optimizationCriteria
            label: "Primary Optimization Goal"
          - type: ComboBox
            name: panelOptimization
            label: "Panel Building Strategy"
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: minSensitivity
            format: number
            label: "Minimum Sensitivity Required (0-1, e.g., 0.8 for 80%)"
          - type: TextBox
            name: minSpecificity
            format: number
            label: "Minimum Specificity Required (0-1, e.g., 0.8 for 80%)"
          - type: TextBox
            name: minImprovement
            format: number
            label: "Minimum Performance Improvement (0-1, e.g., 0.05 for 5%)"
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: topN
            format: number
            label: "Number of Top Panels to Display (default: 10)"
          - type: TextBox
            name: redundancyThreshold
            format: number
            label: "Test Correlation Threshold (0-1, higher = more redundancy)"
  
  # ==========================================
  # STEP 4: COST-EFFECTIVENESS ANALYSIS
  # ==========================================
  - type: CollapseBox
    label: Cost-Effectiveness Analysis
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: useCosts
            label: Include Cost-Effectiveness Analysis
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: testCosts
            format: string
            label: Individual Test Costs (comma-separated)
            enable: (useCosts)
          - type: TextBox
            name: fpCost
            format: number
            label: Cost of False Positive Result
            enable: (useCosts)
          - type: TextBox
            name: fnCost
            format: number
            label: Cost of False Negative Result
            enable: (useCosts)
          - type: TextBox
            name: prevalence
            format: number
            label: Disease Prevalence (0 = use sample prevalence)
  
  # ==========================================
  # STEP 5: DECISION TREE ANALYSIS
  # ==========================================
  - type: CollapseBox
    label: Decision Tree Analysis
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: createTree
            label: Create Decision Tree for Sequential Testing
      - type: LayoutBox
        margin: large
        children:
          - type: ComboBox
            name: treeMethod
            label: Tree Construction Method
            enable: (createTree)
          - type: TextBox
            name: maxDepth
            format: number
            label: Maximum Tree Depth
            enable: (createTree)
          - type: TextBox
            name: minSplit
            format: number
            label: Minimum Node Size for Split
            enable: (createTree)
  
  # ==========================================
  # STEP 6: VALIDATION METHODS
  # ==========================================
  - type: CollapseBox
    label: Validation & Robustness Testing
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: bootstrap
            label: Bootstrap Confidence Intervals
          - type: TextBox
            name: bootReps
            format: number
            label: Bootstrap Replications
            enable: (bootstrap)
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: crossValidate
            label: K-Fold Cross-Validation
          - type: TextBox
            name: nFolds
            format: number
            label: Number of Folds
            enable: (crossValidate)
  
  # ==========================================
  # STEP 7: OUTPUT & VISUALIZATION OPTIONS
  # ==========================================
  - type: CollapseBox
    label: Output & Display Options
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: CheckBox
            name: showAllCombinations
            label: Show All Test Combinations
          - type: CheckBox
            name: compareStrategies
            label: Compare Testing Strategies
      - type: LayoutBox
        margin: large  
        children:
          - type: CheckBox
            name: plotTree
            label: Decision Tree Plot
            enable: (createTree)
          - type: CheckBox
            name: plotComparison
            label: Strategy Comparison Plots
          - type: CheckBox
            name: plotCostEffect
            label: Cost-Effectiveness Frontier Plot
            enable: (useCosts)
          - type: CheckBox
            name: plotROC
            label: ROC Curves for Top Panels
  
  # ==========================================
  # CLINICAL GUIDANCE & GLOSSARY
  # ==========================================
  - type: CollapseBox
    label: "üìö Clinical Guidance & Terminology"
    margin: normal
    collapsed: true
    children:
      - type: Label
        label: "Understanding Diagnostic Test Performance"
        children:
          - type: Label
            label: "‚Ä¢ Sensitivity: Proportion of true positive cases correctly identified (true positive rate)"
          - type: Label
            label: "‚Ä¢ Specificity: Proportion of true negative cases correctly identified (true negative rate)"
          - type: Label
            label: "‚Ä¢ PPV (Positive Predictive Value): Probability that a positive test indicates disease"
          - type: Label
            label: "‚Ä¢ NPV (Negative Predictive Value): Probability that a negative test excludes disease"
          - type: Label
            label: "‚Ä¢ Accuracy: Overall proportion of correct classifications"
          - type: Label
            label: "‚Ä¢ AUC (Area Under Curve): Overall discriminative ability (0.5 = random, 1.0 = perfect)"
      - type: Label
        label: "Clinical Decision Guidelines"
        children:
          - type: Label
            label: "üè• Screening Tests: Prioritize high sensitivity (minimize missed cases)"
          - type: Label
            label: "üî¨ Confirmatory Tests: Prioritize high specificity (minimize false alarms)"
          - type: Label
            label: "‚öñÔ∏è Balanced Testing: Consider both sensitivity and specificity equally"
          - type: Label
            label: "üí∞ Cost-Effectiveness: Include test costs and clinical consequences"

  # ==========================================
  # ADVANCED SETTINGS
  # ==========================================
  - type: CollapseBox
    label: "Advanced Settings"
    margin: normal
    collapsed: true
    children:
      - type: LayoutBox
        margin: large
        children:
          - type: TextBox
            name: seed
            format: number
            label: "Random Seed (for reproducible results)"
          - type: CheckBox
            name: showProgress
            label: "Show Progress Indicators and Performance Statistics"
