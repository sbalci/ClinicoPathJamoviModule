---
name: datevalidator
title: Date/DateTime Validator
menuGroup: SurvivalD
menuSubgroup: Data Preparation
menuSubtitle: Validate and diagnose messy date/datetime formats
version: '0.0.32'
jas: '1.2'

description:
  main: |
    Comprehensive date and datetime field validation and quality assessment using multiple R packages (datefixR, anytime, lubridate).
    This module validates and diagnoses messy date/datetime formats commonly found in clinical databases: different separators,
    month representations, missing components, and ambiguous formats. Provides detailed validation reports and quality assessment.
    Perfect for clinical research data quality control and database audit workflows.

    For datetime conversion with component extraction (year, month, day, hour, minute, second), see the DateTime Converter module.
  R:
    dontrun: true
    usage: |
      # Example:
      # 1. Select variables containing date/datetime information that need validation.
      # 2. Choose validation method (automatic detection or specific format).
      # 3. Configure missing value imputation settings.
      # 4. Review validation results and quality assessment.

options:

    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.

    - name: date_vars
      title: Date/DateTime Variables to Validate
      type: Variables
      description:
          R: >
            Variables containing date or datetime information in various formats that need validation and quality assessment.
            Can handle character strings, numeric values, factors with date/datetime representations.

    - name: correction_method
      title: Validation Method
      type: List
      options:
        - title: "Automatic Detection (datefixR)"
          name: datefixr
        - title: "Flexible Parsing (anytime)"
          name: anytime
        - title: "Format-Specific (lubridate)"
          name: lubridate
        - title: "Multi-Method Consensus"
          name: consensus
      default: datefixr
      description:
          R: >
            Method for date/datetime validation. datefixR provides robust format detection,
            anytime offers flexible parsing, lubridate allows format specification,
            and consensus combines methods for maximum reliability.

    - name: date_format
      title: Expected Date/DateTime Format
      type: List
      options:
        - title: "Day-Month-Year (DMY)"
          name: dmy
        - title: "Month-Day-Year (MDY)"
          name: mdy
        - title: "Year-Month-Day (YMD)"
          name: ymd
        - title: "Day-Month-Year Hour:Min:Sec (DMY HMS)"
          name: dmy_hms
        - title: "Month-Day-Year Hour:Min:Sec (MDY HMS)"
          name: mdy_hms
        - title: "Year-Month-Day Hour:Min:Sec (YMD HMS)"
          name: ymd_hms
        - title: "Auto-detect"
          name: auto
      default: auto
      description:
          R: >
            Expected date or datetime format for ambiguous cases. Auto-detect tries to determine
            the most likely format based on the data patterns. HMS formats include time components (hours, minutes, seconds).

    - name: day_impute
      title: Missing Day Imputation
      type: Number
      min: 1
      max: 31
      default: 1
      description:
          R: >
            Day of month to impute when day is missing (1-31). Default is 1st of month.
            If value exceeds days in month, last day of month will be used.

    - name: month_impute
      title: Missing Month Imputation
      type: Number
      min: 1
      max: 12
      default: 7
      description:
          R: >
            Month to impute when month is missing (1-12). Default is 7 (July).
            Commonly used middle-year value for clinical research.

    - name: handle_excel
      title: Handle Excel Date Numbers
      type: Bool
      default: false
      description:
          R: >
            Whether to convert Excel numeric date values (days since 1900-01-01).
            Useful for data exported from Excel spreadsheets.

    - name: timezone
      title: Output Timezone
      type: String
      default: "UTC"
      description:
          R: >
            Timezone for output dates/datetimes. Use UTC for standardization, or local timezone
            if time-of-day information is critical. Only applies to anytime and consensus methods.

    - name: show_correction_table
      title: Show Validation Results Table
      type: Bool
      default: false
      description:
          R: >
            Display detailed table showing original values, validated values, and
            validation status for each observation.

    - name: show_quality_assessment
      title: Show Quality Assessment
      type: Bool
      default: false
      description:
          R: >
            Provide quality assessment including success rates, common problems,
            and recommendations for further validation.

    - name: show_format_analysis
      title: Show Format Analysis
      type: Bool
      default: false
      description:
          R: >
            Analyze detected date/datetime formats and patterns in the original data.

    - name: show_correction_summary
      title: Show Validation Summary
      type: Bool
      default: false
      description:
          R: >
            Summary statistics of the validation process including before/after
            comparison and data quality metrics.

    - name: show_interpretation
      title: Show Usage Guide
      type: Bool
      default: false
      description:
          R: >
            Display guidance on date/datetime validation methods, best practices, and
            recommendations for clinical research data. Includes information about the DateTime Converter module.

...
