---
name:  riverplot
title: River Plots
menuGroup: JJStatsPlotT
menuSubgroup: 'Categorical Over Time'
menuSubtitle: 'Temporal Categorical Flow Visualization'
version: '0.0.31'
jas: '1.2'

description:
    main: |
        Creates river plots to visualize how categorical variables change over time 
        or sequential stages. Shows temporal flows of categories across time periods, 
        ideal for tracking patient journeys, treatment progressions, disease stages, 
        or any categorical changes over time. Requires a time/sequence variable and 
        supports individual entity tracking.
    R:
        dontrun: true
        usage: |
            # Load temporal clinical data
            data(patient_followup)
            
            # Basic temporal flow - Track treatment response changes over time
            riverplot(
              data = patient_followup,
              time = "follow_up_date",
              strata = "treatment_response",
              plotType = "flow",
              labelNodes = TRUE
            )
            
            # Individual patient tracking over time with ID
            riverplot(
              data = patient_followup,
              id = "patient_id",
              time = "follow_up_date",
              strata = "disease_stage",
              plotType = "flow",
              fillType = "last",
              showCounts = TRUE,
              curveType = "cubic"
            )
            
            # Weighted temporal flow - Account for severity scores
            riverplot(
              data = patient_followup,
              time = "visit_number",
              strata = "pain_level",
              weight = "patient_count",
              plotType = "flow",
              curveType = "sigmoid"
            )
            
            # Stream chart - Aggregate trends over time (no individual tracking)
            riverplot(
              data = patient_followup,
              time = "month",
              strata = "outcome_category",
              plotType = "stream",
              showLegend = TRUE
            )
            
            # Complex temporal tracking - Multi-level response changes
            riverplot(
              data = longitudinal_study,
              id = "subject_id",
              time = "assessment_period",
              strata = "functional_status",
              weight = "quality_of_life_score",
              plotType = "flow",
              labelNodes = TRUE,
              showCounts = TRUE
            )

options:
    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.

    - name: id
      title: ID Variable (optional)
      type: Variable
      suggested: [ nominal, ordinal ]
      permitted: [ factor ]
      description:
          R: >
            Optional identifier for tracking individual entities (patients, cases) through transitions.

    - name: time
      title: Time/Sequence Variable (required)
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      description:
          R: >
            Required variable representing time points or sequential stages (e.g., visit dates, follow-up periods).

    - name: strata
      title: Categorical Variable
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      description:
          R: >
            The categorical variable that changes over time (e.g., treatment response, disease stage).

    - name: weight
      title: Weight Variable (optional)
      type: Variable
      suggested: [ continuous ]
      permitted: [ numeric ]
      default: NULL
      description:
          R: >
            Optional numerical variable to determine stream width.

    - name: plotType
      title: Visualization Type
      type: List
      options:
        - title: Flow Diagram (tracks individual changes)
          name: flow
        - title: Stream Chart (shows aggregate trends)
          name: stream
      default: flow
      description:
          R: >
            Flow diagrams track individual entities through time periods. 
            Stream charts show aggregate category trends over time.

    - name: fillType
      title: Fill Pattern
      type: List
      options:
        - title: By First Variable
          name: first
        - title: By Last Variable
          name: last
      default: first
      description:
          R: >
            Determines how colors are assigned to flows.

    - name: sortStreams
      title: Sort Streams
      type: Bool
      default: true
      description:
          R: >
            Sort alluvial streams by frequency.

    - name: labelNodes
      title: Label Nodes
      type: Bool
      default: true
      description:
          R: >
            Add labels to nodes.

    - name: curveType
      title: Flow Curve Style
      type: List
      options:
        - title: Smooth (cubic splines)
          name: cubic
        - title: Very smooth (quintic)
          name: quintic
        - title: Linear connections
          name: linear
        - title: S-shaped (sigmoid)
          name: sigmoid
      default: cubic
      description:
          R: >
            Style of curves connecting time periods. Smooth curves work best for temporal flows.

    - name: showCounts
      title: Show Counts
      type: Bool
      default: false
      description:
          R: >
            Display counts on the diagram.

    - name: showLegend
      title: Show Legend
      type: Bool
      default: true
      description:
          R: >
            Display color legend.

    - name: mytitle
      title: Title
      type: String
      default: ''
      description:
          R: >
            Title for the plot.

    - name: xtitle
      title: X-Title
      type: String
      default: ''
      description:
          R: >
            Label for the x-axis.

    - name: ytitle
      title: Y-Title
      type: String
      default: ''
      description:
          R: >
            Label for the y-axis.

    - name: originaltheme
      title: Use Minimal Theme
      type: Bool
      default: false
      description:
          R: >
            Use a minimal theme instead of the default ggplot2 theme.

...
