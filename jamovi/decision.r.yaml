---
name:  decision
title: Medical Decision
jrs:   '1.1'

items:

    - name: welcome
      title: 'Getting Started'
      type: Html
      visible: (!(gold && newtest && goldPositive && testPositive))
      clearWith:
        - gold
        - newtest
        - goldPositive
        - testPositive
        - goldNegative
        - testNegative
        - goldNegative
        - testNegative

    # Notice outputs converted to HTML to avoid serialization errors
    - name: notices
      title: 'Important Information'
      type: Html
      clearWith:
        - gold
        - newtest
        - goldPositive
        - testPositive
        - goldNegative
        - testNegative
        - pp
        - pprob
        - ci
        - showMisclassified
        - maxCasesShow

    # - name:  todo
    #   title: To Do
    #   type:  Html

    # - name:  text1
    #   title: Original Data
    #   type:  Preformatted
    #   visible: (od)


    # - name:  text2
    #   title: Original Data
    #   type:  Html
    #   visible: (od)

    - name: rawContingency
      title: Raw Contingency Table
      type: Table
      visible: (od)
      rows: 0
      columns:
        - name: test_level
          title: ''
          type: text
        - name: gold_pos
          title: ''
          type: number
        - name: gold_neg
          title: ''
          type: number
        - name: row_total
          title: Total
          type: number
      clearWith:
        - gold
        - newtest
        - goldPositive
        - testPositive
        - goldNegative
        - testNegative

    - name: rawCounts
      title: Raw Combination Counts
      type: Table
      visible: (od)
      rows: 0
      columns:
        - name: test_level
          title: ''
          type: text
        - name: gold_level
          title: ''
          type: text
        - name: count
          title: Count
          type: integer
      clearWith:
        - gold
        - newtest

    # - name:  text2
    #   title: Original Data
    #   type:  Preformatted

    # - name:  text3
    #   title: Preformatted
    #   type:  Preformatted


    # - name:  text2
    #   title: Decision Tests
    #   type:  Preformatted
    #   refs: caret



    # - name:  origTable
    #   title: 'Original Table'
    #   type: Table
    #   rows: (newtest)
    #   columns:
    #     - name: goldPositive
    #       title: ''
    #       type: text
    #       content: ($key)





    - name:  cTable
      title: 'Recoded Data for Decision Test Statistics'
      type: Table
      rows: 0
      columns:
        - name: newtest
          title: ''
          type: text
        - name: GP
          title: 'Gold Positive'
          type: number
        - name: GN
          title: 'Gold Negative'
          type: number
        - name: Total
          title: 'Total'
          type: number


    # - name:  cTable2
    #   title: 'Recoded Data for Decision Test Statistics 2'
    #   type: Table
    #   rows: 0
    #   columns:
    #     - name: newtest
    #       title: ''
    #       type: text
    #     - name: GP
    #       title: 'Gold Positive'
    #       type: number
    #     - name: GN
    #       title: 'Gold Negative'
    #       type: number
    #     - name: Total
    #       title: 'Total'
    #       type: number





    # - name:  nTable2
    #   title: nTable2
    #   type: Preformatted




    - name:  nTable
      title: 'n'
      type: Table
      swapRowsColumns: true
      rows:  1
      columns:
        - name: tablename
          title: ''
          type: text
        - name: TotalPop
          title: 'Total'
          type: number
        - name: DiseaseP
          title: 'Diseased'
          type: number
        - name: DiseaseN
          title: 'Healthy'
          type: number
        - name: TestP
          title: 'Positive Tests'
          type: number
        - name: TestN
          title: 'Negative Tests'
          type: number
        - name: TestT
          title: 'True Test'
          type: number
        - name: TestW
          title: 'Wrong Test'
          type: number
      clearWith:
          - pp
          - pprob


    - name:  ratioTable
      title: ''
      type: Table
      swapRowsColumns: true
      rows:  1
      columns:
        - name: tablename
          title: ''
          type: text
        - name: Sens
          title: 'Sensitivity'
          type: number
          format: pc
        - name: Spec
          title: 'Specificity'
          type: number
          format: pc
        - name: AccurT
          title: 'Accuracy'
          type: number
          format: pc
        - name: PrevalenceD
          title: 'Prevalence'
          type: number
          format: pc
        - name: PPV
          title: 'Positive Predictive Value'
          type: number
          format: pc
        - name: NPV
          title: 'Negative Predictive Value'
          type: number
          format: pc
        - name: PostTestProbDisease
          title: 'Post-test Disease Probability'
          type: number
          format: pc
        - name: PostTestProbHealthy
          title: 'Post-test Health Probability'
          type: number
          format: pc
        - name: LRP
          title: Positive Likelihood Ratio
          type: number
          # format: pc
        - name: LRN
          title: Negative Likelihood Ratio
          type: number
          # format: pc
      clearWith:
          - pp
          - pprob
          
    - name: missingDataSummary
      title: 'Data Quality Summary'
      type: Html
      visible: (od)


    # - name:  ratioTable2
    #   title: ''
    #   type: Table
    #   swapRowsColumns: true
    #   rows:  1
    #   columns:
    #     - name: tablename
    #       title: ''
    #       type: text
    #     - name: Sens
    #       title: 'Sensitivity'
    #       type: number
    #       format: pc
    #     - name: Spec
    #       title: 'Specificity'
    #       type: number
    #       format: pc
    #     - name: AccurT
    #       title: 'Accuracy'
    #       type: number
    #       format: pc
    #     - name: PrevalenceD
    #       title: 'Prevalence'
    #       type: number
    #       format: pc
    #     - name: PPV
    #       title: 'Positive Predictive Value'
    #       type: number
    #       format: pc
    #     - name: NPV
    #       title: 'Negative Predictive Value'
    #       type: number
    #       format: pc
    #     - name: PostTestProbDisease
    #       title: 'Post-test Disease Probability'
    #       type: number
    #       format: pc
    #     - name: PostTestProbHealthy
    #       title: 'Post-test Health Probability'
    #       type: number
    #       format: pc
    #     - name: LRP
    #       title: Positive Likelihood Ratio
    #       type: number
    #       # format: pc
    #     - name: LRN
    #       title: Negative Likelihood Ratio
    #       type: number
    #       # format: pc
    #   clearWith:
    #       - pp
    #       - pprob



    - name: epirTable_ratio
      title: 'EpiR Table Ratios'
      type: Table
      visible: (ci)
      rows: 0
      columns:
        - name: statsnames
          title: "Decision Statistics"
          type: text
        - name: est
          title: "Estimate"
          type: number
          format: pc
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
          format: pc
      clearWith:
          - pp
          - pprob
      refs: epiR


    - name: epirTable_number
      title: ''
      # title: 'EpiR Table Numbers'
      type: Table
      visible: (ci)
      rows: 0
      columns:
        - name: statsnames
          title: "Decision Statistics"
          type: text
        - name: est
          title: "Estimate"
          type: number
        - name: lower
          title: 'Lower'
          superTitle: '95% Confidence Interval'
          type: number
        - name: upper
          title: 'Upper'
          superTitle: '95% Confidence Interval'
          type: number
      clearWith:
          - pp
          - pprob
      refs: epiR

    # - name:  plotcontent
    #   title: plotcontent
    #   type:  Preformatted

    # - name:  text3
    #   title: Matrix Details
    #   type:  Preformatted


    # - name:  text4
    #   title: Medical Decision Deneme
    #   type:  Preformatted


    # - name:  text5
    #   title: Medical Decision epiR
    #   type:  Preformatted

    - name: plot1
      title: 'Fagan nomogram'
      type: Image
      width:  600
      height: 450
      renderFun: .plot1
      requiresData: true
      visible: (fagan)
      clearWith:
          - pp
          - pprob
          - fagan
      refs:
          - Fagan
          - Fagan2


      
    - name: naturalLanguageSummary
      title: 'Clinical Summary'
      type: Html
      visible: (showNaturalLanguage)

    - name: clinicalInterpretation
      title: 'Clinical Interpretation Guide'
      type: Html
      visible: (showClinicalInterpretation)

    - name: reportTemplate
      title: 'Copy-Ready Report'
      type: Html
      visible: (showReportTemplate)

    - name: aboutAnalysis
      title: 'About This Analysis'
      type: Html
      visible: (showAboutAnalysis)

    # Misclassified Cases Analysis ----

    - name: misclassifiedHeading
      title: 'Misclassified Cases Analysis'
      type: Html
      visible: (showMisclassified)

    - name: confusionMatrixSummary
      title: 'Confusion Matrix Summary'
      type: Table
      visible: (showMisclassified)
      rows: 0
      columns:
        - name: classification
          title: 'Classification'
          type: text
        - name: count
          title: 'Count'
          type: integer
        - name: percentage
          title: 'Percentage'
          type: number
          format: pc

    - name: falsePositiveTable
      title: 'False Positive Cases (Test+ but Disease-)'
      type: Table
      visible: (showMisclassified)
      rows: 0
      columns:
        - name: case_id
          title: 'Row'
          type: integer
        - name: gold_value
          title: 'True Status'
          type: text
        - name: test_value
          title: 'Test Result'
          type: text

    - name: falseNegativeTable
      title: 'False Negative Cases (Test- but Disease+)'
      type: Table
      visible: (showMisclassified)
      rows: 0
      columns:
        - name: case_id
          title: 'Row'
          type: integer
        - name: gold_value
          title: 'True Status'
          type: text
        - name: test_value
          title: 'Test Result'
          type: text

    - name: misclassificationInterpretation
      title: 'Interpretation of Misclassified Cases'
      type: Html
      visible: (showMisclassified)

    - name: saveClassifications
      title: 'Classification Groups'
      type: Output
      varTitle: "Classification Group"
      varDescription: "Classification of each case: True Positive, False Positive, False Negative, or True Negative"
      measureType: nominal
      clearWith:
        - gold
        - newtest
        - goldPositive
        - testPositive


refs:
    - DiagnosticTests
    - ClinicoPathJamoviModule
    - epiR

...
