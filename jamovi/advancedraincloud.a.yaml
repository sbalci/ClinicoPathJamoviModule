---
name: advancedraincloud
title: Advanced Raincloud Plot
menuGroup: JJStatsPlot
menuSubgroup: Categorical vs Continuous
version: '0.0.32'
jas: '1.2'

description:
  main: |
    Creates advanced raincloud plots with longitudinal connections using ggrain package.
    This module complements the existing Raincloud Plot module by providing advanced 
    features including longitudinal data connections, Likert scale support, and flexible
    raincloud positioning. Perfect for repeated measures data, survey analysis, and 
    complex distribution visualization in clinical research. Uses the ggrain package
    for enhanced customization and connectivity features.
  R:
    dontrun: true
    usage: |
      # Example:
      # 1. Select continuous variable for distribution analysis.
      # 2. Choose grouping variable for comparisons.
      # 3. Optionally add longitudinal ID variable for connections.
      # 4. Configure advanced raincloud features and positioning.

options:

    - name: data
      type: Data
      description:
          R: >
            The data as a data frame.

    - name: y_var
      title: Y-Axis Variable
      type: Variable
      suggested:
        - continuous
      permitted:
        - numeric
      description:
        R: >
          Continuous variable for distribution visualization on Y-axis.

    - name: x_var
      title: X-Axis Variable (Grouping)
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
        - numeric
      description:
        R: >
          Grouping variable for X-axis categories.

    - name: fill_var
      title: Fill Variable (Optional)
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
        - numeric
      default: NULL
      description:
        R: >
          Optional variable for color filling different groups.

    - name: id_var
      title: Longitudinal ID (Optional)
      type: Variable
      suggested:
        - nominal
        - ordinal
      permitted:
        - factor
        - numeric
        - id
      default: NULL
      description:
        R: >
          Optional ID variable for connecting longitudinal observations across groups.

    - name: cov_var
      title: Point Color Variable (Optional)
      type: Variable
      suggested:
        - continuous
        - nominal
        - ordinal
      permitted:
        - numeric
        - factor
      default: NULL
      description:
        R: >
          Optional variable for remapping point colors based on covariate values.

    - name: rain_side
      title: Raincloud Position
      type: List
      options:
        - title: "Left"
          name: l
        - title: "Right"
          name: r
        - title: "Flanking (Both Sides)"
          name: f
        - title: "Flanking 1x1 (Paired)"
          name: f1x1
        - title: "Flanking 2x2 (Grouped)"
          name: f2x2
      default: l
      description:
        R: >
          Position of the raincloud relative to the data points. 
          'Left' (l): Density on left, points on right.
          'Right' (r): Density on right, points on left.
          'Flanking' (f): Density on both sides.
          'Flanking 1x1' (f1x1): Paired flanking for 1x1 comparisons.
          'Flanking 2x2' (f2x2): Grouped flanking for 2x2 comparisons.

    - name: likert_mode
      title: Likert Scale Mode
      type: Bool
      default: false
      description:
        R: >
          If TRUE, adds Y-axis jittering for Likert scale or ordinal data.

    - name: show_longitudinal
      title: Show Longitudinal Connections
      type: Bool
      default: false
      description:
        R: >
          If TRUE, connects repeated observations using the ID variable.

    - name: point_size
      title: Point Size
      type: Number
      min: 0.1
      max: 5
      default: 1.5
      description:
        R: >
          Size of individual data points.

    - name: point_alpha
      title: Point Transparency
      type: Number
      min: 0
      max: 1
      default: 0.7
      description:
        R: >
          Transparency level for data points.

    - name: violin_alpha
      title: Violin Transparency
      type: Number
      min: 0
      max: 1
      default: 0.7
      description:
        R: >
          Transparency level for violin plots.

    - name: boxplot_width
      title: Boxplot Width
      type: Number
      min: 0.1
      max: 1
      default: 0.1
      description:
        R: >
          Width of the boxplot component.

    - name: jitter_seed
      title: Jitter Seed
      type: Number
      default: 42
      description:
        R: >
          Random seed for consistent point jittering across plot updates.

    - name: color_palette
      title: Color Palette
      type: List
      options:
        - title: "Clinical"
          name: clinical
        - title: "Viridis"
          name: viridis
        - title: "Set1"
          name: set1
        - title: "Set2"
          name: set2
        - title: "Pastel"
          name: pastel
        - title: "Dark2"
          name: dark2
      default: clinical
      description:
        R: >
          Color palette for different groups.

    - name: plot_title
      title: Plot Title
      type: String
      default: "Advanced Raincloud Plot"
      description:
        R: >
          Title for the raincloud plot.

    - name: x_label
      title: X-Axis Label
      type: String
      default: ""
      description:
        R: >
          Custom label for X-axis. If empty, uses variable name.

    - name: y_label
      title: Y-Axis Label
      type: String
      default: ""
      description:
        R: >
          Custom label for Y-axis. If empty, uses variable name.

    - name: show_statistics
      title: Show Summary Statistics
      type: Bool
      default: true
      description:
        R: >
          If TRUE, displays summary statistics table.

    - name: show_comparisons
      title: Show Group Comparisons
      type: Bool
      default: false
      description:
        R: >
          If TRUE, performs statistical tests between groups.

    - name: show_interpretation
      title: Show Usage Guide
      type: Bool
      default: true
      description:
        R: >
          If TRUE, displays interpretation and feature guide.

    # Clinical Significance Options
    - name: clinical_cutoff
      title: Clinical Cutoff Value
      type: Number
      default: 0
      description:
        R: >
          Add horizontal line for clinical threshold or decision boundary.

    - name: reference_range_min
      title: Reference Range Minimum
      type: Number
      default: 0
      description:
        R: >
          Lower bound of normal reference range (shaded area).
          
    - name: reference_range_max
      title: Reference Range Maximum
      type: Number
      default: 0
      description:
        R: >
          Upper bound of normal reference range (shaded area).

    - name: show_mcid
      title: Show MCID Band
      type: Bool
      default: false
      description:
        R: >
          Display Minimal Clinically Important Difference band.
          
    - name: mcid_value
      title: MCID Value
      type: Number
      default: 0
      description:
        R: >
          Size of the Minimal Clinically Important Difference.

    # Effect Size Options
    - name: show_effect_size
      title: Display Effect Size
      type: Bool
      default: false
      description:
        R: >
          Show effect size calculations between groups.

    - name: effect_size_type
      title: Effect Size Type
      type: List
      options:
        - title: "Cohen's d"
          name: cohens_d
        - title: "Hedges' g"
          name: hedges_g
        - title: "Glass's delta"
          name: glass_delta
      default: cohens_d
      description:
        R: >
          Method for calculating effect size.

    # Change Score Analysis
    - name: show_change_scores
      title: Show Change Analysis
      type: Bool
      default: false
      description:
        R: >
          Display change from baseline analysis for longitudinal data.
          
    - name: baseline_group
      title: Baseline Group Identifier
      type: String
      default: ""
      description:
        R: >
          Name or level of the baseline/reference group.
          
    - name: responder_threshold
      title: Response Threshold (%)
      type: Number
      default: 20
      description:
        R: >
          Percentage change threshold for responder classification.

    # Sample Size Annotations
    - name: show_sample_size
      title: Display Sample Sizes
      type: Bool
      default: true
      description:
        R: >
          Show sample size (N) for each group on the plot.
          
    - name: show_missing_info
      title: Show Missing Data Info
      type: Bool
      default: false
      description:
        R: >
          Display information about missing data and exclusions.

    # Clinical Trial Features
    - name: trial_arms
      title: Treatment Arm Labels
      type: String
      default: ""
      description:
        R: >
          Custom labels for treatment arms (comma-separated).
          
    - name: time_labels
      title: Time Point Labels
      type: String
      default: ""
      description:
        R: >
          Custom labels for time points (comma-separated).
          
    - name: population_type
      title: Analysis Population
      type: List
      options:
        - title: "Intention-to-Treat"
          name: itt
        - title: "Per-Protocol"
          name: pp
        - title: "Modified ITT"
          name: mitt
        - title: "As-Treated"
          name: at
      default: itt
      description:
        R: >
          Type of analysis population for clinical trials.

    # Biomarker Features
    - name: log_transform
      title: Log Transform Y-axis
      type: Bool
      default: false
      description:
        R: >
          Apply log transformation to Y-axis values.
          
    - name: outlier_method
      title: Outlier Handling
      type: List
      options:
        - title: "None"
          name: none
        - title: "Winsorize (5/95%)"
          name: winsorize
        - title: "Trim (5/95%)"
          name: trim
        - title: "IQR Method"
          name: iqr
      default: none
      description:
        R: >
          Method for handling outliers in the data.
          
    - name: show_cv_bands
      title: Show CV% Bands
      type: Bool
      default: false
      description:
        R: >
          Display coefficient of variation bands for assay variability.
          
    - name: cv_band_1
      title: CV Band 1 Percentage
      type: Number
      min: 1
      max: 50
      default: 15
      description:
        R: >
          First CV band percentage (typically 15% for analytical variability).
          
    - name: cv_band_2
      title: CV Band 2 Percentage
      type: Number
      min: 1
      max: 50
      default: 20
      description:
        R: >
          Second CV band percentage (typically 20% for biological variability).

    # Publication Options
    - name: p_value_position
      title: P-value Display Position
      type: List
      options:
        - title: "Above Plot"
          name: above
        - title: "In Legend"
          name: legend
        - title: "In Table"
          name: table
        - title: "None"
          name: none
      default: above
      description:
        R: >
          Where to display p-values from group comparisons.
          
    - name: journal_style
      title: Journal Style Format
      type: List
      options:
        - title: "Default"
          name: default
        - title: "Nature"
          name: nature
        - title: "NEJM"
          name: nejm
        - title: "Lancet"
          name: lancet
        - title: "JAMA"
          name: jama
      default: default
      description:
        R: >
          Apply journal-specific formatting guidelines.

    # Report Generation
    - name: generate_report
      title: Generate Clinical Report
      type: Bool
      default: false
      description:
        R: >
          Generate comprehensive clinical analysis report.
          
    - name: include_methods
      title: Include Methods Text
      type: Bool
      default: false
      description:
        R: >
          Include methods section text for publications.

...
