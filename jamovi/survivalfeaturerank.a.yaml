---
name:  survivalfeaturerank
title: Survival Feature Ranking
menuGroup: SurvivalD
menuSubgroup: ClinicoPath Survival
menuSubtitle: 'Univariate Cox Screening, Biomarker Discovery'
version: '0.0.31'
jas: '1.2'

description:
    main: >-
        Performs univariate survival analysis for multiple features to identify potential prognostic factors.
        This analysis runs a separate Cox proportional hazards model for each selected feature and ranks them
        by statistical significance, hazard ratio, or concordance index. Useful for biomarker screening,
        exploratory analysis, and feature selection before building multivariable models.
    R:
        dontrun: false
        usage: |
            # Example 1: Basic feature ranking
            library(survival)
            data(colon)

            survivalfeaturerank(
                data = colon,
                survtime = "time",
                event = "status",
                eventLevel = "1",
                features = c("sex", "obstruct", "perfor", "adhere", "nodes", "differ"),
                rankBy = "pvalue"
            )

            # Example 2: Rank by hazard ratio with plots
            survivalfeaturerank(
                data = colon,
                survtime = "time",
                event = "status",
                eventLevel = "1",
                features = c("sex", "obstruct", "perfor", "age", "nodes"),
                rankBy = "hazard",
                showForestPlot = TRUE,
                showTopKM = TRUE,
                topN = 3
            )

            # Example 3: Rank by C-index for predictive power
            survivalfeaturerank(
                data = colon,
                survtime = "time",
                event = "status",
                eventLevel = "1",
                features = c("age", "nodes", "extent", "surg"),
                rankBy = "cindex",
                showCI = TRUE,
                adjustPValues = TRUE,
                adjustMethod = "fdr"
            )

options:

# Data ----

    - name: data
      type: Data
      description:
          R: >
            The dataset to be analyzed, provided as a data frame.

# Time ----

    - name: survtime
      title: 'Survival Time'
      type: Variable
      suggested: [ continuous ]
      permitted: [ numeric ]
      default: NULL
      description:
        R: >
          The numeric variable representing follow-up time until the event or censoring.

# Event ----

    - name: event
      title: 'Event Status'
      type: Variable
      suggested: [ ordinal, nominal, continuous ]
      permitted: [ factor, numeric ]
      default: NULL
      description:
        R: >
          The event indicator variable (e.g., death, recurrence). Should be coded as
          1 = event, 0 = censored, or as a factor where one level represents the event.

    - name: eventLevel
      title: Event Level
      type: Level
      variable: (event)
      description:
        R: >
          The level of the event variable that represents the event of interest.
          For numeric variables, typically "1". For factors, select the appropriate level.

# Features ----

    - name: features
      title: Features to Rank
      type: Variables
      suggested: [ ordinal, nominal, continuous ]
      permitted: [ factor, numeric ]
      default: NULL
      description:
        R: >
          Variables to be tested individually for association with survival.
          Each variable will be tested in a separate univariate Cox model.
          Can include both categorical and continuous variables.

# Ranking Options ----

    - name: rankBy
      title: 'Rank Features By'
      type: List
      options:
        - title: P-value (Most Significant First)
          name: pvalue
        - title: Hazard Ratio (Largest Effect)
          name: hazard
        - title: C-index (Best Discrimination)
          name: cindex
      default: pvalue
      description:
        R: >
          Criterion for ranking features:
          - pvalue: Sorts by statistical significance (smallest p-value first)
          - hazard: Sorts by effect size (hazard ratio furthest from 1)
          - cindex: Sorts by discriminative ability (highest C-index first)

    - name: showCI
      title: Show Confidence Intervals
      type: Bool
      default: true
      description:
        R: >
          If true, displays 95% confidence intervals for hazard ratios in the results table.

    - name: adjustPValues
      title: Adjust P-values for Multiple Testing
      type: Bool
      default: false
      description:
        R: >
          If true, applies multiple testing correction to p-values. Recommended when
          testing many features to control false discovery rate.

    - name: adjustMethod
      title: Adjustment Method
      type: List
      options:
        - title: Benjamini-Hochberg (FDR)
          name: fdr
        - title: Bonferroni
          name: bonferroni
        - title: Holm
          name: holm
        - title: Benjamini-Yekutieli
          name: by
      default: fdr
      description:
        R: >
          Method for p-value adjustment. FDR (Benjamini-Hochberg) is recommended
          for exploratory analysis. Bonferroni is most conservative.

# Visualization Options ----

    - name: showForestPlot
      title: Show Forest Plot
      type: Bool
      default: true
      description:
        R: >
          If true, generates a forest plot showing hazard ratios and confidence intervals
          for all features, sorted by the ranking criterion.

    - name: forestStyle
      title: Forest Plot Style
      type: List
      options:
        - title: Standard
          name: standard
        - title: Compact
          name: compact
        - title: Publication-ready
          name: publication
      default: standard
      description:
        R: >
          Visual style for the forest plot.

    - name: showTopKM
      title: Show Kaplan-Meier Plots for Top Features
      type: Bool
      default: false
      description:
        R: >
          If true, generates Kaplan-Meier survival curves for the top-ranked features.
          Useful for visualizing the survival differences for the most important predictors.

    - name: topN
      title: Number of Top Features to Plot
      type: Integer
      default: 5
      min: 1
      max: 20
      description:
        R: >
          Number of top-ranked features for which to generate Kaplan-Meier plots.
          Only used if "Show Kaplan-Meier Plots for Top Features" is enabled.

    - name: kmLayout
      title: KM Plot Layout
      type: List
      options:
        - title: Separate Plots
          name: separate
        - title: Faceted Grid
          name: faceted
      default: separate
      description:
        R: >
          Layout for multiple Kaplan-Meier plots. Separate shows one plot per feature,
          faceted shows all in a grid.

# Plot Options ----

    - name: endplot
      title: Plot End Time
      type: Integer
      default: 60
      description:
        R: >
          Maximum follow-up time to display on Kaplan-Meier plots.

    - name: byplot
      title: Time Interval
      type: Integer
      default: 12
      description:
        R: >
          Interval for time axis labels on plots.

    - name: risktable
      title: Risk Table
      type: Bool
      default: false
      description:
        R: >
          If true, displays the number at risk below Kaplan-Meier plots.

    - name: pplot
      title: P-value on Plots
      type: Bool
      default: true
      description:
        R: >
          If true, displays log-rank test p-values on Kaplan-Meier plots.

# Output Options ----

    - name: showSummary
      title: Show Summary Statistics
      type: Bool
      default: true
      description:
        R: >
          If true, displays summary statistics including total number of features tested,
          number of significant features, and interpretation guidance.

    - name: alphaLevel
      title: Significance Level
      type: Number
      default: 0.05
      min: 0.001
      max: 0.1
      description:
        R: >
          Significance level for highlighting significant features in the results table.

    - name: showFullTable
      title: Show All Features
      type: Bool
      default: true
      description:
        R: >
          If true, shows results for all tested features. If false, shows only
          statistically significant features.

    - name: exportRanking
      title: Export Ranking Table
      type: Output
      description:
        R: >
          If enabled, exports the feature ranking table to the dataset for further analysis.

...
