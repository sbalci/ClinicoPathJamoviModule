---
name: decisioncombine
title: Combine Medical Decision Tests
jrs: '1.1'

items:
    - name: combinationTable
      title: 'Test Combination Performance'
      type: Table
      rows: 0
      columns:
        - name: pattern
          title: 'Pattern'
          type: text
        - name: tp
          title: 'TP'
          type: integer
        - name: fp
          title: 'FP'
          type: integer
        - name: fn
          title: 'FN'
          type: integer
        - name: tn
          title: 'TN'
          type: integer
        - name: prevalence
          title: 'Prevalence'
          type: number
          format: pc
        - name: sens
          title: 'Sensitivity'
          type: number
          format: pc
        - name: spec
          title: 'Specificity'
          type: number
          format: pc
        - name: ppv
          title: 'PPV'
          type: number
          format: pc
        - name: npv
          title: 'NPV'
          type: number
          format: pc
        - name: acc
          title: 'Accuracy'
          type: number
          format: pc
        - name: balancedAccuracy
          title: 'Balanced Accuracy'
          type: number
          format: pc
        - name: youden
          title: "Youden's J"
          type: number
          format: number
        - name: lrPos
          title: 'LR+'
          type: number
          format: number
        - name: lrNeg
          title: 'LR-'
          type: number
          format: number
        - name: dor
          title: 'Diagnostic OR'
          type: number
          format: number
      description: "Counts and diagnostic performance metrics for each test combination pattern and clinical strategy, including prevalence, balanced accuracy, Youden's J, likelihood ratios, and diagnostic odds ratios"

    - name: combinationTableCI
      title: 'Combination Statistics with 95% Confidence Intervals'
      type: Table
      rows: 0
      columns:
        - name: pattern
          title: 'Pattern'
          type: text
        - name: statistic
          title: 'Statistic'
          type: text
        - name: estimate
          title: 'Estimate'
          type: number
          format: number
        - name: lower
          title: 'Lower'
          superTitle: '95% CI'
          type: number
          format: number
        - name: upper
          title: 'Upper'
          superTitle: '95% CI'
          type: number
          format: number
      description: '95% confidence intervals for diagnostic metrics. Wilson intervals are used for proportions, and log-scale intervals for likelihood ratios and diagnostic odds ratios.'

    - name: goldFreqTable
      title: 'Gold Standard Frequency Distribution'
      type: Table
      rows: 0
      visible: (showFrequency)
      columns:
        - name: level
          title: 'Level'
          type: text
        - name: count
          title: 'Count'
          type: integer
        - name: percent
          title: 'Percent'
          type: number
          format: pc
      description: 'Frequency distribution of the gold standard (reference) test showing counts and percentages for each level'

    - name: crossTabTable
      title: 'Test Results Cross-Tabulation'
      type: Table
      rows: 0
      visible: (showFrequency)
      columns:
        - name: testCombo
          title: 'Test Pattern'
          type: text
        - name: goldPos
          title: 'Gold Positive'
          type: integer
        - name: goldNeg
          title: 'Gold Negative'
          type: integer
        - name: total
          title: 'Total'
          type: integer
      description: 'Cross-tabulation showing how test combination patterns align with gold standard results'

    - name: individualTest1
      title: 'Test 1 Performance'
      type: Group
      items:
        - name: test1Contingency
          title: 'Contingency Table'
          type: Table
          rows: 0
          columns:
            - name: testResult
              title: ''
              type: text
            - name: goldPos
              title: 'Gold Positive'
              type: integer
            - name: goldNeg
              title: 'Gold Negative'
              type: integer
            - name: total
              title: 'Total'
              type: integer
        - name: test1Stats
          title: 'Diagnostic Statistics'
          type: Table
          rows: 0
          columns:
            - name: statistic
              title: 'Statistic'
              type: text
            - name: estimate
              title: 'Estimate'
              type: number
              format: pc

    - name: individualTest2
      title: 'Test 2 Performance'
      type: Group
      items:
        - name: test2Contingency
          title: 'Contingency Table'
          type: Table
          rows: 0
          columns:
            - name: testResult
              title: ''
              type: text
            - name: goldPos
              title: 'Gold Positive'
              type: integer
            - name: goldNeg
              title: 'Gold Negative'
              type: integer
            - name: total
              title: 'Total'
              type: integer
        - name: test2Stats
          title: 'Diagnostic Statistics'
          type: Table
          rows: 0
          columns:
            - name: statistic
              title: 'Statistic'
              type: text
            - name: estimate
              title: 'Estimate'
              type: number
              format: pc

    - name: individualTest3
      title: 'Test 3 Performance'
      type: Group
      items:
        - name: test3Contingency
          title: 'Contingency Table'
          type: Table
          rows: 0
          columns:
            - name: testResult
              title: ''
              type: text
            - name: goldPos
              title: 'Gold Positive'
              type: integer
            - name: goldNeg
              title: 'Gold Negative'
              type: integer
            - name: total
              title: 'Total'
              type: integer
        - name: test3Stats
          title: 'Diagnostic Statistics'
          type: Table
          rows: 0
          columns:
            - name: statistic
              title: 'Statistic'
              type: text
            - name: estimate
              title: 'Estimate'
              type: number
              format: pc

    - name: barPlot
      title: 'Bar Chart - Performance Comparison'
      type: Image
      width: 800
      height: 500
      visible: (showBarPlot)
      renderFun: .plotBarChart
      clearWith:
        - gold
        - test1
        - test2
        - test3
        - filterStatistic
        - filterPattern
      description: 'Grouped bar chart comparing sensitivity, specificity, PPV, NPV, and accuracy across test combinations'

    - name: heatmapPlot
      title: 'Heatmap - All Metrics by Pattern'
      type: Image
      width: 900
      height: 600
      visible: (showHeatmap)
      renderFun: .plotHeatmap
      clearWith:
        - gold
        - test1
        - test2
        - test3
        - filterStatistic
        - filterPattern
      description: 'Color-coded heatmap showing all diagnostic metrics for each test pattern'

    - name: forestPlot
      title: 'Forest Plot - Confidence Intervals'
      type: Image
      width: 800
      height: 600
      visible: (showForest)
      renderFun: .plotForest
      clearWith:
        - gold
        - test1
        - test2
        - test3
        - filterStatistic
        - filterPattern
      description: 'Forest plot displaying 95% confidence intervals for key diagnostic metrics'

    - name: decisionTreePlot
      title: 'Decision Tree - Test Combination Strategy'
      type: Image
      width: 900
      height: 700
      visible: (showDecisionTree)
      renderFun: .plotDecisionTree
      clearWith:
        - gold
        - test1
        - test2
        - test3
        - filterStatistic
        - filterPattern
      description: 'Hierarchical decision tree showing test patterns with performance-based recommendations'

    - name: recommendationTable
      title: 'Optimal Pattern Recommendation'
      type: Table
      rows: 1
      visible: (showRecommendation)
      columns:
        - name: pattern
          title: 'Recommended Pattern'
          type: text
        - name: method
          title: 'Selection Method'
          type: text
        - name: youden
          title: "Youden's J"
          type: number
          format: number
        - name: sens
          title: 'Sensitivity'
          type: number
          format: pc
        - name: spec
          title: 'Specificity'
          type: number
          format: pc
        - name: acc
          title: 'Accuracy'
          type: number
          format: pc
        - name: rationale
          title: 'Clinical Rationale'
          type: text
      description: 'Recommended optimal test combination pattern based on Youden index and clinical performance metrics'

refs:
    - DiagnosticTests
    - ClinicoPathJamoviModule

...
