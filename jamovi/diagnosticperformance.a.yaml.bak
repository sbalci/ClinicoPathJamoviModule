---
name: diagnosticperformance
title: Diagnostic Performance Analysis
menuGroup: meddecide
menuSubgroup: 'Diagnostic Tests'
menuSubtitle: 'ROC Analysis & Validation'
version: '1.0.0'
jas: '1.2'

description:
    main: |
        Comprehensive diagnostic performance analysis including ROC curves, cross-validation,
        and statistical comparison of diagnostic tests. Supports both single and multiple
        biomarker evaluation with robust validation methods.
    R:
        dontrun: false
        usage: |
            # Single biomarker diagnostic performance
            diagnosticperformance(
                data = dataset,
                outcome = "disease_status",
                predictors = "biomarker_level",
                validation_method = "crossval",
                cv_folds = 10
            )
            
            # Multiple biomarker comparison
            diagnosticperformance(
                data = dataset,
                outcome = "disease_status", 
                predictors = c("marker1", "marker2", "marker3"),
                comparison_method = "delong",
                validation_method = "bootstrap",
                bootstrap_n = 1000
            )

options:
    - name: data
      type: Data

    - name: outcome
      title: Outcome Variable
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor, numeric ]
      description:
          R: >
            Binary outcome variable indicating disease/condition status (0/1 or factor).

    - name: outcomeLevel
      title: Event Level
      type: Level
      variable: (outcome)
      description:
          R: >
            Level of outcome variable representing positive cases (events).

    - name: predictors
      title: Predictor Variables
      type: Variables
      suggested: [ continuous ]
      permitted: [ numeric ]
      description:
          R: >
            Continuous predictor variables (biomarkers, risk scores) to evaluate.

    - name: validationMethod
      title: Validation Method
      type: List
      options:
        - title: None
          name: none
        - title: K-fold Cross-Validation
          name: crossval
        - title: Bootstrap Validation
          name: bootstrap
        - title: Holdout Validation
          name: holdout
      default: none
      description:
          R: >
            Method for validating diagnostic performance to avoid overfitting.

    - name: cvFolds
      title: Number of CV Folds
      type: Integer
      default: 10
      min: 2
      max: 20
      description:
          R: >
            Number of folds for cross-validation (typically 5 or 10).

    - name: cvRepeats
      title: CV Repeats
      type: Integer
      default: 1
      min: 1
      max: 10
      description:
          R: >
            Number of times to repeat cross-validation for more stable results.

    - name: bootstrapN
      title: Bootstrap Samples
      type: Integer
      default: 1000
      min: 100
      max: 5000
      description:
          R: >
            Number of bootstrap samples for bootstrap validation and confidence intervals.

    - name: holdoutProp
      title: Holdout Proportion
      type: Number
      default: 0.3
      min: 0.1
      max: 0.5
      description:
          R: >
            Proportion of data to hold out for validation (0.1 to 0.5).

    - name: comparisonMethod
      title: ROC Comparison Method
      type: List
      options:
        - title: DeLong Test
          name: delong
        - title: Bootstrap Test
          name: bootstrap
        - title: Venkatraman Test
          name: venkatraman
      default: delong
      description:
          R: >
            Statistical method for comparing multiple ROC curves.

    - name: optimalCutoff
      title: Optimal Cutoff Method
      type: List
      options:
        - title: Youden Index
          name: youden
        - title: Closest to (0,1)
          name: closest_topleft
        - title: Specificity = Sensitivity
          name: equal_sens_spec
        - title: Cost-Weighted
          name: cost_weighted
      default: youden
      description:
          R: >
            Method for determining optimal diagnostic cutoff point.

    - name: costRatio
      title: False Positive to False Negative Cost Ratio
      type: Number
      default: 1.0
      min: 0.1
      max: 10.0
      description:
          R: >
            Ratio of cost of false positive to false negative (for cost-weighted cutoff).

    - name: confidenceLevel
      title: Confidence Level
      type: Number
      default: 0.95
      min: 0.80
      max: 0.99
      description:
          R: >
            Confidence level for confidence intervals (0.80 to 0.99).

    - name: plotROC
      title: Plot ROC Curves
      type: Bool
      default: true

    - name: plotPR
      title: Plot Precision-Recall Curves
      type: Bool
      default: false
      description:
          R: >
            Generate precision-recall curves (useful for imbalanced datasets).

    - name: plotCalibration
      title: Plot Calibration Curves
      type: Bool
      default: false
      description:
          R: >
            Generate calibration plots to assess prediction calibration.

    - name: showMetrics
      title: Show Detailed Metrics
      type: Bool
      default: true
      description:
          R: >
            Show comprehensive diagnostic performance metrics table.

    - name: showCutoffAnalysis
      title: Show Cutoff Analysis
      type: Bool
      default: true
      description:
          R: >
            Show optimal cutoff analysis with sensitivity/specificity trade-offs.

    - name: stratifyBy
      title: Stratification Variable (Optional)
      type: Variable
      suggested: [ ordinal, nominal ]
      permitted: [ factor ]
      description:
          R: >
            Optional variable for stratified analysis (subgroup analysis).

...