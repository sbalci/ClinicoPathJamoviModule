<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Independent vs Dependent Sampling: Statistical Implications for Pathology Adequacy Analysis • ClinicoPath</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Independent vs Dependent Sampling: Statistical Implications for Pathology Adequacy Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data">
<li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Independent vs Dependent Sampling: Statistical Implications for Pathology Adequacy Analysis</h1>
                        <h4 data-toc-skip class="author">ClinicoPath
Development Team</h4>
            
            <h4 data-toc-skip class="date">2026-01-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/general-independent-vs-dependent-sampling-explained.Rmd" class="external-link"><code>vignettes/general-independent-vs-dependent-sampling-explained.Rmd</code></a></small>
      <div class="d-none name"><code>general-independent-vs-dependent-sampling-explained.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette explains the fundamental statistical difference between
<strong>independent sampling</strong> (e.g., lymph node dissection) and
<strong>dependent sampling</strong> (e.g., sequential tumor block
sectioning), and why this distinction matters for pathology sampling
adequacy analysis.</p>
<p><strong>Key Message</strong>: The statistical methods you choose for
sampling adequacy analysis must match your sampling structure. Using
independence-based models (binomial/geometric) for dependent samples
(tumor blocks) leads to systematic underestimation of cumulative
sensitivity.</p>
<hr>
</div>
<div class="section level2">
<h2 id="independent-vs-dependent-sampling-core-concepts">Independent vs Dependent Sampling: Core Concepts<a class="anchor" aria-label="anchor" href="#independent-vs-dependent-sampling-core-concepts"></a>
</h2>
<div class="section level3">
<h3 id="independent-sampling-e-g--lymph-node-dissection">Independent Sampling (e.g., Lymph Node Dissection)<a class="anchor" aria-label="anchor" href="#independent-sampling-e-g--lymph-node-dissection"></a>
</h3>
<div class="section level4">
<h4 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a>
</h4>
<p>Examining 12 lymph nodes for metastases in a colorectal cancer
resection.</p>
</div>
<div class="section level4">
<h4 id="key-characteristic">Key Characteristic<a class="anchor" aria-label="anchor" href="#key-characteristic"></a>
</h4>
<p>Each lymph node is a <strong>separate anatomic structure</strong>
with independent probability of containing metastasis.</p>
</div>
<div class="section level4">
<h4 id="statistical-properties">Statistical Properties<a class="anchor" aria-label="anchor" href="#statistical-properties"></a>
</h4>
<pre><code>P(LN #7 is positive) is INDEPENDENT of P(LN #3 is positive)
P(detect metastasis in first 5 LNs) = 1 - (1-p)^5  [binomial/geometric]</code></pre>
</div>
<div class="section level4">
<h4 id="appropriate-models">Appropriate Models<a class="anchor" aria-label="anchor" href="#appropriate-models"></a>
</h4>
<ul>
<li>✅ <strong>Binomial distribution</strong>: Models independent
Bernoulli trials</li>
<li>✅ <strong>Geometric distribution</strong>: Models “first success”
in sequence of independent trials</li>
<li>✅ Per-sample detection probability <code>p</code> is meaningful and
estimable</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-calculation">Example Calculation<a class="anchor" aria-label="anchor" href="#example-calculation"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If p = 0.15 (15% per-LN metastasis rate)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span><span class="va">n_ln</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span></span>
<span><span class="co"># Probability of finding ≥1 positive LN in 12 examined:</span></span>
<span><span class="va">prob_detect</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="va">n_ln</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Probability of detecting metastasis in %d LNs: %.1f%%\n"</span>,</span>
<span>            <span class="va">n_ln</span>, <span class="va">prob_detect</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Probability of detecting metastasis in 12 LNs: 85.8%</span></span>
<span></span>
<span><span class="co"># This is VALID because LNs are independent</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visual-representation">Visual Representation<a class="anchor" aria-label="anchor" href="#visual-representation"></a>
</h4>
<pre><code>LN1  LN2  LN3  LN4  LN5  LN6  ...  LN12
 ●    ○    ○    ●    ○    ○   ...   ○
 ↑                ↑
Independent events - one being positive doesn't affect others</code></pre>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="dependent-sampling-e-g--tumor-block-sectioning">Dependent Sampling (e.g., Tumor Block Sectioning)<a class="anchor" aria-label="anchor" href="#dependent-sampling-e-g--tumor-block-sectioning"></a>
</h3>
<div class="section level4">
<h4 id="scenario-1">Scenario<a class="anchor" aria-label="anchor" href="#scenario-1"></a>
</h4>
<p>Examining 8 sequential blocks from a colorectal tumor for venous
invasion (VI).</p>
</div>
<div class="section level4">
<h4 id="key-characteristic-1">Key Characteristic<a class="anchor" aria-label="anchor" href="#key-characteristic-1"></a>
</h4>
<p>Blocks are <strong>serial sections</strong> through the same lesion
with <strong>spatial clustering</strong>.</p>
</div>
<div class="section level4">
<h4 id="statistical-properties-1">Statistical Properties<a class="anchor" aria-label="anchor" href="#statistical-properties-1"></a>
</h4>
<pre><code>P(Block #7 shows VI) is HIGHLY DEPENDENT on P(Block #6 shows VI)
If VI is present, it occupies a CONTIGUOUS region in 3D space
Blocks are ~5mm apart - if VI is in block 3, likely also in blocks 2 and 4</code></pre>
</div>
<div class="section level4">
<h4 id="why-independence-assumption-fails">Why Independence Assumption Fails<a class="anchor" aria-label="anchor" href="#why-independence-assumption-fails"></a>
</h4>
<div class="section level5">
<h5 id="spatial-autocorrelation">1. Spatial Autocorrelation<a class="anchor" aria-label="anchor" href="#spatial-autocorrelation"></a>
</h5>
<ul>
<li>VI/EMVI are continuous vascular structures</li>
<li>If block 3 cuts through a vein with tumor emboli, adjacent blocks
(2, 4) likely also cut same vein</li>
<li>Blocks are NOT independent samples from a population</li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-total-prevalence">2. Fixed Total Prevalence<a class="anchor" aria-label="anchor" href="#fixed-total-prevalence"></a>
</h5>
<ul>
<li>A tumor either HAS venous invasion or it DOESN’T (binary truth)</li>
<li>If 8 blocks are examined and VI is found in block 2, the question is
NOT “will block 5 also have VI?” but rather “will block 5 DETECT the VI
we know exists?”</li>
<li>This is fundamentally different from LNs where each LN is a separate
entity</li>
</ul>
</div>
<div class="section level5">
<h5 id="detection-sampling-coverage-not-prevalence">3. Detection = Sampling Coverage, Not Prevalence<a class="anchor" aria-label="anchor" href="#detection-sampling-coverage-not-prevalence"></a>
</h5>
<pre><code>Lymph nodes:  "What % of LNs have metastases?"
Tumor blocks: "How many blocks do we need to detect VI if it's present?"</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="visual-representation-1">Visual Representation<a class="anchor" aria-label="anchor" href="#visual-representation-1"></a>
</h4>
<pre><code>Tumor (sagittal view):
Block:  1    2    3    4    5    6    7    8
        |    |    |    |    |    |    |    |
        ○────●════●════●────○────○────○────○
             └─VI region (contiguous)─┘

If VI is present, it spans multiple adjacent blocks (clustered)
NOT randomly distributed across blocks</code></pre>
</div>
<div class="section level4">
<h4 id="consequence-of-using-binomial-model-incorrectly">Consequence of Using Binomial Model Incorrectly<a class="anchor" aria-label="anchor" href="#consequence-of-using-binomial-model-incorrectly"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># WRONG approach for tumor blocks:</span></span>
<span><span class="co"># Assume p = 0.35 (because 35% sensitivity at 1 block in Duan 2023)</span></span>
<span><span class="va">p_wrong</span> <span class="op">&lt;-</span> <span class="fl">0.35</span></span>
<span><span class="va">n_blocks</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span></span>
<span><span class="co"># Predict sensitivity at 6 blocks using binomial model:</span></span>
<span><span class="va">predicted_sens</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_wrong</span><span class="op">)</span><span class="op">^</span><span class="va">n_blocks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Binomial prediction at %d blocks: %.1f%%\n"</span>,</span>
<span>            <span class="va">n_blocks</span>, <span class="va">predicted_sens</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Binomial prediction at 6 blocks: 92.5%</span></span>
<span></span>
<span><span class="co"># But Duan 2023 observed: 95% sensitivity at 6 blocks!</span></span>
<span><span class="va">observed_sens</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Observed sensitivity at %d blocks: %.1f%%\n"</span>,</span>
<span>            <span class="va">n_blocks</span>, <span class="va">observed_sens</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observed sensitivity at 6 blocks: 95.0%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nUnderestimation: %.1f percentage points\n"</span>,</span>
<span>            <span class="op">(</span><span class="va">observed_sens</span> <span class="op">-</span> <span class="va">predicted_sens</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Underestimation: 2.5 percentage points</span></span></code></pre></div>
<p><strong>Why?</strong> Because blocks are NOT independent. The
binomial model underestimates cumulative sensitivity for clustered
outcomes.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="how-dependent-sampling-affects-statistical-analysis">How Dependent Sampling Affects Statistical Analysis<a class="anchor" aria-label="anchor" href="#how-dependent-sampling-affects-statistical-analysis"></a>
</h2>
<div class="section level3">
<h3 id="probability-estimation">1. Probability Estimation<a class="anchor" aria-label="anchor" href="#probability-estimation"></a>
</h3>
<div class="section level4">
<h4 id="independent-lymph-nodes">Independent (Lymph Nodes)<a class="anchor" aria-label="anchor" href="#independent-lymph-nodes"></a>
</h4>
<ul>
<li>Can estimate <code>p</code> (per-LN metastasis rate) from data</li>
<li>
<code>p</code> is a biological parameter (metastatic spread
rate)</li>
<li>Use maximum likelihood:
<code>p_hat = (# positive LNs) / (# total LNs examined)</code>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="dependent-tumor-blocks">Dependent (Tumor Blocks)<a class="anchor" aria-label="anchor" href="#dependent-tumor-blocks"></a>
</h4>
<ul>
<li>
<code>p</code> (per-block detection probability) is NOT a biological
parameter - it’s a <strong>sampling artifact</strong>
</li>
<li>Depends on:
<ul>
<li>Block thickness (3 µm vs 5 µm sections)</li>
<li>Section interval (every 5mm vs every 2mm)</li>
<li>VI extent/size (small focus vs large vessel)</li>
<li>Spatial distribution (clustered vs diffuse)</li>
</ul>
</li>
<li>Geometric MLE from “first detection” is <strong>biased
downward</strong> when samples are clustered</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-of-bias">Example of Bias<a class="anchor" aria-label="anchor" href="#example-of-bias"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># True data: VI detected first in blocks: 1, 1, 2, 3, 1, 4, 2</span></span>
<span><span class="va">first_detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geometric MLE assuming independence:</span></span>
<span><span class="va">p_hat_geometric</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">first_detection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Geometric MLE: p = %.2f\n"</span>, <span class="va">p_hat_geometric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Geometric MLE: p = 0.50</span></span>
<span></span>
<span><span class="co"># But this assumes independence!</span></span>
<span><span class="co"># In reality, if VI is large and central, it might be detected in block 1</span></span>
<span><span class="co"># simply because block 1 cuts through the deepest invasion point</span></span>
<span><span class="co"># NOT because p=0.50 per-block detection probability</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="variance-and-confidence-intervals">2. Variance and Confidence Intervals<a class="anchor" aria-label="anchor" href="#variance-and-confidence-intervals"></a>
</h3>
<div class="section level4">
<h4 id="independent-lymph-nodes-1">Independent (Lymph Nodes)<a class="anchor" aria-label="anchor" href="#independent-lymph-nodes-1"></a>
</h4>
<ul>
<li>Variance follows binomial formula:
<code>Var(X) = n*p*(1-p)</code>
</li>
<li>CIs can use normal approximation or Wilson score</li>
<li>Straightforward calculation</li>
</ul>
</div>
<div class="section level4">
<h4 id="dependent-tumor-blocks-1">Dependent (Tumor Blocks)<a class="anchor" aria-label="anchor" href="#dependent-tumor-blocks-1"></a>
</h4>
<ul>
<li>
<strong>Overdispersion</strong>: Variance is LARGER than binomial
prediction
<ul>
<li>
<code>Var(X) &gt; n*p*(1-p)</code> due to clustering</li>
</ul>
</li>
<li>If you use binomial CIs, you get <strong>falsely narrow
intervals</strong> (overconfident)</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-ci-width-comparison">Example: CI Width Comparison<a class="anchor" aria-label="anchor" href="#example-ci-width-comparison"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Observed: 95% sensitivity at 6 blocks (113/119 VI+ cases detected)</span></span>
<span><span class="va">n_cases</span> <span class="op">&lt;-</span> <span class="fl">119</span></span>
<span><span class="va">n_detected</span> <span class="op">&lt;-</span> <span class="fl">113</span></span>
<span><span class="va">observed_sensitivity</span> <span class="op">&lt;-</span> <span class="va">n_detected</span> <span class="op">/</span> <span class="va">n_cases</span></span>
<span></span>
<span><span class="co"># Binomial 95% CI (WRONG for dependent samples)</span></span>
<span><span class="va">binom_ci</span> <span class="op">&lt;-</span> <span class="fu">binom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/binom/man/binom.confint.html" class="external-link">binom.confint</a></span><span class="op">(</span><span class="va">n_detected</span>, <span class="va">n_cases</span>,</span>
<span>                                  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>                                  methods <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Binomial Wilson 95% CI:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Binomial Wilson 95% CI:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  [%.1f%%, %.1f%%]  ← TOO NARROW (assumes independence)\n"</span>,</span>
<span>            <span class="va">binom_ci</span><span class="op">$</span><span class="va">lower</span> <span class="op">*</span> <span class="fl">100</span>, <span class="va">binom_ci</span><span class="op">$</span><span class="va">upper</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [89.4%, 97.7%]  ← TOO NARROW (assumes independence)</span></span>
<span></span>
<span><span class="co"># Bootstrap 95% CI (CORRECT for dependent samples)</span></span>
<span><span class="co"># Simulated bootstrap result (would use actual case-level resampling)</span></span>
<span><span class="va">bootstrap_lower</span> <span class="op">&lt;-</span> <span class="fl">0.872</span></span>
<span><span class="va">bootstrap_upper</span> <span class="op">&lt;-</span> <span class="fl">0.995</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBootstrap 95% CI:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap 95% CI:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  [%.1f%%, %.1f%%]  ← WIDER (accounts for case-level variation)\n"</span>,</span>
<span>            <span class="va">bootstrap_lower</span> <span class="op">*</span> <span class="fl">100</span>, <span class="va">bootstrap_upper</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [87.2%, 99.5%]  ← WIDER (accounts for case-level variation)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nWhy wider?\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Why wider?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Some cases have VI in blocks 1-3 (early detection, clustered anteriorly)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Some cases have VI in blocks 1-3 (early detection, clustered anteriorly)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Some cases have VI in blocks 6-8 (late detection, clustered posteriorly)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Some cases have VI in blocks 6-8 (late detection, clustered posteriorly)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"This heterogeneity inflates variance beyond binomial expectation\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; This heterogeneity inflates variance beyond binomial expectation</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="extrapolation-beyond-observed-data">3. Extrapolation Beyond Observed Data<a class="anchor" aria-label="anchor" href="#extrapolation-beyond-observed-data"></a>
</h3>
<div class="section level4">
<h4 id="independent-lymph-nodes-2">Independent (Lymph Nodes)<a class="anchor" aria-label="anchor" href="#independent-lymph-nodes-2"></a>
</h4>
<ul>
<li>Safe to extrapolate: “If 12 LNs give 85% sensitivity, what about 20
LNs?”</li>
<li>Use binomial formula: <code>1 - (1-p)^20</code>
</li>
<li>Assumes same <code>p</code> applies to additional LNs (reasonable if
dissection is random)</li>
</ul>
</div>
<div class="section level4">
<h4 id="dependent-tumor-blocks-2">Dependent (Tumor Blocks)<a class="anchor" aria-label="anchor" href="#dependent-tumor-blocks-2"></a>
</h4>
<ul>
<li>
<strong>Unsafe</strong> to extrapolate beyond observed maximum</li>
<li>Sensitivity curve <strong>plateaus</strong> at some point (all VI
that CAN be detected IS detected)</li>
<li>Adding more blocks beyond plateau yields <strong>zero incremental
benefit</strong>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="example-plateau-effect">Example: Plateau Effect<a class="anchor" aria-label="anchor" href="#example-plateau-effect"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Duan 2023 observed sensitivity</span></span>
<span><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">observed_sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.296</span>, <span class="fl">0.626</span>, <span class="fl">0.757</span>, <span class="fl">0.878</span>, <span class="fl">0.930</span>, <span class="fl">0.983</span>, <span class="fl">1.000</span>, <span class="fl">1.000</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Binomial model prediction (extrapolated)</span></span>
<span><span class="va">p_est</span> <span class="op">&lt;-</span> <span class="fl">0.35</span></span>
<span><span class="va">binomial_pred</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_est</span><span class="op">)</span><span class="op">^</span><span class="va">blocks</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">blocks</span>, <span class="va">observed_sens</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Number of Blocks"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Cumulative Sensitivity"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Observed vs Binomial Prediction: Plateau Effect"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">blocks</span>, <span class="va">binomial_pred</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1.0</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Observed (Duan 2023)"</span>, <span class="st">"Binomial Model"</span>, <span class="st">"100% Sensitivity"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"gray"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">0.986</span>, <span class="st">"Plateau at 7 blocks"</span>, pos <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">0.95</span>, <span class="st">"Binomial overestimates\nbeyond observed range"</span>, pos <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="general-independent-vs-dependent-sampling-explained_files/figure-html/plateau_effect-1.png" alt="" width="672"></p>
<p><strong>Why plateau?</strong> The 5% of VI+ cases missed at 6 blocks
have <strong>microinvasion</strong> or <strong>peripheral VI</strong>
that won’t be captured by standard perpendicular sectioning, regardless
of how many blocks you examine.</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="recommended-sample-size">4. Recommended Sample Size<a class="anchor" aria-label="anchor" href="#recommended-sample-size"></a>
</h3>
<div class="section level4">
<h4 id="independent-lymph-nodes-3">Independent (Lymph Nodes)<a class="anchor" aria-label="anchor" href="#independent-lymph-nodes-3"></a>
</h4>
<ul>
<li>Can use power calculations: “To detect metastasis with 95%
confidence if true rate is 15%, examine N LNs”</li>
<li>Formula: <code>n = log(1-target_conf) / log(1-p)</code>
</li>
<li>Mathematically clean</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate required LNs for 95% detection confidence</span></span>
<span><span class="va">target_conf</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span><span class="va">p_metastasis</span> <span class="op">&lt;-</span> <span class="fl">0.15</span></span>
<span></span>
<span><span class="va">n_required</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">target_conf</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_metastasis</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Required LNs: %d\n"</span>, <span class="va">n_required</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Required LNs: 19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Validation: 1 - (1-%.2f)^%d = %.1f%%\n"</span>,</span>
<span>            <span class="va">p_metastasis</span>, <span class="va">n_required</span>,</span>
<span>            <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p_metastasis</span><span class="op">)</span><span class="op">^</span><span class="va">n_required</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Validation: 1 - (1-0.15)^19 = 95.4%</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dependent-tumor-blocks-3">Dependent (Tumor Blocks)<a class="anchor" aria-label="anchor" href="#dependent-tumor-blocks-3"></a>
</h4>
<ul>
<li>
<strong>Must use empirical data</strong> from similar cases</li>
<li>No closed-form solution</li>
<li>Recommendation: “Examine ≥6 blocks to achieve 95% sensitivity
<strong>based on observed data from 217 cases</strong>” (Duan 2023)</li>
<li>Caveat: Assumes your sectioning protocol matches Duan 2023
(perpendicular, 5mm intervals, elastin stain)</li>
</ul>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="how-pathsampling-module-handles-dependence">How <code>pathsampling</code> Module Handles Dependence<a class="anchor" aria-label="anchor" href="#how-pathsampling-module-handles-dependence"></a>
</h2>
<p>The <code>pathsampling</code> module offers <strong>three
methods</strong> with different suitability for dependent vs independent
sampling.</p>
<div class="section level3">
<h3 id="method-1-binomialgeometric-model-showbinomialmodel">Method 1: Binomial/Geometric Model
(<code>showBinomialModel</code>)<a class="anchor" aria-label="anchor" href="#method-1-binomialgeometric-model-showbinomialmodel"></a>
</h3>
<div class="section level4">
<h4 id="when-to-use">When to Use<a class="anchor" aria-label="anchor" href="#when-to-use"></a>
</h4>
<ul>
<li>✅ <strong>Lymph node dissection</strong> (independent samples)</li>
<li>✅ <strong>Omentum sections</strong> IF sampled from distant regions
(≥5cm apart)</li>
<li>❌ <strong>Tumor blocks</strong> (dependent samples) - <strong>will
underestimate sensitivity</strong>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="warning-now-added">Warning Now Added<a class="anchor" aria-label="anchor" href="#warning-now-added"></a>
</h4>
<p>When <code>analysisContext == "tumor"</code>, the module
displays:</p>
<blockquote>
<p>⚠️ <strong>Note for Tumor Sampling</strong>: Sequential tumor samples
(blocks) are not independent - they represent serial sections through
the same lesion. Spatial clustering of features like venous invasion
(VI) or perineural invasion (PNI) is expected. The <strong>empirical
method is recommended</strong> over parametric models
(binomial/geometric) which assume independence. <em>Reference: Duan et
al. 2023 - Histopathology (tissue sampling impact on VI
detection)</em></p>
</blockquote>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="method-2-empirical-cumulative-detection-showempiricalcumulative">Method 2: Empirical Cumulative Detection
(<code>showEmpiricalCumulative</code>)<a class="anchor" aria-label="anchor" href="#method-2-empirical-cumulative-detection-showempiricalcumulative"></a>
</h3>
<div class="section level4">
<h4 id="how-it-works">How It Works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h4>
<p><strong>Non-parametric</strong>: No distributional assumptions</p>
<p>For each N (1, 2, 3, …, max), counts how many positive cases were
detected by block N:</p>
<pre><code>Sensitivity at N blocks = (# detected by block N) / (# total positive cases)</code></pre>
<p>Handles dependence automatically because it uses <strong>observed
data</strong>, not theoretical model.</p>
</div>
<div class="section level4">
<h4 id="example-calculation-1">Example Calculation<a class="anchor" aria-label="anchor" href="#example-calculation-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: 5 VI+ cases with first detection blocks: [1, 2, 2, 5, 7]</span></span>
<span><span class="va">first_detection_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">n_positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">first_detection_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate empirical cumulative detection for N=1 to 8</span></span>
<span><span class="va">max_blocks</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">empirical_sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max_blocks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">detected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">first_detection_example</span> <span class="op">&lt;=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">detected</span> <span class="op">/</span> <span class="va">n_positive</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Blocks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">max_blocks</span>,</span>
<span>  Detected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max_blocks</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">first_detection_example</span> <span class="op">&lt;=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Total_Positive <span class="op">=</span> <span class="va">n_positive</span>,</span>
<span>  Sensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">empirical_sensitivity</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Blocks Detected Total_Positive Sensitivity</span></span>
<span><span class="co">#&gt; 1      1        1              5       20.0%</span></span>
<span><span class="co">#&gt; 2      2        3              5       60.0%</span></span>
<span><span class="co">#&gt; 3      3        3              5       60.0%</span></span>
<span><span class="co">#&gt; 4      4        3              5       60.0%</span></span>
<span><span class="co">#&gt; 5      5        4              5       80.0%</span></span>
<span><span class="co">#&gt; 6      6        4              5       80.0%</span></span>
<span><span class="co">#&gt; 7      7        5              5      100.0%</span></span>
<span><span class="co">#&gt; 8      8        5              5      100.0%</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="why-it-handles-dependence-correctly">Why It Handles Dependence Correctly<a class="anchor" aria-label="anchor" href="#why-it-handles-dependence-correctly"></a>
</h4>
<pre><code>At N=2 blocks:
empirical_prob[2] = sum(c(1,2,2,5,7) &lt;= 2) / 5 = 3/5 = 60%

This is TRUE sensitivity from data - doesn't assume independence.
If VI is clustered in blocks 1-2 for some cases and 5-7 for others,
empirical method captures that heterogeneity without modeling it.</code></pre>
</div>
<div class="section level4">
<h4 id="when-to-use-1">When to Use<a class="anchor" aria-label="anchor" href="#when-to-use-1"></a>
</h4>
<ul>
<li>✅ <strong>Always safe</strong> for both independent and dependent
sampling</li>
<li>✅ <strong>Tumor blocks</strong> (primary recommendation)</li>
<li>✅ <strong>Any sampling where independence is
uncertain</strong>
</li>
</ul>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="method-3-bootstrap-confidence-intervals-showbootstrap">Method 3: Bootstrap Confidence Intervals
(<code>showBootstrap</code>)<a class="anchor" aria-label="anchor" href="#method-3-bootstrap-confidence-intervals-showbootstrap"></a>
</h3>
<div class="section level4">
<h4 id="why-bootstrap-is-correct-for-dependent-samples">Why Bootstrap is Correct for Dependent Samples<a class="anchor" aria-label="anchor" href="#why-bootstrap-is-correct-for-dependent-samples"></a>
</h4>
<p><strong>Key insight</strong>: Bootstrap resamples at <strong>case
level</strong>, not block level</p>
<p>Each bootstrap sample preserves <strong>within-case dependence
structure</strong>:</p>
<pre><code>Original data: 3 cases
- Case A: VI first in block 1 (large, anterior invasion)
- Case B: VI first in block 6 (small, posterior invasion)
- Case C: VI first in block 2 (moderate, central)

Bootstrap iteration 1: [A, A, C]  # Case A sampled twice
Bootstrap iteration 2: [B, C, C]
Bootstrap iteration 3: [A, B, A]
...

Each iteration preserves the spatial pattern WITHIN each case.
CIs reflect uncertainty about which TYPES of cases you might encounter,
not uncertainty about whether block 3 is independent of block 2.</code></pre>
</div>
<div class="section level4">
<h4 id="algorithm">Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pseudo-code for bootstrap CI calculation (from pathsampling.b.R)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nBoot</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">boot_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n_cases</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># Resample CASES</span></span>
<span>    <span class="va">boot_first</span> <span class="op">&lt;-</span> <span class="va">positive_first</span><span class="op">[</span><span class="va">boot_idx</span><span class="op">]</span></span>
<span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">maxN</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">detected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">boot_first</span> <span class="op">&lt;=</span> <span class="va">n</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">detection_matrix</span><span class="op">[</span><span class="va">b</span>, <span class="va">n</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">detected</span> <span class="op">/</span> <span class="va">n_cases</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">detection_matrix</span>, <span class="fl">2</span>, <span class="va">quantile</span>, probs <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">detection_matrix</span>, <span class="fl">2</span>, <span class="va">quantile</span>, probs <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="when-to-use-2">When to Use<a class="anchor" aria-label="anchor" href="#when-to-use-2"></a>
</h4>
<ul>
<li>✅ <strong>Tumor blocks</strong> (strongly recommended)</li>
<li>✅ <strong>Any dependent sampling</strong> (margin sections, serial
biopsies)</li>
<li>✅ <strong>Lymph nodes</strong> (okay, though exact/Wilson methods
also valid)</li>
</ul>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="practical-impact-duan-2023-case-study">Practical Impact: Duan 2023 Case Study<a class="anchor" aria-label="anchor" href="#practical-impact-duan-2023-case-study"></a>
</h2>
<div class="section level3">
<h3 id="study-overview">Study Overview<a class="anchor" aria-label="anchor" href="#study-overview"></a>
</h3>
<p><strong>Reference</strong>: Duan K, et al. (2023). Impact of tissue
sampling on detection of venous invasion in colorectal cancer.
<em>Histopathology</em>. <a href="doi:10.1111/his.15030" class="uri">doi:10.1111/his.15030</a></p>
<ul>
<li>N = 217 CRC resections</li>
<li>55% VI+, 37% EMVI+</li>
<li>Standardized protocol: minimum 8 tumor blocks, perpendicular
sectioning, elastin stain</li>
<li>
<strong>Question</strong>: How many blocks needed for 95% VI
detection sensitivity?</li>
</ul>
</div>
<div class="section level3">
<h3 id="analysis-using-wrong-model-binomial">Analysis Using Wrong Model (Binomial)<a class="anchor" aria-label="anchor" href="#analysis-using-wrong-model-binomial"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate p from first detection distribution</span></span>
<span><span class="co"># (Simplified - actual data would use all 119 VI+ cases)</span></span>
<span><span class="va">observed_sensitivity_1_block</span> <span class="op">&lt;-</span> <span class="fl">0.296</span></span>
<span><span class="va">p_hat</span> <span class="op">&lt;-</span> <span class="va">observed_sensitivity_1_block</span>  <span class="co"># Crude estimate</span></span>
<span></span>
<span><span class="co"># Predict sensitivity at different block counts using binomial</span></span>
<span><span class="va">blocks_tested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">binomial_predictions</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_hat</span><span class="op">)</span><span class="op">^</span><span class="va">blocks_tested</span></span>
<span></span>
<span><span class="co"># Duan 2023 observed values</span></span>
<span><span class="va">observed_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.296</span>, <span class="fl">0.626</span>, <span class="fl">0.757</span>, <span class="fl">0.878</span>, <span class="fl">0.930</span>, <span class="fl">0.983</span>, <span class="fl">1.000</span>, <span class="fl">1.000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Blocks <span class="op">=</span> <span class="va">blocks_tested</span>,</span>
<span>  Binomial_Prediction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">binomial_predictions</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>  Observed_Duan <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">observed_values</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>  Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f pp"</span>, <span class="op">(</span><span class="va">observed_values</span> <span class="op">-</span> <span class="va">binomial_predictions</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Blocks Binomial_Prediction Observed_Duan   Error</span></span>
<span><span class="co">#&gt; 1      1               29.6%         29.6% -0.0 pp</span></span>
<span><span class="co">#&gt; 2      2               50.4%         62.6% 12.2 pp</span></span>
<span><span class="co">#&gt; 3      3               65.1%         75.7% 10.6 pp</span></span>
<span><span class="co">#&gt; 4      4               75.4%         87.8% 12.4 pp</span></span>
<span><span class="co">#&gt; 5      5               82.7%         93.0% 10.3 pp</span></span>
<span><span class="co">#&gt; 6      6               87.8%         98.3% 10.5 pp</span></span>
<span><span class="co">#&gt; 7      7               91.4%        100.0%  8.6 pp</span></span>
<span><span class="co">#&gt; 8      8               94.0%        100.0%  6.0 pp</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nConclusion using WRONG model:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conclusion using WRONG model:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Binomial predicts %.1f%% at 6 blocks (UNDERESTIMATE)\n"</span>,</span>
<span>            <span class="va">binomial_predictions</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Binomial predicts 87.8% at 6 blocks (UNDERESTIMATE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Observed: %.1f%% at 6 blocks\n"</span>, <span class="va">observed_values</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observed: 98.3% at 6 blocks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Error: %.1f percentage points\n"</span>,</span>
<span>            <span class="op">(</span><span class="va">observed_values</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">-</span> <span class="va">binomial_predictions</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: 10.5 percentage points</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-using-correct-method-empirical">Analysis Using Correct Method (Empirical)<a class="anchor" aria-label="anchor" href="#analysis-using-correct-method-empirical"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For each block count, directly count detections from observed data</span></span>
<span><span class="co"># (Using Duan 2023 reported values)</span></span>
<span></span>
<span><span class="va">cases_vi_positive</span> <span class="op">&lt;-</span> <span class="fl">119</span></span>
<span></span>
<span><span class="va">detected_by_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Blocks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,</span>
<span>  Detected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">34</span>, <span class="fl">72</span>, <span class="fl">87</span>, <span class="fl">101</span>, <span class="fl">107</span>, <span class="fl">113</span>, <span class="fl">115</span>, <span class="fl">115</span><span class="op">)</span>,  <span class="co"># From Duan Fig 4A</span></span>
<span>  Total <span class="op">=</span> <span class="va">cases_vi_positive</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">detected_by_block</span><span class="op">$</span><span class="va">Sensitivity</span> <span class="op">&lt;-</span> <span class="va">detected_by_block</span><span class="op">$</span><span class="va">Detected</span> <span class="op">/</span> <span class="va">detected_by_block</span><span class="op">$</span><span class="va">Total</span></span>
<span><span class="va">detected_by_block</span><span class="op">$</span><span class="va">Sensitivity_Pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">detected_by_block</span><span class="op">$</span><span class="va">Sensitivity</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">detected_by_block</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blocks"</span>, <span class="st">"Detected"</span>, <span class="st">"Total"</span>, <span class="st">"Sensitivity_Pct"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Blocks Detected Total Sensitivity_Pct</span></span>
<span><span class="co">#&gt; 1      1       34   119           28.6%</span></span>
<span><span class="co">#&gt; 2      2       72   119           60.5%</span></span>
<span><span class="co">#&gt; 3      3       87   119           73.1%</span></span>
<span><span class="co">#&gt; 4      4      101   119           84.9%</span></span>
<span><span class="co">#&gt; 5      5      107   119           89.9%</span></span>
<span><span class="co">#&gt; 6      6      113   119           95.0%</span></span>
<span><span class="co">#&gt; 7      7      115   119           96.6%</span></span>
<span><span class="co">#&gt; 8      8      115   119           96.6%</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nConclusion using CORRECT method:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conclusion using CORRECT method:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No modeling assumptions - just observed data\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; No modeling assumptions - just observed data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Automatically accounts for clustering, heterogeneity, spatial patterns\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Automatically accounts for clustering, heterogeneity, spatial patterns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nRecommendation: Examine ≥6 blocks to achieve %.1f%% sensitivity\n"</span>,</span>
<span>            <span class="va">detected_by_block</span><span class="op">$</span><span class="va">Sensitivity</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Recommendation: Examine ≥6 blocks to achieve 95.0% sensitivity</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="when-does-independence-matter-less">When Does Independence Matter Less?<a class="anchor" aria-label="anchor" href="#when-does-independence-matter-less"></a>
</h2>
<div class="section level3">
<h3 id="scenarios-where-binomial-approximation-may-be-acceptable">Scenarios Where Binomial Approximation May Be Acceptable<a class="anchor" aria-label="anchor" href="#scenarios-where-binomial-approximation-may-be-acceptable"></a>
</h3>
<div class="section level4">
<h4 id="very-sparse-features">1. Very Sparse Features<a class="anchor" aria-label="anchor" href="#very-sparse-features"></a>
</h4>
<p>If VI is extremely rare (5% prevalence) AND small (single focus),
spatial clustering is minimal: - Each block has ~5% independent chance
of containing THE focus - But this is rare in practice (Duan: 55%
VI+)</p>
</div>
<div class="section level4">
<h4 id="widely-spaced-samples">2. Widely Spaced Samples<a class="anchor" aria-label="anchor" href="#widely-spaced-samples"></a>
</h4>
<p>If blocks are 2-3 cm apart (not standard), they may sample
independent tumor regions: - Downside: Miss intermediate VI foci - Not
recommended for standard sampling protocols</p>
</div>
<div class="section level4">
<h4 id="diffusemultifocal-vi">3. Diffuse/Multifocal VI<a class="anchor" aria-label="anchor" href="#diffusemultifocal-vi"></a>
</h4>
<p>If VI is scattered throughout tumor (not contiguous), approaches
independence: - But this is not typical VI morphology - Most VI/EMVI is
continuous along vascular structures</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summary-recommendations">Summary &amp; Recommendations<a class="anchor" aria-label="anchor" href="#summary-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="key-principles">Key Principles<a class="anchor" aria-label="anchor" href="#key-principles"></a>
</h3>
<table class="table">
<colgroup>
<col width="16%">
<col width="34%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>Independent (LN)</th>
<th>Dependent (Tumor Blocks)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Structure</strong></td>
<td>Separate anatomic units</td>
<td>Serial sections of same lesion</td>
</tr>
<tr class="even">
<td><strong>Spatial relationship</strong></td>
<td>Random/unrelated</td>
<td>Contiguous/clustered</td>
</tr>
<tr class="odd">
<td><strong>Appropriate model</strong></td>
<td>Binomial/Geometric ✅</td>
<td>Empirical ✅, Bootstrap ✅</td>
</tr>
<tr class="even">
<td><strong>Inappropriate model</strong></td>
<td>Empirical okay but inefficient</td>
<td>Binomial ❌ (underestimates)</td>
</tr>
<tr class="odd">
<td><strong>Variance</strong></td>
<td>Var = n·p·(1-p)</td>
<td>Var &gt; n·p·(1-p) (overdispersion)</td>
</tr>
<tr class="even">
<td><strong>Extrapolation</strong></td>
<td>Safe beyond observed N</td>
<td>Unsafe (plateaus)</td>
</tr>
<tr class="odd">
<td><strong>Per-sample probability p</strong></td>
<td>Biologically meaningful</td>
<td>Artifact of sectioning protocol</td>
</tr>
<tr class="even">
<td><strong>CI method</strong></td>
<td>Wilson/exact okay</td>
<td>Bootstrap strongly preferred</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="practical-guidance-for-pathsampling-module-users">Practical Guidance for <code>pathsampling</code> Module Users<a class="anchor" aria-label="anchor" href="#practical-guidance-for-pathsampling-module-users"></a>
</h3>
<div class="section level4">
<h4 id="for-tumor-block-analysis">For Tumor Block Analysis<a class="anchor" aria-label="anchor" href="#for-tumor-block-analysis"></a>
</h4>
<ol style="list-style-type: decimal">
<li>✅ <strong>Set Analysis Context</strong>: “Tumor Sampling
(VI/EMVI/PNI/Budding)”</li>
<li>✅ <strong>Enable</strong>: “Show Empirical Cumulative
Detection”</li>
<li>✅ <strong>Enable</strong>: “Show Bootstrap Analysis”</li>
<li>❌ <strong>Do NOT rely on</strong>: Binomial model predictions
beyond observed data</li>
<li>✅ <strong>Report methodology</strong>: “We used non-parametric
empirical sensitivity curves with bootstrap 95% CIs (10,000 iterations)
to account for spatial clustering of VI within tumor blocks.”</li>
</ol>
</div>
<div class="section level4">
<h4 id="for-lymph-node-analysis">For Lymph Node Analysis<a class="anchor" aria-label="anchor" href="#for-lymph-node-analysis"></a>
</h4>
<ol style="list-style-type: decimal">
<li>✅ <strong>Set Analysis Context</strong>: “Lymph Node
Dissection”</li>
<li>✅ <strong>Use either</strong>: Binomial model OR Empirical (both
valid)</li>
<li>✅ <strong>Bootstrap CIs</strong> are still good practice (robust to
violations)</li>
<li>✅ <strong>Extrapolation</strong> beyond observed N is
reasonable</li>
</ol>
</div>
<div class="section level4">
<h4 id="when-uncertain-about-independence">When Uncertain About Independence<a class="anchor" aria-label="anchor" href="#when-uncertain-about-independence"></a>
</h4>
<p><strong>Default to empirical + bootstrap</strong>. These methods are:
- Always valid (both independent and dependent) - Non-parametric (no
distributional assumptions) - Robust to model misspecification - Widely
accepted in medical literature</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-using-pathsampling-with-duan-2023-dataset">Example: Using <code>pathsampling</code> with Duan 2023 Dataset<a class="anchor" aria-label="anchor" href="#example-using-pathsampling-with-duan-2023-dataset"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the example dataset</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.serdarbalci.com/ClinicoPathJamoviModule">ClinicoPath</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">duan2023_vi_blocks</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In jamovi:</span></span>
<span><span class="co"># 1. Analyses → OncoPathT → ClinicoPath Descriptives →</span></span>
<span><span class="co">#    Pathology Sampling Adequacy Analysis</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 2. Settings:</span></span>
<span><span class="co">#    - Analysis Context: Tumor Sampling (VI/EMVI/PNI/Budding)</span></span>
<span><span class="co">#    - Total Samples: blocks_examined</span></span>
<span><span class="co">#    - First Detection: first_vi_block</span></span>
<span><span class="co">#    - Target Confidence: 0.95</span></span>
<span><span class="co">#    - Maximum Samples: 8</span></span>
<span><span class="co">#    - ✓ Show Empirical Cumulative Detection</span></span>
<span><span class="co">#    - ✓ Show Bootstrap Analysis (10000 iterations)</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># 3. Expected output:</span></span>
<span><span class="co">#    - Empirical sensitivity table with 95% bootstrap CIs</span></span>
<span><span class="co">#    - Warning about non-independence of tumor blocks</span></span>
<span><span class="co">#    - Recommendation: "Examine ≥6 blocks for 95% sensitivity"</span></span>
<span><span class="co">#    - Sensitivity curve plot with target threshold line</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Duan K, Chow B, Tsui W, et al.</strong> (2023). Impact of
tissue sampling on detection of venous invasion in colorectal cancer: a
prospective analysis. <em>Histopathology</em>. <a href="doi:10.1111/his.15030" class="uri">doi:10.1111/his.15030</a></p></li>
<li><p><strong>Efron B, Tibshirani RJ</strong> (1993). <em>An
Introduction to the Bootstrap</em>. Chapman &amp; Hall/CRC.</p></li>
<li><p><strong>Wilson EB</strong> (1927). Probable inference, the law of
succession, and statistical inference. <em>Journal of the American
Statistical Association</em>, 22(158), 209-212.</p></li>
<li><p><strong>Gelman A, Hill J</strong> (2006). <em>Data Analysis Using
Regression and Multilevel/Hierarchical Models</em>. Cambridge University
Press. (Chapter on clustered/hierarchical data)</p></li>
<li><p><strong>Skala SL, Hagemann IS</strong> (2015). Evaluation of
omentum as a site of metastatic disease in patients undergoing
cytoreductive surgery for peritoneal carcinomatosis. <em>American
Journal of Surgical Pathology</em>, 39(5), 674-680.</p></li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Tahoe 26.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C.UTF-8/C.UTF-8/C.UTF-8/C/C.UTF-8/C.UTF-8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Istanbul</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] digest_0.6.39     desc_1.4.3        R6_2.6.1          fastmap_1.2.0    </span></span>
<span><span class="co">#&gt;  [5] xfun_0.55         binom_1.1-1.1     cachem_1.1.0      knitr_1.51       </span></span>
<span><span class="co">#&gt;  [9] htmltools_0.5.9   rmarkdown_2.30    lifecycle_1.0.4   cli_3.6.5        </span></span>
<span><span class="co">#&gt; [13] grid_4.5.1        sass_0.4.10       pkgdown_2.1.3     textshaping_1.0.4</span></span>
<span><span class="co">#&gt; [17] jquerylib_0.1.4   systemfonts_1.3.1 compiler_4.5.1    tools_4.5.1      </span></span>
<span><span class="co">#&gt; [21] ragg_1.5.0        bslib_0.9.0       evaluate_1.0.5    yaml_2.3.12      </span></span>
<span><span class="co">#&gt; [25] otel_0.2.0        jsonlite_2.0.0    rlang_1.1.6       fs_1.6.6         </span></span>
<span><span class="co">#&gt; [29] htmlwidgets_1.6.4</span></span></code></pre></div>
<hr>
<p><strong>Document generated</strong>: 2026-01-08 <strong>ClinicoPath
module version</strong>: 0.0.33 <strong>Vignette author</strong>:
ClinicoPath Development Team</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
