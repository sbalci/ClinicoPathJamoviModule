<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath • ClinicoPath</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.53</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/clinicopath-biomarker-01-biomarkerresponse-comprehensive.html">Biomarker Response Association Analysis - Comprehensive Guide for Precision Medicine</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-checkdata-01-comprehensive-data-quality.html">Data Quality Assessment - Comprehensive Guide for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-01-introduction.html">ClinicoPath Descriptives 01: Introduction to Descriptive Statistics for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-02-data-quality.html">Data Quality Assessment and Exploration</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-02-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-data-summary.html">Summarising Clinicopathological Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-04-benford-comprehensive.html">Benford's Law Analysis - Comprehensive Guide for Data Validation and Fraud Detection</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-04-benford.html">Vignette: Checking Data Authenticity with Benford's Law</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-04-data-quality-exploration.html">ClinicoPath Descriptives 04: Data Quality Assessment for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-05-alluvial.html">Comprehensive Guide to Alluvial Diagrams in ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-05-dataquality-comprehensive.html">Data Quality Assessment - Enhanced Visual Analysis with visdat Integration</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-05-digital-pathology.html">Digital Pathology Validation: AI-Assisted Quantification and Method Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-06-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-06-molecular-workflow.html">Modern Molecular Pathology Workflow: Integrated Morphologic and Molecular Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-07-ihcstats-comprehensive-guide.html">Comprehensive IHC Analysis Guide</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-08-autoeda.html">Automated Exploratory Data Analysis with AutoEDA</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-08-function-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-09-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-09-function-alluvial.html">Function Reference: alluvial() - Complete Parameter Guide</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-1-multisurvival-time-dependent-comprehensive.html">Time-Dependent Covariates in Multisurvival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-10-function-benford.html">Vignette: Performing a Benford's Law Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-11-function-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-11-swimmerplot.html">Vignette: Creating Advanced Swimmer Plots with Date and Event Handling</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-12-chisqposttest.html">Chi-Square Post-Hoc Tests for Clinicopathological Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-12-function-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-13-cisingle.html">Confidence Intervals for Mean Values in Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-13-enhancedcrosstable.html">Enhanced Cross Tables with danchaltiel/crosstable - Professional Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-13-function-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-14-enhancedtables.html">Enhanced Tables with gt Package - Professional Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-14-function-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-15-clinical-hemodynamic-monitoring.html">Clinical Hemodynamic Monitoring and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-15-eurostatmap.html">Creating European Statistical Maps with eurostatmap</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-15-function-venn.html">Vignette: Visualizing Co-occurrence with Venn &amp; Upset Plots</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-15-groupsummary-comprehensive.html">Group and Summarize: Data Aggregation and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-16-coefficient-plots.html">Coefficient Plots for Regression Models</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-16-data-summary-legacy.html">Summarising Clinicopathological Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-17-desctools.html">Advanced Statistical Tests with DescTools</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-17-introduction-legacy.html">ClinicoPathDescriptives: Introduction to Clinical and Pathological Descriptive Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-18-consort-flowcharts.html">CONSORT Flow Charts for Clinical Trial Reporting</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-18-digital-pathology-validation-legacy.html">Digital Pathology Validation: AI-Assisted Quantification and Method Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-19-contingency-tables.html">Vignette: Contingency Tables and Association Tests with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-19-flowchart-comprehensive.html">Creating Study Flowcharts with the flowchart Function</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-19-molecular-pathology-workflow-legacy.html">Modern Molecular Pathology Workflow: Integrated Morphologic and Molecular Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-20-ggflowchart-comprehensive.html">Modern Flowcharts with ggFlowchart</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-20-ihcstats-comprehensive-legacy.html">Comprehensive Guide to IHC Expression Analysis with ihcstats</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-20-paired-contingency-tables.html">Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-21-correlation-analysis.html">Vignette: Comprehensive Correlation Analysis with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-21-ggprism-comprehensive.html">GraphPad Prism Style Plots with ggprism</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-21-use-in-r-legacy.html">Use ClinicoPathDescriptives in R</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-22-gtsummary-comprehensive.html">Publication-Ready Tables with gtsummary</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-22-venn-legacy.html">Vignette: Visualizing Co-occurrence with Venn &amp; Upset Plots</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-23-hullplot-comprehensive.html">Hull Plot Visualization for Group Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-01-getting-started.html">Getting Started with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-02-jamovi-user-guide.html">General 01: jamovi User Guide for Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-03-clinical-examples.html">Clinical Research Examples with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-03-getting-started-alt.html">General 02: Getting Started with Statistical Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/general-04-clinical-workflow.html">Clinical Research Workflow with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-05-jamovi-workflow.html">Using jsurvival in jamovi: Complete Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/general-06-jamovi-workflow-examples.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-07-pathology-jamovi.html">Using jamovi for the Common Statistical Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/general-08-advanced-topics.html">Advanced Survival Analysis with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-09-analysis-gallery.html">Complete Analysis Gallery - All jjstatsplot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/general-10-visualization-gallery.html">Visualization Gallery for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/general-11-data-preparation.html">Data Preparation for Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-12-module-development.html">Module Development for Jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/general-13-quick-reference.html">Quick Reference Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-14-r-programming-guide.html">R Programming Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-15-troubleshooting-faq.html">Troubleshooting Guide and FAQ for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-16-use-clinicopath-in-r.html">Use ClinicoPathDescriptives in R</a></li>
    <li><a class="dropdown-item" href="../articles/general-17-users-of-clinicopath.html">Users of ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/general-18-analysis-gallery-legacy.html">Complete Analysis Gallery - All jjstatsplot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/general-19-clinical-examples-legacy.html">Clinical Research Examples with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-20-clinical-workflow-legacy.html">Clinical Research Workflow with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-21-visualization-gallery-legacy.html">Visualization Gallery for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/general-22-advanced-topics-legacy.html">Advanced Survival Analysis with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-23-data-preparation-legacy.html">Data Preparation for Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-24-jamovi-user-guide-legacy.html">Complete jamovi User Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-25-jamovi-workflow-examples-legacy.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-26-jamovi-workflow-legacy.html">Using jsurvival in jamovi: Complete Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/general-28-pathology-jamovi-legacy.html">Using jamovi for the Common Statistical Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/general-29-quick-reference-legacy.html">Quick Reference Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-30-r-programming-guide-legacy.html">R Programming Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-31-troubleshooting-faq-legacy.html">Troubleshooting Guide and FAQ for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-01-introduction.html">jjStatsPlot 01: Statistical Visualization for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-02-categorical-plots.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-03-continuous-comparisons.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-04-continuous-comparisons-alt.html">Continuous Variable Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-05-correlations-scatterplots.html">Correlations and Scatter Plots</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-06-BBC-style-data-visualization.html">BBC-Style Data Visualization - Professional News Graphics</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-06-use-in-r.html">Use jjstatsplot in R</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-07-advancedbarplot.html">Advanced Bar Charts - 7 Professional Approaches</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-07-continuous-comparisons-legacy.html">Continuous Variable Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-08-advancedraincloud.html">Advanced Raincloud Plots - Enhanced Distribution Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-08-categorical-plots-legacy.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-09-advancedtree.html">Advanced Decision Tree Analysis in ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-09-basegraphics.html">Base Graphics Visualization - Fast &amp; Customizable Base R Plots</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-09-continuous-comparisons-legacy.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-10-correlations-scatterplots-legacy.html">Correlations and Scatter Plots</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-11-introduction-legacy.html">jjstatsplot: Statistical Visualization for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-12-economistplots.html">Economist-Style Distribution Plots - Professional Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-14-clinical-classification-comprehensive.html">Clinical Classification Analysis with Machine Learning</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-15-grafify-comprehensive.html">Scientific Visualization with Grafify: Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-16-jcomplexupset-comprehensive.html">Complex UpSet Plot Visualization with jcomplexupset</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-17-jextractggstats-comprehensive.html">Statistical Data Extraction from ggstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-18-jforester-comprehensive.html">Forest Plot Visualization with jforester</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-19-jforestmodel-comprehensive.html">Forest Plots from Regression Models with jforestmodel</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-20-jggheatmap-comprehensive.html">Advanced Heatmap Visualization with jggheatmap</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-21-jggridges-comprehensive.html">Ridge Plot Visualization with jggridges</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-22-jggsankeyfier-comprehensive.html">Comprehensive Guide to Sankey &amp; Alluvial Diagrams with jggsankeyfier</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-23-jggstats-comprehensive.html">Comprehensive Guide to Enhanced Statistical Visualization with jggstats</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-23-jjbarstats-comprehensive.html">Comprehensive Bar Chart Analysis with jjbarstats</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-24-jjarcdiagram-comprehensive.html">Network Visualization with jjarcdiagram</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-24-jjbetweenstats-comprehensive.html">High-Performance Violin Plot Analysis with jjbetweenstats</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-25-jjcorrmat-comprehensive.html">jjcorrmat: Comprehensive Correlation Matrix Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-26-jjdotplotstats-comprehensive.html">jjdotplotstats: Comprehensive Dot Plot Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-27-jjhistostats-comprehensive.html">jjhistostats: Comprehensive Histogram Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-28-jjpiestats-comprehensive.html">jjpiestats: Pie Charts with Performance Optimization and Visualization Best Practices</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-29-jjridgestats-comprehensive.html">jjridgestats: Comprehensive Ridgeline Plot Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-30-jjriverplot-comprehensive.html">jjriverplot: Comprehensive River Plot and Flow Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-30-linechart-comprehensive.html">Line Charts for Clinical Time Series and Trend Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-31-jjscatterstats-comprehensive.html">UNKNOWN TITLE</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-31-jpps-comprehensive.html">Predictive Power Score (PPS) Analysis with jpps</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-31-jscattermore-comprehensive.html">High-Performance Scatter Plots with jscattermore</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-31-lollipop-comprehensive.html">Lollipop Charts for Clinical Categorical Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-32-jjstreamgraph-comprehensive.html">jjstreamgraph: Comprehensive Interactive Stream Graph Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-32-jsjplot-comprehensive.html">Social Science Statistical Visualization with jsjplot</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-33-jjtreemap-comprehensive.html">jjtreemap: Comprehensive Treemap Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-33-jsummarytools-comprehensive.html">Comprehensive Descriptive Statistics with jsummarytools</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-34-jjwithinstats-comprehensive.html">jjwithinstats: Comprehensive Within-Subjects Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-34-jviolin-comprehensive.html">Professional Violin Plots with jviolin</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-35-jvisr-comprehensive.html">Clinical Research Visualization with jvisr</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-36-jwaffle-comprehensive.html">Professional Waffle Charts with jwaffle</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-37-missingdata-comprehensive.html">Missing Data Analysis and Multiple Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-38-modelbuilder-comprehensive.html">Clinical Prediction Model Builder</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-01-introduction.html">jSurvival 01: Introduction to Survival Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-02-person-time-analysis.html">Person-Time Analysis in jsurvival Module</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-03-treatment-response.html">Treatment Response Analysis in Oncology</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-04-stage-migration-analysis.html">Stage Migration Analysis: Understanding the Will Rogers Phenomenon</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-05-function-swimmerplot.html">Vignette: Creating Advanced Swimmer Plots with Date and Event Handling</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-05-treatment-pathway-visualization.html">Treatment Pathway Visualization with alluvialSurvival</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-06-function-waterfall.html">Vignette: Creating Waterfall Plots to Show Patient Response to Therapy</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-07-use-in-r.html">Use jsurvival in R</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-08-groupedforest-comprehensive.html">Grouped Hazard Forest Plots for Subgroup Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-08-stage-migration-analysis-legacy.html">Stage Migration Analysis: Understanding the Will Rogers Phenomenon</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-09-lassocox-comprehensive.html">Lasso-Cox Regression for Variable Selection in Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-09-waterfall-legacy.html">Vignette: Creating Waterfall Plots to Show Patient Response to Therapy</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-1-stagemigration-comprehensive.html">Advanced TNM Stage Migration Analysis: A Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-10-introduction-legacy.html">jsurvival: Introduction to Survival Analysis for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-11-person-time-analysis-legacy.html">Person-Time Analysis in jsurvival Module</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-12-treatment-response-analysis-legacy.html">Treatment Response Analysis in Oncology</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-13-use-in-r-legacy.html">Use jsurvival in R</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-14-comparing-survival.html">jSurvival 14: Comparing Survival Outcomes Between Groups</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-15-competing-survival.html">jSurvival 15: Competing Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-16-cox-model-diagnostics.html">jSurvival 16: Cox Proportional Hazards Model Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-17-jiwillsurvive-comprehensive.html">Intuitive Survival Analysis with jiwillsurvive</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-01-introduction.html">MedDecide 01: Introduction to Medical Decision Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-02-comprehensive-guide.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-03-agreement-advanced-features.html">Advanced Features in Interrater Agreement Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-03-agreement-analysis.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-03-roc-analysis.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-04-decision-tree-guide.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-05-decision-tree-analysis.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-06-decision-tree-vs-markov.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-07-bayesian-decision-curve-analysis.html">Bayesian Decision Curve Analysis - Advanced Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-07-decision-trees.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-07-kappasizeci-comprehensive.html">Sample Size Calculations for Interobserver Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-08-decision-panel-clinical.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-08-kappasizefixedn-comprehensive.html">Complete Guide to kappasizefixedn: Fixed Sample Size Kappa Power Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-09-decision-panel-advanced.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-09-kappasizepower-comprehensive.html">Complete Guide to kappasizepower: Power Analysis for Inter-rater Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-10-decision-panel-optimization.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-11-precision-oncology.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-12-nogoldstandard.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-13-diagnostic-tests.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-14-diagnostic-style-quick-guide.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-15-diagnostic-style-clustering.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-16-use-in-r.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-17-introduction-legacy.html">meddecide: Introduction to Medical Decision Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-18-roc-analysis-legacy.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-19-decisionpanel-advanced-legacy.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-20-decisionpanel-clinical-legacy.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-21-decisionpanel-optimization-legacy.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-22-diagnostic-style-clustering-legacy.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-23-diagnostic-style-quick-guide-legacy.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-24-agreement-analysis-legacy.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-25-diagnostic-tests-legacy.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-26-medical-decision-tree-guide-legacy.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-27-nogoldstandard-legacy.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-28-decision-tree-examples-legacy.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-29-decision-tree-vs-markov-analysis-legacy.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-30-decisiontree-analysis-vignette-legacy.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-31-precision-oncology-biomarkers-legacy.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-32-vignettes-legacy.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-33-use-in-r-legacy.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-34-cotest-analysis.html">Co-Testing Analysis: Combining Diagnostic Tests for Better Clinical Decision Making</a></li>
    <li><a class="dropdown-item" href="../articles/module-development-jamovi.html">Comprehensive Guide to jamovi Module Development</a></li>
    <li><a class="dropdown-item" href="../articles/pkgnet-report.html">ClinicoPath Package Report, by pkgnet</a></li>
    <li><a class="dropdown-item" href="../articles/use-jjstatsplot-in-R.html">Use jjstatsplot in R</a></li>
    <li><a class="dropdown-item" href="../articles/users-of-ClinicoPath.html">Users of ClinicoPath</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath</h1>
                        <h4 data-toc-skip class="author">Analysis by
Claude</h4>
            
            <h4 data-toc-skip class="date">2025-07-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/clinicopath-descriptives-20-paired-contingency-tables.Rmd" class="external-link"><code>vignettes/clinicopath-descriptives-20-paired-contingency-tables.Rmd</code></a></small>
      <div class="d-none name"><code>clinicopath-descriptives-20-paired-contingency-tables.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>contTablesPaired</code> function in ClinicoPath provides
specialized analysis for paired samples contingency tables using
McNemar’s test. This function is designed for situations where the same
subjects or matched pairs are measured on two occasions or by two
different methods, making it ideal for inter-rater agreement studies,
before-after comparisons, and diagnostic test evaluations.</p>
<div class="section level3">
<h3 id="when-to-use-paired-contingency-tables">When to Use Paired Contingency Tables<a class="anchor" aria-label="anchor" href="#when-to-use-paired-contingency-tables"></a>
</h3>
<p>Paired contingency tables are used when: - The same subjects are
measured twice (before-after studies) - Two raters evaluate the same
cases (inter-rater agreement) - Comparing two diagnostic tests on the
same patients - Analyzing matched pairs or twins - Testing for marginal
homogeneity in square tables</p>
<p><strong>Key Difference from Independent Samples</strong>: Unlike
regular contingency tables, paired samples account for the correlation
between measurements on the same subjects.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.serdarbalci.com/ClinicoPathJamoviModule">ClinicoPath</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">histopathology</span>, package <span class="op">=</span> <span class="st">"ClinicoPath"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span>, package <span class="op">=</span> <span class="st">"ClinicoPath"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the rater variables in histopathology</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">histopathology</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rater 1"</span>, <span class="st">"Rater 2"</span>, <span class="st">"Rater 3"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [250 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ Rater 1: num [1:250] 0 1 1 0 0 0 1 1 1 0 ...</span></span>
<span><span class="co">#&gt;  $ Rater 2: num [1:250] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ Rater 3: num [1:250] 1 1 1 0 1 1 1 1 1 1 ...</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-inter-rater-agreement-analysis">Basic Inter-Rater Agreement Analysis<a class="anchor" aria-label="anchor" href="#basic-inter-rater-agreement-analysis"></a>
</h2>
<p>Let’s start with a basic inter-rater agreement analysis comparing two
pathologists:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic McNemar test for inter-rater agreement</span></span>
<span><span class="va">basic_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the basic agreement results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">basic_agreement</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PAIRED SAMPLES CONTINGENCY TABLES</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Contingency Tables                                                </span></span>
<span><span class="co">#&gt;  ───────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    Rater 1                       0            1            Total   </span></span>
<span><span class="co">#&gt;  ───────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    0          Count                     74            6       80   </span></span>
<span><span class="co">#&gt;               % within row        92.50000      7.50000            </span></span>
<span><span class="co">#&gt;               % within column     84.09091      3.72671            </span></span>
<span><span class="co">#&gt;                                                                    </span></span>
<span><span class="co">#&gt;    1          Count                     14          155      169   </span></span>
<span><span class="co">#&gt;               % within row         8.28402     91.71598            </span></span>
<span><span class="co">#&gt;               % within column     15.90909     96.27329            </span></span>
<span><span class="co">#&gt;                                                                    </span></span>
<span><span class="co">#&gt;    Total      Count                     88          161      249   </span></span>
<span><span class="co">#&gt;               % within row        35.34137     64.65863            </span></span>
<span><span class="co">#&gt;               % within column    100.00000    100.00000            </span></span>
<span><span class="co">#&gt;  ───────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  McNemar Test                                                </span></span>
<span><span class="co">#&gt;  ─────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;                                Value       df    p           </span></span>
<span><span class="co">#&gt;  ─────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    χ²                          3.200000     1    0.0736383   </span></span>
<span><span class="co">#&gt;    χ² continuity correction    2.450000     1    0.1175249   </span></span>
<span><span class="co">#&gt;    N                                249                      </span></span>
<span><span class="co">#&gt;  ───────────────────────────────────────────────────────────</span></span></code></pre></div>
<div class="section level3">
<h3 id="understanding-mcnemars-test">Understanding McNemar’s Test<a class="anchor" aria-label="anchor" href="#understanding-mcnemars-test"></a>
</h3>
<p>McNemar’s test specifically examines the
<strong>disagreement</strong> between paired measurements. It focuses on
the off-diagonal cells: - Cases where Rater 1 = 0 and Rater 2 = 1 -
Cases where Rater 1 = 1 and Rater 2 = 0</p>
<p>If there’s no systematic bias between raters, these disagreements
should be equally distributed.</p>
</div>
</div>
<div class="section level2">
<h2 id="multi-level-agreement-analysis">Multi-Level Agreement Analysis<a class="anchor" aria-label="anchor" href="#multi-level-agreement-analysis"></a>
</h2>
<p>For ordinal or multi-category variables, we can still use McNemar’s
test:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-level agreement analysis with Gleason scores</span></span>
<span><span class="va">gleason_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Urologist_B"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the Gleason agreement results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gleason_agreement</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PAIRED SAMPLES CONTINGENCY TABLES</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Contingency Tables                                                                                                                     </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    Urologist_A                       3+3=6        3+4=7        4+3=7        4+4=8        4+5=9        5+4=9        5+5=10       Total   </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    3+3=6          Count                     22            7            0            0            0            0            0       29   </span></span>
<span><span class="co">#&gt;                   % within row        75.86207     24.13793      0.00000      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column     73.33333     16.66667      0.00000      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    3+4=7          Count                      5           20            7            1            0            0            0       33   </span></span>
<span><span class="co">#&gt;                   % within row        15.15152     60.60606     21.21212      3.03030      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column     16.66667     47.61905     38.88889      5.26316      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+3=7          Count                      3           11            9            5            0            0            0       28   </span></span>
<span><span class="co">#&gt;                   % within row        10.71429     39.28571     32.14286     17.85714      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column     10.00000     26.19048     50.00000     26.31579      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+4=8          Count                      0            4            2           11            1            0            0       18   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000     22.22222     11.11111     61.11111      5.55556      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      9.52381     11.11111     57.89474     20.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+5=9          Count                      0            0            0            2            3            3            0        8   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000     25.00000     37.50000     37.50000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000     10.52632     60.00000     60.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    5+4=9          Count                      0            0            0            0            1            1            0        2   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000      0.00000     50.00000     50.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000      0.00000     20.00000     20.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    5+5=10         Count                      0            0            0            0            0            1            1        2   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000      0.00000      0.00000     50.00000     50.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000      0.00000      0.00000     20.00000    100.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    Total          Count                     30           42           18           19            5            5            1      120   </span></span>
<span><span class="co">#&gt;                   % within row        25.00000     35.00000     15.00000     15.83333      4.16667      4.16667      0.83333            </span></span>
<span><span class="co">#&gt;                   % within column    100.00000    100.00000    100.00000    100.00000    100.00000    100.00000    100.00000            </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  McNemar Test                                             </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;                                Value    df    p           </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    χ²                            NaN                      </span></span>
<span><span class="co">#&gt;    χ² continuity correction      NaN                      </span></span>
<span><span class="co">#&gt;    N                             120                      </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────</span></span>
<span></span>
<span><span class="co"># Check the structure of the Gleason score data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span><span class="op">$</span><span class="va">Urologist_A</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  3+3=6  3+4=7  4+3=7  4+4=8  4+5=9  5+4=9 5+5=10 </span></span>
<span><span class="co">#&gt;     29     33     28     18      8      2      2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span><span class="op">$</span><span class="va">Urologist_B</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  3+3=6  3+4=7  4+3=7  4+4=8  4+5=9  5+4=9 5+5=10 </span></span>
<span><span class="co">#&gt;     30     42     18     19      5      5      1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gold-standard-comparison">Gold Standard Comparison<a class="anchor" aria-label="anchor" href="#gold-standard-comparison"></a>
</h2>
<p>A common application is comparing a new rater or method against a
gold standard:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare Urologist A against the true Gleason score</span></span>
<span><span class="va">gold_standard_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"True_Gleason"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the gold standard comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gold_standard_comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PAIRED SAMPLES CONTINGENCY TABLES</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Contingency Tables                                                                                                                     </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    Urologist_A                       3+3=6        3+4=7        4+3=7        4+4=8        4+5=9        5+4=9        5+5=10       Total   </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    3+3=6          Count                     27            2            0            0            0            0            0       29   </span></span>
<span><span class="co">#&gt;                   % within row        93.10345      6.89655      0.00000      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column     75.00000      5.71429      0.00000      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    3+4=7          Count                      6           23            4            0            0            0            0       33   </span></span>
<span><span class="co">#&gt;                   % within row        18.18182     69.69697     12.12121      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column     16.66667     65.71429     17.39130      0.00000      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+3=7          Count                      3            6           18            1            0            0            0       28   </span></span>
<span><span class="co">#&gt;                   % within row        10.71429     21.42857     64.28571      3.57143      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      8.33333     17.14286     78.26087      7.14286      0.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+4=8          Count                      0            4            1           11            2            0            0       18   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000     22.22222      5.55556     61.11111     11.11111      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000     11.42857      4.34783     78.57143     22.22222      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    4+5=9          Count                      0            0            0            2            6            0            0        8   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000     25.00000     75.00000      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000     14.28571     66.66667      0.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    5+4=9          Count                      0            0            0            0            1            1            0        2   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000      0.00000     50.00000     50.00000      0.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000      0.00000     11.11111    100.00000      0.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    5+5=10         Count                      0            0            0            0            0            0            2        2   </span></span>
<span><span class="co">#&gt;                   % within row         0.00000      0.00000      0.00000      0.00000      0.00000      0.00000    100.00000            </span></span>
<span><span class="co">#&gt;                   % within column      0.00000      0.00000      0.00000      0.00000      0.00000      0.00000    100.00000            </span></span>
<span><span class="co">#&gt;                                                                                                                                         </span></span>
<span><span class="co">#&gt;    Total          Count                     36           35           23           14            9            1            2      120   </span></span>
<span><span class="co">#&gt;                   % within row        30.00000     29.16667     19.16667     11.66667      7.50000      0.83333      1.66667            </span></span>
<span><span class="co">#&gt;                   % within column    100.00000    100.00000    100.00000    100.00000    100.00000    100.00000    100.00000            </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  McNemar Test                                             </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;                                Value    df    p           </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    χ²                            NaN                      </span></span>
<span><span class="co">#&gt;    χ² continuity correction      NaN                      </span></span>
<span><span class="co">#&gt;    N                             120                      </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────</span></span>
<span></span>
<span><span class="co"># This helps assess the accuracy of Urologist A's diagnoses</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-count-data">Working with Count Data<a class="anchor" aria-label="anchor" href="#working-with-count-data"></a>
</h2>
<p>The function can handle pre-aggregated count data, useful for
published data or summary tables:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example from the documentation: Survey data</span></span>
<span><span class="va">survey_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  `1st survey` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Approve'</span>, <span class="st">'Approve'</span>, <span class="st">'Disapprove'</span>, <span class="st">'Disapprove'</span><span class="op">)</span>,</span>
<span>  `2nd survey` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Approve'</span>, <span class="st">'Disapprove'</span>, <span class="st">'Approve'</span>, <span class="st">'Disapprove'</span><span class="op">)</span>,</span>
<span>  `Counts` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">794</span>, <span class="fl">150</span>, <span class="fl">86</span>, <span class="fl">570</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analysis using count data</span></span>
<span><span class="va">survey_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"1st survey"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"2nd survey"</span>,</span>
<span>  counts <span class="op">=</span> <span class="st">"Counts"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the survey data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">survey_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   1st survey 2nd survey Counts</span></span>
<span><span class="co">#&gt; 1    Approve    Approve    794</span></span>
<span><span class="co">#&gt; 2    Approve Disapprove    150</span></span>
<span><span class="co">#&gt; 3 Disapprove    Approve     86</span></span>
<span><span class="co">#&gt; 4 Disapprove Disapprove    570</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formula-interface">Formula Interface<a class="anchor" aria-label="anchor" href="#formula-interface"></a>
</h2>
<p>The function supports formula notation for convenience:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using formula interface with the same survey data</span></span>
<span><span class="va">formula_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Counts</span> <span class="op">~</span> <span class="va">`1st survey`</span><span class="op">:</span><span class="va">`2nd survey`</span>,</span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative without counts (each row = one observation)</span></span>
<span><span class="co"># contTablesPaired(formula = ~ `1st survey`:`2nd survey`, data = expanded_data)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="before-after-analysis">Before-After Analysis<a class="anchor" aria-label="anchor" href="#before-after-analysis"></a>
</h2>
<p>A classic use case is analyzing treatment effects or changes over
time:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create simulated before-after treatment data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">treatment_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  before_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poor"</span>, <span class="st">"Good"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  after_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poor"</span>, <span class="st">"Good"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># McNemar test for treatment effect</span></span>
<span><span class="va">treatment_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">treatment_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"before_treatment"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"after_treatment"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the simulated data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">treatment_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id before_treatment after_treatment</span></span>
<span><span class="co">#&gt; 1          1             Poor            Good</span></span>
<span><span class="co">#&gt; 2          2             Good            Good</span></span>
<span><span class="co">#&gt; 3          3             Poor            Good</span></span>
<span><span class="co">#&gt; 4          4             Good            Poor</span></span>
<span><span class="co">#&gt; 5          5             Good            Good</span></span>
<span><span class="co">#&gt; 6          6             Poor            Poor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">treatment_data</span><span class="op">$</span><span class="va">before_treatment</span>, <span class="va">treatment_data</span><span class="op">$</span><span class="va">after_treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt;        Good Poor</span></span>
<span><span class="co">#&gt;   Good   15   14</span></span>
<span><span class="co">#&gt;   Poor   47   24</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exact-tests-for-small-samples">Exact Tests for Small Samples<a class="anchor" aria-label="anchor" href="#exact-tests-for-small-samples"></a>
</h2>
<p>For small samples or when assumptions are violated, exact tests can
be useful:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exact log odds ratio (requires exact2x2 package)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">exact2x2</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">exact_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>    rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>    cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>    chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    exact <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Exact test analysis completed"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"exact2x2 package not available - using standard tests only"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Standard analysis without exact test</span></span>
<span>  <span class="va">exact_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>    rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>    cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>    chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    exact <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multiple-rater-comparisons">Multiple Rater Comparisons<a class="anchor" aria-label="anchor" href="#multiple-rater-comparisons"></a>
</h2>
<p>Often we need to compare multiple raters against each other:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Compare Urologist A vs C directly</span></span>
<span><span class="va">urol_a_vs_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Urologist_C"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">urol_a_vs_c</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PAIRED SAMPLES CONTINGENCY TABLES</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Contingency Tables                                                                       </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    Urologist_A    3+3=6    3+4=7    4+3=7    4+4=8    4+5=9    5+4=9    5+5=10    Total   </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    3+3=6             18        9        2        0        0        0         0       29   </span></span>
<span><span class="co">#&gt;    3+4=7              8       15        8        2        0        0         0       33   </span></span>
<span><span class="co">#&gt;    4+3=7              4        7       14        3        0        0         0       28   </span></span>
<span><span class="co">#&gt;    4+4=8              2        3        1        9        2        1         0       18   </span></span>
<span><span class="co">#&gt;    4+5=9              0        0        1        2        5        0         0        8   </span></span>
<span><span class="co">#&gt;    5+4=9              0        0        0        0        2        0         0        2   </span></span>
<span><span class="co">#&gt;    5+5=10             0        0        0        0        0        0         2        2   </span></span>
<span><span class="co">#&gt;    Total             32       34       26       16        9        1         2      120   </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  McNemar Test                                             </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;                                Value    df    p           </span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────── </span></span>
<span><span class="co">#&gt;    χ²                            NaN                      </span></span>
<span><span class="co">#&gt;    χ² continuity correction      NaN                      </span></span>
<span><span class="co">#&gt;    N                             120                      </span></span>
<span><span class="co">#&gt;  ────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clinical-examples">Clinical Examples<a class="anchor" aria-label="anchor" href="#clinical-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-diagnostic-test-agreement">Example 1: Diagnostic Test Agreement<a class="anchor" aria-label="anchor" href="#example-1-diagnostic-test-agreement"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate diagnostic test data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">diagnostic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">150</span>,</span>
<span>  test_method_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_method_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># McNemar test for diagnostic agreement</span></span>
<span><span class="va">diagnostic_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">diagnostic_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"test_method_1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"test_method_2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cross-tabulation of diagnostic results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">diagnostic_data</span><span class="op">$</span><span class="va">test_method_1</span>, <span class="va">diagnostic_data</span><span class="op">$</span><span class="va">test_method_2</span><span class="op">)</span></span>
<span><span class="co">#&gt;           </span></span>
<span><span class="co">#&gt;            Negative Positive</span></span>
<span><span class="co">#&gt;   Negative       68       26</span></span>
<span><span class="co">#&gt;   Positive       44       12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-observer-variability-in-pathology">Example 2: Observer Variability in Pathology<a class="anchor" aria-label="anchor" href="#example-2-observer-variability-in-pathology"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the actual rater data for pathology scoring</span></span>
<span><span class="va">pathology_agreement</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 3"</span>,  <span class="co"># Different pair for variety</span></span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This assesses inter-observer variability in pathological assessment</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<div class="section level3">
<h3 id="mcnemars-test-statistics">McNemar’s Test Statistics<a class="anchor" aria-label="anchor" href="#mcnemars-test-statistics"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>χ² (chi-square)</strong>: Tests the null hypothesis that
disagreements are equally distributed
<ul>
<li>Low p-value suggests systematic bias between raters/methods</li>
<li>High p-value suggests no systematic bias (good agreement)</li>
</ul>
</li>
<li>
<strong>χ² with continuity correction</strong>: Yates’ correction
for small samples
<ul>
<li>More conservative than standard χ²</li>
<li>Recommended for 2×2 tables with small expected frequencies</li>
</ul>
</li>
<li>
<strong>Exact log odds ratio</strong>: Provides exact confidence
intervals
<ul>
<li>Useful for small samples or when normal approximation is
questionable</li>
<li>Requires exact2x2 package</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="agreement-vs--association">Agreement vs. Association<a class="anchor" aria-label="anchor" href="#agreement-vs--association"></a>
</h3>
<ul>
<li>
<strong>McNemar’s test</strong>: Tests for <em>systematic bias</em>
or <em>marginal homogeneity</em>
</li>
<li>
<strong>Not the same as</strong>: Overall agreement or
correlation</li>
<li>
<strong>Use additionally</strong>: Kappa statistics or ICC for
agreement strength</li>
</ul>
</div>
<div class="section level3">
<h3 id="clinical-interpretation-guidelines">Clinical Interpretation Guidelines<a class="anchor" aria-label="anchor" href="#clinical-interpretation-guidelines"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Significant McNemar test (p &lt; 0.05)</strong>:
<ul>
<li>Systematic bias exists between raters/methods</li>
<li>One consistently rates higher/lower than the other</li>
<li>Need to investigate source of bias</li>
</ul>
</li>
<li>
<strong>Non-significant McNemar test (p ≥ 0.05)</strong>:
<ul>
<li>No systematic bias detected</li>
<li>Disagreements are balanced</li>
<li>Still need to assess overall agreement level</li>
</ul>
</li>
<li>
<strong>Contingency Table Patterns</strong>:
<ul>
<li>
<strong>High diagonal values</strong>: Good overall agreement</li>
<li>
<strong>High off-diagonal values</strong>: Poor agreement</li>
<li>
<strong>Asymmetric off-diagonals</strong>: Systematic bias</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="sample-size-considerations">Sample Size Considerations<a class="anchor" aria-label="anchor" href="#sample-size-considerations"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of how sample size affects power</span></span>
<span><span class="va">small_sample</span> <span class="op">&lt;-</span> <span class="va">histopathology</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">small_sample_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contTablesPaired.html">contTablesPaired</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">small_sample</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Continuity correction especially important for small samples</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With small samples, consider exact tests</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-practices-for-clinical-research">Best Practices for Clinical Research<a class="anchor" aria-label="anchor" href="#best-practices-for-clinical-research"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Pre-specify hypotheses</strong>: Define what constitutes
acceptable agreement</li>
<li>
<strong>Power calculations</strong>: Ensure adequate sample size for
detecting meaningful differences</li>
<li>
<strong>Multiple comparisons</strong>: Adjust for multiple testing
when comparing many rater pairs</li>
<li>
<strong>Context matters</strong>: Consider clinical significance,
not just statistical significance</li>
<li>
<strong>Report effect sizes</strong>: Include measures of agreement
strength (kappa, ICC)</li>
<li>
<strong>Validate findings</strong>: Use independent datasets when
possible</li>
</ol>
</div>
<div class="section level2">
<h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="anchor" aria-label="anchor" href="#troubleshooting-common-issues"></a>
</h2>
<div class="section level3">
<h3 id="non-22-tables">Non-2×2 Tables<a class="anchor" aria-label="anchor" href="#non-22-tables"></a>
</h3>
<p>For tables larger than 2×2, McNemar’s test becomes a test of marginal
homogeneity but may have reduced power.</p>
</div>
<div class="section level3">
<h3 id="small-expected-frequencies">Small Expected Frequencies<a class="anchor" aria-label="anchor" href="#small-expected-frequencies"></a>
</h3>
<p>Use continuity correction or exact tests when expected frequencies
are small.</p>
</div>
<div class="section level3">
<h3 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h3>
<p>The function uses complete cases only. Consider multiple imputation
for missing data patterns.</p>
</div>
<div class="section level3">
<h3 id="multiple-categories">Multiple Categories<a class="anchor" aria-label="anchor" href="#multiple-categories"></a>
</h3>
<p>For ordinal data, consider alternative approaches like weighted kappa
or ordinal McNemar tests.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>contTablesPaired</code> function provides a comprehensive
toolkit for analyzing paired samples contingency tables in clinical
research. From basic inter-rater agreement to complex diagnostic test
comparisons, it handles the unique challenges of paired data while
providing appropriate statistical tests.</p>
<p>Key advantages: - Accounts for within-subject correlation - Multiple
test options (standard, continuity correction, exact) - Flexible data
input (individual observations or counts) - Formula interface for
convenience - Comprehensive error handling</p>
<p>This makes it an essential tool for quality assurance, method
comparison, and reliability studies in clinical pathology and medical
research.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
