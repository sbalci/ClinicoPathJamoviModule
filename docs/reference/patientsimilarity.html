<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Patient Similarity Clustering — patientsimilarity • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Patient Similarity Clustering — patientsimilarity"><meta name="description" content="Visualizes patient similarity using dimensionality reduction techniques
(PCA, t-SNE, UMAP, MDS). Projects high-dimensional patient data into 2D or
3D space to reveal natural patient groupings and subpopulations. Inspired
by Orange Data Mining's interactive projection widgets, adapted for jamovi
with comprehensive cluster analysis and statistical validation."><meta property="og:description" content="Visualizes patient similarity using dimensionality reduction techniques
(PCA, t-SNE, UMAP, MDS). Projects high-dimensional patient data into 2D or
3D space to reveal natural patient groupings and subpopulations. Inspired
by Orange Data Mining's interactive projection widgets, adapted for jamovi
with comprehensive cluster analysis and statistical validation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Patient Similarity Clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/patientsimilarity.h.R" class="external-link"><code>R/patientsimilarity.h.R</code></a></small>
      <div class="d-none name"><code>patientsimilarity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Visualizes patient similarity using dimensionality reduction techniques
(PCA, t-SNE, UMAP, MDS). Projects high-dimensional patient data into 2D or
3D space to reveal natural patient groupings and subpopulations. Inspired
by Orange Data Mining's interactive projection widgets, adapted for jamovi
with comprehensive cluster analysis and statistical validation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">patientsimilarity</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"tsne"</span>,</span>
<span>  dimensions <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>  colorBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  perplexity <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  umapNeighbors <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  umapMinDist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  performClustering <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  dbscan_eps <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  dbscan_minpts <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  showClusterStats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  survivalAnalysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  survivalTime <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  survivalEvent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">survivalEventLevel</span>,</span>
<span>  scaleVars <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  removeOutliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  showLoadings <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show3DPlot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The dataset to be analyzed, provided as a data frame.</p></dd>


<dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>Continuous variables to use for calculating patient similarity.
These will be used to compute distances between patients. Categorical
variables should be converted to numeric or one-hot encoded.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducibility of t-SNE, UMAP, and clustering
results.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method for dimensionality reduction: - PCA: Linear method,
preserves global structure - t-SNE: Non-linear, excellent for
visualization, preserves local structure - UMAP: Non-linear, preserves both
local and global structure, faster than t-SNE - MDS: Classical method,
preserves pairwise distances</p></dd>


<dt id="arg-dimensions">dimensions<a class="anchor" aria-label="anchor" href="#arg-dimensions"></a></dt>
<dd><p>Number of dimensions for projection. 2D is easier to
interpret, 3D can reveal additional structure.</p></dd>


<dt id="arg-colorby">colorBy<a class="anchor" aria-label="anchor" href="#arg-colorby"></a></dt>
<dd><p>Variable to use for coloring points. Typically an outcome
variable (e.g., disease status, survival, response) to see if it
corresponds to natural patient groupings.</p></dd>


<dt id="arg-perplexity">perplexity<a class="anchor" aria-label="anchor" href="#arg-perplexity"></a></dt>
<dd><p>Perplexity parameter for t-SNE. Roughly corresponds to
the number of nearest neighbors considered. Typical values: 5-50. Higher
values preserve more global structure.</p></dd>


<dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>Number of iterations for t-SNE optimization. More
iterations improve convergence but take longer.</p></dd>


<dt id="arg-umapneighbors">umapNeighbors<a class="anchor" aria-label="anchor" href="#arg-umapneighbors"></a></dt>
<dd><p>Number of nearest neighbors for UMAP. Controls local
vs global structure. Smaller values preserve local structure, larger values
preserve global.</p></dd>


<dt id="arg-umapmindist">umapMinDist<a class="anchor" aria-label="anchor" href="#arg-umapmindist"></a></dt>
<dd><p>Minimum distance between points in UMAP. Controls how
tightly points are packed. Smaller values create tighter clusters.</p></dd>


<dt id="arg-performclustering">performClustering<a class="anchor" aria-label="anchor" href="#arg-performclustering"></a></dt>
<dd><p>Automatically identify patient clusters using
k-means or hierarchical clustering on the reduced-dimension space.</p></dd>


<dt id="arg-clustermethod">clusterMethod<a class="anchor" aria-label="anchor" href="#arg-clustermethod"></a></dt>
<dd><p>Method for clustering patients in the reduced space.</p></dd>


<dt id="arg-nclusters">nClusters<a class="anchor" aria-label="anchor" href="#arg-nclusters"></a></dt>
<dd><p>Number of clusters for k-means or hierarchical clustering.
For DBSCAN, this is ignored.</p></dd>


<dt id="arg-dbscan-eps">dbscan_eps<a class="anchor" aria-label="anchor" href="#arg-dbscan-eps"></a></dt>
<dd><p>The radius of the neighborhood around a point (eps) for
DBSCAN.</p></dd>


<dt id="arg-dbscan-minpts">dbscan_minpts<a class="anchor" aria-label="anchor" href="#arg-dbscan-minpts"></a></dt>
<dd><p>The minimum number of points required to form a dense
region (MinPts) for DBSCAN.</p></dd>


<dt id="arg-showclusterstats">showClusterStats<a class="anchor" aria-label="anchor" href="#arg-showclusterstats"></a></dt>
<dd><p>Display summary statistics for each cluster
including size, characteristics, and outcome distribution.</p></dd>


<dt id="arg-survivalanalysis">survivalAnalysis<a class="anchor" aria-label="anchor" href="#arg-survivalanalysis"></a></dt>
<dd><p>If survival data is available, compare survival
across discovered clusters. Useful for identifying prognostic patient
subtypes.</p></dd>


<dt id="arg-survivaltime">survivalTime<a class="anchor" aria-label="anchor" href="#arg-survivaltime"></a></dt>
<dd><p>Time to event or censoring for survival analysis.</p></dd>


<dt id="arg-survivalevent">survivalEvent<a class="anchor" aria-label="anchor" href="#arg-survivalevent"></a></dt>
<dd><p>Event indicator (1=event, 0=censored).</p></dd>


<dt id="arg-survivaleventlevel">survivalEventLevel<a class="anchor" aria-label="anchor" href="#arg-survivaleventlevel"></a></dt>
<dd><p>Level indicating the event occurred.</p></dd>


<dt id="arg-scalevars">scaleVars<a class="anchor" aria-label="anchor" href="#arg-scalevars"></a></dt>
<dd><p>Standardize variables to mean=0, sd=1 before analysis.
Recommended when variables have different scales.</p></dd>


<dt id="arg-removeoutliers">removeOutliers<a class="anchor" aria-label="anchor" href="#arg-removeoutliers"></a></dt>
<dd><p>Remove outliers before analysis using IQR method. May
improve visualization quality.</p></dd>


<dt id="arg-showloadings">showLoadings<a class="anchor" aria-label="anchor" href="#arg-showloadings"></a></dt>
<dd><p>Show how original variables contribute to each
dimension. Only available for PCA and MDS.</p></dd>


<dt id="arg-show-dplot">show3DPlot<a class="anchor" aria-label="anchor" href="#arg-show-dplot"></a></dt>
<dd><p>Generate interactive 3D plot using plotly (if
dimensions=3).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A results object containing:</p><table class="table table"><tr><td><code>results$instructions</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$summaryText</code></td><td></td><td></td><td></td><td></td><td>a preformatted</td></tr><tr><td><code>results$projectionPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$projection3D</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$varianceTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$loadingsTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$clusterHeading</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$clusterSummary</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$clusterCharacteristics</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$clusterOutcomes</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$clusterQuality</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$survivalHeading</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$survivalTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$survivalPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$survivalComparison</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$exportClusters</code></td><td></td><td></td><td></td><td></td><td>an output</td></tr><tr><td><code>results$exportCoordinates</code></td><td></td><td></td><td></td><td></td><td>an output</td></tr><tr><td><code>results$interpretation</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr></table><p>Tables can be converted to data frames with <code>asDF</code> or <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>. For example:</p>
<p><code>results$varianceTable$asDF</code></p>
<p><code>as.data.frame(results$varianceTable)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Basic t-SNE visualization</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jkrijthe/Rtsne" class="external-link">Rtsne</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">patientsimilarity</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">iris</span>,</span></span>
<span class="r-in"><span>    vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>, <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"tsne"</span>,</span></span>
<span class="r-in"><span>    colorBy <span class="op">=</span> <span class="st">"Species"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in patientsimilarity(data = iris, vars = c("Sepal.Length", "Sepal.Width",     "Petal.Length", "Petal.Width"), method = "tsne", colorBy = "Species"):</span> argument "survivalEventLevel" is missing, with no default</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: UMAP with cluster analysis</span></span></span>
<span class="r-in"><span><span class="fu">patientsimilarity</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">clinical_data</span>,</span></span>
<span class="r-in"><span>    vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"tumor_size"</span>, <span class="st">"grade"</span>, <span class="st">"ki67"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"umap"</span>,</span></span>
<span class="r-in"><span>    colorBy <span class="op">=</span> <span class="st">"survival_status"</span>,</span></span>
<span class="r-in"><span>    performClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    nClusters <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    showClusterStats <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in patientsimilarity(data = clinical_data, vars = c("age", "tumor_size",     "grade", "ki67"), method = "umap", colorBy = "survival_status",     performClustering = TRUE, nClusters = 3, showClusterStats = TRUE):</span> argument "survivalEventLevel" is missing, with no default</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: PCA with survival comparison</span></span></span>
<span class="r-in"><span><span class="fu">patientsimilarity</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">pathology_data</span>,</span></span>
<span class="r-in"><span>    vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"stage"</span>, <span class="st">"nodes"</span>, <span class="st">"size"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"pca"</span>,</span></span>
<span class="r-in"><span>    colorBy <span class="op">=</span> <span class="st">"death"</span>,</span></span>
<span class="r-in"><span>    dimensions <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    survivalTime <span class="op">=</span> <span class="st">"months"</span>,</span></span>
<span class="r-in"><span>    survivalEvent <span class="op">=</span> <span class="st">"death"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in patientsimilarity(data = pathology_data, vars = c("age", "stage",     "nodes", "size"), method = "pca", colorBy = "death", dimensions = 3,     survivalTime = "months", survivalEvent = "death"):</span> argument "survivalEventLevel" is missing, with no default</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

