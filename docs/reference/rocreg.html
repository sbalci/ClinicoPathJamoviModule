<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ROC Regression (Covariate-Adjusted ROC) — rocreg • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ROC Regression (Covariate-Adjusted ROC) — rocreg"><meta name="description" content="ROC regression for covariate-adjusted diagnostic accuracy assessment.
Traditional ROC analysis assumes diagnostic test performance is constant
across all patients, but accuracy often varies by patient characteristics
(age, disease stage, scanner type, staining protocol). ROC regression
models how sensitivity and specificity change as functions of covariates,
providing covariate-specific ROC curves and adjusted summary measures
(covariate-adjusted AUC). Essential for comparing diagnostic tests across
heterogeneous populations, adjusting for confounders in test comparison
studies, and identifying patient subgroups where tests perform differently.
Particularly valuable in digital pathology for accounting for batch effects
(different scanners, institutions, staining protocols) and in biomarker
studies for age/stage-specific performance assessment. Uses binormal,
non-parametric, or Bayesian approaches to model covariate effects on ROC
curves. Provides both population-averaged and covariate-specific diagnostic
accuracy estimates."><meta property="og:description" content="ROC regression for covariate-adjusted diagnostic accuracy assessment.
Traditional ROC analysis assumes diagnostic test performance is constant
across all patients, but accuracy often varies by patient characteristics
(age, disease stage, scanner type, staining protocol). ROC regression
models how sensitivity and specificity change as functions of covariates,
providing covariate-specific ROC curves and adjusted summary measures
(covariate-adjusted AUC). Essential for comparing diagnostic tests across
heterogeneous populations, adjusting for confounders in test comparison
studies, and identifying patient subgroups where tests perform differently.
Particularly valuable in digital pathology for accounting for batch effects
(different scanners, institutions, staining protocols) and in biomarker
studies for age/stage-specific performance assessment. Uses binormal,
non-parametric, or Bayesian approaches to model covariate effects on ROC
curves. Provides both population-averaged and covariate-specific diagnostic
accuracy estimates."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ROC Regression (Covariate-Adjusted ROC)</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/rocreg.h.R" class="external-link"><code>R/rocreg.h.R</code></a></small>
      <div class="d-none name"><code>rocreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>ROC regression for covariate-adjusted diagnostic accuracy assessment.
Traditional ROC analysis assumes diagnostic test performance is constant
across all patients, but accuracy often varies by patient characteristics
(age, disease stage, scanner type, staining protocol). ROC regression
models how sensitivity and specificity change as functions of covariates,
providing covariate-specific ROC curves and adjusted summary measures
(covariate-adjusted AUC). Essential for comparing diagnostic tests across
heterogeneous populations, adjusting for confounders in test comparison
studies, and identifying patient subgroups where tests perform differently.
Particularly valuable in digital pathology for accounting for batch effects
(different scanners, institutions, staining protocols) and in biomarker
studies for age/stage-specific performance assessment. Uses binormal,
non-parametric, or Bayesian approaches to model covariate effects on ROC
curves. Provides both population-averaged and covariate-specific diagnostic
accuracy estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rocreg</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">predictor</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">positive_level</span>,</span>
<span>  <span class="va">covariates</span>,</span>
<span>  covariate_effects <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"binormal"</span>,</span>
<span>  adjusted_auc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  covariate_specific_auc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  covariate_profiles <span class="op">=</span> <span class="st">""</span>,</span>
<span>  compare_unadjusted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_covariate_effects <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variable_selection <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  selection_criterion <span class="op">=</span> <span class="st">"aic"</span>,</span>
<span>  test_interactions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  confidence_intervals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ci_method <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>  bootstrap_samples <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  plot_covariate_specific_rocs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_auc_by_covariate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_effect_estimates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_residual_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  adjustment_purpose <span class="op">=</span> <span class="st">"confounder"</span>,</span>
<span>  clinical_application <span class="op">=</span> <span class="st">"general"</span>,</span>
<span>  show_interpretation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  standardize_covariates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_handling <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  random_seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data as a data frame.</p></dd>


<dt id="arg-predictor">predictor<a class="anchor" aria-label="anchor" href="#arg-predictor"></a></dt>
<dd><p>Continuous diagnostic test variable (biomarker level,
imaging score, AI probability). The test whose accuracy varies by
covariates.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>Binary outcome variable (diseased vs non-diseased, positive
vs negative).</p></dd>


<dt id="arg-positive-level">positive_level<a class="anchor" aria-label="anchor" href="#arg-positive-level"></a></dt>
<dd><p>Which level represents the diseased/positive state.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Variables that may affect diagnostic accuracy. Examples:
age, sex, disease stage, scanner type, institution, staining batch. Both
continuous and categorical covariates supported.</p></dd>


<dt id="arg-covariate-effects">covariate_effects<a class="anchor" aria-label="anchor" href="#arg-covariate-effects"></a></dt>
<dd><p>Where to model covariate effects. "Both" allows
different effects in diseased and non-diseased groups, "sensitivity" models
effects only in diseased, "specificity" only in non-diseased.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method for ROC regression. Binormal assumes normal
distributions with covariate effects on location/scale, non-parametric uses
kernel smoothing, semi-parametric combines both, Bayesian provides
posterior distributions.</p></dd>


<dt id="arg-adjusted-auc">adjusted_auc<a class="anchor" aria-label="anchor" href="#arg-adjusted-auc"></a></dt>
<dd><p>Calculate population-averaged AUC adjusted for
covariates. This is the overall AUC accounting for covariate distribution
in the population.</p></dd>


<dt id="arg-covariate-specific-auc">covariate_specific_auc<a class="anchor" aria-label="anchor" href="#arg-covariate-specific-auc"></a></dt>
<dd><p>Calculate AUC at specific covariate values to
show how diagnostic accuracy varies across patient characteristics.</p></dd>


<dt id="arg-covariate-profiles">covariate_profiles<a class="anchor" aria-label="anchor" href="#arg-covariate-profiles"></a></dt>
<dd><p>Specify covariate values for covariate-specific
ROC curves. Example for age: "30, 50, 70" to get curves for
young/middle/elderly patients. Leave empty for automatic selection
(quartiles for continuous, all levels for categorical).</p></dd>


<dt id="arg-compare-unadjusted">compare_unadjusted<a class="anchor" aria-label="anchor" href="#arg-compare-unadjusted"></a></dt>
<dd><p>Show comparison between covariate-adjusted and
unadjusted (pooled) ROC analysis. Demonstrates impact of covariate
adjustment.</p></dd>


<dt id="arg-test-covariate-effects">test_covariate_effects<a class="anchor" aria-label="anchor" href="#arg-test-covariate-effects"></a></dt>
<dd><p>Perform statistical tests to determine if
covariates significantly affect diagnostic accuracy. Likelihood ratio tests
or Wald tests depending on method.</p></dd>


<dt id="arg-variable-selection">variable_selection<a class="anchor" aria-label="anchor" href="#arg-variable-selection"></a></dt>
<dd><p>Use stepwise or information criteria to select
which covariates to include in final model. Helpful with many potential
confounders.</p></dd>


<dt id="arg-selection-criterion">selection_criterion<a class="anchor" aria-label="anchor" href="#arg-selection-criterion"></a></dt>
<dd><p>Criterion for automatic variable selection.</p></dd>


<dt id="arg-test-interactions">test_interactions<a class="anchor" aria-label="anchor" href="#arg-test-interactions"></a></dt>
<dd><p>Test for interactions between covariates (e.g.,
does age effect differ by sex? does scanner effect vary by institution?).</p></dd>


<dt id="arg-confidence-intervals">confidence_intervals<a class="anchor" aria-label="anchor" href="#arg-confidence-intervals"></a></dt>
<dd><p>Calculate confidence intervals for
covariate-adjusted AUC and ROC curves.</p></dd>


<dt id="arg-ci-method">ci_method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>Method for confidence interval estimation. Bootstrap
recommended for small samples or non-parametric methods.</p></dd>


<dt id="arg-bootstrap-samples">bootstrap_samples<a class="anchor" aria-label="anchor" href="#arg-bootstrap-samples"></a></dt>
<dd><p>Number of bootstrap samples for CI estimation.</p></dd>


<dt id="arg-confidence-level">confidence_level<a class="anchor" aria-label="anchor" href="#arg-confidence-level"></a></dt>
<dd><p>Confidence level for intervals.</p></dd>


<dt id="arg-plot-covariate-specific-rocs">plot_covariate_specific_rocs<a class="anchor" aria-label="anchor" href="#arg-plot-covariate-specific-rocs"></a></dt>
<dd><p>Display multiple ROC curves for
different covariate profiles on same plot. Shows how ROC curve changes with
patient characteristics.</p></dd>


<dt id="arg-plot-auc-by-covariate">plot_auc_by_covariate<a class="anchor" aria-label="anchor" href="#arg-plot-auc-by-covariate"></a></dt>
<dd><p>For continuous covariates, plot how AUC
changes as covariate varies. Shows non-linear relationships between
covariates and diagnostic accuracy.</p></dd>


<dt id="arg-plot-effect-estimates">plot_effect_estimates<a class="anchor" aria-label="anchor" href="#arg-plot-effect-estimates"></a></dt>
<dd><p>Forest plot showing estimated covariate
effects on diagnostic accuracy with confidence intervals.</p></dd>


<dt id="arg-plot-residual-diagnostics">plot_residual_diagnostics<a class="anchor" aria-label="anchor" href="#arg-plot-residual-diagnostics"></a></dt>
<dd><p>Display residual plots and goodness-of-fit
diagnostics for ROC regression model.</p></dd>


<dt id="arg-adjustment-purpose">adjustment_purpose<a class="anchor" aria-label="anchor" href="#arg-adjustment-purpose"></a></dt>
<dd><p>Purpose of covariate adjustment for
interpretation guidance.</p></dd>


<dt id="arg-clinical-application">clinical_application<a class="anchor" aria-label="anchor" href="#arg-clinical-application"></a></dt>
<dd><p>Clinical application context for
interpretation.</p></dd>


<dt id="arg-show-interpretation">show_interpretation<a class="anchor" aria-label="anchor" href="#arg-show-interpretation"></a></dt>
<dd><p>Provide interpretation with clinical context and
recommendations.</p></dd>


<dt id="arg-standardize-covariates">standardize_covariates<a class="anchor" aria-label="anchor" href="#arg-standardize-covariates"></a></dt>
<dd><p>Standardize continuous covariates (mean 0, SD</p><ol><li><p>for better numerical stability and interpretability of effect sizes.</p></li>
</ol></dd>


<dt id="arg-missing-handling">missing_handling<a class="anchor" aria-label="anchor" href="#arg-missing-handling"></a></dt>
<dd><p>Method for handling missing covariate data.</p></dd>


<dt id="arg-random-seed">random_seed<a class="anchor" aria-label="anchor" href="#arg-random-seed"></a></dt>
<dd><p>Random seed for bootstrap and stochastic procedures.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A results object containing:</p><table class="table table"><tr><td><code>results$instructions</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$adjustedAUC</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$covariateEffects</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$covariateSpecificAUC</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$covariateROCPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$aucByCovPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$effectEstimatesPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$interpretation</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr></table><p>Tables can be converted to data frames with <code>asDF</code> or <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>. For example:</p>
<p><code>results$adjustedAUC$asDF</code></p>
<p><code>as.data.frame(results$adjustedAUC)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">rocreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">multi_center_data</span>,</span></span>
<span class="r-in"><span>    predictor <span class="op">=</span> <span class="st">"biomarker_level"</span>,</span></span>
<span class="r-in"><span>    outcome <span class="op">=</span> <span class="st">"disease_status"</span>,</span></span>
<span class="r-in"><span>    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"scanner_type"</span>, <span class="st">"center"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'multi_center_data' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

