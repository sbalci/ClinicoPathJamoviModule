<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clinical Heatmap with tidyheatmaps — clinicalheatmapClass • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clinical Heatmap with tidyheatmaps — clinicalheatmapClass"><meta name="description" content="Advanced heatmap visualization for clinical and biomedical data using the tidyheatmaps package.
This function creates publication-ready heatmaps from tidy data with support for clinical annotations,
multiple scaling methods, and comprehensive customization options. Perfect for visualizing biomarker
expression patterns, treatment responses, genomic data, and quality control metrics."><meta property="og:description" content="Advanced heatmap visualization for clinical and biomedical data using the tidyheatmaps package.
This function creates publication-ready heatmaps from tidy data with support for clinical annotations,
multiple scaling methods, and comprehensive customization options. Perfect for visualizing biomarker
expression patterns, treatment responses, genomic data, and quality control metrics."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clinical Heatmap with tidyheatmaps</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/clinicalheatmap.b.R" class="external-link"><code>R/clinicalheatmap.b.R</code></a></small>
      <div class="d-none name"><code>clinicalheatmapClass.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Advanced heatmap visualization for clinical and biomedical data using the tidyheatmaps package.
This function creates publication-ready heatmaps from tidy data with support for clinical annotations,
multiple scaling methods, and comprehensive customization options. Perfect for visualizing biomarker
expression patterns, treatment responses, genomic data, and quality control metrics.</p>
    </div>


    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A jamovi analysis object containing the clinical heatmap and supporting information</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Clinical Heatmap module leverages the powerful tidyheatmaps package to create sophisticated
visualizations of multivariate clinical data. It supports various data types and use cases:</p>
<p><strong>Supported Data Types:</strong></p><ul><li><p><strong>Biomarker Expression:</strong> IHC scores, molecular markers, protein levels</p></li>
<li><p><strong>Genomic Data:</strong> Gene expression, mutation status, copy number variations</p></li>
<li><p><strong>Clinical Metrics:</strong> Laboratory values, vital signs, diagnostic scores</p></li>
<li><p><strong>Quality Control:</strong> Batch effects, instrument performance, reproducibility</p></li>
<li><p><strong>Treatment Response:</strong> Longitudinal measurements, dose-response relationships</p></li>
</ul><p><strong>Key Features:</strong></p><ul><li><p><strong>Tidy Data Integration:</strong> Works directly with long-format clinical datasets</p></li>
<li><p><strong>Clinical Annotations:</strong> Row and column annotations for patient/biomarker characteristics</p></li>
<li><p><strong>Flexible Scaling:</strong> Row, column, or bidirectional Z-score normalization</p></li>
<li><p><strong>Hierarchical Clustering:</strong> Automatic pattern discovery with customizable clustering</p></li>
<li><p><strong>Color Palettes:</strong> Clinical-friendly color schemes including colorblind-safe options</p></li>
<li><p><strong>Missing Data Handling:</strong> Multiple strategies for incomplete clinical datasets</p></li>
<li><p><strong>Export Options:</strong> Publication-ready outputs with customizable dimensions</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="clinical-applications">Clinical Applications<a class="anchor" aria-label="anchor" href="#clinical-applications"></a></h2>


<ul><li><p><strong>Biomarker Profiling:</strong> Visualize multi-marker expression panels across patient cohorts</p></li>
<li><p><strong>Precision Medicine:</strong> Display genomic alterations and therapeutic targets</p></li>
<li><p><strong>Quality Assurance:</strong> Monitor laboratory performance and batch effects</p></li>
<li><p><strong>Clinical Trials:</strong> Show treatment response patterns and dose relationships</p></li>
<li><p><strong>Diagnostic Patterns:</strong> Reveal disease subtypes and molecular classifications</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="data-format-requirements">Data Format Requirements<a class="anchor" aria-label="anchor" href="#data-format-requirements"></a></h2>


<p>The function expects data in "tidy" (long) format with three essential variables:</p><ul><li><p><strong>Row Variable:</strong> Defines heatmap rows (e.g., patient IDs, gene names)</p></li>
<li><p><strong>Column Variable:</strong> Defines heatmap columns (e.g., biomarkers, time points)</p></li>
<li><p><strong>Value Variable:</strong> Numeric values to visualize (e.g., expression levels, scores)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="scaling-methods">Scaling Methods<a class="anchor" aria-label="anchor" href="#scaling-methods"></a></h2>


<ul><li><p><strong>None:</strong> Raw values displayed without transformation</p></li>
<li><p><strong>Row:</strong> Z-score normalization within each row (standardizes across columns)</p></li>
<li><p><strong>Column:</strong> Z-score normalization within each column (standardizes across rows)</p></li>
<li><p><strong>Both:</strong> Global Z-score normalization across entire dataset</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="missing-data-strategies">Missing Data Strategies<a class="anchor" aria-label="anchor" href="#missing-data-strategies"></a></h2>


<ul><li><p><strong>Exclude:</strong> Remove rows/columns with missing values (complete cases only)</p></li>
<li><p><strong>Mean:</strong> Replace missing values with column/row means</p></li>
<li><p><strong>Median:</strong> Replace missing values with column/row medians (robust to outliers)</p></li>
<li><p><strong>Zero:</strong> Replace missing values with zero (appropriate for some clinical scales)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html" class="external-link">jmvcore::Analysis</a></code> -&gt; <code>ClinicoPath::clinicalheatmapBase</code> -&gt; <code>clinicalheatmapClass</code></p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-clinicalheatmapClass-clone"><code>clinicalheatmapClass$clone()</code></a></p></li>
</ul></div><p><details><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".createImage"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.createImage"><code>jmvcore::Analysis$.createImage()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".createImages"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.createImages"><code>jmvcore::Analysis$.createImages()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".createPlotObject"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.createPlotObject"><code>jmvcore::Analysis$.createPlotObject()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".load"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.load"><code>jmvcore::Analysis$.load()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".render"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.render"><code>jmvcore::Analysis$.render()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".save"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.save"><code>jmvcore::Analysis$.save()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".savePart"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.savePart"><code>jmvcore::Analysis$.savePart()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setCheckpoint"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setCheckpoint"><code>jmvcore::Analysis$.setCheckpoint()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setParent"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setParent"><code>jmvcore::Analysis$.setParent()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setReadDatasetHeaderSource"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setReadDatasetHeaderSource"><code>jmvcore::Analysis$.setReadDatasetHeaderSource()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setReadDatasetSource"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setReadDatasetSource"><code>jmvcore::Analysis$.setReadDatasetSource()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setResourcesPathSource"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setResourcesPathSource"><code>jmvcore::Analysis$.setResourcesPathSource()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id=".setStatePathSource"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-.setStatePathSource"><code>jmvcore::Analysis$.setStatePathSource()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="addAddon"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-addAddon"><code>jmvcore::Analysis$addAddon()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="asProtoBuf"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-asProtoBuf"><code>jmvcore::Analysis$asProtoBuf()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="asSource"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-asSource"><code>jmvcore::Analysis$asSource()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="check"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-check"><code>jmvcore::Analysis$check()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="init"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-init"><code>jmvcore::Analysis$init()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="optionsChangedHandler"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-optionsChangedHandler"><code>jmvcore::Analysis$optionsChangedHandler()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="postInit"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-postInit"><code>jmvcore::Analysis$postInit()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="print"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-print"><code>jmvcore::Analysis$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="readDataset"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-readDataset"><code>jmvcore::Analysis$readDataset()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="run"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-run"><code>jmvcore::Analysis$run()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="serialize"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-serialize"><code>jmvcore::Analysis$serialize()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="setError"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-setError"><code>jmvcore::Analysis$setError()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="setStatus"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-setStatus"><code>jmvcore::Analysis$setStatus()</code></a></span></li>
<li><span class="pkg-link" data-pkg="jmvcore" data-topic="Analysis" data-id="translate"><a href="https://rdrr.io/pkg/jmvcore/man/Analysis.html#method-translate"><code>jmvcore::Analysis$translate()</code></a></span></li>
<li><span class="pkg-link" data-pkg="ClinicoPath" data-topic="clinicalheatmapBase" data-id="initialize"><a href="clinicalheatmapBase.html#method-initialize"><code>ClinicoPath::clinicalheatmapBase$initialize()</code></a></span></li>
</ul></details></p><hr><a id="method-clinicalheatmapClass-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">clinicalheatmapClass</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># TODO: Add proper examples with working datasets</span></span></span>
<span class="r-in"><span><span class="co"># Currently commented to prevent installation errors</span></span></span>
<span class="r-in"><span><span class="co"># Need to use existing datasets from ClinicoPathDescriptives</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># # Example 1: Basic biomarker heatmap</span></span></span>
<span class="r-in"><span><span class="co"># data(histopathology)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># # Create sample biomarker data in long format</span></span></span>
<span class="r-in"><span><span class="co"># biomarker_data &lt;- data.frame(</span></span></span>
<span class="r-in"><span><span class="co">#   patient_id = rep(paste0("P", 1:50), each = 4),</span></span></span>
<span class="r-in"><span><span class="co">#   biomarker = rep(c("ER", "PR", "HER2", "Ki67"), 50),</span></span></span>
<span class="r-in"><span><span class="co">#   expression = rnorm(200, mean = 50, sd = 20)</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># clinicalheatmap(</span></span></span>
<span class="r-in"><span><span class="co">#   data = biomarker_data,</span></span></span>
<span class="r-in"><span><span class="co">#   rowVar = "patient_id",</span></span></span>
<span class="r-in"><span><span class="co">#   colVar = "biomarker",</span></span></span>
<span class="r-in"><span><span class="co">#   valueVar = "expression",</span></span></span>
<span class="r-in"><span><span class="co">#   scaleMethod = "row",</span></span></span>
<span class="r-in"><span><span class="co">#   colorPalette = "RdBu"</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># # Example 2: Gene expression with clinical annotations</span></span></span>
<span class="r-in"><span><span class="co"># gene_data &lt;- expand.grid(</span></span></span>
<span class="r-in"><span><span class="co">#   sample_id = paste0("S", 1:30),</span></span></span>
<span class="r-in"><span><span class="co">#   gene = paste0("Gene", 1:20)</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="co"># gene_data$expression &lt;- rnorm(nrow(gene_data), mean = 0, sd = 1)</span></span></span>
<span class="r-in"><span><span class="co"># gene_data$tumor_type &lt;- rep(c("TypeA", "TypeB", "TypeC"), length.out = 30)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># clinicalheatmap(</span></span></span>
<span class="r-in"><span><span class="co">#   data = gene_data,</span></span></span>
<span class="r-in"><span><span class="co">#   rowVar = "sample_id",</span></span></span>
<span class="r-in"><span><span class="co">#   colVar = "gene",</span></span></span>
<span class="r-in"><span><span class="co">#   valueVar = "expression",</span></span></span>
<span class="r-in"><span><span class="co">#   annotationCols = "tumor_type",</span></span></span>
<span class="r-in"><span><span class="co">#   scaleMethod = "column",</span></span></span>
<span class="r-in"><span><span class="co">#   clusterRows = TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#   clusterCols = TRUE</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

