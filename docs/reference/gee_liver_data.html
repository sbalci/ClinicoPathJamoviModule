<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Example Liver Pathology Data for GEE Analysis — gee_liver_data • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example Liver Pathology Data for GEE Analysis — gee_liver_data"><meta name="description" content="Simulated dataset of liver biopsies from dogs with multiple samples per subject.
This dataset is designed to demonstrate Generalized Estimating Equations (GEE)
analysis for correlated/clustered data common in pathology studies."><meta property="og:description" content="Simulated dataset of liver biopsies from dogs with multiple samples per subject.
This dataset is designed to demonstrate Generalized Estimating Equations (GEE)
analysis for correlated/clustered data common in pathology studies."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example Liver Pathology Data for GEE Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/gee_liver_data_documentation.R" class="external-link"><code>R/gee_liver_data_documentation.R</code></a></small>
      <div class="d-none name"><code>gee_liver_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulated dataset of liver biopsies from dogs with multiple samples per subject.
This dataset is designed to demonstrate Generalized Estimating Equations (GEE)
analysis for correlated/clustered data common in pathology studies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">gee_liver_data</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 135 observations and 10 variables:</p><dl><dt>dog_id</dt>
<dd><p>Factor. Unique identifier for each dog (cluster ID)</p></dd>

<dt>sample_number</dt>
<dd><p>Integer. Sequential sample number for each dog (1-4)</p></dd>

<dt>time_point</dt>
<dd><p>Integer. Time sequence for longitudinal analysis</p></dd>

<dt>age</dt>
<dd><p>Numeric. Dog's age in years</p></dd>

<dt>breed</dt>
<dd><p>Factor. Dog breed (Labrador, German Shepherd, Poodle, Mixed)</p></dd>

<dt>sample_method</dt>
<dd><p>Factor. Biopsy method (Fine Needle, Core Biopsy, Surgical)</p></dd>

<dt>pathologist_experience</dt>
<dd><p>Numeric. Years of pathologist experience (5, 10, 15, 20)</p></dd>

<dt>fibrosis_score</dt>
<dd><p>Numeric. Liver fibrosis score (0-6 scale, continuous)</p></dd>

<dt>diagnosis</dt>
<dd><p>Factor. Binary diagnosis (Negative, Positive)</p></dd>

<dt>cell_count</dt>
<dd><p>Integer. Inflammatory cell count (Poisson distributed)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Simulated data generated using <code>data-raw/gee_example_data.R</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Study Design:</strong></p><ul><li><p>50 dogs with 2-4 liver samples each (unbalanced design)</p></li>
<li><p>Samples from the same dog are correlated</p></li>
<li><p>Represents typical veterinary pathology study with multiple biopsies</p></li>
</ul><p><strong>Clinical Context:</strong>
In veterinary pathology, multiple liver samples are often taken from the same
animal to assess disease distribution and severity. These samples are not
independent, requiring GEE or mixed models for proper statistical analysis.</p>
<p><strong>Correlation Structure:</strong></p><ul><li><p><strong>Within-dog correlation</strong>: Samples from the same dog share baseline characteristics</p></li>
<li><p><strong>Exchangeable structure</strong>: Recommended for this data (samples equally correlated)</p></li>
<li><p><strong>AR(1) structure</strong>: Can be used if time_point represents sequential sampling</p></li>
</ul><p><strong>Example Analyses:</strong></p><ol><li><p><strong>Binary Outcome (Diagnosis):</strong></p><div class="sourceCode"><pre><code><span></span>
<span><span class="co"># Predicting diagnosis from fibrosis score and age</span></span>
<span><span class="fu"><a href="../reference/geemodel.html">geemodel</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gee_liver_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">'diagnosis'</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'fibrosis_score'</span>, <span class="st">'age'</span>, <span class="st">'sample_method'</span><span class="op">)</span>,</span>
<span>  cluster_id <span class="op">=</span> <span class="st">'dog_id'</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'binomial'</span>,</span>
<span>  corstr <span class="op">=</span> <span class="st">'exchangeable'</span>,</span>
<span>  robust_se <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div></li>
<li><p><strong>Count Outcome (Cell Count):</strong></p><div class="sourceCode"><pre><code><span></span>
<span><span class="co"># Modeling inflammatory cell count</span></span>
<span><span class="fu"><a href="../reference/geemodel.html">geemodel</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gee_liver_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">'cell_count'</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'fibrosis_score'</span>, <span class="st">'breed'</span><span class="op">)</span>,</span>
<span>  cluster_id <span class="op">=</span> <span class="st">'dog_id'</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'poisson'</span>,</span>
<span>  corstr <span class="op">=</span> <span class="st">'exchangeable'</span>,</span>
<span>  robust_se <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div></li>
<li><p><strong>Continuous Outcome (Fibrosis Score):</strong></p><div class="sourceCode"><pre><code><span></span>
<span><span class="co"># Predicting fibrosis from age and sample method</span></span>
<span><span class="fu"><a href="../reference/geemodel.html">geemodel</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gee_liver_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">'fibrosis_score'</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'age'</span>, <span class="st">'sample_method'</span>, <span class="st">'pathologist_experience'</span><span class="op">)</span>,</span>
<span>  cluster_id <span class="op">=</span> <span class="st">'dog_id'</span>,</span>
<span>  family <span class="op">=</span> <span class="st">'gaussian'</span>,</span>
<span>  corstr <span class="op">=</span> <span class="st">'exchangeable'</span>,</span>
<span>  robust_se <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div></li>
</ol><p><strong>Why GEE is Needed:</strong></p><ul><li><p>Standard regression assumes independent observations</p></li>
<li><p>Multiple samples per dog violate independence assumption</p></li>
<li><p>GEE accounts for within-dog correlation</p></li>
<li><p>Provides valid standard errors and inference</p></li>
</ul><p><strong>Data Generation:</strong>
Data was simulated with realistic correlations:</p><ul><li><p>Dogs with higher age tend to have higher fibrosis scores</p></li>
<li><p>Samples from the same dog share baseline disease severity</p></li>
<li><p>Diagnosis probability increases with fibrosis score and age</p></li>
<li><p>Sample method affects diagnostic accuracy</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="geemodel.html">geemodel()</a></code> for GEE analysis function</p></li>
<li><p><code><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geepack::geeglm()</a></code> for the underlying GEE implementation</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gee_liver_data</span>, package <span class="op">=</span> <span class="st">"ClinicoPath"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View structure</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">gee_liver_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	125 obs. of  10 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dog_id                : Factor w/ 50 levels "Dog_001","Dog_002",..: 1 1 2 2 3 3 4 4 5 5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sample_number         : int  1 2 1 2 1 2 1 2 1 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ time_point            : int  1 2 1 2 1 2 1 2 1 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ age                   : num  8.7 8.7 3.6 3.6 0.7 0.7 5.2 5.2 7 7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ breed                 : Factor w/ 4 levels "German Shepherd",..: 2 2 3 3 2 2 3 3 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sample_method         : Factor w/ 3 levels "Core Biopsy",..: 1 1 1 2 1 2 1 3 2 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pathologist_experience: num  20 15 15 5 10 5 15 10 10 15 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ fibrosis_score        : num  3.6 3.9 3.5 2.3 0.1 0.9 0.2 0.4 1 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ diagnosis             : Factor w/ 2 levels "Negative","Positive": 1 1 2 1 2 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ cell_count            : int  8 15 12 6 2 3 7 5 4 4 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check cluster sizes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">gee_liver_data</span><span class="op">$</span><span class="va">dog_id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2  3  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 15  5 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Summary statistics by diagnosis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">fibrosis_score</span> <span class="op">~</span> <span class="va">diagnosis</span>, data <span class="op">=</span> <span class="va">gee_liver_data</span>,</span></span>
<span class="r-in"><span>          FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   diagnosis fibrosis_score.mean fibrosis_score.sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Negative            1.535211          1.065444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Positive            2.255769          1.112745</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

