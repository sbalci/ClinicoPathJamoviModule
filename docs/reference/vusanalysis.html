<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Volume Under ROC Surface (VUS) Analysis — vusanalysis • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Volume Under ROC Surface (VUS) Analysis — vusanalysis"><meta name="description" content="Volume Under ROC Surface (VUS) analysis extends the traditional Area Under
the ROC Curve (AUC) to diagnostic tests with three or more ordered classes.
While binary ROC analysis calculates the area under a 2D curve, VUS
calculates the volume under a 3D surface for multi-class problems. The VUS
represents the probability that a randomly selected triple of observations
(one from each class) will be correctly ordered by the diagnostic marker.
VUS ranges from 0 to 1, where 0.5 indicates random classification (no
discrimination), and 1 indicates perfect discrimination across all classes.
This method is particularly valuable for tumor grading (Grade 1/2/3),
disease staging (Stage I/II/III/IV), severity classification
(mild/moderate/severe), and any diagnostic scenario where outcomes
naturally fall into three or more ordered categories. The analysis provides
pairwise AUC comparisons between adjacent classes, overall VUS with
confidence intervals, and hypothesis testing against chance performance.
Essential for validating biomarkers, imaging features, and AI models in
multi-class clinicopathological applications where binary classification is
insufficient."><meta property="og:description" content="Volume Under ROC Surface (VUS) analysis extends the traditional Area Under
the ROC Curve (AUC) to diagnostic tests with three or more ordered classes.
While binary ROC analysis calculates the area under a 2D curve, VUS
calculates the volume under a 3D surface for multi-class problems. The VUS
represents the probability that a randomly selected triple of observations
(one from each class) will be correctly ordered by the diagnostic marker.
VUS ranges from 0 to 1, where 0.5 indicates random classification (no
discrimination), and 1 indicates perfect discrimination across all classes.
This method is particularly valuable for tumor grading (Grade 1/2/3),
disease staging (Stage I/II/III/IV), severity classification
(mild/moderate/severe), and any diagnostic scenario where outcomes
naturally fall into three or more ordered categories. The analysis provides
pairwise AUC comparisons between adjacent classes, overall VUS with
confidence intervals, and hypothesis testing against chance performance.
Essential for validating biomarkers, imaging features, and AI models in
multi-class clinicopathological applications where binary classification is
insufficient."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Volume Under ROC Surface (VUS) Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/vusanalysis.h.R" class="external-link"><code>R/vusanalysis.h.R</code></a></small>
      <div class="d-none name"><code>vusanalysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Volume Under ROC Surface (VUS) analysis extends the traditional Area Under
the ROC Curve (AUC) to diagnostic tests with three or more ordered classes.
While binary ROC analysis calculates the area under a 2D curve, VUS
calculates the volume under a 3D surface for multi-class problems. The VUS
represents the probability that a randomly selected triple of observations
(one from each class) will be correctly ordered by the diagnostic marker.
VUS ranges from 0 to 1, where 0.5 indicates random classification (no
discrimination), and 1 indicates perfect discrimination across all classes.
This method is particularly valuable for tumor grading (Grade 1/2/3),
disease staging (Stage I/II/III/IV), severity classification
(mild/moderate/severe), and any diagnostic scenario where outcomes
naturally fall into three or more ordered categories. The analysis provides
pairwise AUC comparisons between adjacent classes, overall VUS with
confidence intervals, and hypothesis testing against chance performance.
Essential for validating biomarkers, imaging features, and AI models in
multi-class clinicopathological applications where binary classification is
insufficient.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vusanalysis</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">predictor</span>,</span>
<span>  <span class="va">multiclass_outcome</span>,</span>
<span>  outcome_order <span class="op">=</span> <span class="st">""</span>,</span>
<span>  vus_method <span class="op">=</span> <span class="st">"mann_whitney"</span>,</span>
<span>  confidence_intervals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ci_method <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>  bootstrap_samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  hypothesis_test <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_method <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>  pairwise_auc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise_tests <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_class_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  covariate_adjustment <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">covariates</span>,</span>
<span>  stratified_analysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">stratify_by</span>,</span>
<span>  plot_3d_surface <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_pairwise_rocs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_class_distributions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  handle_ties <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  random_seed <span class="op">=</span> <span class="fl">12345</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data as a data frame.</p></dd>


<dt id="arg-predictor">predictor<a class="anchor" aria-label="anchor" href="#arg-predictor"></a></dt>
<dd><p>Continuous predictor variable (biomarker, risk score,
imaging feature). Should be numeric with higher values generally indicating
higher class membership.</p></dd>


<dt id="arg-multiclass-outcome">multiclass_outcome<a class="anchor" aria-label="anchor" href="#arg-multiclass-outcome"></a></dt>
<dd><p>Outcome variable with 3 or more ordered classes.
Examples: tumor grade (1/2/3), disease stage (I/II/III/IV), severity
(mild/moderate/severe).</p></dd>


<dt id="arg-outcome-order">outcome_order<a class="anchor" aria-label="anchor" href="#arg-outcome-order"></a></dt>
<dd><p>Comma-separated list specifying the order of outcome
classes from low to high. Example: "Grade 1, Grade 2, Grade 3". If not
specified, factor levels are used.</p></dd>


<dt id="arg-vus-method">vus_method<a class="anchor" aria-label="anchor" href="#arg-vus-method"></a></dt>
<dd><p>Method for VUS estimation. Mann-Whitney is most robust
and recommended for general use. Normal theory assumes multivariate
normality. Bootstrap provides non-parametric confidence intervals.</p></dd>


<dt id="arg-confidence-intervals">confidence_intervals<a class="anchor" aria-label="anchor" href="#arg-confidence-intervals"></a></dt>
<dd><p>Calculate confidence intervals for VUS using
specified method.</p></dd>


<dt id="arg-ci-method">ci_method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>Method for confidence interval calculation. Bootstrap is
recommended for most applications. BCa provides bias-corrected intervals.</p></dd>


<dt id="arg-bootstrap-samples">bootstrap_samples<a class="anchor" aria-label="anchor" href="#arg-bootstrap-samples"></a></dt>
<dd><p>Number of bootstrap resamples for confidence
intervals and hypothesis testing.</p></dd>


<dt id="arg-confidence-level">confidence_level<a class="anchor" aria-label="anchor" href="#arg-confidence-level"></a></dt>
<dd><p>Confidence level for interval estimation.</p></dd>


<dt id="arg-hypothesis-test">hypothesis_test<a class="anchor" aria-label="anchor" href="#arg-hypothesis-test"></a></dt>
<dd><p>Test null hypothesis: VUS = 1/6 (random
classification for 3 classes). For k classes, null VUS = 1/k!</p></dd>


<dt id="arg-test-method">test_method<a class="anchor" aria-label="anchor" href="#arg-test-method"></a></dt>
<dd><p>Method for hypothesis testing. Bootstrap and permutation
are robust to distributional assumptions.</p></dd>


<dt id="arg-pairwise-auc">pairwise_auc<a class="anchor" aria-label="anchor" href="#arg-pairwise-auc"></a></dt>
<dd><p>Calculate AUC for all pairwise class comparisons. Helps
identify which class transitions are well-discriminated.</p></dd>


<dt id="arg-pairwise-ci">pairwise_ci<a class="anchor" aria-label="anchor" href="#arg-pairwise-ci"></a></dt>
<dd><p>Calculate confidence intervals for pairwise AUC
comparisons.</p></dd>


<dt id="arg-pairwise-tests">pairwise_tests<a class="anchor" aria-label="anchor" href="#arg-pairwise-tests"></a></dt>
<dd><p>Test whether each pairwise AUC differs significantly
from 0.5.</p></dd>


<dt id="arg-min-class-size">min_class_size<a class="anchor" aria-label="anchor" href="#arg-min-class-size"></a></dt>
<dd><p>Minimum number of observations required per class for
analysis. Smaller classes may produce unstable estimates.</p></dd>


<dt id="arg-covariate-adjustment">covariate_adjustment<a class="anchor" aria-label="anchor" href="#arg-covariate-adjustment"></a></dt>
<dd><p>Adjust VUS for covariates (experimental
feature). Useful for controlling confounding factors.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Covariates for adjustment (age, sex, site, etc.).
Requires covariate_adjustment = TRUE.</p></dd>


<dt id="arg-stratified-analysis">stratified_analysis<a class="anchor" aria-label="anchor" href="#arg-stratified-analysis"></a></dt>
<dd><p>Calculate VUS stratified by subgroups to assess
consistency across populations.</p></dd>


<dt id="arg-stratify-by">stratify_by<a class="anchor" aria-label="anchor" href="#arg-stratify-by"></a></dt>
<dd><p>Variable for stratified analysis (e.g., age group,
disease subtype).</p></dd>


<dt id="arg-plot-d-surface">plot_3d_surface<a class="anchor" aria-label="anchor" href="#arg-plot-d-surface"></a></dt>
<dd><p>Generate 3D visualization of ROC surface (requires
additional packages). Warning: May be computationally intensive for large
datasets.</p></dd>


<dt id="arg-plot-pairwise-rocs">plot_pairwise_rocs<a class="anchor" aria-label="anchor" href="#arg-plot-pairwise-rocs"></a></dt>
<dd><p>Plot ROC curves for all pairwise class
comparisons.</p></dd>


<dt id="arg-plot-class-distributions">plot_class_distributions<a class="anchor" aria-label="anchor" href="#arg-plot-class-distributions"></a></dt>
<dd><p>Display predictor distributions by outcome
class (box plots or density plots).</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>Type of plot for showing predictor distributions across
classes.</p></dd>


<dt id="arg-handle-ties">handle_ties<a class="anchor" aria-label="anchor" href="#arg-handle-ties"></a></dt>
<dd><p>Method for handling tied predictor values. Average ranks
is standard for Mann-Whitney based calculations.</p></dd>


<dt id="arg-random-seed">random_seed<a class="anchor" aria-label="anchor" href="#arg-random-seed"></a></dt>
<dd><p>Random seed for bootstrap and permutation procedures.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A results object containing:</p><table class="table table"><tr><td><code>results$instructions</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$vusSummary</code></td><td></td><td></td><td></td><td></td><td>Overall VUS with confidence intervals</td></tr><tr><td><code>results$hypothesisTest</code></td><td></td><td></td><td></td><td></td><td>Test whether VUS differs from random classification</td></tr><tr><td><code>results$classBreakdown</code></td><td></td><td></td><td></td><td></td><td>Sample sizes and summary statistics by class</td></tr><tr><td><code>results$pairwiseAUC</code></td><td></td><td></td><td></td><td></td><td>AUC for all pairwise class comparisons</td></tr><tr><td><code>results$stratifiedVUS</code></td><td></td><td></td><td></td><td></td><td>VUS by subgroup</td></tr><tr><td><code>results$pairwiseROCPlot</code></td><td></td><td></td><td></td><td></td><td>ROC curves for all pairwise class comparisons</td></tr><tr><td><code>results$classDistributionPlot</code></td><td></td><td></td><td></td><td></td><td>Distribution of predictor values across outcome classes</td></tr><tr><td><code>results$surface3DPlot</code></td><td></td><td></td><td></td><td></td><td>Three-dimensional ROC surface visualization</td></tr><tr><td><code>results$interpretation</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr></table><p>Tables can be converted to data frames with <code>asDF</code> or <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>. For example:</p>
<p><code>results$vusSummary$asDF</code></p>
<p><code>as.data.frame(results$vusSummary)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">vusanalysis</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">tumor_data</span>,</span></span>
<span class="r-in"><span>    predictor <span class="op">=</span> <span class="st">"biomarker_score"</span>,</span></span>
<span class="r-in"><span>    multiclass_outcome <span class="op">=</span> <span class="st">"tumor_grade"</span>,</span></span>
<span class="r-in"><span>    outcome_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grade 1"</span>, <span class="st">"Grade 2"</span>, <span class="st">"Grade 3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tumor_data' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

