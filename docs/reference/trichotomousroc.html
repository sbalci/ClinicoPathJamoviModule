<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trichotomous (Three-way) ROC Analysis — trichotomousroc • ClinicoPath</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trichotomous (Three-way) ROC Analysis — trichotomousroc"><meta name="description" content='Trichotomous ROC analysis for three-category diagnostic tests with
positive, indeterminate (grey zone), and negative outcomes. Essential for
biomarker scoring systems like HER2 (0-1+/2+/3+), PD-L1 expression levels,
and cytology classifications with "atypical" results. Unlike binary ROC
which only considers positive vs negative, trichotomous ROC accounts for
the clinically important indeterminate zone where additional testing may be
required. The analysis provides 3×3 confusion matrices, category-specific
sensitivities and specificities, volume under the ROC surface (VUS) as a 3D
extension of AUC, and optimal threshold determination for each decision
boundary. Particularly valuable for establishing clinical cutoffs in
molecular pathology where grey-zone results trigger reflex testing (e.g.,
HER2 2+ requires FISH confirmation).'><meta property="og:description" content='Trichotomous ROC analysis for three-category diagnostic tests with
positive, indeterminate (grey zone), and negative outcomes. Essential for
biomarker scoring systems like HER2 (0-1+/2+/3+), PD-L1 expression levels,
and cytology classifications with "atypical" results. Unlike binary ROC
which only considers positive vs negative, trichotomous ROC accounts for
the clinically important indeterminate zone where additional testing may be
required. The analysis provides 3×3 confusion matrices, category-specific
sensitivities and specificities, volume under the ROC surface (VUS) as a 3D
extension of AUC, and optimal threshold determination for each decision
boundary. Particularly valuable for establishing clinical cutoffs in
molecular pathology where grey-zone results trigger reflex testing (e.g.,
HER2 2+ requires FISH confirmation).'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.32.72</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-test-data" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-database"></span> Test Data</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-test-data"><li><a class="dropdown-item" href="../articles/test-data-catalog.html">Test Data Catalog</a></li>
    <li><a class="dropdown-item" href="../articles/test-data-complete-catalog.html">Complete Catalog (945 files)</a></li>
    <li><a class="dropdown-item" href="../articles/function-reference.html">Function Reference</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Trichotomous (Three-way) ROC Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/R/trichotomousroc.h.R" class="external-link"><code>R/trichotomousroc.h.R</code></a></small>
      <div class="d-none name"><code>trichotomousroc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Trichotomous ROC analysis for three-category diagnostic tests with
positive, indeterminate (grey zone), and negative outcomes. Essential for
biomarker scoring systems like HER2 (0-1+/2+/3+), PD-L1 expression levels,
and cytology classifications with "atypical" results. Unlike binary ROC
which only considers positive vs negative, trichotomous ROC accounts for
the clinically important indeterminate zone where additional testing may be
required. The analysis provides 3×3 confusion matrices, category-specific
sensitivities and specificities, volume under the ROC surface (VUS) as a 3D
extension of AUC, and optimal threshold determination for each decision
boundary. Particularly valuable for establishing clinical cutoffs in
molecular pathology where grey-zone results trigger reflex testing (e.g.,
HER2 2+ requires FISH confirmation).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trichotomousroc</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">predictor</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">positive_level</span>,</span>
<span>  <span class="va">indeterminate_level</span>,</span>
<span>  <span class="va">negative_level</span>,</span>
<span>  threshold_method <span class="op">=</span> <span class="st">"youden"</span>,</span>
<span>  lower_threshold <span class="op">=</span> <span class="fl">0.33</span>,</span>
<span>  upper_threshold <span class="op">=</span> <span class="fl">0.67</span>,</span>
<span>  cost_fn <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cost_fp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cost_indeterminate <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  bootstrap_samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  bootstrap_method <span class="op">=</span> <span class="st">"bca"</span>,</span>
<span>  calculate_vus <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  category_sensitivities <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pairwise_comparisons <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  confusion_matrix_3x3 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_3d_surface <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_threshold_analysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_category_distributions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_pairwise_rocs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clinical_context <span class="op">=</span> <span class="st">"general"</span>,</span>
<span>  show_clinical_interpretation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  indeterminate_action <span class="op">=</span> <span class="st">"test"</span>,</span>
<span>  stratified_analysis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">stratify_by</span>,</span>
<span>  missing_handling <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  random_seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data as a data frame.</p></dd>


<dt id="arg-predictor">predictor<a class="anchor" aria-label="anchor" href="#arg-predictor"></a></dt>
<dd><p>Continuous predictor variable (e.g., IHC H-score, gene
expression level, AI probability score) used to classify cases into three
categories.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>Three-level gold standard outcome variable defining the true
classification (positive/indeterminate/negative or
diseased/borderline/healthy).</p></dd>


<dt id="arg-positive-level">positive_level<a class="anchor" aria-label="anchor" href="#arg-positive-level"></a></dt>
<dd><p>Level of the outcome variable representing definite
positive/diseased cases.</p></dd>


<dt id="arg-indeterminate-level">indeterminate_level<a class="anchor" aria-label="anchor" href="#arg-indeterminate-level"></a></dt>
<dd><p>Level of the outcome variable representing
indeterminate/borderline/grey zone cases.</p></dd>


<dt id="arg-negative-level">negative_level<a class="anchor" aria-label="anchor" href="#arg-negative-level"></a></dt>
<dd><p>Level of the outcome variable representing definite
negative/non-diseased cases.</p></dd>


<dt id="arg-threshold-method">threshold_method<a class="anchor" aria-label="anchor" href="#arg-threshold-method"></a></dt>
<dd><p>Method for determining the two thresholds that
separate the three categories. Youden maximizes overall correct
classification, clinical uses cost-benefit analysis, fixed allows manual
threshold specification, tertile divides into equal thirds.</p></dd>


<dt id="arg-lower-threshold">lower_threshold<a class="anchor" aria-label="anchor" href="#arg-lower-threshold"></a></dt>
<dd><p>Lower threshold value when using fixed threshold
method. Values below this are classified as negative. Required when
threshold_method = 'fixed'.</p></dd>


<dt id="arg-upper-threshold">upper_threshold<a class="anchor" aria-label="anchor" href="#arg-upper-threshold"></a></dt>
<dd><p>Upper threshold value when using fixed threshold
method. Values above this are classified as positive. Required when
threshold_method = 'fixed'.</p></dd>


<dt id="arg-cost-fn">cost_fn<a class="anchor" aria-label="anchor" href="#arg-cost-fn"></a></dt>
<dd><p>Relative cost of misclassifying a positive case as negative.
Higher values increase sensitivity at expense of specificity.</p></dd>


<dt id="arg-cost-fp">cost_fp<a class="anchor" aria-label="anchor" href="#arg-cost-fp"></a></dt>
<dd><p>Relative cost of misclassifying a negative case as positive.
Higher values increase specificity at expense of sensitivity.</p></dd>


<dt id="arg-cost-indeterminate">cost_indeterminate<a class="anchor" aria-label="anchor" href="#arg-cost-indeterminate"></a></dt>
<dd><p>Relative cost of classifying a case as
indeterminate (requiring additional testing). Typically lower than definite
misclassification but higher than correct classification.</p></dd>


<dt id="arg-confidence-level">confidence_level<a class="anchor" aria-label="anchor" href="#arg-confidence-level"></a></dt>
<dd><p>Confidence level for intervals around VUS and
performance metrics.</p></dd>


<dt id="arg-bootstrap-samples">bootstrap_samples<a class="anchor" aria-label="anchor" href="#arg-bootstrap-samples"></a></dt>
<dd><p>Number of bootstrap samples for confidence
interval estimation. More samples provide more stable estimates but
increase computation time.</p></dd>


<dt id="arg-bootstrap-method">bootstrap_method<a class="anchor" aria-label="anchor" href="#arg-bootstrap-method"></a></dt>
<dd><p>Bootstrap confidence interval method. BCa provides
bias-corrected intervals.</p></dd>


<dt id="arg-calculate-vus">calculate_vus<a class="anchor" aria-label="anchor" href="#arg-calculate-vus"></a></dt>
<dd><p>Calculate Volume Under the ROC Surface, the 3D
extension of AUC for three categories. VUS ranges from 0 to 1, where 0.167
represents random classification and 1 represents perfect classification.
Values &gt; 0.167 indicate discriminatory ability.</p></dd>


<dt id="arg-category-sensitivities">category_sensitivities<a class="anchor" aria-label="anchor" href="#arg-category-sensitivities"></a></dt>
<dd><p>Calculate sensitivity for each category
(ability to correctly identify positive, indeterminate, and negative cases
respectively).</p></dd>


<dt id="arg-pairwise-comparisons">pairwise_comparisons<a class="anchor" aria-label="anchor" href="#arg-pairwise-comparisons"></a></dt>
<dd><p>Perform binary ROC analysis for all three
pairwise comparisons: positive vs negative (ignoring indeterminate),
positive vs indeterminate, and indeterminate vs negative.</p></dd>


<dt id="arg-confusion-matrix-x-">confusion_matrix_3x3<a class="anchor" aria-label="anchor" href="#arg-confusion-matrix-x-"></a></dt>
<dd><p>Display full 3×3 confusion matrix showing all
possible classification outcomes. Rows represent true categories, columns
represent predicted categories.</p></dd>


<dt id="arg-plot-d-surface">plot_3d_surface<a class="anchor" aria-label="anchor" href="#arg-plot-d-surface"></a></dt>
<dd><p>Create 3D visualization of the ROC surface. The
surface extends the 2D ROC curve to three dimensions, showing
classification performance across all threshold combinations.</p></dd>


<dt id="arg-plot-threshold-analysis">plot_threshold_analysis<a class="anchor" aria-label="anchor" href="#arg-plot-threshold-analysis"></a></dt>
<dd><p>Plot showing how classification metrics vary
with different threshold combinations. Helps visualize the trade-off
between definite and indeterminate classifications.</p></dd>


<dt id="arg-plot-category-distributions">plot_category_distributions<a class="anchor" aria-label="anchor" href="#arg-plot-category-distributions"></a></dt>
<dd><p>Display distribution of predictor scores
for each outcome category with threshold lines showing decision boundaries.</p></dd>


<dt id="arg-plot-pairwise-rocs">plot_pairwise_rocs<a class="anchor" aria-label="anchor" href="#arg-plot-pairwise-rocs"></a></dt>
<dd><p>Show the three pairwise binary ROC curves for
comparison with the trichotomous analysis.</p></dd>


<dt id="arg-clinical-context">clinical_context<a class="anchor" aria-label="anchor" href="#arg-clinical-context"></a></dt>
<dd><p>Clinical context for interpretation assistance.
Provides context-specific guidance on threshold selection and clinical
implications.</p></dd>


<dt id="arg-show-clinical-interpretation">show_clinical_interpretation<a class="anchor" aria-label="anchor" href="#arg-show-clinical-interpretation"></a></dt>
<dd><p>Provide clinical interpretation of
results including recommendations for threshold use and implications for
patient management.</p></dd>


<dt id="arg-indeterminate-action">indeterminate_action<a class="anchor" aria-label="anchor" href="#arg-indeterminate-action"></a></dt>
<dd><p>Specify the clinical action for cases
classified as indeterminate. This affects the interpretation of diagnostic
performance metrics.</p></dd>


<dt id="arg-stratified-analysis">stratified_analysis<a class="anchor" aria-label="anchor" href="#arg-stratified-analysis"></a></dt>
<dd><p>Perform stratified trichotomous ROC analysis by
important subgroups to assess consistency across populations.</p></dd>


<dt id="arg-stratify-by">stratify_by<a class="anchor" aria-label="anchor" href="#arg-stratify-by"></a></dt>
<dd><p>Variable defining strata for stratified analysis. Each
level will receive separate trichotomous ROC analysis.</p></dd>


<dt id="arg-missing-handling">missing_handling<a class="anchor" aria-label="anchor" href="#arg-missing-handling"></a></dt>
<dd><p>Method for handling missing data in predictor or
outcome variables.</p></dd>


<dt id="arg-random-seed">random_seed<a class="anchor" aria-label="anchor" href="#arg-random-seed"></a></dt>
<dd><p>Random seed for bootstrap sampling. Ensures reproducible
results.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A results object containing:</p><table class="table table"><tr><td><code>results$instructions</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr><tr><td><code>results$performanceSummary</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$vusTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$thresholdsTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$confusionMatrix3x3</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$categorySensitivitiesTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$pairwiseROCTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$clinicalImpactTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$stratifiedAnalysisTable</code></td><td></td><td></td><td></td><td></td><td>a table</td></tr><tr><td><code>results$surface3DPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$thresholdAnalysisPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$categoryDistributionPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$pairwiseROCPlot</code></td><td></td><td></td><td></td><td></td><td>an image</td></tr><tr><td><code>results$clinicalInterpretation</code></td><td></td><td></td><td></td><td></td><td>a html</td></tr></table><p>Tables can be converted to data frames with <code>asDF</code> or <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></code>. For example:</p>
<p><code>results$performanceSummary$asDF</code></p>
<p><code>as.data.frame(results$performanceSummary)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">trichotomousroc</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">her2_data</span>,</span></span>
<span class="r-in"><span>    predictor <span class="op">=</span> <span class="st">"her2_score"</span>,</span></span>
<span class="r-in"><span>    outcome <span class="op">=</span> <span class="st">"gold_standard"</span>,</span></span>
<span class="r-in"><span>    positive_level <span class="op">=</span> <span class="st">"positive"</span>,</span></span>
<span class="r-in"><span>    indeterminate_level <span class="op">=</span> <span class="st">"indeterminate"</span>,</span></span>
<span class="r-in"><span>    negative_level <span class="op">=</span> <span class="st">"negative"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'her2_data' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

