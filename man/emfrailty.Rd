% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/emfrailty.h.R
\name{emfrailty}
\alias{emfrailty}
\title{EM-Algorithm Frailty Models}
\usage{
emfrailty(
  data,
  elapsedtime,
  outcome,
  covariates,
  frailty_variable,
  outcomeLevel = "1",
  frailty_distribution = "gamma",
  estimation_method = "em",
  baseline_hazard = "weibull",
  ties_method = "breslow",
  confidence_level = 0.95,
  max_iterations = 100,
  convergence_tolerance = 1e-06,
  em_acceleration = FALSE,
  variance_estimation = "observed_information",
  bootstrap_samples = 500,
  frailty_prediction = TRUE,
  model_selection = FALSE,
  diagnostic_plots = TRUE,
  show_model_summary = TRUE,
  show_coefficients = TRUE,
  show_frailty_analysis = TRUE,
  show_convergence = TRUE,
  show_diagnostics = TRUE,
  show_predictions = TRUE,
  show_comparison = TRUE,
  show_convergence_plots = TRUE,
  show_frailty_plots = TRUE,
  show_residual_plots = TRUE,
  show_survival_plots = TRUE,
  showSummaries = FALSE,
  showExplanations = FALSE
)
}
\arguments{
\item{data}{the data as a data frame}

\item{elapsedtime}{Survival time or follow-up duration variable. Should
contain positive  numeric values representing the time to event or
censoring.}

\item{outcome}{Event indicator variable specifying whether the event of
interest occurred. Can be coded as 0/1, TRUE/FALSE, or factor levels.}

\item{covariates}{Predictor variables for the frailty model. Can include
continuous variables, factors, and interactions. Will be included as fixed
effects in the model.}

\item{frailty_variable}{Variable defining the frailty groups (clusters).
Each unique value represents a different frailty group sharing common
unobserved risk factors.}

\item{outcomeLevel}{Specifies which level of the outcome variable
represents the event of interest. For numeric variables, typically '1'. For
factors, specify the appropriate level name.}

\item{frailty_distribution}{Distribution assumed for the frailty terms.
Gamma is most commonly used and provides conjugate properties for efficient
EM estimation.}

\item{estimation_method}{Method for parameter estimation. Standard EM is
most robust, while accelerated variants may converge faster for large
datasets.}

\item{baseline_hazard}{Specification for the baseline hazard function.
Parametric forms provide efficiency while non-parametric allows maximum
flexibility.}

\item{ties_method}{Method for handling tied event times. Breslow is
fastest, Efron more accurate, exact method most precise but computationally
intensive.}

\item{confidence_level}{Confidence level for parameter confidence intervals
and hypothesis tests.}

\item{max_iterations}{Maximum number of EM algorithm iterations before
forced termination.}

\item{convergence_tolerance}{Convergence tolerance for the EM algorithm.
Smaller values require more precise convergence but may increase
computation time.}

\item{em_acceleration}{Enable acceleration methods (SQUAREM, Anderson) to
speed up EM convergence. Recommended for large datasets or complex models.}

\item{variance_estimation}{Method for estimating parameter variances and
standard errors. Observed information is most common, bootstrap most
robust.}

\item{bootstrap_samples}{Number of bootstrap samples for variance
estimation when bootstrap method is selected.}

\item{frailty_prediction}{Compute empirical Bayes predictions of individual
frailty values with prediction intervals and shrinkage estimates.}

\item{model_selection}{Perform automatic model selection comparing
different frailty distributions and baseline hazard specifications using
information criteria.}

\item{diagnostic_plots}{Generate comprehensive diagnostic plots including
convergence traces, residuals, frailty predictions, and model fit
assessments.}

\item{show_model_summary}{Display comprehensive model summary with sample
characteristics and convergence information.}

\item{show_coefficients}{Display fixed effects coefficient estimates with
confidence intervals and tests.}

\item{show_frailty_analysis}{Display frailty variance estimates,
distribution parameters, and heterogeneity measures.}

\item{show_convergence}{Display EM algorithm convergence diagnostics and
iteration history.}

\item{show_diagnostics}{Display comprehensive model diagnostics including
fit statistics and residual analysis.}

\item{show_predictions}{Display empirical Bayes frailty predictions with
shrinkage analysis.}

\item{show_comparison}{Compare EM frailty model with standard Cox model and
alternative specifications.}

\item{show_convergence_plots}{Display EM algorithm convergence trace plots
and diagnostic visualizations.}

\item{show_frailty_plots}{Display frailty distribution plots and empirical
Bayes prediction visualizations.}

\item{show_residual_plots}{Display residual diagnostic plots for model
adequacy assessment.}

\item{show_survival_plots}{Display survival curves stratified by frailty
groups and predictions.}

\item{showSummaries}{Generate comprehensive explanatory text summarizing
the analysis results, methodology, and clinical interpretation guidelines.}

\item{showExplanations}{Provide detailed explanations of the EM-algorithm
frailty methodology, assumptions, advantages, and interpretation
guidelines.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$modelSummary} \tab \tab \tab \tab \tab a table \cr
\code{results$coefficients} \tab \tab \tab \tab \tab a table \cr
\code{results$frailtyAnalysis} \tab \tab \tab \tab \tab a table \cr
\code{results$convergenceInfo} \tab \tab \tab \tab \tab a table \cr
\code{results$diagnostics} \tab \tab \tab \tab \tab a table \cr
\code{results$frailtyPredictions} \tab \tab \tab \tab \tab a table \cr
\code{results$modelComparison} \tab \tab \tab \tab \tab a table \cr
\code{results$baselineHazard} \tab \tab \tab \tab \tab a table \cr
\code{results$heterogeneityAnalysis} \tab \tab \tab \tab \tab a table \cr
\code{results$shrinkageAnalysis} \tab \tab \tab \tab \tab a table \cr
\code{results$convergencePlots} \tab \tab \tab \tab \tab an image \cr
\code{results$frailtyPlots} \tab \tab \tab \tab \tab an image \cr
\code{results$residualPlots} \tab \tab \tab \tab \tab an image \cr
\code{results$survivalPlots} \tab \tab \tab \tab \tab an image \cr
\code{results$fitPlots} \tab \tab \tab \tab \tab an image \cr
\code{results$summaryTable} \tab \tab \tab \tab \tab a html \cr
\code{results$methodExplanation} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$modelSummary$asDF}

\code{as.data.frame(results$modelSummary)}
}
\description{
Implements expectation-maximization (EM) algorithm based frailty models for
survival analysis. Provides efficient estimation of frailty distributions
and variance components in complex survival data with unobserved
heterogeneity. Supports multiple frailty distributions and convergence
diagnostics.
}
\examples{
data('lung', package='survival')

emfrailty(data = lung,
         elapsedtime = 'time',
         outcome = 'status',
         covariates = c('age', 'sex'),
         frailty_variable = 'inst',
         frailty_distribution = 'gamma',
         estimation_method = 'em',
         max_iterations = 100)

}
