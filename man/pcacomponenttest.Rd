% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pcacomponenttest.h.R
\name{pcacomponenttest}
\alias{pcacomponenttest}
\title{PCA Component Significance Test}
\usage{
pcacomponenttest(
  data,
  vars,
  ncomp = 5,
  nperm = 1000,
  center = TRUE,
  scale = TRUE,
  conflevel = 0.95,
  adjustmethod = "BH",
  showpercent = TRUE,
  colororiginal = "steelblue",
  colorpermuted = "orange",
  plotwidth = 600,
  plotheight = 450
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{vars}{Continuous variables to include in Principal Component
Analysis. Select at least 3 numeric variables.}

\item{ncomp}{Number of principal components to test for significance (1 to
20). Testing will be performed for PC1 through the specified number of
components.}

\item{nperm}{Number of permutations to generate null distribution
(100-10000). Higher values provide more accurate p-values but take longer.
Minimum p-value = 1/(nperm+1). For p<0.001, use nperm>=1000.}

\item{center}{Center variables to have mean = 0 before PCA. Recommended:
TRUE for most analyses.}

\item{scale}{Scale variables to have standard deviation = 1 before PCA.
Recommended: TRUE when variables have different units or scales.}

\item{conflevel}{Confidence level for confidence intervals (0.80-0.99).
Default: 0.95 for 95\\% CI.}

\item{adjustmethod}{Method for adjusting p-values for multiple testing. BH
(Benjamini-Hochberg) controls false discovery rate.}

\item{showpercent}{Display variance accounted for (VAF) as percentage
(0-100) instead of proportion (0-1).}

\item{colororiginal}{Color for original VAF line/points. Use color names or
hex codes.}

\item{colorpermuted}{Color for permuted VAF line/points. Use color names or
hex codes.}

\item{plotwidth}{Width of the plot in pixels.}

\item{plotheight}{Height of the plot in pixels.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$results} \tab \tab \tab \tab \tab Statistical significance of principal components based on permutation testing \cr
\code{results$vafplot} \tab \tab \tab \tab \tab Visualization comparing original VAF to permuted null distribution \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$results$asDF}

\code{as.data.frame(results$results)}
}
\description{
Performs SEQUENTIAL permutation-based significance testing to determine
which principal
components explain more variance than expected by random chance. This
provides
an objective, hypothesis-tested approach to component retention.
}
\details{
The test uses the Buja & Eyuboglu (1992) sequential method where:
\enumerate{
\item Each component is tested against a permutation null distribution
\item Significant components have their variance REMOVED before testing the
next component
\item Testing STOPS when the first non-significant component is found
}

This sequential approach prevents inflated Type I errors that occur when
all components
are tested against the same null distribution (batch testing).

CRITICAL: Requires centered and scaled data for valid correlation-based
interpretation.
Without centering/scaling, the test compares raw variance instead of
correlation structure.
}
\section{References}{

Buja A, Eyuboglu N. (1992). Remarks on Parallel Analysis. Multivariate Behavioral Research, 27(4):509-540.

Torres-Espin A, Chou A, Huie JR, et al. (2021). Reproducible analysis of disease space via principal components using the novel R package syndRomics. eLife, 10:e61812.
}

\examples{
# Example with mtcars dataset
data("mtcars")

# Test significance of first 5 principal components
pcacomponenttest(
  data = mtcars,
  vars = c("mpg", "disp", "hp", "drat", "wt", "qsec"),
  ncomp = 5,
  nperm = 1000,
  center = TRUE,
  scale = TRUE,
  conflevel = 0.95,
  adjustmethod = "BH"
)

}
