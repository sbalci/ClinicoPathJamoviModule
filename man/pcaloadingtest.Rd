% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pcaloadingtest.h.R
\name{pcaloadingtest}
\alias{pcaloadingtest}
\title{PCA Loading Significance Test}
\usage{
pcaloadingtest(
  data,
  vars,
  ncomp = 3,
  nperm = 1000,
  seed = 123,
  componentfilter = 0,
  center = TRUE,
  scale = TRUE,
  conflevel = 0.95,
  adjustmethod = "BH",
  colorlow = "steelblue1",
  colormid = "white",
  colorhigh = "firebrick1",
  plotwidth = 700,
  plotheight = 450
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{vars}{Continuous variables to include in Principal Component
Analysis. Select at least 3 numeric variables.}

\item{ncomp}{Number of principal components to test loadings for (1 to 10).}

\item{nperm}{Number of permutations per variable (100-5000). Total
permutations = nperm Ã— number of variables. Higher values provide more
accurate p-values but take longer.}

\item{seed}{Seed for permutation reproducibility. Use the same seed to
obtain identical results.}

\item{componentfilter}{Filter results table by component. 0 shows all
components, 1 shows only PC1, 2 shows only PC2, etc.}

\item{center}{Center variables to have mean = 0 before PCA.}

\item{scale}{Scale variables to have standard deviation = 1 before PCA.}

\item{conflevel}{Confidence level for confidence intervals (0.80-0.99).}

\item{adjustmethod}{Method for adjusting p-values within each component. BH
(Benjamini-Hochberg) controls false discovery rate.}

\item{colorlow}{Color for negative loadings in barplot.}

\item{colormid}{Midpoint color for zero loading.}

\item{colorhigh}{Color for positive loadings in barplot.}

\item{plotwidth}{Width of the plot in pixels.}

\item{plotheight}{Height of the plot in pixels.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$clinicalGuide} \tab \tab \tab \tab \tab a html \cr
\code{results$results} \tab \tab \tab \tab \tab Permutation-based significance testing for each variable-component loading \cr
\code{results$variance} \tab \tab \tab \tab \tab a table \cr
\code{results$loadingplot} \tab \tab \tab \tab \tab Barplot showing loadings with confidence intervals from permutation \cr
\code{results$scree} \tab \tab \tab \tab \tab Scree/variance explained plot \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$results$asDF}

\code{as.data.frame(results$results)}
}
\description{
Performs permutation-based significance testing for PCA loadings using the
permV method (Linting et al., 2011). This approach permutes one variable at
a time, providing variable-specific and component-specific significance
thresholds
with higher statistical power and proper Type I error control.
}
\details{
Instead of arbitrary cutoffs (e.g., |loading| > 0.5), this test provides
objective, hypothesis-tested thresholds for each variable on each
component.
Procrustes rotation is applied to handle sign reflection and component
indeterminacy issues.
}
\section{References}{

Linting M, van Os BJ, Meulman JJ. (2011). Statistical Significance of the Contribution of Variables to the PCA solution: An Alternative Permutation Strategy. Psychometrika, 76(3):440-460.

Torres-Espin A, Chou A, Huie JR, et al. (2021). Reproducible analysis of disease space via principal components using the novel R package syndRomics. eLife, 10:e61812.
}

\examples{
# Example with pcaloadingtest_data (simulated dataset with known structure)
data("pcaloadingtest_data")

# Test loading significance for first 3 components
# Expected: var1-3 load on PC1, var4-5 on PC2, var6-7 on PC3
pcaloadingtest(
  data = pcaloadingtest_data,
  vars = c("var1", "var2", "var3", "var4", "var5", "var6", "var7", "noise"),
  ncomp = 3,
  nperm = 1000,
  center = TRUE,
  scale = TRUE,
  conflevel = 0.95,
  adjustmethod = "BH"
)

}
