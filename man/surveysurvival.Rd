% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/surveysurvival.h.R
\name{surveysurvival}
\alias{surveysurvival}
\title{Survey-Weighted Survival Analysis}
\usage{
surveysurvival(
  data,
  elapsedtime = NULL,
  tint = FALSE,
  dxdate = NULL,
  fudate = NULL,
  timetypedata = "ymd",
  timetypeoutput = "months",
  outcome = NULL,
  outcomeLevel,
  weights = NULL,
  strata = NULL,
  cluster = NULL,
  fpc = NULL,
  design_type = "srs",
  nest_clusters = FALSE,
  explanatory = NULL,
  contexpl = NULL,
  km_weighted = TRUE,
  cox_weighted = FALSE,
  robust_se = TRUE,
  ci_level = 0.95,
  population_totals = FALSE,
  subpopulation = NULL,
  km_plot = TRUE,
  endplot = 60,
  byplot = 12,
  ci95 = TRUE,
  risktable = FALSE,
  design_summary = TRUE,
  showSummaries = FALSE,
  showExplanations = FALSE
)
}
\arguments{
\item{data}{The survey dataset to be analyzed, provided as a data frame.
Must contain survival variables, survey design variables (weights, strata,
clusters), and any explanatory variables for analysis.}

\item{elapsedtime}{The numeric variable representing follow-up time until
the event or last observation. Time should be in consistent units across
all observations.}

\item{tint}{If true, survival time will be calculated from diagnosis and
follow-up dates. If false, elapsedtime should be provided as a
pre-calculated numeric variable.}

\item{dxdate}{Date of diagnosis or start of follow-up. Required if tint =
true. Must match the format specified in timetypedata.}

\item{fudate}{Follow-up date or date of last observation. Required if tint
= true. Must match the format specified in timetypedata.}

\item{timetypedata}{Specifies the format of date variables in the input
data. Used when tint = true to parse diagnosis and follow-up dates.}

\item{timetypeoutput}{The units in which survival time is reported in the
output.}

\item{outcome}{The outcome variable indicating event status (e.g., death,
disease occurrence).}

\item{outcomeLevel}{The level of outcome considered as the event.}

\item{weights}{Variable containing survey sampling weights for each
observation. Required for survey-weighted analysis.}

\item{strata}{Variable defining survey strata. Used in stratified sampling
designs.}

\item{cluster}{Variable defining primary sampling units or clusters. Used
in cluster and multi-stage sampling designs.}

\item{fpc}{Variable containing finite population correction factors.
Optional for improved variance estimation when sampling fraction is large.}

\item{design_type}{Type of survey sampling design used to collect the data.}

\item{nest_clusters}{Whether clusters are nested within strata (TRUE) or
crossed (FALSE). Relevant for stratified cluster designs.}

\item{explanatory}{Categorical explanatory variables for weighted Cox
regression.}

\item{contexpl}{Continuous explanatory variables for weighted Cox
regression.}

\item{km_weighted}{Perform survey-weighted Kaplan-Meier survival
estimation.}

\item{cox_weighted}{Perform survey-weighted Cox proportional hazards
regression.}

\item{robust_se}{Use robust variance estimation accounting for survey
design effects.}

\item{ci_level}{Confidence level for confidence intervals (e.g., 0.95 for
95\\% CI).}

\item{population_totals}{Calculate population-level survival estimates and
totals.}

\item{subpopulation}{Variable defining subpopulation for domain estimation.}

\item{km_plot}{Generate survey-weighted Kaplan-Meier survival plot.}

\item{endplot}{Maximum follow-up time to display on survival plots.}

\item{byplot}{Time interval for plot labels and risk tables.}

\item{ci95}{Display confidence intervals on survival plots.}

\item{risktable}{Display number at risk below survival plots.}

\item{design_summary}{Display summary of survey design characteristics.}

\item{showSummaries}{Display natural language summaries alongside tables
and plots for interpretation of survey-weighted survival results.}

\item{showExplanations}{Display detailed explanations of survey-weighted
survival methods and interpretation guidelines.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$designSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$survivalAnalysis} \tab \tab \tab \tab \tab a html \cr
\code{results$coxAnalysis} \tab \tab \tab \tab \tab a html \cr
\code{results$populationEstimates} \tab \tab \tab \tab \tab a html \cr
\code{results$kmPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$designDiagnostics} \tab \tab \tab \tab \tab a table \cr
\code{results$weightedSurvivalTable} \tab \tab \tab \tab \tab a table \cr
\code{results$coxCoefficients} \tab \tab \tab \tab \tab a table \cr
\code{results$populationTotalsTable} \tab \tab \tab \tab \tab a table \cr
\code{results$subpopulationAnalysis} \tab \tab \tab \tab \tab a table \cr
\code{results$modelFitStatistics} \tab \tab \tab \tab \tab a table \cr
\code{results$designEffectsSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$analysisSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$methodExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$surveyDesignExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$kmWeightedExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$coxWeightedExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$populationInferenceExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$calculatedtime} \tab \tab \tab \tab \tab an output \cr
\code{results$outcomeredefined} \tab \tab \tab \tab \tab an output \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$designDiagnostics$asDF}

\code{as.data.frame(results$designDiagnostics)}
}
\description{
Perform survival analysis on complex survey data using the survey
package. Supports weighted estimates, complex sampling designs, and
weighted Cox proportional hazards models.
}
\details{
This module implements survey-weighted survival methods for
population-based
inference from complex sampling designs including stratified, clustered,
and
multi-stage sampling. The analysis accounts for survey design effects on
standard errors and confidence intervals, enabling proper population-level
survival estimates from survey data.
}
\examples{
# Example 1: Basic survey-weighted Kaplan-Meier
library(survival)
library(survey)

surveysurvival(
    data = mysurveydata,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    weights = "survey_weight",
    strata = "stratum",
    cluster = "psu",
    timetypeoutput = "months"
)

# Example 2: Weighted Cox regression with complex design
surveysurvival(
    data = mysurveydata,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    explanatory = c("age_group", "sex"),
    contexpl = c("income"),
    weights = "survey_weight",
    strata = "stratum",
    cluster = "psu",
    fpc = "fpc_var",
    design_type = "stratified_cluster"
)

# Example 3: Multi-stage survey design
surveysurvival(
    data = nhanes_data,
    elapsedtime = "followup_years",
    outcome = "death",
    outcomeLevel = "Dead",
    explanatory = c("education", "race"),
    weights = "wtmec2yr",
    strata = "sdmvstra",
    cluster = "sdmvpsu",
    design_type = "multistage",
    nest_clusters = TRUE
)

}
