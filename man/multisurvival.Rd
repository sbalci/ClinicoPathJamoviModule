% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multisurvival.h.R
\name{multisurvival}
\alias{multisurvival}
\title{Multivariable Survival Analysis}
\usage{
multisurvival(
  data,
  elapsedtime = NULL,
  tint = FALSE,
  dxdate = NULL,
  fudate = NULL,
  timetypedata = "ymd",
  timetypeoutput = "months",
  uselandmark = FALSE,
  landmark = 3,
  outcome = NULL,
  outcomeLevel,
  dod,
  dooc,
  awd,
  awod,
  analysistype = "overall",
  explanatory = NULL,
  contexpl = NULL,
  multievent = FALSE,
  hr = FALSE,
  sty = "t1",
  ph_cox = FALSE,
  km = FALSE,
  endplot = 60,
  byplot = 12,
  ci95 = FALSE,
  risktable = FALSE,
  censored = FALSE,
  medianline = "none",
  pplot = FALSE,
  cutp = "12, 36, 60",
  calculateRiskScore = FALSE,
  numRiskGroups = "four",
  plotRiskGroups = FALSE,
  ac = FALSE,
  adjexplanatory = NULL,
  ac_method = "average",
  showNomogram = FALSE,
  use_stratify = FALSE,
  stratvar = NULL,
  person_time = FALSE,
  time_intervals = "12, 36, 60",
  rate_multiplier = 100,
  showExplanations = FALSE,
  showSummaries = TRUE,
  debug = FALSE,
  debug_dummy_plot = FALSE
)
}
\arguments{
\item{data}{The dataset to be analyzed, provided as a data frame. Must
contain the variables specified in the options below.}

\item{elapsedtime}{The numeric variable representing follow-up time until
the event or last observation. If \code{tint} = false, this should be a
pre-calculated numeric time variable. If \code{tint} = true, \code{dxdate}
and \code{fudate} will be used to calculate this time.}

\item{tint}{If true, survival time will be calculated from \code{dxdate}
and \code{fudate}. If false, \code{elapsedtime} should be provided as a
pre-calculated numeric variable.}

\item{dxdate}{Date of diagnosis. Required if \code{tint} = true. Accepts:
(1) Date/datetime text, (2) Numeric Unix epoch seconds (from DateTime
Converter's corrected_datetime_numeric output), (3) Numeric datetime values
from R. Time intervals calculated as difference from follow-up date.}

\item{fudate}{Follow-up date or date of last observation. Required if
\code{tint} = true. Accepts: (1) Date/datetime text, (2) Numeric Unix epoch
seconds (from DateTime Converter's corrected_datetime_numeric output), (3)
Numeric datetime values from R. Must be in same format as diagnosis date.}

\item{timetypedata}{Specifies the format of the date variables in the input
data. This is critical if \code{tint = true}, as \code{dxdate} and
\code{fudate} will be parsed according to this format to calculate survival
time. For example, if your data files record dates as "YYYY-MM-DD", select
\code{ymd}.}

\item{timetypeoutput}{The units in which survival time is reported in the
output. Choose from days, weeks, months, or years.}

\item{uselandmark}{If true, applies a landmark analysis starting at a
specified time point.}

\item{landmark}{The time point (in the units defined by
\code{timetypeoutput}) at which to start landmark analyses. Only used if
\code{uselandmark} = true.}

\item{outcome}{The outcome variable. Typically indicates event status
(e.g., death, recurrence). For survival analysis, this may be a factor or
numeric event indicator.}

\item{outcomeLevel}{The level of \code{outcome} considered as the event.
For example, if \code{outcome} is a factor, specify which level indicates
the event occurrence.}

\item{dod}{The level of \code{outcome} corresponding to death due to
disease, if applicable.}

\item{dooc}{The level of \code{outcome} corresponding to death due to other
causes, if applicable.}

\item{awd}{The level of \code{outcome} corresponding to alive with disease,
if applicable.}

\item{awod}{The level of \code{outcome} corresponding to alive without
disease, if applicable.}

\item{analysistype}{Type of survival analysis: - overall: All-cause
survival - cause: Cause-specific survival - compete: Competing risks
analysis}

\item{explanatory}{Categorical explanatory (predictor) variables included
in the Cox model.}

\item{contexpl}{Continuous explanatory (predictor) variables included in
the Cox model.}

\item{multievent}{If true, multiple event levels will be considered for
competing risks analysis. Requires specifying \code{dod}, \code{dooc}, etc.}

\item{hr}{If true, generates a plot of hazard ratios for each explanatory
variable in the Cox model.}

\item{sty}{The style of the hazard ratio (forest) plot. "finalfit" or
"survminer forestplot".}

\item{ph_cox}{If true, tests the proportional hazards assumption for the
Cox model. Use if you suspect violations of the PH assumption.}

\item{km}{If true, produces a Kaplan-Meier survival plot. Useful for
visualization of survival functions without covariate adjustment.}

\item{endplot}{The maximum follow-up time (in units defined by
\code{timetypeoutput}) to display on survival plots.}

\item{byplot}{The interval (in units defined by \code{timetypeoutput}) at
which time points or labels are shown on plots.}

\item{ci95}{If true, displays 95\\% confidence intervals around the survival
estimates on plots.}

\item{risktable}{If true, displays the number of subjects at risk at each
time point below the survival plot.}

\item{censored}{If true, marks censored observations (e.g., using tick
marks) on the survival plot.}

\item{medianline}{If true, displays a line indicating the median survival
time on the survival plot.}

\item{pplot}{If true, displays the p-value from the survival comparison
test on the survival plot.}

\item{cutp}{.}

\item{calculateRiskScore}{If true, calculates a risk score from the Cox
model coefficients for each individual.}

\item{numRiskGroups}{Select the number of risk groups to create from the
risk scores. The data will be divided into equal quantiles based on this
selection.}

\item{plotRiskGroups}{If true, stratifies individuals into risk groups
based on their calculated risk scores and plots their survival curves.}

\item{ac}{.}

\item{adjexplanatory}{.}

\item{ac_method}{Method for computing adjusted survival curves}

\item{showNomogram}{.}

\item{use_stratify}{If true, uses stratification to handle variables that
violate the proportional hazards assumption. Stratification creates
separate baseline hazard functions for different groups.}

\item{stratvar}{Variables used for stratification. When proportional
hazards are not met, stratification can adjust the model to better fit the
data by allowing different baseline hazards.}

\item{person_time}{Enable this option to calculate and display person-time
metrics, including total follow-up time and incidence rates. These metrics
help quantify the rate of events per unit of time in your study population.}

\item{time_intervals}{Specify time intervals for stratified person-time
analysis. Enter a  comma-separated list of time points to create intervals.
For example,  "12, 36, 60" will create intervals 0-12, 12-36, 36-60, and
60+.}

\item{rate_multiplier}{Specify the multiplier for incidence rates (e.g.,
100 for rates per 100 person-years, 1000 for rates per 1000 person-years).}

\item{showExplanations}{Display detailed explanations for each analysis
component to help interpret the statistical methods and results.}

\item{showSummaries}{Display natural language summaries alongside tables
and plots. These summaries provide plain-language interpretations of the
statistical results. Recommended for clinical users. Turn off to reduce
visual clutter when summaries are not needed.}

\item{debug}{If true, writes extra diagnostic information during plot
rendering to \code{results$mydataview_plot} and to the R console (when
available).}

\item{debug_dummy_plot}{If true, plot renderers draw a simple dummy plot
instead of the real plot to help isolate rendering/device issues.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$mydataview_plot} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$multivariableCoxHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$text} \tab \tab \tab \tab \tab a html \cr
\code{results$text2} \tab \tab \tab \tab \tab a html \cr
\code{results$multivariableCoxSummaryHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$multivariableCoxSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$glossaryPanel} \tab \tab \tab \tab \tab a html \cr
\code{results$assumptionsPanel} \tab \tab \tab \tab \tab a html \cr
\code{results$personTimeHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$personTimeTable} \tab \tab \tab \tab \tab a table \cr
\code{results$personTimeSummaryHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$personTimeSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$survivalPlotsHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$plot} \tab \tab \tab \tab \tab an image \cr
\code{results$plot3} \tab \tab \tab \tab \tab an image \cr
\code{results$cox_ph} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$plot8} \tab \tab \tab \tab \tab an image \cr
\code{results$plotKM} \tab \tab \tab \tab \tab an image \cr
\code{results$risk_score_analysis} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$risk_score_analysis2} \tab \tab \tab \tab \tab a html \cr
\code{results$riskScoreHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$riskScoreSummaryHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$riskScoreTable} \tab \tab \tab \tab \tab a table \cr
\code{results$riskScoreSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$riskScoreMetrics} \tab \tab \tab \tab \tab a html \cr
\code{results$riskGroupPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$stratificationExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$calculatedtime} \tab \tab \tab \tab \tab an output \cr
\code{results$outcomeredefined} \tab \tab \tab \tab \tab an output \cr
\code{results$addRiskScore} \tab \tab \tab \tab \tab an output \cr
\code{results$addRiskGroup} \tab \tab \tab \tab \tab an output \cr
\code{results$adjustedSurvivalHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$plot_adj} \tab \tab \tab \tab \tab an image \cr
\code{results$adjustedSurvivalSummaryHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$adjustedSurvivalSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$nomogramHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$plot_nomogram} \tab \tab \tab \tab \tab an image \cr
\code{results$nomogram_display} \tab \tab \tab \tab \tab a html \cr
\code{results$nomogramSummaryHeading} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$nomogramSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$multivariableCoxExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$multivariableCoxHeading3} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$adjustedSurvivalExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$riskScoreExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$nomogramExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$personTimeExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$stratifiedAnalysisExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$survivalPlotsHeading3} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$survivalPlotsExplanation} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$personTimeTable$asDF}

\code{as.data.frame(results$personTimeTable)}
}
\description{
Performs multivariable survival analysis using Cox proportional hazards
regression. In multivariable survival analysis, person-time follow-up is
crucial for properly adjusting for covariates while accounting for varying
observation periods. The Cox proportional hazards model incorporates
person-time by modeling the hazard function, which represents the
instantaneous event rate per unit of person-time. When stratifying analyses
or examining multiple predictors, the model accounts for how these factors
influence event rates relative to the person-time at risk in each subgroup.
}
\examples{
# Example 1: Basic multivariable Cox regression
library(survival)
data(colon)

multisurvival(
    data = colon,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    explanatory = c("sex", "obstruct", "perfor"),
    contexpl = c("age", "nodes"),
    timetypeoutput = "days",
    hr = TRUE  # Show hazard ratio plot
)

# Example 2: Using dates to calculate survival time
# Assuming you have diagnosis and follow-up dates
multisurvival(
    data = mydata,
    tint = TRUE,
    dxdate = "diagnosis_date",
    fudate = "last_followup_date",
    timetypedata = "ymd",
    timetypeoutput = "months",
    outcome = "vital_status",
    outcomeLevel = "Dead",
    explanatory = c("stage", "grade"),
    contexpl = "age"
)

# Example 3: Risk stratification analysis
multisurvival(
    data = colon,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    explanatory = c("sex", "obstruct"),
    contexpl = c("age", "nodes"),
    calculateRiskScore = TRUE,
    numRiskGroups = "three",
    plotRiskGroups = TRUE,
    addRiskScore = TRUE,  # Add risk score to data
    addRiskGroup = TRUE   # Add risk group to data
)

# Example 4: Model with stratification for non-proportional hazards
multisurvival(
    data = colon,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    explanatory = c("obstruct", "perfor"),
    contexpl = c("age", "nodes"),
    use_stratify = TRUE,
    stratvar = "sex",  # Stratify by sex if PH assumption violated
    ph_cox = TRUE      # Test proportional hazards assumption
)

# Example 5: Stepwise model selection
# multisurvival(
#     data = colon,
#     elapsedtime = "time",
#     outcome = "status",
#     outcomeLevel = "1",
#     explanatory = c("sex", "obstruct", "perfor", "adhere"),
#     contexpl = c("age", "nodes"),
#     use_modelSelection = TRUE,
#     modelSelection = "both",  # Stepwise selection
#     selectionCriteria = "aic",
#     pEntry = 0.05,
#     pRemoval = 0.10
# )

# Example 6: Person-time analysis
multisurvival(
    data = colon,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    explanatory = "sex",
    contexpl = "age",
    person_time = TRUE,
    time_intervals = "180, 365, 730",  # 6mo, 1yr, 2yr
    rate_multiplier = 1000  # Rate per 1000 person-days
)

}
