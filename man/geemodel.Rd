% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geemodel.h.R
\name{geemodel}
\alias{geemodel}
\title{Generalized Estimating Equations}
\usage{
geemodel(
  data,
  outcome,
  predictors,
  cluster_id,
  time_var,
  family = "gaussian",
  corstr = "exchangeable",
  robust_se = TRUE,
  conf_level = 0.95,
  qic = TRUE,
  posthoc = FALSE,
  posthoc_adjust = "holm",
  diagnostics = TRUE,
  correlation_plot = FALSE
)
}
\arguments{
\item{data}{the data as a data frame}

\item{outcome}{outcome variable (dependent variable); can be continuous,
binary, or count}

\item{predictors}{predictor variables (independent variables) for the model}

\item{cluster_id}{variable identifying clusters (e.g., patient ID, dog ID).
Observations with the same ID are treated as correlated.}

\item{time_var}{for longitudinal data, specifies time ordering within
clusters. Used with AR(1) correlation structure.}

\item{family}{distribution family and link function for the outcome
variable. Gaussian for continuous, Binomial for binary, Poisson for counts.}

\item{corstr}{Working correlation structure within clusters: -
Exchangeable: constant correlation between all pairs (recommended starting
point) - AR(1): correlation decays with time lag (for longitudinal data) -
Unstructured: estimates all pairwise correlations (requires many
observations) - Independence: no correlation (equivalent to GLM)}

\item{robust_se}{sandwich estimator for standard errors (recommended).
Provides valid inference even if correlation structure is misspecified.}

\item{conf_level}{confidence level for confidence intervals (default 95\\%)}

\item{qic}{Quasi-likelihood under Independence Model Criterion. Lower QIC
indicates better model fit. Use for comparing models.}

\item{posthoc}{compare levels of categorical predictors using estimated
marginal means}

\item{posthoc_adjust}{multiple testing correction for post-hoc comparisons}

\item{diagnostics}{display model diagnostics including number of clusters,
observations per cluster}

\item{correlation_plot}{visualize the estimated within-cluster correlation
structure}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab a html \cr
\code{results$modelInfo} \tab \tab \tab \tab \tab a table \cr
\code{results$coefficientsTable} \tab \tab \tab \tab \tab a table \cr
\code{results$qicTable} \tab \tab \tab \tab \tab a table \cr
\code{results$posthocTable} \tab \tab \tab \tab \tab a table \cr
\code{results$diagnosticsTable} \tab \tab \tab \tab \tab a table \cr
\code{results$correlationPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$methodologyNote} \tab \tab \tab \tab \tab a html \cr
\code{results$interpretationNote} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$modelInfo$asDF}

\code{as.data.frame(results$modelInfo)}
}
\description{
Generalized Estimating Equations for analyzing correlated/clustered data.
Handles repeated measures, longitudinal data, multi-site studies with
marginal model approach. Essential for pathology studies with multiple
samples per subject (e.g., bilateral organs, multiple biopsies per
patient).
}
\details{
\strong{Key Features:}
\itemize{
\item Handles binary, continuous, and count outcomes
\item Multiple correlation structures (exchangeable, AR-1, unstructured)
\item Robust standard errors (sandwich estimator)
\item Post-hoc pairwise comparisons
\item Model selection with QIC
}

\strong{Clinical Applications:}
\itemize{
\item Multiple samples per patient
\item Bilateral organs (eyes, kidneys)
\item Repeated measures over time
\item Multi-site studies
\item Clustered randomized trials
}
}
\examples{
# Example: Multiple liver samples per dog
geemodel(
  data = liver_data,
  outcome = 'diagnosis',
  predictors = c('sample_method', 'fibrosis_score'),
  cluster_id = 'dog_id',
  family = 'binomial',
  corstr = 'exchangeable',
  robust_se = TRUE
)

}
