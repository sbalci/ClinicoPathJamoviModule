% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mendelianrandomization.h.R
\name{mendelianrandomization}
\alias{mendelianrandomization}
\title{Mendelian Randomization}
\usage{
mendelianrandomization(
  exposure_data,
  outcome_data,
  use_same_dataset = TRUE,
  snp_column,
  beta_exposure,
  se_exposure,
  pval_exposure = NULL,
  beta_outcome,
  se_outcome,
  pval_outcome = NULL,
  eaf_column = NULL,
  pval_threshold = 5e-08,
  clump_r2 = 0.001,
  clump_kb = 10000,
  mr_methods = "main_three",
  ivw_model = "random",
  egger_bootstrap = FALSE,
  bootstrap_samples = 1000,
  heterogeneity_test = TRUE,
  pleiotropy_test = TRUE,
  leave_one_out = TRUE,
  single_snp_analysis = FALSE,
  mr_presso = FALSE,
  presso_threshold = 0.05,
  plot_forest = TRUE,
  plot_funnel = TRUE,
  plot_scatter = TRUE,
  plot_loo = TRUE,
  harmonize_alleles = TRUE,
  remove_palindromic = TRUE,
  steiger_filtering = FALSE,
  min_snps = 3,
  conf_level = 0.95,
  random_seed = 42
)
}
\arguments{
\item{exposure_data}{GWAS summary statistics for exposure variable}

\item{outcome_data}{GWAS summary statistics for outcome variable (optional
if same dataset)}

\item{use_same_dataset}{Whether exposure and outcome are in the same
dataset}

\item{snp_column}{Column containing SNP identifiers (e.g., rsID)}

\item{beta_exposure}{Effect size (beta) for exposure}

\item{se_exposure}{Standard error for exposure beta}

\item{pval_exposure}{P-value for exposure association}

\item{beta_outcome}{Effect size (beta) for outcome}

\item{se_outcome}{Standard error for outcome beta}

\item{pval_outcome}{P-value for outcome association}

\item{eaf_column}{Effect allele frequency (optional)}

\item{pval_threshold}{Genome-wide significance threshold (default 5e-8)}

\item{clump_r2}{RÂ² threshold for LD clumping}

\item{clump_kb}{Distance window for LD clumping in kilobases}

\item{mr_methods}{Which MR methods to perform}

\item{ivw_model}{Model specification for IVW method}

\item{egger_bootstrap}{Use bootstrap for MR-Egger confidence intervals}

\item{bootstrap_samples}{Number of bootstrap samples}

\item{heterogeneity_test}{Perform Cochran Q heterogeneity test}

\item{pleiotropy_test}{Test for horizontal pleiotropy (MR-Egger intercept)}

\item{leave_one_out}{Perform leave-one-out sensitivity analysis}

\item{single_snp_analysis}{Analyze each SNP individually}

\item{mr_presso}{Detect and correct for outliers using MR-PRESSO}

\item{presso_threshold}{P-value threshold for MR-PRESSO outlier detection}

\item{plot_forest}{Generate forest plot of MR estimates}

\item{plot_funnel}{Generate funnel plot for asymmetry assessment}

\item{plot_scatter}{Generate scatter plot with method lines}

\item{plot_loo}{Plot leave-one-out analysis results}

\item{harmonize_alleles}{Harmonize exposure and outcome effect alleles}

\item{remove_palindromic}{Remove palindromic SNPs with ambiguous strand}

\item{steiger_filtering}{Filter SNPs using Steiger test for directionality}

\item{min_snps}{Minimum number of SNPs required for analysis}

\item{conf_level}{Confidence level for intervals}

\item{random_seed}{Random seed for reproducibility}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab a html \cr
\code{results$dataInfo} \tab \tab \tab \tab \tab a preformatted \cr
\code{results$snpSelection} \tab \tab \tab \tab \tab a html \cr
\code{results$selectedSNPs} \tab \tab \tab \tab \tab a table \cr
\code{results$mrResults} \tab \tab \tab \tab \tab a table \cr
\code{results$heterogeneityTable} \tab \tab \tab \tab \tab a table \cr
\code{results$pleiotropyTable} \tab \tab \tab \tab \tab a table \cr
\code{results$looTable} \tab \tab \tab \tab \tab a table \cr
\code{results$pressoResults} \tab \tab \tab \tab \tab a html \cr
\code{results$forestPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$funnelPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$scatterPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$looPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
\code{results$assumptions} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$selectedSNPs$asDF}

\code{as.data.frame(results$selectedSNPs)}
}
\description{
Mendelian Randomization (MR) uses genetic variants as instrumental
variables to infer causal relationships between exposures and outcomes.
}
\details{
This module supports GWAS summary statistics (NOT individual-level data)
and provides multiple MR methods with comprehensive sensitivity analysis.

Applications: Genetic epidemiology, drug target validation, causal
inference in observational studies.
}
\examples{
# Example: Analyze effect of BMI on coronary disease
mendelianrandomization(
    exposure_data = bmi_gwas,
    outcome_data = cad_gwas,
    snp_column = 'rsID',
    beta_exposure = 'beta_bmi',
    se_exposure = 'se_bmi',
    beta_outcome = 'beta_cad',
    se_outcome = 'se_cad',
    mr_methods = c('IVW', 'MR-Egger', 'Weighted Median')
)

}
