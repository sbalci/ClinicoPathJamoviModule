% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rocreg.h.R
\name{rocreg}
\alias{rocreg}
\title{ROC Regression (Covariate-Adjusted ROC)}
\usage{
rocreg(
  data,
  predictor,
  outcome,
  positive_level,
  covariates,
  covariate_effects = "both",
  method = "binormal",
  adjusted_auc = TRUE,
  covariate_specific_auc = TRUE,
  covariate_profiles = "",
  compare_unadjusted = TRUE,
  test_covariate_effects = TRUE,
  variable_selection = FALSE,
  selection_criterion = "aic",
  test_interactions = FALSE,
  confidence_intervals = TRUE,
  ci_method = "bootstrap",
  bootstrap_samples = 500,
  confidence_level = 0.95,
  plot_covariate_specific_rocs = TRUE,
  plot_auc_by_covariate = TRUE,
  plot_effect_estimates = TRUE,
  plot_residual_diagnostics = FALSE,
  adjustment_purpose = "confounder",
  clinical_application = "general",
  show_interpretation = TRUE,
  standardize_covariates = TRUE,
  missing_handling = "complete",
  random_seed = 123
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{predictor}{Continuous diagnostic test variable (biomarker level,
imaging score, AI probability). The test whose accuracy varies by
covariates.}

\item{outcome}{Binary outcome variable (diseased vs non-diseased, positive
vs negative).}

\item{positive_level}{Which level represents the diseased/positive state.}

\item{covariates}{Variables that may affect diagnostic accuracy. Examples:
age, sex, disease stage, scanner type, institution, staining batch. Both
continuous and categorical covariates supported.}

\item{covariate_effects}{Where to model covariate effects. "Both" allows
different effects in diseased and non-diseased groups, "sensitivity" models
effects only in diseased, "specificity" only in non-diseased.}

\item{method}{Method for ROC regression. Binormal assumes normal
distributions with covariate effects on location/scale, non-parametric uses
kernel smoothing, semi-parametric combines both, Bayesian provides
posterior distributions.}

\item{adjusted_auc}{Calculate population-averaged AUC adjusted for
covariates. This is the overall AUC accounting for covariate distribution
in the population.}

\item{covariate_specific_auc}{Calculate AUC at specific covariate values to
show how diagnostic accuracy varies across patient characteristics.}

\item{covariate_profiles}{Specify covariate values for covariate-specific
ROC curves. Example for age: "30, 50, 70" to get curves for
young/middle/elderly patients. Leave empty for automatic selection
(quartiles for continuous, all levels for categorical).}

\item{compare_unadjusted}{Show comparison between covariate-adjusted and
unadjusted (pooled) ROC analysis. Demonstrates impact of covariate
adjustment.}

\item{test_covariate_effects}{Perform statistical tests to determine if
covariates significantly affect diagnostic accuracy. Likelihood ratio tests
or Wald tests depending on method.}

\item{variable_selection}{Use stepwise or information criteria to select
which covariates to include in final model. Helpful with many potential
confounders.}

\item{selection_criterion}{Criterion for automatic variable selection.}

\item{test_interactions}{Test for interactions between covariates (e.g.,
does age effect differ by sex? does scanner effect vary by institution?).}

\item{confidence_intervals}{Calculate confidence intervals for
covariate-adjusted AUC and ROC curves.}

\item{ci_method}{Method for confidence interval estimation. Bootstrap
recommended for small samples or non-parametric methods.}

\item{bootstrap_samples}{Number of bootstrap samples for CI estimation.}

\item{confidence_level}{Confidence level for intervals.}

\item{plot_covariate_specific_rocs}{Display multiple ROC curves for
different covariate profiles on same plot. Shows how ROC curve changes with
patient characteristics.}

\item{plot_auc_by_covariate}{For continuous covariates, plot how AUC
changes as covariate varies. Shows non-linear relationships between
covariates and diagnostic accuracy.}

\item{plot_effect_estimates}{Forest plot showing estimated covariate
effects on diagnostic accuracy with confidence intervals.}

\item{plot_residual_diagnostics}{Display residual plots and goodness-of-fit
diagnostics for ROC regression model.}

\item{adjustment_purpose}{Purpose of covariate adjustment for
interpretation guidance.}

\item{clinical_application}{Clinical application context for
interpretation.}

\item{show_interpretation}{Provide interpretation with clinical context and
recommendations.}

\item{standardize_covariates}{Standardize continuous covariates (mean 0, SD
\enumerate{
\item for better numerical stability and interpretability of effect sizes.
}}

\item{missing_handling}{Method for handling missing covariate data.}

\item{random_seed}{Random seed for bootstrap and stochastic procedures.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab a html \cr
\code{results$adjustedAUC} \tab \tab \tab \tab \tab a table \cr
\code{results$covariateEffects} \tab \tab \tab \tab \tab a table \cr
\code{results$covariateSpecificAUC} \tab \tab \tab \tab \tab a table \cr
\code{results$covariateROCPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$aucByCovPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$effectEstimatesPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$adjustedAUC$asDF}

\code{as.data.frame(results$adjustedAUC)}
}
\description{
ROC regression for covariate-adjusted diagnostic accuracy assessment.
Traditional ROC analysis assumes diagnostic test performance is constant
across all patients, but accuracy often varies by patient characteristics
(age, disease stage, scanner type, staining protocol). ROC regression
models how sensitivity and specificity change as functions of covariates,
providing covariate-specific ROC curves and adjusted summary measures
(covariate-adjusted AUC). Essential for comparing diagnostic tests across
heterogeneous populations, adjusting for confounders in test comparison
studies, and identifying patient subgroups where tests perform differently.
Particularly valuable in digital pathology for accounting for batch effects
(different scanners, institutions, staining protocols) and in biomarker
studies for age/stage-specific performance assessment. Uses binormal,
non-parametric, or Bayesian approaches to model covariate effects on ROC
curves. Provides both population-averaged and covariate-specific diagnostic
accuracy estimates.
}
\examples{
result <- rocreg(
    data = multi_center_data,
    predictor = "biomarker_level",
    outcome = "disease_status",
    covariates = c("age", "scanner_type", "center")
)

}
