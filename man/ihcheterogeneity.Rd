% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ihcheterogeneity.h.R
\name{ihcheterogeneity}
\alias{ihcheterogeneity}
\title{IHC Heterogeneity Analysis}
\usage{
ihcheterogeneity(
  data,
  wholesection = NULL,
  biopsy1,
  biopsy2 = NULL,
  biopsy3 = NULL,
  biopsy4 = NULL,
  biopsies = NULL,
  spatial_id = NULL,
  compareCompartments = FALSE,
  compartmentTests = FALSE,
  analysis_type = "comprehensive",
  sampling_strategy = "unknown",
  cv_threshold = 20,
  correlation_threshold = 0.8,
  show_variability_plots = FALSE,
  variance_components = FALSE,
  power_analysis = FALSE,
  generate_recommendations = FALSE,
  showSummary = FALSE,
  showGlossary = FALSE
)
}
\arguments{
\item{data}{the data as a data frame}

\item{wholesection}{Optional reference measurement for comparison with
regional measurements. Can be whole section average, hotspot area, or
overall tumor measurement. Leave empty for inter-regional comparison
studies. Example: Ki67 proliferation index (0-100\\%), ER H-score (0-300),
PR percentage (0-100\\%).}

\item{biopsy1}{Continuous biomarker measurement from first tissue region or
area. Should represent same biomarker as reference measurement for
heterogeneity comparison. Example: Ki67 \\% from tumor periphery, ER H-score
from invasive front.}

\item{biopsy2}{Second tissue region biomarker measurement for heterogeneity
analysis}

\item{biopsy3}{Third tissue region biomarker measurement}

\item{biopsy4}{Fourth tissue region biomarker measurement}

\item{biopsies}{additional simulated biopsy measurements}

\item{spatial_id}{identifier for spatial regions or tissue areas (e.g.,
Central/Invasive, Preinvasive/Invasive)}

\item{compareCompartments}{Perform statistical comparison of heterogeneity
patterns between spatial compartments. Requires spatial_id variable.
Compares ICC, CV, and bias across compartments.}

\item{compartmentTests}{Perform statistical tests to determine if
heterogeneity differs significantly between compartments. Uses Levene's
test for variance equality and Kruskal-Wallis for distributional
differences.}

\item{analysis_type}{primary focus of biopsy simulation analysis}

\item{sampling_strategy}{biopsy sampling strategy used}

\item{cv_threshold}{Coefficient of variation threshold for acceptable
sampling variability. Typical clinical values: 15-25\\% for
immunohistochemistry (Ki67, ER, PR), 10-20\\% for molecular assays, 20-30\\%
for heterogeneous markers (HER2, PD-L1). Lower values indicate more
stringent quality requirements.}

\item{correlation_threshold}{Minimum Spearman correlation between biopsy
and whole section measurements. Clinical guidelines: ≥0.80 excellent
agreement, ≥0.70 good agreement, ≥0.60 moderate agreement, <0.60 poor
agreement. Higher values indicate better representativeness of biopsy
samples.}

\item{show_variability_plots}{display plots showing sampling variability}

\item{variance_components}{perform variance component decomposition}

\item{power_analysis}{perform power analysis for sample size
recommendations}

\item{generate_recommendations}{provide recommendations for optimal
heterogeneity assessment strategy}

\item{showSummary}{Display natural-language summary of heterogeneity
analysis results}

\item{showGlossary}{Display definitions of statistical terms (ICC, CV,
correlation)}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$welcome} \tab \tab \tab \tab \tab Welcome screen shown when no variables selected \cr
\code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
\code{results$report_sentences} \tab \tab \tab \tab \tab Pre-formatted sentences ready for clinical reports and publications \cr
\code{results$assumptions} \tab \tab \tab \tab \tab Analysis assumptions, data requirements, and methodological considerations \cr
\code{results$summary} \tab \tab \tab \tab \tab Natural-language summary of heterogeneity analysis results \cr
\code{results$glossary} \tab \tab \tab \tab \tab Definitions of key statistical terms used in the analysis \cr
\code{results$reproducibilitytable} \tab \tab \tab \tab \tab Correlation and reliability metrics \cr
\code{results$samplingbiastable} \tab \tab \tab \tab \tab Systematic bias assessment between methods \cr
\code{results$variancetable} \tab \tab \tab \tab \tab Sources of measurement variability \cr
\code{results$poweranalysistable} \tab \tab \tab \tab \tab Sample size recommendations and power calculations \cr
\code{results$spatialanalysistable} \tab \tab \tab \tab \tab Variability across spatial regions \cr
\code{results$compartmentComparison} \tab \tab \tab \tab \tab Statistical comparison of heterogeneity metrics between compartments \cr
\code{results$compartmentTests} \tab \tab \tab \tab \tab Formal statistical tests comparing heterogeneity across compartments \cr
\code{results$biopsyplot} \tab \tab \tab \tab \tab Distribution comparison across regional measurements and reference (if provided) \cr
\code{results$variabilityplot} \tab \tab \tab \tab \tab Coefficient of variation by case \cr
\code{results$spatialplot} \tab \tab \tab \tab \tab Spatial distribution of biomarker values \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$reproducibilitytable$asDF}

\code{as.data.frame(results$reproducibilitytable)}
}
\description{
IHC Heterogeneity Analysis
}
