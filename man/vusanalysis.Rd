% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vusanalysis.h.R
\name{vusanalysis}
\alias{vusanalysis}
\title{Volume Under ROC Surface (VUS) Analysis}
\usage{
vusanalysis(
  data,
  predictor,
  multiclass_outcome,
  outcome_order = "",
  vus_method = "mann_whitney",
  confidence_intervals = TRUE,
  ci_method = "bootstrap",
  bootstrap_samples = 1000,
  confidence_level = 0.95,
  hypothesis_test = TRUE,
  test_method = "bootstrap",
  pairwise_auc = TRUE,
  pairwise_ci = TRUE,
  pairwise_tests = FALSE,
  min_class_size = 10,
  covariate_adjustment = FALSE,
  covariates,
  stratified_analysis = FALSE,
  stratify_by,
  plot_3d_surface = FALSE,
  plot_pairwise_rocs = TRUE,
  plot_class_distributions = TRUE,
  plot_type = "boxplot",
  handle_ties = "average",
  random_seed = 12345
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{predictor}{Continuous predictor variable (biomarker, risk score,
imaging feature). Should be numeric with higher values generally indicating
higher class membership.}

\item{multiclass_outcome}{Outcome variable with 3 or more ordered classes.
Examples: tumor grade (1/2/3), disease stage (I/II/III/IV), severity
(mild/moderate/severe).}

\item{outcome_order}{Comma-separated list specifying the order of outcome
classes from low to high. Example: "Grade 1, Grade 2, Grade 3". If not
specified, factor levels are used.}

\item{vus_method}{Method for VUS estimation. Mann-Whitney is most robust
and recommended for general use. Normal theory assumes multivariate
normality. Bootstrap provides non-parametric confidence intervals.}

\item{confidence_intervals}{Calculate confidence intervals for VUS using
specified method.}

\item{ci_method}{Method for confidence interval calculation. Bootstrap is
recommended for most applications. BCa provides bias-corrected intervals.}

\item{bootstrap_samples}{Number of bootstrap resamples for confidence
intervals and hypothesis testing.}

\item{confidence_level}{Confidence level for interval estimation.}

\item{hypothesis_test}{Test null hypothesis: VUS = 1/6 (random
classification for 3 classes). For k classes, null VUS = 1/k!}

\item{test_method}{Method for hypothesis testing. Bootstrap and permutation
are robust to distributional assumptions.}

\item{pairwise_auc}{Calculate AUC for all pairwise class comparisons. Helps
identify which class transitions are well-discriminated.}

\item{pairwise_ci}{Calculate confidence intervals for pairwise AUC
comparisons.}

\item{pairwise_tests}{Test whether each pairwise AUC differs significantly
from 0.5.}

\item{min_class_size}{Minimum number of observations required per class for
analysis. Smaller classes may produce unstable estimates.}

\item{covariate_adjustment}{Adjust VUS for covariates (experimental
feature). Useful for controlling confounding factors.}

\item{covariates}{Covariates for adjustment (age, sex, site, etc.).
Requires covariate_adjustment = TRUE.}

\item{stratified_analysis}{Calculate VUS stratified by subgroups to assess
consistency across populations.}

\item{stratify_by}{Variable for stratified analysis (e.g., age group,
disease subtype).}

\item{plot_3d_surface}{Generate 3D visualization of ROC surface (requires
additional packages). Warning: May be computationally intensive for large
datasets.}

\item{plot_pairwise_rocs}{Plot ROC curves for all pairwise class
comparisons.}

\item{plot_class_distributions}{Display predictor distributions by outcome
class (box plots or density plots).}

\item{plot_type}{Type of plot for showing predictor distributions across
classes.}

\item{handle_ties}{Method for handling tied predictor values. Average ranks
is standard for Mann-Whitney based calculations.}

\item{random_seed}{Random seed for bootstrap and permutation procedures.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab a html \cr
\code{results$vusSummary} \tab \tab \tab \tab \tab Overall VUS with confidence intervals \cr
\code{results$hypothesisTest} \tab \tab \tab \tab \tab Test whether VUS differs from random classification \cr
\code{results$classBreakdown} \tab \tab \tab \tab \tab Sample sizes and summary statistics by class \cr
\code{results$pairwiseAUC} \tab \tab \tab \tab \tab AUC for all pairwise class comparisons \cr
\code{results$stratifiedVUS} \tab \tab \tab \tab \tab VUS by subgroup \cr
\code{results$pairwiseROCPlot} \tab \tab \tab \tab \tab ROC curves for all pairwise class comparisons \cr
\code{results$classDistributionPlot} \tab \tab \tab \tab \tab Distribution of predictor values across outcome classes \cr
\code{results$surface3DPlot} \tab \tab \tab \tab \tab Three-dimensional ROC surface visualization \cr
\code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$vusSummary$asDF}

\code{as.data.frame(results$vusSummary)}
}
\description{
Volume Under ROC Surface (VUS) analysis extends the traditional Area Under
the ROC Curve (AUC) to diagnostic tests with three or more ordered classes.
While binary ROC analysis calculates the area under a 2D curve, VUS
calculates the volume under a 3D surface for multi-class problems. The VUS
represents the probability that a randomly selected triple of observations
(one from each class) will be correctly ordered by the diagnostic marker.
VUS ranges from 0 to 1, where 0.5 indicates random classification (no
discrimination), and 1 indicates perfect discrimination across all classes.
This method is particularly valuable for tumor grading (Grade 1/2/3),
disease staging (Stage I/II/III/IV), severity classification
(mild/moderate/severe), and any diagnostic scenario where outcomes
naturally fall into three or more ordered categories. The analysis provides
pairwise AUC comparisons between adjacent classes, overall VUS with
confidence intervals, and hypothesis testing against chance performance.
Essential for validating biomarkers, imaging features, and AI models in
multi-class clinicopathological applications where binary classification is
insufficient.
}
\examples{
result <- vusanalysis(
    data = tumor_data,
    predictor = "biomarker_score",
    multiclass_outcome = "tumor_grade",
    outcome_order = c("Grade 1", "Grade 2", "Grade 3")
)

}
