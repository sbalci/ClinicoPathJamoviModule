% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/waterfall.h.R
\name{waterfall}
\alias{waterfall}
\title{Treatment Response Analysis}
\usage{
waterfall(
  data,
  patientID,
  responseVar,
  timeVar = NULL,
  groupVar = NULL,
  inputType = "percentage",
  sortBy = "response",
  showThresholds = TRUE,
  labelOutliers = FALSE,
  showMedian = FALSE,
  showCI = FALSE,
  minResponseForLabel = 50,
  colorBy = "recist",
  colorScheme = "jamovi",
  barAlpha = 1,
  barWidth = 0.7,
  showWaterfallPlot = TRUE,
  showSpiderPlot = TRUE,
  spiderColorBy = "response",
  spiderColorScheme = "classic",
  timeUnitLabel = "generic",
  generateCopyReadyReport = FALSE,
  showClinicalSignificance = FALSE,
  showConfidenceIntervals = TRUE,
  enableGuidedMode = FALSE
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{patientID}{Variable containing patient identifiers (e.g., PT001,
Patient_1, Study_ID). Each patient should have a unique identifier for
proper analysis.}

\item{responseVar}{Response variable: either raw tumor measurements (mm,
cm, sum of diameters) or pre-calculated percentage changes from baseline.
For raw measurements: requires time variable with baseline at time = 0. For
percentages: negative values = tumor shrinkage (good response), positive
values = tumor growth (poor response). Example: -30 means 30\\% decrease.}

\item{timeVar}{Time point of measurement (e.g., months from baseline, days
from treatment start). Required for spider plot and raw measurement
processing. Baseline should be time = 0.}

\item{groupVar}{Optional grouping variable for coloring bars by patient
groups (e.g., treatment arms, disease subtypes). When specified, overrides
RECIST category coloring to show group-based colors.}

\item{inputType}{Specify data format: 'raw' for actual tumor measurements
(requires time variable) or 'percentage' for pre-calculated percentage
changes from baseline}

\item{sortBy}{Sort the waterfall plot by best response or patient ID.}

\item{showThresholds}{Show +20\\% and -30\\% RECIST v1.1 thresholds as dashed
lines. Helps identify Progressive Disease (PD) and Partial Response (PR)
cutoffs.}

\item{labelOutliers}{Label responses exceeding the specified threshold.}

\item{showMedian}{Show median response as a horizontal line.}

\item{showCI}{Show confidence interval around median response.}

\item{minResponseForLabel}{Minimum response value for labels to be
displayed.}

\item{colorBy}{Coloring method: RECIST categories or patient groups
(requires Group Variable).}

\item{colorScheme}{Color scheme for waterfall plot. 'Colorful' provides
distinct colors for group-based coloring.}

\item{barAlpha}{Transparency of bars in waterfall plot.}

\item{barWidth}{Width of bars in waterfall plot.}

\item{showWaterfallPlot}{Display the waterfall plot showing best response
for each patient.}

\item{showSpiderPlot}{Display spider plot showing response trajectories
over time (requires time variable).}

\item{spiderColorBy}{Coloring method for spider plot: Response status or
patient groups. For backward compatibility, defaults to response status
coloring.}

\item{spiderColorScheme}{Color scheme for spider plot lines and points.}

\item{timeUnitLabel}{Label to use for the spider plot time axis. Does not
rescale data; only affects axis labeling.}

\item{generateCopyReadyReport}{Generate publication-ready result sentences
with statistical details}

\item{showClinicalSignificance}{Display clinical significance
interpretations for ORR and DCR}

\item{showConfidenceIntervals}{Calculate and display exact binomial
confidence intervals for ORR and DCR}

\item{enableGuidedMode}{Enable step-by-step guidance for new users}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$guidedAnalysis} \tab \tab \tab \tab \tab a html \cr
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$todo2} \tab \tab \tab \tab \tab a html \cr
\code{results$clinicalSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$aboutAnalysis} \tab \tab \tab \tab \tab a html \cr
\code{results$summaryTable} \tab \tab \tab \tab \tab a table \cr
\code{results$personTimeTable} \tab \tab \tab \tab \tab a table \cr
\code{results$clinicalMetrics} \tab \tab \tab \tab \tab a table \cr
\code{results$waterfallplot} \tab \tab \tab \tab \tab an image \cr
\code{results$spiderplot} \tab \tab \tab \tab \tab an image \cr
\code{results$copyReadyReport} \tab \tab \tab \tab \tab a html \cr
\code{results$clinicalSignificance} \tab \tab \tab \tab \tab a html \cr
\code{results$clinicalGlossary} \tab \tab \tab \tab \tab a html \cr
\code{results$enhancedClinicalMetrics} \tab \tab \tab \tab \tab a table \cr
\code{results$groupComparisonTable} \tab \tab \tab \tab \tab a table \cr
\code{results$groupComparisonTest} \tab \tab \tab \tab \tab a table \cr
\code{results$addResponseCategory} \tab \tab \tab \tab \tab an output \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$summaryTable$asDF}

\code{as.data.frame(results$summaryTable)}
}
\description{
Creates waterfall and spider plots to analyze tumor response data following
RECIST criteria. Supports both raw tumor measurements and pre-calculated
percentage changes. Provides comprehensive response analysis including ORR,
DCR, and person-time metrics.
}
\examples{
\donttest{
# Example 1: Percentage data
data_pct <- data.frame(
    PatientID = paste0("PT", 1:5),
    Response = c(-60, -35, -10, 15, 45)
)
waterfall(
    data = data_pct,
    patientID = "PatientID",
    responseVar = "Response",
    inputType = "percentage"
)

# Example 2: Raw measurements
data_raw <- data.frame(
    PatientID = rep(paste0("PT", 1:3), each = 3),
    Time = rep(c(0, 2, 4), 3),
    Measurement = c(50, 30, 25, 60, 45, 40, 55, 50, 48)
)
waterfall(
    data = data_raw,
    patientID = "PatientID",
    responseVar = "Measurement",
    timeVar = "Time",
    inputType = "raw"
)
}
}
