% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mixedcox.h.R
\name{mixedcox}
\alias{mixedcox}
\title{Mixed-Effects Cox Regression}
\usage{
mixedcox(
  data,
  elapsedtime = NULL,
  tint = FALSE,
  dxdate = NULL,
  fudate = NULL,
  timetypedata = "ymd",
  timetypeoutput = "months",
  outcome = NULL,
  outcomeLevel,
  fixed_effects = NULL,
  continuous_effects = NULL,
  cluster_var = NULL,
  random_effects = "intercept",
  random_slope_var = NULL,
  nested_clustering = FALSE,
  nested_cluster_var = NULL,
  correlation_structure = "unstructured",
  sparse_matrix = TRUE,
  optimization_method = "penalized",
  likelihood_ratio_test = TRUE,
  random_effects_significance = TRUE,
  icc_calculation = TRUE,
  residual_analysis = FALSE,
  influence_diagnostics = FALSE,
  random_effects_prediction = FALSE,
  fixed_effects_plot = TRUE,
  random_effects_plot = FALSE,
  cluster_survival_plot = FALSE,
  n_clusters_plot = 5,
  variance_components = TRUE,
  confidence_intervals = TRUE,
  bootstrap_variance = FALSE,
  bootstrap_samples = 500,
  show_fixed_effects = TRUE,
  show_random_effects = TRUE,
  show_model_comparison = TRUE,
  show_cluster_summary = FALSE,
  showSummaries = FALSE,
  showExplanations = FALSE,
  addClusterEffects = FALSE,
  addFittedValues = FALSE
)
}
\arguments{
\item{data}{The dataset for analysis, provided as a data frame. Should
contain survival variables, fixed effects, and clustering variables.}

\item{elapsedtime}{The numeric variable representing follow-up time until
the event or censoring.}

\item{tint}{If true, survival time will be calculated from diagnosis and
follow-up dates.}

\item{dxdate}{Date of diagnosis or start of follow-up. Required if tint =
true.}

\item{fudate}{Follow-up date or date of last observation. Required if tint
= true.}

\item{timetypedata}{Specifies the format of date variables in the input
data.}

\item{timetypeoutput}{The units in which survival time is reported in the
output.}

\item{outcome}{The outcome variable indicating event status (e.g., death,
recurrence).}

\item{outcomeLevel}{The level of outcome considered as the event.}

\item{fixed_effects}{Categorical variables for fixed effects in the
mixed-effects model.}

\item{continuous_effects}{Continuous variables for fixed effects in the
mixed-effects model.}

\item{cluster_var}{Variable defining clusters (e.g., hospital, patient,
family). Observations within the same cluster are assumed correlated.}

\item{random_effects}{Type of random effects to include in the model.}

\item{random_slope_var}{Variable for random slopes when random_effects
includes slopes.}

\item{nested_clustering}{Whether to model nested clustering structure
(e.g., patients within hospitals).}

\item{nested_cluster_var}{Higher-level clustering variable for nested
structures.}

\item{correlation_structure}{Correlation structure for random effects.}

\item{sparse_matrix}{Use sparse matrix methods for computational efficiency
with large datasets.}

\item{optimization_method}{Method for optimizing the mixed-effects model
likelihood.}

\item{likelihood_ratio_test}{Perform likelihood ratio test comparing
mixed-effects vs standard Cox model.}

\item{random_effects_significance}{Test significance of random effects
using appropriate methods.}

\item{icc_calculation}{Calculate intracluster correlation coefficient
(ICC).}

\item{residual_analysis}{Perform residual analysis for mixed-effects Cox
model.}

\item{influence_diagnostics}{Calculate influence diagnostics for clusters
and observations.}

\item{random_effects_prediction}{Predict random effects (BLUPs) for each
cluster.}

\item{fixed_effects_plot}{Generate forest plot for fixed effects
coefficients.}

\item{random_effects_plot}{Generate plots for random effects distribution.}

\item{cluster_survival_plot}{Generate survival curves for selected
clusters.}

\item{n_clusters_plot}{Number of clusters to display in cluster-specific
plots.}

\item{variance_components}{Estimate and display variance components for
random effects.}

\item{confidence_intervals}{Calculate confidence intervals for fixed and
random effects.}

\item{bootstrap_variance}{Use bootstrap methods for variance estimation.}

\item{bootstrap_samples}{Number of bootstrap samples for variance
estimation.}

\item{show_fixed_effects}{Display table of fixed effects estimates.}

\item{show_random_effects}{Display summary of random effects variance
components.}

\item{show_model_comparison}{Display comparison between mixed-effects and
standard Cox models.}

\item{show_cluster_summary}{Display summary statistics by cluster.}

\item{showSummaries}{Display natural language summaries alongside tables
and plots for interpretation of mixed-effects Cox regression results.}

\item{showExplanations}{Display detailed explanations of mixed-effects Cox
regression methods and interpretation guidelines.}

\item{addClusterEffects}{Add predicted random effects (BLUPs) as new
variables to dataset.}

\item{addFittedValues}{Add fitted values from mixed-effects model to
dataset.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$modelSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$fixedEffectsTable} \tab \tab \tab \tab \tab a table \cr
\code{results$randomEffectsSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$varianceTable} \tab \tab \tab \tab \tab a table \cr
\code{results$iccTable} \tab \tab \tab \tab \tab a table \cr
\code{results$modelComparison} \tab \tab \tab \tab \tab a html \cr
\code{results$likelihoodRatioTable} \tab \tab \tab \tab \tab a table \cr
\code{results$clusterSummaryTable} \tab \tab \tab \tab \tab a table \cr
\code{results$randomEffectsPredTable} \tab \tab \tab \tab \tab a table \cr
\code{results$diagnosticsTable} \tab \tab \tab \tab \tab a table \cr
\code{results$fixedEffectsPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$randomEffectsPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$clusterSurvivalPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$residualPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$analysisSummary} \tab \tab \tab \tab \tab a html \cr
\code{results$methodExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$clusteringExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$randomEffectsExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$iccExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$modelSelectionExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$bootstrapTable} \tab \tab \tab \tab \tab a table \cr
\code{results$calculatedtime} \tab \tab \tab \tab \tab an output \cr
\code{results$clusterEffectsOutput} \tab \tab \tab \tab \tab an output \cr
\code{results$fittedValuesOutput} \tab \tab \tab \tab \tab an output \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$fixedEffectsTable$asDF}

\code{as.data.frame(results$fixedEffectsTable)}
}
\description{
Performs Cox proportional hazards regression with random effects for
clustered or hierarchical survival data. This method accounts for
correlation within clusters (e.g., patients within hospitals, multiple
events per patient) using mixed-effects modeling. The random effects
capture cluster-specific variation while estimating population-level  fixed
effects.
}
\examples{
# Example 1: Patients clustered within hospitals
library(survival)
library(coxme)

mixedcox(
    data = hospital_data,
    elapsedtime = "time",
    outcome = "status",
    outcomeLevel = "1",
    fixed_effects = c("age", "sex", "treatment"),
    cluster_var = "hospital_id",
    random_effects = "intercept"
)

# Example 2: Multiple tumors per patient
mixedcox(
    data = tumor_data,
    elapsedtime = "survival_time",
    outcome = "recurrence",
    outcomeLevel = "Yes",
    fixed_effects = c("tumor_size", "grade", "stage"),
    continuous_effects = c("age", "biomarker_level"),
    cluster_var = "patient_id",
    random_effects = "slope",
    random_slope_var = "treatment"
)

}
