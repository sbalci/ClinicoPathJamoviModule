% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enhancednonparametric.h.R
\name{enhancednonparametric}
\alias{enhancednonparametric}
\title{Enhanced Non-Parametric Tests}
\usage{
enhancednonparametric(
  data,
  deps,
  group,
  test_type = "mann_whitney",
  effect_size = TRUE,
  confidence_intervals = TRUE,
  posthoc = "none",
  posthoc_correction = "bonferroni",
  assumption_checks = TRUE,
  normality_tests = TRUE,
  show_descriptives = TRUE,
  descriptive_plots = TRUE,
  exact_test = FALSE,
  continuity_correction = TRUE,
  tie_correction = TRUE,
  confidence_level = 0.95,
  show_explanations = FALSE,
  show_interpretation = FALSE,
  show_recommendations = FALSE
)
}
\arguments{
\item{data}{The dataset to be analyzed, provided as a data frame. Must
contain the variables specified in the options below.}

\item{deps}{Continuous variables to be analyzed. These should be numeric
variables representing biomarker expression levels, cell counts,
morphometric measurements, or other quantitative pathology data.}

\item{group}{Categorical variable defining the groups to be compared. For
Mann-Whitney U test, this should have exactly 2 levels. For Kruskal-Wallis
test, can have 2 or more levels. Examples: tumor grade, treatment group,
diagnostic category.}

\item{test_type}{Select the appropriate non-parametric test based on your
study design: - Mann-Whitney U: Compare 2 independent groups -
Kruskal-Wallis: Compare 3+ independent groups   - Wilcoxon Signed-Rank:
Compare paired samples - Friedman: Compare repeated measures (3+ time
points)}

\item{effect_size}{Calculate appropriate effect sizes for non-parametric
tests: - Mann-Whitney: rank-biserial correlation (r) - Kruskal-Wallis:
eta-squared based on H statistic (eta²) - Wilcoxon: matched pairs
rank-biserial correlation - Friedman: Kendall's W (coefficient of
concordance)}

\item{confidence_intervals}{Calculate bootstrap confidence intervals for
effect sizes. Provides 95\\% confidence intervals using bias-corrected and
accelerated (BCa) bootstrap method.}

\item{posthoc}{Post hoc tests for multiple group comparisons
(Kruskal-Wallis): - Dunn's Test: Most conservative, controls family-wise
error rate - Conover-Iman: More powerful, uses pooled variance estimate -
Pairwise Wilcoxon: Individual Mann-Whitney tests between pairs}

\item{posthoc_correction}{Method for correcting p-values in multiple
comparisons: - Bonferroni: Most conservative, controls FWER strictly -
Holm-Bonferroni: Less conservative than Bonferroni - FDR (BH): Controls
false discovery rate (Benjamini-Hochberg) - FDR (BY): More conservative FDR
control (Benjamini-Yekutieli)}

\item{assumption_checks}{Perform assumption checks for non-parametric
tests: - Independence assessment (Durbin-Watson if applicable) -
Distribution shape comparison between groups - Outlier detection and impact
assessment - Sample size adequacy evaluation}

\item{normality_tests}{Test normality of data to justify use of
non-parametric methods. Performs Shapiro-Wilk test (n<50) or
Anderson-Darling test (n≥50) and provides recommendation for parametric vs
non-parametric analysis.}

\item{show_descriptives}{Display comprehensive descriptive statistics
including: - Median, quartiles, and interquartile range - Mean and standard
deviation (for comparison) - Sample sizes and missing data counts - Min/max
values and outlier identification}

\item{descriptive_plots}{Generate publication-quality descriptive plots: -
Box plots with individual data points - Violin plots showing distribution
shapes - Density plots for distribution comparison - QQ plots for normality
assessment}

\item{exact_test}{Use exact distribution calculations instead of asymptotic
approximations when computationally feasible. Recommended for small sample
sizes (n<20) or when ties are present in the data.}

\item{continuity_correction}{Apply continuity correction for better
approximation to normal distribution in Mann-Whitney U and Wilcoxon tests.
Generally recommended unless sample sizes are very large.}

\item{tie_correction}{Apply correction for tied observations in rank-based
tests. Important for accurate p-values when data contains many tied values,
common in categorical or discretized measurements.}

\item{confidence_level}{Confidence level for confidence intervals (e.g.,
0.95 for 95\\% CI). Applied to effect size confidence intervals and
descriptive statistics.}

\item{show_explanations}{Display detailed explanations of non-parametric
methods, assumptions, and interpretation guidelines. Helpful for
educational purposes and ensuring proper understanding of the statistical
methods used.}

\item{show_interpretation}{Provide plain-language interpretation of
statistical results, including effect size magnitude interpretation and
clinical significance guidelines. Designed to help non-statisticians
understand results.}

\item{show_recommendations}{Provide recommendations for follow-up analyses,
sample size considerations, and potential improvements to study design.
Includes guidance on when to consider parametric alternatives or additional
testing.}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab a html \cr
\code{results$descriptives} \tab \tab \tab \tab \tab a table \cr
\code{results$normality} \tab \tab \tab \tab \tab a table \cr
\code{results$assumptions} \tab \tab \tab \tab \tab a table \cr
\code{results$tests} \tab \tab \tab \tab \tab a table \cr
\code{results$effectsizes} \tab \tab \tab \tab \tab a table \cr
\code{results$posthoc} \tab \tab \tab \tab \tab a table \cr
\code{results$distributionplot} \tab \tab \tab \tab \tab an image \cr
\code{results$boxplot} \tab \tab \tab \tab \tab an image \cr
\code{results$violinplot} \tab \tab \tab \tab \tab an image \cr
\code{results$effectsizeplot} \tab \tab \tab \tab \tab an image \cr
\code{results$qqplot} \tab \tab \tab \tab \tab an image \cr
\code{results$methodExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$effectSizeExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$postHocExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$assumptionExplanation} \tab \tab \tab \tab \tab a html \cr
\code{results$resultInterpretation} \tab \tab \tab \tab \tab a html \cr
\code{results$clinicalInterpretation} \tab \tab \tab \tab \tab a html \cr
\code{results$statisticalRecommendations} \tab \tab \tab \tab \tab a html \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$descriptives$asDF}

\code{as.data.frame(results$descriptives)}
}
\description{
Performs enhanced non-parametric statistical tests specifically designed
for digital pathology and biomarker analysis. This module provides
comprehensive non-parametric testing with proper effect size calculations,
assumption checking, and post hoc analysis - addressing critical gaps
identified in 30\\% of pathology studies that use these methods. Includes
enhanced  Mann-Whitney U tests, Kruskal-Wallis tests with Dunn's post hoc
testing, and proper  multiple comparison corrections commonly needed in
biomarker expression analysis.
}
\examples{
# Example 1: Enhanced Mann-Whitney U test for biomarker expression
library(ClinicoPath)
data(histopathology)

enhancednonparametric(
    data = histopathology,
    deps = "Age",
    group = "Group",
    test_type = "mann_whitney",
    effect_size = TRUE,
    assumption_checks = TRUE,
    show_descriptives = TRUE
)

# Example 2: Kruskal-Wallis with post hoc analysis for tumor grades
enhancednonparametric(
    data = histopathology,
    deps = "Age",
    group = "Grade",
    test_type = "kruskal_wallis",
    posthoc = "dunn",
    posthoc_correction = "bonferroni",
    effect_size = TRUE,
    assumption_checks = TRUE
)

}
