% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ihccluster.h.R
\name{ihccluster}
\alias{ihccluster}
\title{IHC Clustering Analysis}
\usage{
ihccluster(
  data,
  catVars,
  contVars,
  vars,
  caseId,
  method = "pam",
  k,
  autoK,
  nClusters,
  autoSelectK = TRUE,
  kRange = "medium",
  scaleContVars = TRUE,
  weights = "",
  handleMissing = "pairwise",
  consensusClustering = FALSE,
  nBootstrap = 100,
  seed = 42,
  showSilhouette = TRUE,
  showHeatmap = TRUE,
  heatmapScale = "row",
  showDendrogram = TRUE,
  showPCAPlot = TRUE,
  showBoxplots = TRUE,
  showSil = FALSE,
  assocTests = FALSE,
  markerSummary = TRUE,
  clusterProfiles = TRUE,
  associationTests = TRUE,
  exportClusters = FALSE,
  clinicalVars,
  survivalTime,
  survivalEvent
)
}
\arguments{
\item{data}{The data as a data frame.}

\item{catVars}{Binary (pos/neg) or ordinal (0/1/2/3) stain results}

\item{contVars}{H-scores (0-300), \\% positivity (0-100), or other
continuous measures}

\item{vars}{Legacy option: categorical stain variables (use catVars
instead)}

\item{caseId}{Case identifier for tracking}

\item{method}{Clustering algorithm to use}

\item{k}{Legacy option: use nClusters instead}

\item{autoK}{Legacy option: use autoSelectK instead}

\item{nClusters}{Leave blank for automatic selection using silhouette}

\item{autoSelectK}{Use silhouette width to find optimal number of clusters}

\item{kRange}{Range to test when auto-selecting k}

\item{scaleContVars}{Z-score continuous markers before clustering}

\item{weights}{Comma-separated weights for markers (e.g., "1,1,2,1" for 4
markers)}

\item{handleMissing}{How to handle missing values}

\item{consensusClustering}{Use bootstrap resampling for stable clusters}

\item{nBootstrap}{Number of bootstrap samples for consensus}

\item{seed}{For reproducibility}

\item{showSilhouette}{Show silhouette width plot for cluster quality}

\item{showHeatmap}{Show clustered heatmap of IHC expression}

\item{heatmapScale}{How to scale heatmap values}

\item{showDendrogram}{Show dendrogram for hierarchical clustering}

\item{showPCAPlot}{Show dimension reduction plot with clusters}

\item{showBoxplots}{Show boxplots of continuous markers by cluster}

\item{showSil}{Legacy option: use showSilhouette instead}

\item{assocTests}{Legacy option: use associationTests instead}

\item{markerSummary}{Summary statistics for each marker by cluster}

\item{clusterProfiles}{Characteristic features of each cluster}

\item{associationTests}{Test marker-cluster associations}

\item{exportClusters}{Save cluster assignments to dataset}

\item{clinicalVars}{Clinical variables to compare across clusters}

\item{survivalTime}{Time variable for survival analysis}

\item{survivalEvent}{Event variable for survival analysis}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$todo} \tab \tab \tab \tab \tab a html \cr
\code{results$summary} \tab \tab \tab \tab \tab a html \cr
\code{results$clusterSizes} \tab \tab \tab \tab \tab a table \cr
\code{results$silhouetteStats} \tab \tab \tab \tab \tab a table \cr
\code{results$clusterProfiles} \tab \tab \tab \tab \tab a table \cr
\code{results$markerSummary} \tab \tab \tab \tab \tab a table \cr
\code{results$associationTests} \tab \tab \tab \tab \tab a table \cr
\code{results$clinicalComparison} \tab \tab \tab \tab \tab a table \cr
\code{results$consensusStats} \tab \tab \tab \tab \tab a table \cr
\code{results$silhouettePlot} \tab \tab \tab \tab \tab an image \cr
\code{results$heatmapPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$dendrogramPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$pcaPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$boxplotPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$survivalPlot} \tab \tab \tab \tab \tab an image \cr
\code{results$medoidInfo} \tab \tab \tab \tab \tab a table \cr
\code{results$interpretationGuide} \tab \tab \tab \tab \tab a html \cr
\code{results$technicalNotes} \tab \tab \tab \tab \tab a html \cr
\code{results$sizes} \tab \tab \tab \tab \tab a table \cr
\code{results$modes} \tab \tab \tab \tab \tab a table \cr
\code{results$distr} \tab \tab \tab \tab \tab a table \cr
\code{results$assoc} \tab \tab \tab \tab \tab a table \cr
\code{results$text} \tab \tab \tab \tab \tab a preformatted \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$clusterSizes$asDF}

\code{as.data.frame(results$clusterSizes)}
}
\description{
Clusters cases based on immunohistochemistry (IHC) staining patterns.
Supports both categorical (pos/neg, intensity levels) and continuous
(H-score, \\% positivity) markers. Uses Gower distance to handle mixed
data types appropriately.
}
