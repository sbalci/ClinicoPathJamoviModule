% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hierarchicalpathology.h.R
\name{hierarchicalpathology}
\alias{hierarchicalpathology}
\title{Hierarchical Mixed-Effects Models}
\usage{
hierarchicalpathology(
  data,
  dependent,
  level_3,
  level_2,
  level_1,
  covariates,
  model_type = "linear",
  descriptives = TRUE,
  variance_components = TRUE,
  icc_analysis = TRUE,
  random_effects = TRUE,
  model_comparison = FALSE,
  diagnostics = TRUE,
  confidence_level = 0.95,
  optimizer = "bobyqa",
  max_iterations = 1000
)
}
\arguments{
\item{data}{the data as a data frame}

\item{dependent}{The dependent variable from \code{data}, variable must be
numeric}

\item{level_3}{Highest level grouping variable (e.g., Patient ID,
Institution)}

\item{level_2}{Intermediate level grouping variable (e.g., Slide ID, Sample
ID)}

\item{level_1}{Lowest level grouping variable (e.g., ROI ID, Field ID)}

\item{covariates}{Optional covariates for fixed effects (age, treatment,
etc.)}

\item{model_type}{Type of mixed-effects model based on outcome variable}

\item{descriptives}{Show descriptive statistics by hierarchical level}

\item{variance_components}{Calculate and display variance components}

\item{icc_analysis}{Calculate Intraclass Correlation Coefficients}

\item{random_effects}{Display random effects variance and standard
deviations}

\item{model_comparison}{Compare nested models with likelihood ratio tests}

\item{diagnostics}{Generate diagnostic plots and residual analysis}

\item{confidence_level}{Confidence level for parameter estimates and
intervals}

\item{optimizer}{Optimization algorithm for model fitting}

\item{max_iterations}{Maximum number of iterations for model convergence}
}
\value{
A results object containing:
\tabular{llllll}{
\code{results$instructions} \tab \tab \tab \tab \tab Instructions for hierarchical mixed-effects modeling \cr
\code{results$descriptives} \tab \tab \tab \tab \tab Summary statistics for each hierarchical level \cr
\code{results$modelresults} \tab \tab \tab \tab \tab Fixed effects parameter estimates and tests \cr
\code{results$randomeffects} \tab \tab \tab \tab \tab Random effects variance components \cr
\code{results$variancecomponents} \tab \tab \tab \tab \tab Partition of variance across hierarchical levels \cr
\code{results$icc} \tab \tab \tab \tab \tab ICC values indicating clustering effects \cr
\code{results$modelcomparison} \tab \tab \tab \tab \tab Likelihood ratio tests comparing nested models \cr
\code{results$diagnosticplot} \tab \tab \tab \tab \tab Residual plots and diagnostic checks \cr
\code{results$residualplot} \tab \tab \tab \tab \tab Residuals plotted by hierarchical level \cr
\code{results$interpretation} \tab \tab \tab \tab \tab Clinical context and interpretation for hierarchical models \cr
}

Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:

\code{results$descriptives$asDF}

\code{as.data.frame(results$descriptives)}
}
\description{
Hierarchical (multilevel) mixed-effects models for analyzing nested
pathology data structures. Essential for WSI analysis with Patient >
Slide > ROI > Cell hierarchies, and prevents Type I errors from ignoring
clustering effects.
}
\examples{
data('histopathology')

hierarchicalpathology(data = histopathology,
                     dependent = measurement,
                     level_3 = patient_id,
                     level_2 = slide_id,
                     level_1 = roi_id)

}
