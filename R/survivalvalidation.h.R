
# This file is automatically generated, you probably don't want to edit this

survivalvalidationOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "survivalvalidationOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            time = NULL,
            status = NULL,
            predicted_risk = NULL,
            covariates = NULL,
            model_formula = "",
            validation_method = "cv",
            cv_folds = 10,
            bootstrap_samples = 500,
            concordance_index = TRUE,
            time_dependent_auc = TRUE,
            prediction_error = TRUE,
            integrated_brier = TRUE,
            calibration_plot = TRUE,
            decision_curve = TRUE,
            time_points = "1,2,3,5",
            max_time = 0,
            plot_roc_curves = TRUE,
            plot_calibration = TRUE,
            plot_decision_curve = TRUE,
            plot_prediction_error = TRUE,
            confidence_level = 0.95,
            smoothing = TRUE,
            risk_groups = 4,
            competing_risks = FALSE,
            cause_specific = NULL,
            model_comparison = FALSE,
            model_names = "",
            net_benefit_thresholds = "0.01,0.05,0.1,0.2,0.3", ...) {

            super$initialize(
                package="ClinicoPath",
                name="survivalvalidation",
                requiresData=TRUE,
                ...)

            private$..time <- jmvcore::OptionVariable$new(
                "time",
                time,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..status <- jmvcore::OptionVariable$new(
                "status",
                status,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "numeric"),
                default=NULL)
            private$..predicted_risk <- jmvcore::OptionVariable$new(
                "predicted_risk",
                predicted_risk,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..covariates <- jmvcore::OptionVariables$new(
                "covariates",
                covariates,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                default=NULL)
            private$..model_formula <- jmvcore::OptionString$new(
                "model_formula",
                model_formula,
                default="")
            private$..validation_method <- jmvcore::OptionList$new(
                "validation_method",
                validation_method,
                options=list(
                    "cv",
                    "bootstrap",
                    "external",
                    "apparent",
                    "optimism"),
                default="cv")
            private$..cv_folds <- jmvcore::OptionInteger$new(
                "cv_folds",
                cv_folds,
                default=10,
                min=3,
                max=20)
            private$..bootstrap_samples <- jmvcore::OptionInteger$new(
                "bootstrap_samples",
                bootstrap_samples,
                default=500,
                min=100,
                max=2000)
            private$..concordance_index <- jmvcore::OptionBool$new(
                "concordance_index",
                concordance_index,
                default=TRUE)
            private$..time_dependent_auc <- jmvcore::OptionBool$new(
                "time_dependent_auc",
                time_dependent_auc,
                default=TRUE)
            private$..prediction_error <- jmvcore::OptionBool$new(
                "prediction_error",
                prediction_error,
                default=TRUE)
            private$..integrated_brier <- jmvcore::OptionBool$new(
                "integrated_brier",
                integrated_brier,
                default=TRUE)
            private$..calibration_plot <- jmvcore::OptionBool$new(
                "calibration_plot",
                calibration_plot,
                default=TRUE)
            private$..decision_curve <- jmvcore::OptionBool$new(
                "decision_curve",
                decision_curve,
                default=TRUE)
            private$..time_points <- jmvcore::OptionString$new(
                "time_points",
                time_points,
                default="1,2,3,5")
            private$..max_time <- jmvcore::OptionNumber$new(
                "max_time",
                max_time,
                default=0,
                min=0)
            private$..plot_roc_curves <- jmvcore::OptionBool$new(
                "plot_roc_curves",
                plot_roc_curves,
                default=TRUE)
            private$..plot_calibration <- jmvcore::OptionBool$new(
                "plot_calibration",
                plot_calibration,
                default=TRUE)
            private$..plot_decision_curve <- jmvcore::OptionBool$new(
                "plot_decision_curve",
                plot_decision_curve,
                default=TRUE)
            private$..plot_prediction_error <- jmvcore::OptionBool$new(
                "plot_prediction_error",
                plot_prediction_error,
                default=TRUE)
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.5,
                max=0.99)
            private$..smoothing <- jmvcore::OptionBool$new(
                "smoothing",
                smoothing,
                default=TRUE)
            private$..risk_groups <- jmvcore::OptionInteger$new(
                "risk_groups",
                risk_groups,
                default=4,
                min=2,
                max=10)
            private$..competing_risks <- jmvcore::OptionBool$new(
                "competing_risks",
                competing_risks,
                default=FALSE)
            private$..cause_specific <- jmvcore::OptionVariable$new(
                "cause_specific",
                cause_specific,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..model_comparison <- jmvcore::OptionBool$new(
                "model_comparison",
                model_comparison,
                default=FALSE)
            private$..model_names <- jmvcore::OptionString$new(
                "model_names",
                model_names,
                default="")
            private$..net_benefit_thresholds <- jmvcore::OptionString$new(
                "net_benefit_thresholds",
                net_benefit_thresholds,
                default="0.01,0.05,0.1,0.2,0.3")

            self$.addOption(private$..time)
            self$.addOption(private$..status)
            self$.addOption(private$..predicted_risk)
            self$.addOption(private$..covariates)
            self$.addOption(private$..model_formula)
            self$.addOption(private$..validation_method)
            self$.addOption(private$..cv_folds)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..concordance_index)
            self$.addOption(private$..time_dependent_auc)
            self$.addOption(private$..prediction_error)
            self$.addOption(private$..integrated_brier)
            self$.addOption(private$..calibration_plot)
            self$.addOption(private$..decision_curve)
            self$.addOption(private$..time_points)
            self$.addOption(private$..max_time)
            self$.addOption(private$..plot_roc_curves)
            self$.addOption(private$..plot_calibration)
            self$.addOption(private$..plot_decision_curve)
            self$.addOption(private$..plot_prediction_error)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..smoothing)
            self$.addOption(private$..risk_groups)
            self$.addOption(private$..competing_risks)
            self$.addOption(private$..cause_specific)
            self$.addOption(private$..model_comparison)
            self$.addOption(private$..model_names)
            self$.addOption(private$..net_benefit_thresholds)
        }),
    active = list(
        time = function() private$..time$value,
        status = function() private$..status$value,
        predicted_risk = function() private$..predicted_risk$value,
        covariates = function() private$..covariates$value,
        model_formula = function() private$..model_formula$value,
        validation_method = function() private$..validation_method$value,
        cv_folds = function() private$..cv_folds$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        concordance_index = function() private$..concordance_index$value,
        time_dependent_auc = function() private$..time_dependent_auc$value,
        prediction_error = function() private$..prediction_error$value,
        integrated_brier = function() private$..integrated_brier$value,
        calibration_plot = function() private$..calibration_plot$value,
        decision_curve = function() private$..decision_curve$value,
        time_points = function() private$..time_points$value,
        max_time = function() private$..max_time$value,
        plot_roc_curves = function() private$..plot_roc_curves$value,
        plot_calibration = function() private$..plot_calibration$value,
        plot_decision_curve = function() private$..plot_decision_curve$value,
        plot_prediction_error = function() private$..plot_prediction_error$value,
        confidence_level = function() private$..confidence_level$value,
        smoothing = function() private$..smoothing$value,
        risk_groups = function() private$..risk_groups$value,
        competing_risks = function() private$..competing_risks$value,
        cause_specific = function() private$..cause_specific$value,
        model_comparison = function() private$..model_comparison$value,
        model_names = function() private$..model_names$value,
        net_benefit_thresholds = function() private$..net_benefit_thresholds$value),
    private = list(
        ..time = NA,
        ..status = NA,
        ..predicted_risk = NA,
        ..covariates = NA,
        ..model_formula = NA,
        ..validation_method = NA,
        ..cv_folds = NA,
        ..bootstrap_samples = NA,
        ..concordance_index = NA,
        ..time_dependent_auc = NA,
        ..prediction_error = NA,
        ..integrated_brier = NA,
        ..calibration_plot = NA,
        ..decision_curve = NA,
        ..time_points = NA,
        ..max_time = NA,
        ..plot_roc_curves = NA,
        ..plot_calibration = NA,
        ..plot_decision_curve = NA,
        ..plot_prediction_error = NA,
        ..confidence_level = NA,
        ..smoothing = NA,
        ..risk_groups = NA,
        ..competing_risks = NA,
        ..cause_specific = NA,
        ..model_comparison = NA,
        ..model_names = NA,
        ..net_benefit_thresholds = NA)
)

survivalvalidationResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "survivalvalidationResults",
    inherit = jmvcore::Group,
    active = list(
        todo = function() private$.items[["todo"]],
        summary = function() private$.items[["summary"]],
        performanceTable = function() private$.items[["performanceTable"]],
        concordanceTable = function() private$.items[["concordanceTable"]],
        aucTable = function() private$.items[["aucTable"]],
        brierTable = function() private$.items[["brierTable"]],
        calibrationTable = function() private$.items[["calibrationTable"]],
        decisionTable = function() private$.items[["decisionTable"]],
        rocPlot = function() private$.items[["rocPlot"]],
        calibrationPlot = function() private$.items[["calibrationPlot"]],
        decisionPlot = function() private$.items[["decisionPlot"]],
        predErrorPlot = function() private$.items[["predErrorPlot"]],
        calibrationMetrics = function() private$.items[["calibrationMetrics"]],
        validationSummary = function() private$.items[["validationSummary"]],
        modelComparison = function() private$.items[["modelComparison"]],
        externalValidation = function() private$.items[["externalValidation"]],
        competingRisksMetrics = function() private$.items[["competingRisksMetrics"]],
        interpretation = function() private$.items[["interpretation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Survival Model Validation",
                refs=list(
                    "ClinicoPathJamoviModule",
                    "survival",
                    "survcomp",
                    "glue",
                    "timeROC",
                    "pec"))
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="To Do",
                clearWith=list(
                    "time",
                    "status",
                    "predicted_risk")))
            self$add(jmvcore::Html$new(
                options=options,
                name="summary",
                title="Validation Summary",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="performanceTable",
                title="Model Performance Metrics",
                visible=TRUE,
                rows=1,
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="apparent", 
                        `title`="Apparent", 
                        `type`="number"),
                    list(
                        `name`="validated", 
                        `title`="Validated", 
                        `type`="number"),
                    list(
                        `name`="optimism", 
                        `title`="Optimism", 
                        `type`="number"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="concordanceTable",
                title="Concordance Index Results",
                visible="(concordance_index)",
                rows=1,
                columns=list(
                    list(
                        `name`="method", 
                        `title`="Method", 
                        `type`="text"),
                    list(
                        `name`="c_index", 
                        `title`="C-index", 
                        `type`="number"),
                    list(
                        `name`="c_ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="c_ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="aucTable",
                title="Time-dependent AUC Results",
                visible="(time_dependent_auc)",
                rows=1,
                columns=list(
                    list(
                        `name`="time_point", 
                        `title`="Time", 
                        `type`="number"),
                    list(
                        `name`="auc", 
                        `title`="AUC", 
                        `type`="number"),
                    list(
                        `name`="auc_ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="auc_ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"),
                    list(
                        `name`="sensitivity", 
                        `title`="Sensitivity", 
                        `type`="number"),
                    list(
                        `name`="specificity", 
                        `title`="Specificity", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="brierTable",
                title="Brier Score Results",
                visible="(prediction_error)",
                rows=1,
                columns=list(
                    list(
                        `name`="time_point", 
                        `title`="Time", 
                        `type`="number"),
                    list(
                        `name`="brier_score", 
                        `title`="Brier Score", 
                        `type`="number"),
                    list(
                        `name`="brier_ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="brier_ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"),
                    list(
                        `name`="integrated_brier", 
                        `title`="IBS", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="calibrationTable",
                title="Calibration Assessment",
                visible="(calibration_plot)",
                rows=1,
                columns=list(
                    list(
                        `name`="risk_group", 
                        `title`="Risk Group", 
                        `type`="text"),
                    list(
                        `name`="predicted", 
                        `title`="Predicted Risk", 
                        `type`="number"),
                    list(
                        `name`="observed", 
                        `title`="Observed Risk", 
                        `type`="number"),
                    list(
                        `name`="n_patients", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="n_events", 
                        `title`="Events", 
                        `type`="integer"),
                    list(
                        `name`="obs_ci_lower", 
                        `title`="Obs CI Lower", 
                        `type`="number"),
                    list(
                        `name`="obs_ci_upper", 
                        `title`="Obs CI Upper", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="decisionTable",
                title="Decision Curve Analysis",
                visible="(decision_curve)",
                rows=1,
                columns=list(
                    list(
                        `name`="threshold", 
                        `title`="Threshold", 
                        `type`="number"),
                    list(
                        `name`="net_benefit", 
                        `title`="Net Benefit", 
                        `type`="number"),
                    list(
                        `name`="nb_ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="nb_ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"),
                    list(
                        `name`="treat_all", 
                        `title`="Treat All", 
                        `type`="number"),
                    list(
                        `name`="treat_none", 
                        `title`="Treat None", 
                        `type`="number"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="rocPlot",
                title="Time-dependent ROC Curves",
                width=700,
                height=450,
                renderFun=".plotROC",
                visible="(plot_roc_curves && time_dependent_auc)",
                clearWith=list(
                    "time",
                    "status",
                    "predicted_risk",
                    "time_points")))
            self$add(jmvcore::Image$new(
                options=options,
                name="calibrationPlot",
                title="Calibration Plot",
                width=700,
                height=450,
                renderFun=".plotCalibration",
                visible="(plot_calibration && calibration_plot)",
                clearWith=list(
                    "time",
                    "status",
                    "predicted_risk",
                    "risk_groups")))
            self$add(jmvcore::Image$new(
                options=options,
                name="decisionPlot",
                title="Decision Curve Analysis",
                width=700,
                height=450,
                renderFun=".plotDecision",
                visible="(plot_decision_curve && decision_curve)",
                clearWith=list(
                    "time",
                    "status",
                    "predicted_risk",
                    "net_benefit_thresholds")))
            self$add(jmvcore::Image$new(
                options=options,
                name="predErrorPlot",
                title="Prediction Error Curves",
                width=700,
                height=450,
                renderFun=".plotPredError",
                visible="(plot_prediction_error && prediction_error)",
                clearWith=list(
                    "time",
                    "status",
                    "predicted_risk",
                    "max_time")))
            self$add(jmvcore::Table$new(
                options=options,
                name="calibrationMetrics",
                title="Calibration Metrics",
                visible="(calibration_plot)",
                rows=1,
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="validationSummary",
                title="Overall Validation Assessment",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelComparison",
                title="Model Comparison Results",
                visible="(model_comparison)",
                rows=1,
                columns=list(
                    list(
                        `name`="model_name", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="c_index", 
                        `title`="C-index", 
                        `type`="number"),
                    list(
                        `name`="auc_mean", 
                        `title`="Mean AUC", 
                        `type`="number"),
                    list(
                        `name`="ibs", 
                        `title`="IBS", 
                        `type`="number"),
                    list(
                        `name`="net_benefit_max", 
                        `title`="Max Net Benefit", 
                        `type`="number"),
                    list(
                        `name`="rank", 
                        `title`="Rank", 
                        `type`="integer"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="externalValidation",
                title="External Validation Results",
                visible="(validation_method:external)",
                clearWith=list(
                    "external_data",
                    "predicted_risk")))
            self$add(jmvcore::Table$new(
                options=options,
                name="competingRisksMetrics",
                title="Competing Risks Validation",
                visible="(competing_risks)",
                rows=1,
                columns=list(
                    list(
                        `name`="cause", 
                        `title`="Cause", 
                        `type`="text"),
                    list(
                        `name`="c_index_cause", 
                        `title`="Cause-Specific C-index", 
                        `type`="number"),
                    list(
                        `name`="auc_cause", 
                        `title`="Cause-Specific AUC", 
                        `type`="number"),
                    list(
                        `name`="subdist_c_index", 
                        `title`="Subdistribution C-index", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="interpretation",
                title="Clinical Interpretation",
                visible=TRUE))}))

survivalvalidationBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "survivalvalidationBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "survivalvalidation",
                version = c(0,0,3),
                options = options,
                results = survivalvalidationResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Survival Model Validation
#'
#' Comprehensive validation and performance assessment for survival models.
#' Includes prediction error curves, time-dependent ROC analysis, calibration 
#' plots,
#' and decision curve analysis for clinical decision making.
#' 
#'
#' @examples
#' \donttest{
#' # Example: Validate Cox regression model
#' survivalvalidation(
#'     data = cancer_data,
#'     time = followup_time,
#'     status = death_status,
#'     predicted_risk = risk_score,
#'     validation_method = "cv",
#'     time_points = c(1, 3, 5)
#' )
#'}
#' @param data The data as a data frame.
#' @param time Time to event or censoring
#' @param status Event indicator variable
#' @param predicted_risk Model predictions to validate
#' @param covariates Covariates to include in the model formula
#' @param model_formula Variables for Cox model if predictions not provided
#' @param external_data Optional external dataset for validation
#' @param validation_method Validation approach
#' @param cv_folds CV fold specification
#' @param bootstrap_samples Bootstrap iterations
#' @param concordance_index Compute C-index
#' @param time_dependent_auc Compute time-dependent AUC
#' @param prediction_error Compute prediction error curves
#' @param integrated_brier Compute IBS
#' @param calibration_plot Create calibration assessment
#' @param decision_curve DCA for clinical decision making
#' @param time_points Specific times for assessment
#' @param max_time Upper time limit
#' @param plot_roc_curves Generate ROC plots
#' @param plot_calibration Generate calibration plots
#' @param plot_decision_curve Generate DCA plots
#' @param plot_prediction_error Generate PEC plots
#' @param confidence_level CI level
#' @param smoothing Smooth curve estimation
#' @param risk_groups Risk group stratification
#' @param competing_risks Competing risks consideration
#' @param cause_specific Cause-specific event variable
#' @param model_comparison Multi-model comparison
#' @param model_names Model labels for comparison
#' @param net_benefit_thresholds DCA threshold range
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$todo} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$summary} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$performanceTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$concordanceTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$aucTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$brierTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$calibrationTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$decisionTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$rocPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$calibrationPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$decisionPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$predErrorPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$calibrationMetrics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$validationSummary} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$modelComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$externalValidation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$competingRisksMetrics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$performanceTable$asDF}
#'
#' \code{as.data.frame(results$performanceTable)}
#'
#' @export
survivalvalidation <- function(
    data,
    time = NULL,
    status = NULL,
    predicted_risk = NULL,
    covariates = NULL,
    model_formula = "",
    external_data,
    validation_method = "cv",
    cv_folds = 10,
    bootstrap_samples = 500,
    concordance_index = TRUE,
    time_dependent_auc = TRUE,
    prediction_error = TRUE,
    integrated_brier = TRUE,
    calibration_plot = TRUE,
    decision_curve = TRUE,
    time_points = "1,2,3,5",
    max_time = 0,
    plot_roc_curves = TRUE,
    plot_calibration = TRUE,
    plot_decision_curve = TRUE,
    plot_prediction_error = TRUE,
    confidence_level = 0.95,
    smoothing = TRUE,
    risk_groups = 4,
    competing_risks = FALSE,
    cause_specific = NULL,
    model_comparison = FALSE,
    model_names = "",
    net_benefit_thresholds = "0.01,0.05,0.1,0.2,0.3") {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("survivalvalidation requires jmvcore to be installed (restart may be required)")

    if ( ! missing(time)) time <- jmvcore::resolveQuo(jmvcore::enquo(time))
    if ( ! missing(status)) status <- jmvcore::resolveQuo(jmvcore::enquo(status))
    if ( ! missing(predicted_risk)) predicted_risk <- jmvcore::resolveQuo(jmvcore::enquo(predicted_risk))
    if ( ! missing(covariates)) covariates <- jmvcore::resolveQuo(jmvcore::enquo(covariates))
    if ( ! missing(cause_specific)) cause_specific <- jmvcore::resolveQuo(jmvcore::enquo(cause_specific))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(time), time, NULL),
            `if`( ! missing(status), status, NULL),
            `if`( ! missing(predicted_risk), predicted_risk, NULL),
            `if`( ! missing(covariates), covariates, NULL),
            `if`( ! missing(cause_specific), cause_specific, NULL))

    for (v in cause_specific) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- survivalvalidationOptions$new(
        time = time,
        status = status,
        predicted_risk = predicted_risk,
        covariates = covariates,
        model_formula = model_formula,
        validation_method = validation_method,
        cv_folds = cv_folds,
        bootstrap_samples = bootstrap_samples,
        concordance_index = concordance_index,
        time_dependent_auc = time_dependent_auc,
        prediction_error = prediction_error,
        integrated_brier = integrated_brier,
        calibration_plot = calibration_plot,
        decision_curve = decision_curve,
        time_points = time_points,
        max_time = max_time,
        plot_roc_curves = plot_roc_curves,
        plot_calibration = plot_calibration,
        plot_decision_curve = plot_decision_curve,
        plot_prediction_error = plot_prediction_error,
        confidence_level = confidence_level,
        smoothing = smoothing,
        risk_groups = risk_groups,
        competing_risks = competing_risks,
        cause_specific = cause_specific,
        model_comparison = model_comparison,
        model_names = model_names,
        net_benefit_thresholds = net_benefit_thresholds)

    analysis <- survivalvalidationClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

