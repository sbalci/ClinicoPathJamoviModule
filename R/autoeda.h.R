
# This file is automatically generated, you probably don't want to edit this

autoedaOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "autoedaOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            vars = NULL,
            analysis_type = "overview",
            target_var = NULL,
            include_plots = TRUE,
            missing_threshold = 5,
            correlation_method = "pearson",
            pca_components = 5,
            plot_theme = "clinical",
            output_format = "combined",
            eda_engine = "dataexplorer",
            advanced_options = FALSE,
            categorical_limit = 15,
            generate_report = FALSE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="autoeda",
                requiresData=TRUE,
                ...)

            private$..vars <- jmvcore::OptionVariables$new(
                "vars",
                vars,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..analysis_type <- jmvcore::OptionList$new(
                "analysis_type",
                analysis_type,
                options=list(
                    "overview",
                    "missing",
                    "distributions",
                    "correlation",
                    "pca",
                    "target",
                    "comprehensive",
                    "ggeda_overview",
                    "ggeda_distributions",
                    "ggeda_correlation",
                    "ggeda_biomarker"),
                default="overview")
            private$..target_var <- jmvcore::OptionVariable$new(
                "target_var",
                target_var,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..include_plots <- jmvcore::OptionBool$new(
                "include_plots",
                include_plots,
                default=TRUE)
            private$..missing_threshold <- jmvcore::OptionNumber$new(
                "missing_threshold",
                missing_threshold,
                min=0,
                max=100,
                default=5)
            private$..correlation_method <- jmvcore::OptionList$new(
                "correlation_method",
                correlation_method,
                options=list(
                    "pearson",
                    "spearman",
                    "kendall"),
                default="pearson")
            private$..pca_components <- jmvcore::OptionInteger$new(
                "pca_components",
                pca_components,
                min=2,
                max=10,
                default=5)
            private$..plot_theme <- jmvcore::OptionList$new(
                "plot_theme",
                plot_theme,
                options=list(
                    "default",
                    "minimal",
                    "classic",
                    "clinical"),
                default="clinical")
            private$..output_format <- jmvcore::OptionList$new(
                "output_format",
                output_format,
                options=list(
                    "html",
                    "tables",
                    "combined"),
                default="combined")
            private$..eda_engine <- jmvcore::OptionList$new(
                "eda_engine",
                eda_engine,
                options=list(
                    "dataexplorer",
                    "ggeda",
                    "hybrid"),
                default="dataexplorer")
            private$..advanced_options <- jmvcore::OptionBool$new(
                "advanced_options",
                advanced_options,
                default=FALSE)
            private$..categorical_limit <- jmvcore::OptionInteger$new(
                "categorical_limit",
                categorical_limit,
                min=5,
                max=50,
                default=15)
            private$..generate_report <- jmvcore::OptionBool$new(
                "generate_report",
                generate_report,
                default=FALSE)

            self$.addOption(private$..vars)
            self$.addOption(private$..analysis_type)
            self$.addOption(private$..target_var)
            self$.addOption(private$..include_plots)
            self$.addOption(private$..missing_threshold)
            self$.addOption(private$..correlation_method)
            self$.addOption(private$..pca_components)
            self$.addOption(private$..plot_theme)
            self$.addOption(private$..output_format)
            self$.addOption(private$..eda_engine)
            self$.addOption(private$..advanced_options)
            self$.addOption(private$..categorical_limit)
            self$.addOption(private$..generate_report)
        }),
    active = list(
        vars = function() private$..vars$value,
        analysis_type = function() private$..analysis_type$value,
        target_var = function() private$..target_var$value,
        include_plots = function() private$..include_plots$value,
        missing_threshold = function() private$..missing_threshold$value,
        correlation_method = function() private$..correlation_method$value,
        pca_components = function() private$..pca_components$value,
        plot_theme = function() private$..plot_theme$value,
        output_format = function() private$..output_format$value,
        eda_engine = function() private$..eda_engine$value,
        advanced_options = function() private$..advanced_options$value,
        categorical_limit = function() private$..categorical_limit$value,
        generate_report = function() private$..generate_report$value),
    private = list(
        ..vars = NA,
        ..analysis_type = NA,
        ..target_var = NA,
        ..include_plots = NA,
        ..missing_threshold = NA,
        ..correlation_method = NA,
        ..pca_components = NA,
        ..plot_theme = NA,
        ..output_format = NA,
        ..eda_engine = NA,
        ..advanced_options = NA,
        ..categorical_limit = NA,
        ..generate_report = NA)
)

autoedaResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "autoedaResults",
    inherit = jmvcore::Group,
    active = list(
        todo = function() private$.items[["todo"]],
        overview = function() private$.items[["overview"]],
        missing_analysis = function() private$.items[["missing_analysis"]],
        distributions = function() private$.items[["distributions"]],
        correlation_analysis = function() private$.items[["correlation_analysis"]],
        pca_analysis = function() private$.items[["pca_analysis"]],
        target_analysis = function() private$.items[["target_analysis"]],
        comprehensive_report = function() private$.items[["comprehensive_report"]],
        plots = function() private$.items[["plots"]],
        recommendations = function() private$.items[["recommendations"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Automated Exploratory Data Analysis",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="Instructions",
                visible=FALSE))
            self$add(jmvcore::Html$new(
                options=options,
                name="overview",
                title="Dataset Overview"))
            self$add(jmvcore::Html$new(
                options=options,
                name="missing_analysis",
                title="Missing Value Analysis"))
            self$add(jmvcore::Html$new(
                options=options,
                name="distributions",
                title="Variable Distributions"))
            self$add(jmvcore::Html$new(
                options=options,
                name="correlation_analysis",
                title="Correlation Analysis"))
            self$add(jmvcore::Html$new(
                options=options,
                name="pca_analysis",
                title="Principal Component Analysis"))
            self$add(jmvcore::Html$new(
                options=options,
                name="target_analysis",
                title="Target Variable Analysis"))
            self$add(jmvcore::Html$new(
                options=options,
                name="comprehensive_report",
                title="Comprehensive EDA Report"))
            self$add(jmvcore::Html$new(
                options=options,
                name="plots",
                title="Automated Visualizations"))
            self$add(jmvcore::Html$new(
                options=options,
                name="recommendations",
                title="Analysis Recommendations"))}))

autoedaBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "autoedaBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "autoeda",
                version = c(0,0,3),
                options = options,
                results = autoedaResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Automated Exploratory Data Analysis
#'
#' Automated Exploratory Data Analysis using DataExplorer package integration.
#' This module provides comprehensive automated EDA capabilities including 
#' dataset overview,
#' missing value analysis, correlation matrices, PCA visualization, and 
#' automated reporting.
#' Based on autoEDA research from R Journal 2019 (Staniak & Biecek).
#' 
#'
#' @examples
#' \donttest{
#' # Example:
#' # 1. Load your data frame.
#' # 2. Select variables for analysis.
#' # 3. Choose analysis type (overview, missing, correlation, etc.)
#' # 4. Configure output options.
#' # 5. Run autoeda module for comprehensive automated analysis.
#'}
#' @param data The data as a data frame.
#' @param vars Variables to include in the automated exploratory data
#'   analysis. All variable types are supported.
#' @param analysis_type Choose the type of automated EDA analysis to perform.
#' @param target_var Optional target variable for supervised EDA analysis.
#'   Used for target vs predictors analysis.
#' @param include_plots Include automated plots and visualizations in the
#'   output.
#' @param missing_threshold Threshold percentage for highlighting variables
#'   with missing values.
#' @param correlation_method Method for correlation analysis.
#' @param pca_components Number of principal components to display in PCA
#'   analysis.
#' @param plot_theme Visual theme for automated plots.
#' @param output_format Format for the automated EDA output.
#' @param eda_engine Choose the exploratory data analysis engine. DataExplorer
#'   provides comprehensive automated reporting. ggEDA provides enhanced
#'   visualizations for clinical research.
#' @param advanced_options Enable advanced features and detailed analysis.
#' @param categorical_limit Maximum number of levels for categorical variables
#'   to include in analysis.
#' @param generate_report Generate a comprehensive automated EDA report with
#'   all analyses.
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$todo} \tab \tab \tab \tab \tab Welcome message and instructions \cr
#'   \code{results$overview} \tab \tab \tab \tab \tab Comprehensive dataset introduction and summary \cr
#'   \code{results$missing_analysis} \tab \tab \tab \tab \tab Missing value patterns and recommendations \cr
#'   \code{results$distributions} \tab \tab \tab \tab \tab Univariate distribution analysis and plots \cr
#'   \code{results$correlation_analysis} \tab \tab \tab \tab \tab Correlation matrices and relationship analysis \cr
#'   \code{results$pca_analysis} \tab \tab \tab \tab \tab PCA results and component visualization \cr
#'   \code{results$target_analysis} \tab \tab \tab \tab \tab Target vs predictors relationship analysis \cr
#'   \code{results$comprehensive_report} \tab \tab \tab \tab \tab Complete automated exploratory data analysis report \cr
#'   \code{results$plots} \tab \tab \tab \tab \tab Collection of automated plots and charts \cr
#'   \code{results$recommendations} \tab \tab \tab \tab \tab Automated recommendations for further analysis \cr
#' }
#'
#' @export
autoeda <- function(
    data,
    vars,
    analysis_type = "overview",
    target_var,
    include_plots = TRUE,
    missing_threshold = 5,
    correlation_method = "pearson",
    pca_components = 5,
    plot_theme = "clinical",
    output_format = "combined",
    eda_engine = "dataexplorer",
    advanced_options = FALSE,
    categorical_limit = 15,
    generate_report = FALSE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("autoeda requires jmvcore to be installed (restart may be required)")

    if ( ! missing(vars)) vars <- jmvcore::resolveQuo(jmvcore::enquo(vars))
    if ( ! missing(target_var)) target_var <- jmvcore::resolveQuo(jmvcore::enquo(target_var))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(vars), vars, NULL),
            `if`( ! missing(target_var), target_var, NULL))


    options <- autoedaOptions$new(
        vars = vars,
        analysis_type = analysis_type,
        target_var = target_var,
        include_plots = include_plots,
        missing_threshold = missing_threshold,
        correlation_method = correlation_method,
        pca_components = pca_components,
        plot_theme = plot_theme,
        output_format = output_format,
        eda_engine = eda_engine,
        advanced_options = advanced_options,
        categorical_limit = categorical_limit,
        generate_report = generate_report)

    analysis <- autoedaClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

