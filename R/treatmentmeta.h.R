
# This file is automatically generated, you probably don't want to edit this

treatmentmetaOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "treatmentmetaOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            study_id = NULL,
            year = NULL,
            outcome_type = "continuous",
            mean_treatment = NULL,
            sd_treatment = NULL,
            n_treatment = NULL,
            mean_control = NULL,
            sd_control = NULL,
            n_control = NULL,
            events_treatment = NULL,
            events_control = NULL,
            correlation = NULL,
            sample_size = NULL,
            effect_size = NULL,
            standard_error = NULL,
            ci_lower = NULL,
            ci_upper = NULL,
            hazard_ratio = NULL,
            log_hr_se = NULL,
            effect_measure = "SMD",
            model_type = "random",
            heterogeneity_test = TRUE,
            prediction_interval = TRUE,
            subgroup_var = NULL,
            subgroup_test = TRUE,
            moderator_vars = NULL,
            sensitivity_analysis = TRUE,
            influence_diagnostics = TRUE,
            publication_bias = TRUE,
            funnel_plot = TRUE,
            eggers_test = TRUE,
            trim_fill = TRUE,
            pcurve = FALSE,
            quality_score = NULL,
            weight_by_quality = FALSE,
            confidence_level = 0.95,
            small_study_correction = TRUE,
            bayesian_analysis = FALSE,
            forest_plot = TRUE,
            baujat_plot = FALSE,
            radial_plot = FALSE,
            cumulative_meta = FALSE,
            show_weights = TRUE,
            show_interpretation = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="treatmentmeta",
                requiresData=TRUE,
                ...)

            private$..study_id <- jmvcore::OptionVariable$new(
                "study_id",
                study_id,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "id"),
                default=NULL)
            private$..year <- jmvcore::OptionVariable$new(
                "year",
                year,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..outcome_type <- jmvcore::OptionList$new(
                "outcome_type",
                outcome_type,
                options=list(
                    "continuous",
                    "binary",
                    "correlation",
                    "survival",
                    "generic"),
                default="continuous")
            private$..mean_treatment <- jmvcore::OptionVariable$new(
                "mean_treatment",
                mean_treatment,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..sd_treatment <- jmvcore::OptionVariable$new(
                "sd_treatment",
                sd_treatment,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..n_treatment <- jmvcore::OptionVariable$new(
                "n_treatment",
                n_treatment,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..mean_control <- jmvcore::OptionVariable$new(
                "mean_control",
                mean_control,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..sd_control <- jmvcore::OptionVariable$new(
                "sd_control",
                sd_control,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..n_control <- jmvcore::OptionVariable$new(
                "n_control",
                n_control,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..events_treatment <- jmvcore::OptionVariable$new(
                "events_treatment",
                events_treatment,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..events_control <- jmvcore::OptionVariable$new(
                "events_control",
                events_control,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..correlation <- jmvcore::OptionVariable$new(
                "correlation",
                correlation,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..sample_size <- jmvcore::OptionVariable$new(
                "sample_size",
                sample_size,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..effect_size <- jmvcore::OptionVariable$new(
                "effect_size",
                effect_size,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..standard_error <- jmvcore::OptionVariable$new(
                "standard_error",
                standard_error,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..ci_lower <- jmvcore::OptionVariable$new(
                "ci_lower",
                ci_lower,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..ci_upper <- jmvcore::OptionVariable$new(
                "ci_upper",
                ci_upper,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..hazard_ratio <- jmvcore::OptionVariable$new(
                "hazard_ratio",
                hazard_ratio,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..log_hr_se <- jmvcore::OptionVariable$new(
                "log_hr_se",
                log_hr_se,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..effect_measure <- jmvcore::OptionList$new(
                "effect_measure",
                effect_measure,
                options=list(
                    "MD",
                    "SMD",
                    "ROM",
                    "RR",
                    "OR",
                    "RD",
                    "HR",
                    "ZCOR"),
                default="SMD")
            private$..model_type <- jmvcore::OptionList$new(
                "model_type",
                model_type,
                options=list(
                    "fixed",
                    "random",
                    "random_dl",
                    "random_pm",
                    "random_hksj"),
                default="random")
            private$..heterogeneity_test <- jmvcore::OptionBool$new(
                "heterogeneity_test",
                heterogeneity_test,
                default=TRUE)
            private$..prediction_interval <- jmvcore::OptionBool$new(
                "prediction_interval",
                prediction_interval,
                default=TRUE)
            private$..subgroup_var <- jmvcore::OptionVariable$new(
                "subgroup_var",
                subgroup_var,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..subgroup_test <- jmvcore::OptionBool$new(
                "subgroup_test",
                subgroup_test,
                default=TRUE)
            private$..moderator_vars <- jmvcore::OptionVariables$new(
                "moderator_vars",
                moderator_vars,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"),
                default=NULL)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=TRUE)
            private$..influence_diagnostics <- jmvcore::OptionBool$new(
                "influence_diagnostics",
                influence_diagnostics,
                default=TRUE)
            private$..publication_bias <- jmvcore::OptionBool$new(
                "publication_bias",
                publication_bias,
                default=TRUE)
            private$..funnel_plot <- jmvcore::OptionBool$new(
                "funnel_plot",
                funnel_plot,
                default=TRUE)
            private$..eggers_test <- jmvcore::OptionBool$new(
                "eggers_test",
                eggers_test,
                default=TRUE)
            private$..trim_fill <- jmvcore::OptionBool$new(
                "trim_fill",
                trim_fill,
                default=TRUE)
            private$..pcurve <- jmvcore::OptionBool$new(
                "pcurve",
                pcurve,
                default=FALSE)
            private$..quality_score <- jmvcore::OptionVariable$new(
                "quality_score",
                quality_score,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..weight_by_quality <- jmvcore::OptionBool$new(
                "weight_by_quality",
                weight_by_quality,
                default=FALSE)
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                min=0.5,
                max=0.999,
                default=0.95)
            private$..small_study_correction <- jmvcore::OptionBool$new(
                "small_study_correction",
                small_study_correction,
                default=TRUE)
            private$..bayesian_analysis <- jmvcore::OptionBool$new(
                "bayesian_analysis",
                bayesian_analysis,
                default=FALSE)
            private$..forest_plot <- jmvcore::OptionBool$new(
                "forest_plot",
                forest_plot,
                default=TRUE)
            private$..baujat_plot <- jmvcore::OptionBool$new(
                "baujat_plot",
                baujat_plot,
                default=FALSE)
            private$..radial_plot <- jmvcore::OptionBool$new(
                "radial_plot",
                radial_plot,
                default=FALSE)
            private$..cumulative_meta <- jmvcore::OptionBool$new(
                "cumulative_meta",
                cumulative_meta,
                default=FALSE)
            private$..show_weights <- jmvcore::OptionBool$new(
                "show_weights",
                show_weights,
                default=TRUE)
            private$..show_interpretation <- jmvcore::OptionBool$new(
                "show_interpretation",
                show_interpretation,
                default=TRUE)

            self$.addOption(private$..study_id)
            self$.addOption(private$..year)
            self$.addOption(private$..outcome_type)
            self$.addOption(private$..mean_treatment)
            self$.addOption(private$..sd_treatment)
            self$.addOption(private$..n_treatment)
            self$.addOption(private$..mean_control)
            self$.addOption(private$..sd_control)
            self$.addOption(private$..n_control)
            self$.addOption(private$..events_treatment)
            self$.addOption(private$..events_control)
            self$.addOption(private$..correlation)
            self$.addOption(private$..sample_size)
            self$.addOption(private$..effect_size)
            self$.addOption(private$..standard_error)
            self$.addOption(private$..ci_lower)
            self$.addOption(private$..ci_upper)
            self$.addOption(private$..hazard_ratio)
            self$.addOption(private$..log_hr_se)
            self$.addOption(private$..effect_measure)
            self$.addOption(private$..model_type)
            self$.addOption(private$..heterogeneity_test)
            self$.addOption(private$..prediction_interval)
            self$.addOption(private$..subgroup_var)
            self$.addOption(private$..subgroup_test)
            self$.addOption(private$..moderator_vars)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..influence_diagnostics)
            self$.addOption(private$..publication_bias)
            self$.addOption(private$..funnel_plot)
            self$.addOption(private$..eggers_test)
            self$.addOption(private$..trim_fill)
            self$.addOption(private$..pcurve)
            self$.addOption(private$..quality_score)
            self$.addOption(private$..weight_by_quality)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..small_study_correction)
            self$.addOption(private$..bayesian_analysis)
            self$.addOption(private$..forest_plot)
            self$.addOption(private$..baujat_plot)
            self$.addOption(private$..radial_plot)
            self$.addOption(private$..cumulative_meta)
            self$.addOption(private$..show_weights)
            self$.addOption(private$..show_interpretation)
        }),
    active = list(
        study_id = function() private$..study_id$value,
        year = function() private$..year$value,
        outcome_type = function() private$..outcome_type$value,
        mean_treatment = function() private$..mean_treatment$value,
        sd_treatment = function() private$..sd_treatment$value,
        n_treatment = function() private$..n_treatment$value,
        mean_control = function() private$..mean_control$value,
        sd_control = function() private$..sd_control$value,
        n_control = function() private$..n_control$value,
        events_treatment = function() private$..events_treatment$value,
        events_control = function() private$..events_control$value,
        correlation = function() private$..correlation$value,
        sample_size = function() private$..sample_size$value,
        effect_size = function() private$..effect_size$value,
        standard_error = function() private$..standard_error$value,
        ci_lower = function() private$..ci_lower$value,
        ci_upper = function() private$..ci_upper$value,
        hazard_ratio = function() private$..hazard_ratio$value,
        log_hr_se = function() private$..log_hr_se$value,
        effect_measure = function() private$..effect_measure$value,
        model_type = function() private$..model_type$value,
        heterogeneity_test = function() private$..heterogeneity_test$value,
        prediction_interval = function() private$..prediction_interval$value,
        subgroup_var = function() private$..subgroup_var$value,
        subgroup_test = function() private$..subgroup_test$value,
        moderator_vars = function() private$..moderator_vars$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        influence_diagnostics = function() private$..influence_diagnostics$value,
        publication_bias = function() private$..publication_bias$value,
        funnel_plot = function() private$..funnel_plot$value,
        eggers_test = function() private$..eggers_test$value,
        trim_fill = function() private$..trim_fill$value,
        pcurve = function() private$..pcurve$value,
        quality_score = function() private$..quality_score$value,
        weight_by_quality = function() private$..weight_by_quality$value,
        confidence_level = function() private$..confidence_level$value,
        small_study_correction = function() private$..small_study_correction$value,
        bayesian_analysis = function() private$..bayesian_analysis$value,
        forest_plot = function() private$..forest_plot$value,
        baujat_plot = function() private$..baujat_plot$value,
        radial_plot = function() private$..radial_plot$value,
        cumulative_meta = function() private$..cumulative_meta$value,
        show_weights = function() private$..show_weights$value,
        show_interpretation = function() private$..show_interpretation$value),
    private = list(
        ..study_id = NA,
        ..year = NA,
        ..outcome_type = NA,
        ..mean_treatment = NA,
        ..sd_treatment = NA,
        ..n_treatment = NA,
        ..mean_control = NA,
        ..sd_control = NA,
        ..n_control = NA,
        ..events_treatment = NA,
        ..events_control = NA,
        ..correlation = NA,
        ..sample_size = NA,
        ..effect_size = NA,
        ..standard_error = NA,
        ..ci_lower = NA,
        ..ci_upper = NA,
        ..hazard_ratio = NA,
        ..log_hr_se = NA,
        ..effect_measure = NA,
        ..model_type = NA,
        ..heterogeneity_test = NA,
        ..prediction_interval = NA,
        ..subgroup_var = NA,
        ..subgroup_test = NA,
        ..moderator_vars = NA,
        ..sensitivity_analysis = NA,
        ..influence_diagnostics = NA,
        ..publication_bias = NA,
        ..funnel_plot = NA,
        ..eggers_test = NA,
        ..trim_fill = NA,
        ..pcurve = NA,
        ..quality_score = NA,
        ..weight_by_quality = NA,
        ..confidence_level = NA,
        ..small_study_correction = NA,
        ..bayesian_analysis = NA,
        ..forest_plot = NA,
        ..baujat_plot = NA,
        ..radial_plot = NA,
        ..cumulative_meta = NA,
        ..show_weights = NA,
        ..show_interpretation = NA)
)

treatmentmetaResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "treatmentmetaResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        data_summary = function() private$.items[["data_summary"]],
        pooled_effects = function() private$.items[["pooled_effects"]],
        individual_studies = function() private$.items[["individual_studies"]],
        heterogeneity = function() private$.items[["heterogeneity"]],
        subgroup_analysis = function() private$.items[["subgroup_analysis"]],
        subgroup_test = function() private$.items[["subgroup_test"]],
        meta_regression = function() private$.items[["meta_regression"]],
        sensitivity = function() private$.items[["sensitivity"]],
        influence = function() private$.items[["influence"]],
        publication_bias_tests = function() private$.items[["publication_bias_tests"]],
        trim_fill_results = function() private$.items[["trim_fill_results"]],
        bayesian_results = function() private$.items[["bayesian_results"]],
        pcurve_results = function() private$.items[["pcurve_results"]],
        quality_assessment = function() private$.items[["quality_assessment"]],
        forest_plot = function() private$.items[["forest_plot"]],
        funnel_plot = function() private$.items[["funnel_plot"]],
        baujat_plot = function() private$.items[["baujat_plot"]],
        radial_plot = function() private$.items[["radial_plot"]],
        cumulative_results = function() private$.items[["cumulative_results"]],
        cumulative_plot = function() private$.items[["cumulative_plot"]],
        pcurve_plot = function() private$.items[["pcurve_plot"]],
        clinical_interpretation = function() private$.items[["clinical_interpretation"]],
        methods_section = function() private$.items[["methods_section"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Treatment Effect Meta-Analysis",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Getting Started",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="data_summary",
                title="Data Summary",
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="details", 
                        `title`="Details", 
                        `type`="text")),
                clearWith=list(
                    "study_id",
                    "outcome_type")))
            self$add(jmvcore::Table$new(
                options=options,
                name="pooled_effects",
                title="Pooled Effect Estimates",
                columns=list(
                    list(
                        `name`="model", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="z_value", 
                        `title`="Z-value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text")),
                clearWith=list(
                    "effect_measure",
                    "model_type")))
            self$add(jmvcore::Table$new(
                options=options,
                name="individual_studies",
                title="Individual Study Results",
                columns=list(
                    list(
                        `name`="study", 
                        `title`="Study", 
                        `type`="text"),
                    list(
                        `name`="year", 
                        `title`="Year", 
                        `type`="integer"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="weight_fixed", 
                        `title`="Weight (Fixed)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="weight_random", 
                        `title`="Weight (Random)", 
                        `type`="number", 
                        `format`="pc")),
                clearWith=list(
                    "study_id",
                    "effect_measure")))
            self$add(jmvcore::Table$new(
                options=options,
                name="heterogeneity",
                title="Heterogeneity Assessment",
                visible="(heterogeneity_test)",
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Heterogeneity Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="text"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="text"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text")),
                clearWith=list(
                    "model_type")))
            self$add(jmvcore::Table$new(
                options=options,
                name="subgroup_analysis",
                title="Subgroup Analysis",
                visible="(subgroup_var)",
                columns=list(
                    list(
                        `name`="subgroup", 
                        `title`="Subgroup", 
                        `type`="text"),
                    list(
                        `name`="n_studies", 
                        `title`="N Studies", 
                        `type`="integer"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="i_squared", 
                        `title`="I\u00B2 (%)", 
                        `type`="number", 
                        `format`="pc")),
                clearWith=list(
                    "subgroup_var",
                    "subgroup_test")))
            self$add(jmvcore::Table$new(
                options=options,
                name="subgroup_test",
                title="Test for Subgroup Differences",
                visible="(subgroup_var)",
                columns=list(
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="q_statistic", 
                        `title`="Q-statistic", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text")),
                clearWith=list(
                    "subgroup_var")))
            self$add(jmvcore::Table$new(
                options=options,
                name="meta_regression",
                title="Meta-Regression Results",
                visible="(moderator_vars)",
                columns=list(
                    list(
                        `name`="moderator", 
                        `title`="Moderator", 
                        `type`="text"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="z_value", 
                        `title`="Z-value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue")),
                clearWith=list(
                    "moderator_vars")))
            self$add(jmvcore::Table$new(
                options=options,
                name="sensitivity",
                title="Sensitivity Analysis",
                visible="(sensitivity_analysis)",
                columns=list(
                    list(
                        `name`="omitted_study", 
                        `title`="Omitted Study", 
                        `type`="text"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="i_squared", 
                        `title`="I\u00B2 (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="change_pct", 
                        `title`="Change (%)", 
                        `type`="number", 
                        `format`="zto")),
                clearWith=list(
                    "study_id")))
            self$add(jmvcore::Table$new(
                options=options,
                name="influence",
                title="Influence Diagnostics",
                visible="(influence_diagnostics)",
                columns=list(
                    list(
                        `name`="study", 
                        `title`="Study", 
                        `type`="text"),
                    list(
                        `name`="dffits", 
                        `title`="DFFITS", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="cooks_d", 
                        `title`="Cook's D", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hatvalues", 
                        `title`="Hat Values", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="residual", 
                        `title`="Residual", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="outlier", 
                        `title`="Outlier", 
                        `type`="text")),
                clearWith=list(
                    "study_id")))
            self$add(jmvcore::Table$new(
                options=options,
                name="publication_bias_tests",
                title="Publication Bias Tests",
                visible="(publication_bias)",
                columns=list(
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"),
                    list(
                        `name`="recommendation", 
                        `title`="Recommendation", 
                        `type`="text")),
                clearWith=list(
                    "effect_measure")))
            self$add(jmvcore::Table$new(
                options=options,
                name="trim_fill_results",
                title="Trim and Fill Analysis",
                visible="(trim_fill)",
                columns=list(
                    list(
                        `name`="analysis", 
                        `title`="Analysis", 
                        `type`="text"),
                    list(
                        `name`="n_studies", 
                        `title`="N Studies", 
                        `type`="integer"),
                    list(
                        `name`="n_filled", 
                        `title`="N Filled", 
                        `type`="integer"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="change_pct", 
                        `title`="Change (%)", 
                        `type`="number", 
                        `format`="zto")),
                clearWith=list(
                    "model_type")))
            self$add(jmvcore::Table$new(
                options=options,
                name="bayesian_results",
                title="Bayesian Meta-Analysis Results",
                visible="(bayesian_analysis)",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate (Mean/Median)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="sd", 
                        `title`="SD", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hpd_lower", 
                        `title`="HPD Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hpd_upper", 
                        `title`="HPD Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="r_hat", 
                        `title`="R-hat", 
                        `type`="number", 
                        `format`="zto")),
                clearWith=list(
                    "bayesian_analysis")))
            self$add(jmvcore::Table$new(
                options=options,
                name="pcurve_results",
                title="P-Curve Analysis",
                visible="(pcurve)",
                columns=list(
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text")),
                clearWith=list(
                    "pcurve")))
            self$add(jmvcore::Table$new(
                options=options,
                name="quality_assessment",
                title="Quality Assessment Summary",
                visible="(quality_score)",
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Quality Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="details", 
                        `title`="Details", 
                        `type`="text")),
                clearWith=list(
                    "quality_score",
                    "weight_by_quality")))
            self$add(jmvcore::Image$new(
                options=options,
                name="forest_plot",
                title="Forest Plot",
                width=900,
                height=600,
                visible="(forest_plot)",
                requiresData=TRUE,
                clearWith=list(
                    "study_id",
                    "effect_measure",
                    "model_type")))
            self$add(jmvcore::Image$new(
                options=options,
                name="funnel_plot",
                title="Funnel Plot",
                width=600,
                height=600,
                visible="(funnel_plot)",
                requiresData=TRUE,
                clearWith=list(
                    "study_id",
                    "effect_measure")))
            self$add(jmvcore::Image$new(
                options=options,
                name="baujat_plot",
                title="Baujat Plot",
                width=600,
                height=600,
                visible="(baujat_plot)",
                requiresData=TRUE,
                clearWith=list(
                    "study_id",
                    "model_type")))
            self$add(jmvcore::Image$new(
                options=options,
                name="radial_plot",
                title="Radial Plot",
                width=600,
                height=600,
                visible="(radial_plot)",
                requiresData=TRUE,
                clearWith=list(
                    "study_id",
                    "effect_measure")))
            self$add(jmvcore::Table$new(
                options=options,
                name="cumulative_results",
                title="Cumulative Meta-Analysis Results",
                visible="(cumulative_meta)",
                columns=list(
                    list(
                        `name`="study", 
                        `title`="Added Study", 
                        `type`="text"),
                    list(
                        `name`="effect_size", 
                        `title`="Cumulative Effect", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="i_squared", 
                        `title`="I\u00B2 (%)", 
                        `type`="number", 
                        `format`="pc")),
                clearWith=list(
                    "cumulative_meta",
                    "year")))
            self$add(jmvcore::Image$new(
                options=options,
                name="cumulative_plot",
                title="Cumulative Meta-Analysis",
                width=800,
                height=600,
                visible="(cumulative_meta)",
                requiresData=TRUE,
                clearWith=list(
                    "study_id",
                    "year")))
            self$add(jmvcore::Image$new(
                options=options,
                name="pcurve_plot",
                title="P-Curve Plot",
                width=600,
                height=450,
                visible="(pcurve)",
                requiresData=TRUE,
                clearWith=list(
                    "pcurve")))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinical_interpretation",
                title="Clinical Interpretation & Recommendations",
                visible="(show_interpretation)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="methods_section",
                title="Methods Section Template",
                visible="(show_interpretation)"))}))

treatmentmetaBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "treatmentmetaBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "treatmentmeta",
                version = c(1,0,0),
                options = options,
                results = treatmentmetaResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Treatment Effect Meta-Analysis
#'
#' Comprehensive meta-analysis for treatment effects in clinical research.
#' Supports continuous outcomes (mean differences, standardized mean 
#' differences),
#' binary outcomes (risk ratios, odds ratios, risk differences), and 
#' time-to-event
#' outcomes (hazard ratios). Includes fixed-effect, random-effects, and 
#' Bayesian
#' meta-analysis approaches with comprehensive heterogeneity assessment and
#' publication bias evaluation.
#' 
#'
#' @examples
#' data('meta_studies')
#'
#' treatmentmeta(
#'     data = meta_studies,
#'     study_id = study,
#'     effect_measure = "SMD",
#'     outcome_type = "continuous",
#'     model_type = "random"
#' )
#'
#' @param data the data as a data frame
#' @param study_id Variable containing study names or identifiers
#' @param year Year of publication for chronological analyses
#' @param outcome_type Type of outcome measure for meta-analysis
#' @param mean_treatment Mean outcome in treatment group (continuous outcomes)
#' @param sd_treatment Standard deviation in treatment group
#' @param n_treatment Sample size in treatment group
#' @param mean_control Mean outcome in control group (continuous outcomes)
#' @param sd_control Standard deviation in control group
#' @param n_control Sample size in control group
#' @param events_treatment Number of events in treatment group (binary
#'   outcomes)
#' @param events_control Number of events in control group
#' @param correlation Correlation coefficient (r) for correlation
#'   meta-analysis
#' @param sample_size Total sample size for correlation studies
#' @param effect_size Pre-calculated effect size (generic meta-analysis)
#' @param standard_error Standard error of effect size
#' @param ci_lower Lower bound of confidence interval
#' @param ci_upper Upper bound of confidence interval
#' @param hazard_ratio Hazard ratio for survival outcomes
#' @param log_hr_se Standard error of log hazard ratio
#' @param effect_measure Effect size measure for meta-analysis
#' @param model_type Statistical model for pooling effect sizes
#' @param heterogeneity_test Perform heterogeneity tests (Q, I², τ²)
#' @param prediction_interval Calculate prediction interval for future studies
#' @param subgroup_var Categorical variable for subgroup analysis
#' @param subgroup_test Test for differences between subgroups
#' @param moderator_vars Variables for meta-regression analysis
#' @param sensitivity_analysis Perform leave-one-out sensitivity analysis
#' @param influence_diagnostics Calculate influence measures and outlier
#'   detection
#' @param publication_bias Assess publication bias using multiple methods
#' @param funnel_plot Generate funnel plot for visual bias assessment
#' @param eggers_test Perform Egger's regression test for asymmetry
#' @param trim_fill Apply trim and fill method for bias adjustment
#' @param pcurve Perform p-curve analysis for evidential value
#' @param quality_score Quality assessment score (e.g., Jadad, Cochrane RoB)
#' @param weight_by_quality Weight studies by quality score in analysis
#' @param confidence_level Confidence level for intervals
#' @param small_study_correction Apply corrections for small study effects
#' @param bayesian_analysis Perform Bayesian meta-analysis (requires
#'   additional packages)
#' @param forest_plot Generate forest plot of results
#' @param baujat_plot Generate Baujat plot for heterogeneity contribution
#' @param radial_plot Generate radial (Galbraith) plot
#' @param cumulative_meta Perform cumulative meta-analysis by year
#' @param show_weights Display individual study weights in output
#' @param show_interpretation Include clinical interpretation and
#'   recommendations
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab Instructions for treatment effect meta-analysis \cr
#'   \code{results$data_summary} \tab \tab \tab \tab \tab Overview of included studies and data quality \cr
#'   \code{results$pooled_effects} \tab \tab \tab \tab \tab Overall meta-analysis results with confidence and prediction intervals \cr
#'   \code{results$individual_studies} \tab \tab \tab \tab \tab Effect sizes and weights for each study \cr
#'   \code{results$heterogeneity} \tab \tab \tab \tab \tab Tests and measures of between-study heterogeneity \cr
#'   \code{results$subgroup_analysis} \tab \tab \tab \tab \tab Meta-analysis results by subgroup \cr
#'   \code{results$subgroup_test} \tab \tab \tab \tab \tab Statistical test for differences between subgroups \cr
#'   \code{results$meta_regression} \tab \tab \tab \tab \tab Moderator analysis using meta-regression \cr
#'   \code{results$sensitivity} \tab \tab \tab \tab \tab Leave-one-out sensitivity analysis results \cr
#'   \code{results$influence} \tab \tab \tab \tab \tab Identification of influential studies and outliers \cr
#'   \code{results$publication_bias_tests} \tab \tab \tab \tab \tab Statistical tests for publication bias \cr
#'   \code{results$trim_fill_results} \tab \tab \tab \tab \tab Adjusted estimates after trim and fill correction \cr
#'   \code{results$bayesian_results} \tab \tab \tab \tab \tab Parameter estimates from Bayesian meta-analysis \cr
#'   \code{results$pcurve_results} \tab \tab \tab \tab \tab Statistical tests for evidential value \cr
#'   \code{results$quality_assessment} \tab \tab \tab \tab \tab Impact of study quality on effect sizes \cr
#'   \code{results$forest_plot} \tab \tab \tab \tab \tab Forest plot showing individual and pooled effect sizes \cr
#'   \code{results$funnel_plot} \tab \tab \tab \tab \tab Funnel plot for assessing publication bias \cr
#'   \code{results$baujat_plot} \tab \tab \tab \tab \tab Contribution to heterogeneity vs influence on pooled estimate \cr
#'   \code{results$radial_plot} \tab \tab \tab \tab \tab Galbraith radial plot for heterogeneity assessment \cr
#'   \code{results$cumulative_results} \tab \tab \tab \tab \tab Sequential pooled estimates as studies are added \cr
#'   \code{results$cumulative_plot} \tab \tab \tab \tab \tab Cumulative meta-analysis plot over time \cr
#'   \code{results$pcurve_plot} \tab \tab \tab \tab \tab Distribution of significant p-values \cr
#'   \code{results$clinical_interpretation} \tab \tab \tab \tab \tab Clinical context and evidence synthesis \cr
#'   \code{results$methods_section} \tab \tab \tab \tab \tab Template text for publication methods section \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$data_summary$asDF}
#'
#' \code{as.data.frame(results$data_summary)}
#'
#' @export
treatmentmeta <- function(
    data,
    study_id = NULL,
    year = NULL,
    outcome_type = "continuous",
    mean_treatment = NULL,
    sd_treatment = NULL,
    n_treatment = NULL,
    mean_control = NULL,
    sd_control = NULL,
    n_control = NULL,
    events_treatment = NULL,
    events_control = NULL,
    correlation = NULL,
    sample_size = NULL,
    effect_size = NULL,
    standard_error = NULL,
    ci_lower = NULL,
    ci_upper = NULL,
    hazard_ratio = NULL,
    log_hr_se = NULL,
    effect_measure = "SMD",
    model_type = "random",
    heterogeneity_test = TRUE,
    prediction_interval = TRUE,
    subgroup_var = NULL,
    subgroup_test = TRUE,
    moderator_vars = NULL,
    sensitivity_analysis = TRUE,
    influence_diagnostics = TRUE,
    publication_bias = TRUE,
    funnel_plot = TRUE,
    eggers_test = TRUE,
    trim_fill = TRUE,
    pcurve = FALSE,
    quality_score = NULL,
    weight_by_quality = FALSE,
    confidence_level = 0.95,
    small_study_correction = TRUE,
    bayesian_analysis = FALSE,
    forest_plot = TRUE,
    baujat_plot = FALSE,
    radial_plot = FALSE,
    cumulative_meta = FALSE,
    show_weights = TRUE,
    show_interpretation = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("treatmentmeta requires jmvcore to be installed (restart may be required)")

    if ( ! missing(study_id)) study_id <- jmvcore::resolveQuo(jmvcore::enquo(study_id))
    if ( ! missing(year)) year <- jmvcore::resolveQuo(jmvcore::enquo(year))
    if ( ! missing(mean_treatment)) mean_treatment <- jmvcore::resolveQuo(jmvcore::enquo(mean_treatment))
    if ( ! missing(sd_treatment)) sd_treatment <- jmvcore::resolveQuo(jmvcore::enquo(sd_treatment))
    if ( ! missing(n_treatment)) n_treatment <- jmvcore::resolveQuo(jmvcore::enquo(n_treatment))
    if ( ! missing(mean_control)) mean_control <- jmvcore::resolveQuo(jmvcore::enquo(mean_control))
    if ( ! missing(sd_control)) sd_control <- jmvcore::resolveQuo(jmvcore::enquo(sd_control))
    if ( ! missing(n_control)) n_control <- jmvcore::resolveQuo(jmvcore::enquo(n_control))
    if ( ! missing(events_treatment)) events_treatment <- jmvcore::resolveQuo(jmvcore::enquo(events_treatment))
    if ( ! missing(events_control)) events_control <- jmvcore::resolveQuo(jmvcore::enquo(events_control))
    if ( ! missing(correlation)) correlation <- jmvcore::resolveQuo(jmvcore::enquo(correlation))
    if ( ! missing(sample_size)) sample_size <- jmvcore::resolveQuo(jmvcore::enquo(sample_size))
    if ( ! missing(effect_size)) effect_size <- jmvcore::resolveQuo(jmvcore::enquo(effect_size))
    if ( ! missing(standard_error)) standard_error <- jmvcore::resolveQuo(jmvcore::enquo(standard_error))
    if ( ! missing(ci_lower)) ci_lower <- jmvcore::resolveQuo(jmvcore::enquo(ci_lower))
    if ( ! missing(ci_upper)) ci_upper <- jmvcore::resolveQuo(jmvcore::enquo(ci_upper))
    if ( ! missing(hazard_ratio)) hazard_ratio <- jmvcore::resolveQuo(jmvcore::enquo(hazard_ratio))
    if ( ! missing(log_hr_se)) log_hr_se <- jmvcore::resolveQuo(jmvcore::enquo(log_hr_se))
    if ( ! missing(subgroup_var)) subgroup_var <- jmvcore::resolveQuo(jmvcore::enquo(subgroup_var))
    if ( ! missing(moderator_vars)) moderator_vars <- jmvcore::resolveQuo(jmvcore::enquo(moderator_vars))
    if ( ! missing(quality_score)) quality_score <- jmvcore::resolveQuo(jmvcore::enquo(quality_score))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(study_id), study_id, NULL),
            `if`( ! missing(year), year, NULL),
            `if`( ! missing(mean_treatment), mean_treatment, NULL),
            `if`( ! missing(sd_treatment), sd_treatment, NULL),
            `if`( ! missing(n_treatment), n_treatment, NULL),
            `if`( ! missing(mean_control), mean_control, NULL),
            `if`( ! missing(sd_control), sd_control, NULL),
            `if`( ! missing(n_control), n_control, NULL),
            `if`( ! missing(events_treatment), events_treatment, NULL),
            `if`( ! missing(events_control), events_control, NULL),
            `if`( ! missing(correlation), correlation, NULL),
            `if`( ! missing(sample_size), sample_size, NULL),
            `if`( ! missing(effect_size), effect_size, NULL),
            `if`( ! missing(standard_error), standard_error, NULL),
            `if`( ! missing(ci_lower), ci_lower, NULL),
            `if`( ! missing(ci_upper), ci_upper, NULL),
            `if`( ! missing(hazard_ratio), hazard_ratio, NULL),
            `if`( ! missing(log_hr_se), log_hr_se, NULL),
            `if`( ! missing(subgroup_var), subgroup_var, NULL),
            `if`( ! missing(moderator_vars), moderator_vars, NULL),
            `if`( ! missing(quality_score), quality_score, NULL))

    for (v in subgroup_var) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- treatmentmetaOptions$new(
        study_id = study_id,
        year = year,
        outcome_type = outcome_type,
        mean_treatment = mean_treatment,
        sd_treatment = sd_treatment,
        n_treatment = n_treatment,
        mean_control = mean_control,
        sd_control = sd_control,
        n_control = n_control,
        events_treatment = events_treatment,
        events_control = events_control,
        correlation = correlation,
        sample_size = sample_size,
        effect_size = effect_size,
        standard_error = standard_error,
        ci_lower = ci_lower,
        ci_upper = ci_upper,
        hazard_ratio = hazard_ratio,
        log_hr_se = log_hr_se,
        effect_measure = effect_measure,
        model_type = model_type,
        heterogeneity_test = heterogeneity_test,
        prediction_interval = prediction_interval,
        subgroup_var = subgroup_var,
        subgroup_test = subgroup_test,
        moderator_vars = moderator_vars,
        sensitivity_analysis = sensitivity_analysis,
        influence_diagnostics = influence_diagnostics,
        publication_bias = publication_bias,
        funnel_plot = funnel_plot,
        eggers_test = eggers_test,
        trim_fill = trim_fill,
        pcurve = pcurve,
        quality_score = quality_score,
        weight_by_quality = weight_by_quality,
        confidence_level = confidence_level,
        small_study_correction = small_study_correction,
        bayesian_analysis = bayesian_analysis,
        forest_plot = forest_plot,
        baujat_plot = baujat_plot,
        radial_plot = radial_plot,
        cumulative_meta = cumulative_meta,
        show_weights = show_weights,
        show_interpretation = show_interpretation)

    analysis <- treatmentmetaClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

