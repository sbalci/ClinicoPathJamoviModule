
# This file is automatically generated, you probably don't want to edit this

betabinomialdiagnosticOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "betabinomialdiagnosticOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            test_result = NULL,
            disease_status = NULL,
            study_id = NULL,
            covariates = NULL,
            overdispersion_model = "beta_binomial",
            correlation_structure = "independent",
            estimation_method = "maximum_likelihood",
            heterogeneity_test = TRUE,
            tau_squared_method = "dersimonian_laird",
            confidence_level = 0.95,
            alpha_prior = 1,
            beta_prior = 1,
            alpha_prior_spec = 1,
            beta_prior_spec = 1,
            mcmc_iterations = 10000,
            burnin_iterations = 2000,
            thin_factor = 5,
            convergence_diagnostics = TRUE,
            prediction_intervals = TRUE,
            forest_plot = TRUE,
            summary_roc_curve = TRUE,
            residual_plots = FALSE,
            influence_diagnostics = FALSE,
            publication_bias = FALSE,
            subgroup_analysis = FALSE,
            robust_variance = FALSE,
            finite_sample_correction = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="betabinomialdiagnostic",
                requiresData=FALSE,
                ...)

            private$..test_result <- jmvcore::OptionVariable$new(
                "test_result",
                test_result,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..disease_status <- jmvcore::OptionVariable$new(
                "disease_status",
                disease_status,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..study_id <- jmvcore::OptionVariable$new(
                "study_id",
                study_id,
                suggested=list(
                    "nominal",
                    "id"),
                permitted=list(
                    "factor",
                    "id"),
                default=NULL)
            private$..covariates <- jmvcore::OptionVariables$new(
                "covariates",
                covariates,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"),
                default=NULL)
            private$..overdispersion_model <- jmvcore::OptionList$new(
                "overdispersion_model",
                overdispersion_model,
                options=list(
                    "beta_binomial",
                    "logit_normal",
                    "probit_normal",
                    "compound_beta",
                    "dirichlet_multinomial"),
                default="beta_binomial")
            private$..correlation_structure <- jmvcore::OptionList$new(
                "correlation_structure",
                correlation_structure,
                options=list(
                    "independent",
                    "correlated",
                    "conditional_dependent",
                    "hierarchical"),
                default="independent")
            private$..estimation_method <- jmvcore::OptionList$new(
                "estimation_method",
                estimation_method,
                options=list(
                    "maximum_likelihood",
                    "restricted_ml",
                    "bayesian_mcmc",
                    "method_of_moments",
                    "quasi_likelihood"),
                default="maximum_likelihood")
            private$..heterogeneity_test <- jmvcore::OptionBool$new(
                "heterogeneity_test",
                heterogeneity_test,
                default=TRUE)
            private$..tau_squared_method <- jmvcore::OptionList$new(
                "tau_squared_method",
                tau_squared_method,
                options=list(
                    "dersimonian_laird",
                    "restricted_ml",
                    "paule_mandel",
                    "empirical_bayes",
                    "hunter_schmidt"),
                default="dersimonian_laird")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.8,
                max=0.99)
            private$..alpha_prior <- jmvcore::OptionNumber$new(
                "alpha_prior",
                alpha_prior,
                default=1,
                min=0.1,
                max=100)
            private$..beta_prior <- jmvcore::OptionNumber$new(
                "beta_prior",
                beta_prior,
                default=1,
                min=0.1,
                max=100)
            private$..alpha_prior_spec <- jmvcore::OptionNumber$new(
                "alpha_prior_spec",
                alpha_prior_spec,
                default=1,
                min=0.1,
                max=100)
            private$..beta_prior_spec <- jmvcore::OptionNumber$new(
                "beta_prior_spec",
                beta_prior_spec,
                default=1,
                min=0.1,
                max=100)
            private$..mcmc_iterations <- jmvcore::OptionInteger$new(
                "mcmc_iterations",
                mcmc_iterations,
                default=10000,
                min=1000,
                max=50000)
            private$..burnin_iterations <- jmvcore::OptionInteger$new(
                "burnin_iterations",
                burnin_iterations,
                default=2000,
                min=100,
                max=10000)
            private$..thin_factor <- jmvcore::OptionInteger$new(
                "thin_factor",
                thin_factor,
                default=5,
                min=1,
                max=20)
            private$..convergence_diagnostics <- jmvcore::OptionBool$new(
                "convergence_diagnostics",
                convergence_diagnostics,
                default=TRUE)
            private$..prediction_intervals <- jmvcore::OptionBool$new(
                "prediction_intervals",
                prediction_intervals,
                default=TRUE)
            private$..forest_plot <- jmvcore::OptionBool$new(
                "forest_plot",
                forest_plot,
                default=TRUE)
            private$..summary_roc_curve <- jmvcore::OptionBool$new(
                "summary_roc_curve",
                summary_roc_curve,
                default=TRUE)
            private$..residual_plots <- jmvcore::OptionBool$new(
                "residual_plots",
                residual_plots,
                default=FALSE)
            private$..influence_diagnostics <- jmvcore::OptionBool$new(
                "influence_diagnostics",
                influence_diagnostics,
                default=FALSE)
            private$..publication_bias <- jmvcore::OptionBool$new(
                "publication_bias",
                publication_bias,
                default=FALSE)
            private$..subgroup_analysis <- jmvcore::OptionBool$new(
                "subgroup_analysis",
                subgroup_analysis,
                default=FALSE)
            private$..robust_variance <- jmvcore::OptionBool$new(
                "robust_variance",
                robust_variance,
                default=FALSE)
            private$..finite_sample_correction <- jmvcore::OptionBool$new(
                "finite_sample_correction",
                finite_sample_correction,
                default=TRUE)

            self$.addOption(private$..test_result)
            self$.addOption(private$..disease_status)
            self$.addOption(private$..study_id)
            self$.addOption(private$..covariates)
            self$.addOption(private$..overdispersion_model)
            self$.addOption(private$..correlation_structure)
            self$.addOption(private$..estimation_method)
            self$.addOption(private$..heterogeneity_test)
            self$.addOption(private$..tau_squared_method)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..alpha_prior)
            self$.addOption(private$..beta_prior)
            self$.addOption(private$..alpha_prior_spec)
            self$.addOption(private$..beta_prior_spec)
            self$.addOption(private$..mcmc_iterations)
            self$.addOption(private$..burnin_iterations)
            self$.addOption(private$..thin_factor)
            self$.addOption(private$..convergence_diagnostics)
            self$.addOption(private$..prediction_intervals)
            self$.addOption(private$..forest_plot)
            self$.addOption(private$..summary_roc_curve)
            self$.addOption(private$..residual_plots)
            self$.addOption(private$..influence_diagnostics)
            self$.addOption(private$..publication_bias)
            self$.addOption(private$..subgroup_analysis)
            self$.addOption(private$..robust_variance)
            self$.addOption(private$..finite_sample_correction)
        }),
    active = list(
        test_result = function() private$..test_result$value,
        disease_status = function() private$..disease_status$value,
        study_id = function() private$..study_id$value,
        covariates = function() private$..covariates$value,
        overdispersion_model = function() private$..overdispersion_model$value,
        correlation_structure = function() private$..correlation_structure$value,
        estimation_method = function() private$..estimation_method$value,
        heterogeneity_test = function() private$..heterogeneity_test$value,
        tau_squared_method = function() private$..tau_squared_method$value,
        confidence_level = function() private$..confidence_level$value,
        alpha_prior = function() private$..alpha_prior$value,
        beta_prior = function() private$..beta_prior$value,
        alpha_prior_spec = function() private$..alpha_prior_spec$value,
        beta_prior_spec = function() private$..beta_prior_spec$value,
        mcmc_iterations = function() private$..mcmc_iterations$value,
        burnin_iterations = function() private$..burnin_iterations$value,
        thin_factor = function() private$..thin_factor$value,
        convergence_diagnostics = function() private$..convergence_diagnostics$value,
        prediction_intervals = function() private$..prediction_intervals$value,
        forest_plot = function() private$..forest_plot$value,
        summary_roc_curve = function() private$..summary_roc_curve$value,
        residual_plots = function() private$..residual_plots$value,
        influence_diagnostics = function() private$..influence_diagnostics$value,
        publication_bias = function() private$..publication_bias$value,
        subgroup_analysis = function() private$..subgroup_analysis$value,
        robust_variance = function() private$..robust_variance$value,
        finite_sample_correction = function() private$..finite_sample_correction$value),
    private = list(
        ..test_result = NA,
        ..disease_status = NA,
        ..study_id = NA,
        ..covariates = NA,
        ..overdispersion_model = NA,
        ..correlation_structure = NA,
        ..estimation_method = NA,
        ..heterogeneity_test = NA,
        ..tau_squared_method = NA,
        ..confidence_level = NA,
        ..alpha_prior = NA,
        ..beta_prior = NA,
        ..alpha_prior_spec = NA,
        ..beta_prior_spec = NA,
        ..mcmc_iterations = NA,
        ..burnin_iterations = NA,
        ..thin_factor = NA,
        ..convergence_diagnostics = NA,
        ..prediction_intervals = NA,
        ..forest_plot = NA,
        ..summary_roc_curve = NA,
        ..residual_plots = NA,
        ..influence_diagnostics = NA,
        ..publication_bias = NA,
        ..subgroup_analysis = NA,
        ..robust_variance = NA,
        ..finite_sample_correction = NA)
)

betabinomialdiagnosticResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "betabinomialdiagnosticResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        modelSummary = function() private$.items[["modelSummary"]],
        overdispersionParameters = function() private$.items[["overdispersionParameters"]],
        heterogeneityTests = function() private$.items[["heterogeneityTests"]],
        studyLevelResults = function() private$.items[["studyLevelResults"]],
        pooledEstimates = function() private$.items[["pooledEstimates"]],
        correlationResults = function() private$.items[["correlationResults"]],
        convergenceDiagnostics = function() private$.items[["convergenceDiagnostics"]],
        subgroupAnalysis = function() private$.items[["subgroupAnalysis"]],
        influenceAnalysis = function() private$.items[["influenceAnalysis"]],
        publicationBiasTests = function() private$.items[["publicationBiasTests"]],
        forestPlotSensitivity = function() private$.items[["forestPlotSensitivity"]],
        forestPlotSpecificity = function() private$.items[["forestPlotSpecificity"]],
        summaryROCPlot = function() private$.items[["summaryROCPlot"]],
        residualPlots = function() private$.items[["residualPlots"]],
        convergencePlots = function() private$.items[["convergencePlots"]],
        funnelPlot = function() private$.items[["funnelPlot"]],
        methodExplanation = function() private$.items[["methodExplanation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Beta-Binomial Diagnostic Accuracy Models")
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Analysis Instructions",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelSummary",
                title="Model Summary",
                visible=TRUE,
                rows=1,
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "overdispersion_model",
                    "estimation_method"),
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="z_value", 
                        `title`="Z-value", 
                        `type`="number", 
                        `format`="zto:3"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto:4"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="overdispersionParameters",
                title="Overdispersion Parameters",
                visible=TRUE,
                rows=1,
                clearWith=list(
                    "overdispersion_model",
                    "correlation_structure"),
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="heterogeneityTests",
                title="Heterogeneity Assessment",
                visible="(heterogeneity_test)",
                rows=1,
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "study_id"),
                columns=list(
                    list(
                        `name`="statistic_type", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic_value", 
                        `title`="Statistic", 
                        `type`="number", 
                        `format`="zto:3"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="tau_squared", 
                        `title`="\u03C4\u00B2", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="i_squared", 
                        `title`="I\u00B2", 
                        `type`="number", 
                        `format`="zto:1"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="studyLevelResults",
                title="Study-Level Results",
                visible=TRUE,
                rows=1,
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "study_id"),
                columns=list(
                    list(
                        `name`="study", 
                        `title`="Study", 
                        `type`="text"),
                    list(
                        `name`="n_diseased", 
                        `title`="Disease +", 
                        `type`="integer"),
                    list(
                        `name`="n_non_diseased", 
                        `title`="Disease -", 
                        `type`="integer"),
                    list(
                        `name`="sensitivity", 
                        `title`="Sensitivity", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="specificity", 
                        `title`="Specificity", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="sensitivity_ci_lower", 
                        `title`="Sens Lower", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="sensitivity_ci_upper", 
                        `title`="Sens Upper", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="specificity_ci_lower", 
                        `title`="Spec Lower", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="specificity_ci_upper", 
                        `title`="Spec Upper", 
                        `type`="number", 
                        `format`="zto:4"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="pooledEstimates",
                title="Pooled Diagnostic Accuracy",
                visible=TRUE,
                rows=1,
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "overdispersion_model"),
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Pooled Estimate", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="prediction_lower", 
                        `title`="Pred Lower", 
                        `type`="number", 
                        `format`="zto:4", 
                        `visible`="(prediction_intervals)"),
                    list(
                        `name`="prediction_upper", 
                        `title`="Pred Upper", 
                        `type`="number", 
                        `format`="zto:4", 
                        `visible`="(prediction_intervals)"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="correlationResults",
                title="Sensitivity-Specificity Correlation",
                visible="(correlation_structure:correlated)",
                rows=1,
                clearWith=list(
                    "correlation_structure",
                    "overdispersion_model"),
                columns=list(
                    list(
                        `name`="correlation_type", 
                        `title`="Correlation Type", 
                        `type`="text"),
                    list(
                        `name`="correlation", 
                        `title`="Correlation", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto:4"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="convergenceDiagnostics",
                title="MCMC Convergence Diagnostics",
                visible="(estimation_method:bayesian_mcmc && convergence_diagnostics)",
                rows=1,
                clearWith=list(
                    "mcmc_iterations",
                    "burnin_iterations"),
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="rhat", 
                        `title`="R\u0302", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="effective_n", 
                        `title`="Effective N", 
                        `type`="integer"),
                    list(
                        `name`="mcmc_se", 
                        `title`="MCMC SE", 
                        `type`="number", 
                        `format`="zto:6"),
                    list(
                        `name`="geweke_z", 
                        `title`="Geweke Z", 
                        `type`="number", 
                        `format`="zto:3"),
                    list(
                        `name`="convergence_status", 
                        `title`="Status", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="subgroupAnalysis",
                title="Subgroup Analysis",
                visible="(subgroup_analysis)",
                rows=1,
                clearWith=list(
                    "covariates",
                    "subgroup_analysis"),
                columns=list(
                    list(
                        `name`="subgroup", 
                        `title`="Subgroup", 
                        `type`="text"),
                    list(
                        `name`="n_studies", 
                        `title`="Studies", 
                        `type`="integer"),
                    list(
                        `name`="pooled_sensitivity", 
                        `title`="Pooled Sensitivity", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="pooled_specificity", 
                        `title`="Pooled Specificity", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="q_between", 
                        `title`="Q-between", 
                        `type`="number", 
                        `format`="zto:3"),
                    list(
                        `name`="p_between", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto:4"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="influenceAnalysis",
                title="Influence Analysis",
                visible="(influence_diagnostics)",
                rows=1,
                clearWith=list(
                    "study_id",
                    "influence_diagnostics"),
                columns=list(
                    list(
                        `name`="study", 
                        `title`="Study", 
                        `type`="text"),
                    list(
                        `name`="cook_distance", 
                        `title`="Cook's D", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="dffits", 
                        `title`="DFFITS", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="leverage", 
                        `title`="Leverage", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="influence_flag", 
                        `title`="Influential", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="publicationBiasTests",
                title="Publication Bias Tests",
                visible="(publication_bias)",
                rows=1,
                clearWith=list(
                    "publication_bias"),
                columns=list(
                    list(
                        `name`="test_name", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto:4"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="forestPlotSensitivity",
                title="Forest Plot - Sensitivity",
                visible="(forest_plot)",
                requiresData=TRUE,
                width=800,
                height=600,
                renderFun=".plotForestSensitivity",
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "study_id")))
            self$add(jmvcore::Image$new(
                options=options,
                name="forestPlotSpecificity",
                title="Forest Plot - Specificity",
                visible="(forest_plot)",
                requiresData=TRUE,
                width=800,
                height=600,
                renderFun=".plotForestSpecificity",
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "study_id")))
            self$add(jmvcore::Image$new(
                options=options,
                name="summaryROCPlot",
                title="Summary ROC Curve",
                visible="(summary_roc_curve)",
                requiresData=TRUE,
                width=700,
                height=700,
                renderFun=".plotSummaryROC",
                clearWith=list(
                    "test_result",
                    "disease_status",
                    "overdispersion_model")))
            self$add(jmvcore::Image$new(
                options=options,
                name="residualPlots",
                title="Residual Diagnostic Plots",
                visible="(residual_plots)",
                requiresData=TRUE,
                width=800,
                height=600,
                renderFun=".plotResiduals",
                clearWith=list(
                    "overdispersion_model",
                    "residual_plots")))
            self$add(jmvcore::Image$new(
                options=options,
                name="convergencePlots",
                title="MCMC Convergence Plots",
                visible="(estimation_method:bayesian_mcmc && convergence_diagnostics)",
                requiresData=TRUE,
                width=800,
                height=600,
                renderFun=".plotConvergence",
                clearWith=list(
                    "mcmc_iterations",
                    "convergence_diagnostics")))
            self$add(jmvcore::Image$new(
                options=options,
                name="funnelPlot",
                title="Funnel Plot for Publication Bias",
                visible="(publication_bias)",
                requiresData=TRUE,
                width=700,
                height=500,
                renderFun=".plotFunnel",
                clearWith=list(
                    "publication_bias")))
            self$add(jmvcore::Html$new(
                options=options,
                name="methodExplanation",
                title="Method and Interpretation",
                visible=TRUE))}))

betabinomialdiagnosticBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "betabinomialdiagnosticBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "betabinomialdiagnostic",
                version = c(0,0,3),
                options = options,
                results = betabinomialdiagnosticResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'na')
        }))

#' Beta-Binomial Diagnostic Accuracy Models
#'
#' Beta-binomial models for overdispersed diagnostic accuracy data.
#' Handles heterogeneity in sensitivity and specificity across studies or
#' centers using beta-binomial distributions with flexible correlation 
#' structures.
#' 
#'
#' @examples
#' # Example: Beta-binomial diagnostic accuracy analysis
#' betabinomialdiagnostic(
#'     data = diagnostic_data,
#'     test_result = test_outcome,
#'     disease_status = true_disease,
#'     study_id = study_center,
#'     overdispersion_model = "beta_binomial"
#' )
#'
#' @param test_result Test result variable
#' @param disease_status Gold standard disease status
#' @param study_id Clustering variable for multi-center studies
#' @param covariates Covariates for explaining between-study heterogeneity
#' @param overdispersion_model Statistical model for overdispersed diagnostic
#'   data
#' @param correlation_structure Assumed correlation structure
#' @param estimation_method Method for estimating model parameters
#' @param heterogeneity_test Whether to test for heterogeneity
#' @param tau_squared_method Estimator for τ² (heterogeneity variance)
#' @param confidence_level Confidence level for parameter estimates
#' @param alpha_prior Prior alpha for sensitivity in Bayesian models
#' @param beta_prior Prior beta for sensitivity in Bayesian models
#' @param alpha_prior_spec Prior alpha for specificity in Bayesian models
#' @param beta_prior_spec Prior beta for specificity in Bayesian models
#' @param mcmc_iterations MCMC iterations for posterior sampling
#' @param burnin_iterations MCMC burn-in iterations
#' @param thin_factor Keep every nth MCMC sample
#' @param convergence_diagnostics Whether to check MCMC convergence
#' @param prediction_intervals Whether to compute prediction intervals
#' @param forest_plot Whether to create forest plots
#' @param summary_roc_curve Whether to plot summary ROC curve
#' @param residual_plots Whether to create residual diagnostic plots
#' @param influence_diagnostics Whether to perform influence analysis
#' @param publication_bias Whether to assess publication bias
#' @param subgroup_analysis Whether to conduct subgroup analyses
#' @param robust_variance Whether to use robust standard errors
#' @param finite_sample_correction Whether to apply small sample corrections
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$modelSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$overdispersionParameters} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$heterogeneityTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$studyLevelResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$pooledEstimates} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$correlationResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$convergenceDiagnostics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$subgroupAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$influenceAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$publicationBiasTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$forestPlotSensitivity} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$forestPlotSpecificity} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$summaryROCPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$residualPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$convergencePlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$funnelPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$methodExplanation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$modelSummary$asDF}
#'
#' \code{as.data.frame(results$modelSummary)}
#'
#' @export
betabinomialdiagnostic <- function(
    test_result,
    disease_status,
    study_id = NULL,
    covariates = NULL,
    overdispersion_model = "beta_binomial",
    correlation_structure = "independent",
    estimation_method = "maximum_likelihood",
    heterogeneity_test = TRUE,
    tau_squared_method = "dersimonian_laird",
    confidence_level = 0.95,
    alpha_prior = 1,
    beta_prior = 1,
    alpha_prior_spec = 1,
    beta_prior_spec = 1,
    mcmc_iterations = 10000,
    burnin_iterations = 2000,
    thin_factor = 5,
    convergence_diagnostics = TRUE,
    prediction_intervals = TRUE,
    forest_plot = TRUE,
    summary_roc_curve = TRUE,
    residual_plots = FALSE,
    influence_diagnostics = FALSE,
    publication_bias = FALSE,
    subgroup_analysis = FALSE,
    robust_variance = FALSE,
    finite_sample_correction = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("betabinomialdiagnostic requires jmvcore to be installed (restart may be required)")

    if ( ! missing(test_result)) test_result <- jmvcore::resolveQuo(jmvcore::enquo(test_result))
    if ( ! missing(disease_status)) disease_status <- jmvcore::resolveQuo(jmvcore::enquo(disease_status))
    if ( ! missing(study_id)) study_id <- jmvcore::resolveQuo(jmvcore::enquo(study_id))
    if ( ! missing(covariates)) covariates <- jmvcore::resolveQuo(jmvcore::enquo(covariates))

    options <- betabinomialdiagnosticOptions$new(
        test_result = test_result,
        disease_status = disease_status,
        study_id = study_id,
        covariates = covariates,
        overdispersion_model = overdispersion_model,
        correlation_structure = correlation_structure,
        estimation_method = estimation_method,
        heterogeneity_test = heterogeneity_test,
        tau_squared_method = tau_squared_method,
        confidence_level = confidence_level,
        alpha_prior = alpha_prior,
        beta_prior = beta_prior,
        alpha_prior_spec = alpha_prior_spec,
        beta_prior_spec = beta_prior_spec,
        mcmc_iterations = mcmc_iterations,
        burnin_iterations = burnin_iterations,
        thin_factor = thin_factor,
        convergence_diagnostics = convergence_diagnostics,
        prediction_intervals = prediction_intervals,
        forest_plot = forest_plot,
        summary_roc_curve = summary_roc_curve,
        residual_plots = residual_plots,
        influence_diagnostics = influence_diagnostics,
        publication_bias = publication_bias,
        subgroup_analysis = subgroup_analysis,
        robust_variance = robust_variance,
        finite_sample_correction = finite_sample_correction)

    analysis <- betabinomialdiagnosticClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

