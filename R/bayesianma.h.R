
# This file is automatically generated, you probably don't want to edit this

bayesianmaOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesianmaOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            time_var = NULL,
            event_var = NULL,
            pred_vars = NULL,
            prior_type = "uniform",
            prior_inclusion_prob = 0.5,
            beta_alpha = 1,
            beta_beta = 1,
            complexity_penalty = 1,
            mcmc_method = "mc3",
            mcmc_chains = 3,
            mcmc_iterations = 5000,
            burn_in = 1000,
            thinning = 1,
            convergence_diagnostic = "gelman_rubin",
            model_selection_method = "highest_posterior",
            occam_ratio = 20,
            temperature_ladder = "1.0,1.5,2.0,3.0",
            proposal_variance = 1,
            variable_selection_threshold = 0.5,
            uncertainty_quantification = TRUE,
            prediction_intervals = TRUE,
            credible_level = 0.95,
            model_diagnostics = TRUE,
            sensitivity_analysis = FALSE,
            cross_validation = FALSE,
            cv_folds = 5,
            parallel_processing = FALSE,
            seed_value = 42,
            show_summary = TRUE,
            show_model_space = TRUE,
            show_coefficients = TRUE,
            show_inclusion_probs = TRUE,
            show_top_models = TRUE,
            show_diagnostics = TRUE,
            show_predictions = FALSE,
            plot_model_probs = TRUE,
            plot_inclusion_probs = TRUE,
            plot_coefficients = TRUE,
            plot_convergence = TRUE,
            plot_model_space = FALSE,
            plot_predictions = FALSE,
            showExplanations = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="bayesianma",
                requiresData=TRUE,
                ...)

            private$..time_var <- jmvcore::OptionVariable$new(
                "time_var",
                time_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..event_var <- jmvcore::OptionVariable$new(
                "event_var",
                event_var,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..pred_vars <- jmvcore::OptionVariables$new(
                "pred_vars",
                pred_vars,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..prior_type <- jmvcore::OptionList$new(
                "prior_type",
                prior_type,
                options=list(
                    "uniform",
                    "beta_binomial",
                    "complexity_prior",
                    "scott_berger",
                    "custom"),
                default="uniform")
            private$..prior_inclusion_prob <- jmvcore::OptionNumber$new(
                "prior_inclusion_prob",
                prior_inclusion_prob,
                min=0.01,
                max=0.99,
                default=0.5)
            private$..beta_alpha <- jmvcore::OptionNumber$new(
                "beta_alpha",
                beta_alpha,
                min=0.1,
                max=10,
                default=1)
            private$..beta_beta <- jmvcore::OptionNumber$new(
                "beta_beta",
                beta_beta,
                min=0.1,
                max=10,
                default=1)
            private$..complexity_penalty <- jmvcore::OptionNumber$new(
                "complexity_penalty",
                complexity_penalty,
                min=0.1,
                max=5,
                default=1)
            private$..mcmc_method <- jmvcore::OptionList$new(
                "mcmc_method",
                mcmc_method,
                options=list(
                    "mc3",
                    "birth_death",
                    "gibbs_variable",
                    "reversible_jump"),
                default="mc3")
            private$..mcmc_chains <- jmvcore::OptionInteger$new(
                "mcmc_chains",
                mcmc_chains,
                min=1,
                max=8,
                default=3)
            private$..mcmc_iterations <- jmvcore::OptionInteger$new(
                "mcmc_iterations",
                mcmc_iterations,
                min=1000,
                max=50000,
                default=5000)
            private$..burn_in <- jmvcore::OptionInteger$new(
                "burn_in",
                burn_in,
                min=100,
                max=20000,
                default=1000)
            private$..thinning <- jmvcore::OptionInteger$new(
                "thinning",
                thinning,
                min=1,
                max=100,
                default=1)
            private$..convergence_diagnostic <- jmvcore::OptionList$new(
                "convergence_diagnostic",
                convergence_diagnostic,
                options=list(
                    "gelman_rubin",
                    "geweke",
                    "heidelberger_welch",
                    "raftery_lewis"),
                default="gelman_rubin")
            private$..model_selection_method <- jmvcore::OptionList$new(
                "model_selection_method",
                model_selection_method,
                options=list(
                    "highest_posterior",
                    "median_probability",
                    "mode_probability",
                    "occam_window"),
                default="highest_posterior")
            private$..occam_ratio <- jmvcore::OptionNumber$new(
                "occam_ratio",
                occam_ratio,
                min=1,
                max=1000,
                default=20)
            private$..temperature_ladder <- jmvcore::OptionString$new(
                "temperature_ladder",
                temperature_ladder,
                default="1.0,1.5,2.0,3.0")
            private$..proposal_variance <- jmvcore::OptionNumber$new(
                "proposal_variance",
                proposal_variance,
                min=0.01,
                max=10,
                default=1)
            private$..variable_selection_threshold <- jmvcore::OptionNumber$new(
                "variable_selection_threshold",
                variable_selection_threshold,
                min=0.1,
                max=0.9,
                default=0.5)
            private$..uncertainty_quantification <- jmvcore::OptionBool$new(
                "uncertainty_quantification",
                uncertainty_quantification,
                default=TRUE)
            private$..prediction_intervals <- jmvcore::OptionBool$new(
                "prediction_intervals",
                prediction_intervals,
                default=TRUE)
            private$..credible_level <- jmvcore::OptionNumber$new(
                "credible_level",
                credible_level,
                min=0.8,
                max=0.99,
                default=0.95)
            private$..model_diagnostics <- jmvcore::OptionBool$new(
                "model_diagnostics",
                model_diagnostics,
                default=TRUE)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=FALSE)
            private$..cross_validation <- jmvcore::OptionBool$new(
                "cross_validation",
                cross_validation,
                default=FALSE)
            private$..cv_folds <- jmvcore::OptionInteger$new(
                "cv_folds",
                cv_folds,
                min=3,
                max=10,
                default=5)
            private$..parallel_processing <- jmvcore::OptionBool$new(
                "parallel_processing",
                parallel_processing,
                default=FALSE)
            private$..seed_value <- jmvcore::OptionInteger$new(
                "seed_value",
                seed_value,
                default=42)
            private$..show_summary <- jmvcore::OptionBool$new(
                "show_summary",
                show_summary,
                default=TRUE)
            private$..show_model_space <- jmvcore::OptionBool$new(
                "show_model_space",
                show_model_space,
                default=TRUE)
            private$..show_coefficients <- jmvcore::OptionBool$new(
                "show_coefficients",
                show_coefficients,
                default=TRUE)
            private$..show_inclusion_probs <- jmvcore::OptionBool$new(
                "show_inclusion_probs",
                show_inclusion_probs,
                default=TRUE)
            private$..show_top_models <- jmvcore::OptionBool$new(
                "show_top_models",
                show_top_models,
                default=TRUE)
            private$..show_diagnostics <- jmvcore::OptionBool$new(
                "show_diagnostics",
                show_diagnostics,
                default=TRUE)
            private$..show_predictions <- jmvcore::OptionBool$new(
                "show_predictions",
                show_predictions,
                default=FALSE)
            private$..plot_model_probs <- jmvcore::OptionBool$new(
                "plot_model_probs",
                plot_model_probs,
                default=TRUE)
            private$..plot_inclusion_probs <- jmvcore::OptionBool$new(
                "plot_inclusion_probs",
                plot_inclusion_probs,
                default=TRUE)
            private$..plot_coefficients <- jmvcore::OptionBool$new(
                "plot_coefficients",
                plot_coefficients,
                default=TRUE)
            private$..plot_convergence <- jmvcore::OptionBool$new(
                "plot_convergence",
                plot_convergence,
                default=TRUE)
            private$..plot_model_space <- jmvcore::OptionBool$new(
                "plot_model_space",
                plot_model_space,
                default=FALSE)
            private$..plot_predictions <- jmvcore::OptionBool$new(
                "plot_predictions",
                plot_predictions,
                default=FALSE)
            private$..showExplanations <- jmvcore::OptionBool$new(
                "showExplanations",
                showExplanations,
                default=TRUE)

            self$.addOption(private$..time_var)
            self$.addOption(private$..event_var)
            self$.addOption(private$..pred_vars)
            self$.addOption(private$..prior_type)
            self$.addOption(private$..prior_inclusion_prob)
            self$.addOption(private$..beta_alpha)
            self$.addOption(private$..beta_beta)
            self$.addOption(private$..complexity_penalty)
            self$.addOption(private$..mcmc_method)
            self$.addOption(private$..mcmc_chains)
            self$.addOption(private$..mcmc_iterations)
            self$.addOption(private$..burn_in)
            self$.addOption(private$..thinning)
            self$.addOption(private$..convergence_diagnostic)
            self$.addOption(private$..model_selection_method)
            self$.addOption(private$..occam_ratio)
            self$.addOption(private$..temperature_ladder)
            self$.addOption(private$..proposal_variance)
            self$.addOption(private$..variable_selection_threshold)
            self$.addOption(private$..uncertainty_quantification)
            self$.addOption(private$..prediction_intervals)
            self$.addOption(private$..credible_level)
            self$.addOption(private$..model_diagnostics)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..cross_validation)
            self$.addOption(private$..cv_folds)
            self$.addOption(private$..parallel_processing)
            self$.addOption(private$..seed_value)
            self$.addOption(private$..show_summary)
            self$.addOption(private$..show_model_space)
            self$.addOption(private$..show_coefficients)
            self$.addOption(private$..show_inclusion_probs)
            self$.addOption(private$..show_top_models)
            self$.addOption(private$..show_diagnostics)
            self$.addOption(private$..show_predictions)
            self$.addOption(private$..plot_model_probs)
            self$.addOption(private$..plot_inclusion_probs)
            self$.addOption(private$..plot_coefficients)
            self$.addOption(private$..plot_convergence)
            self$.addOption(private$..plot_model_space)
            self$.addOption(private$..plot_predictions)
            self$.addOption(private$..showExplanations)
        }),
    active = list(
        time_var = function() private$..time_var$value,
        event_var = function() private$..event_var$value,
        pred_vars = function() private$..pred_vars$value,
        prior_type = function() private$..prior_type$value,
        prior_inclusion_prob = function() private$..prior_inclusion_prob$value,
        beta_alpha = function() private$..beta_alpha$value,
        beta_beta = function() private$..beta_beta$value,
        complexity_penalty = function() private$..complexity_penalty$value,
        mcmc_method = function() private$..mcmc_method$value,
        mcmc_chains = function() private$..mcmc_chains$value,
        mcmc_iterations = function() private$..mcmc_iterations$value,
        burn_in = function() private$..burn_in$value,
        thinning = function() private$..thinning$value,
        convergence_diagnostic = function() private$..convergence_diagnostic$value,
        model_selection_method = function() private$..model_selection_method$value,
        occam_ratio = function() private$..occam_ratio$value,
        temperature_ladder = function() private$..temperature_ladder$value,
        proposal_variance = function() private$..proposal_variance$value,
        variable_selection_threshold = function() private$..variable_selection_threshold$value,
        uncertainty_quantification = function() private$..uncertainty_quantification$value,
        prediction_intervals = function() private$..prediction_intervals$value,
        credible_level = function() private$..credible_level$value,
        model_diagnostics = function() private$..model_diagnostics$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        cross_validation = function() private$..cross_validation$value,
        cv_folds = function() private$..cv_folds$value,
        parallel_processing = function() private$..parallel_processing$value,
        seed_value = function() private$..seed_value$value,
        show_summary = function() private$..show_summary$value,
        show_model_space = function() private$..show_model_space$value,
        show_coefficients = function() private$..show_coefficients$value,
        show_inclusion_probs = function() private$..show_inclusion_probs$value,
        show_top_models = function() private$..show_top_models$value,
        show_diagnostics = function() private$..show_diagnostics$value,
        show_predictions = function() private$..show_predictions$value,
        plot_model_probs = function() private$..plot_model_probs$value,
        plot_inclusion_probs = function() private$..plot_inclusion_probs$value,
        plot_coefficients = function() private$..plot_coefficients$value,
        plot_convergence = function() private$..plot_convergence$value,
        plot_model_space = function() private$..plot_model_space$value,
        plot_predictions = function() private$..plot_predictions$value,
        showExplanations = function() private$..showExplanations$value),
    private = list(
        ..time_var = NA,
        ..event_var = NA,
        ..pred_vars = NA,
        ..prior_type = NA,
        ..prior_inclusion_prob = NA,
        ..beta_alpha = NA,
        ..beta_beta = NA,
        ..complexity_penalty = NA,
        ..mcmc_method = NA,
        ..mcmc_chains = NA,
        ..mcmc_iterations = NA,
        ..burn_in = NA,
        ..thinning = NA,
        ..convergence_diagnostic = NA,
        ..model_selection_method = NA,
        ..occam_ratio = NA,
        ..temperature_ladder = NA,
        ..proposal_variance = NA,
        ..variable_selection_threshold = NA,
        ..uncertainty_quantification = NA,
        ..prediction_intervals = NA,
        ..credible_level = NA,
        ..model_diagnostics = NA,
        ..sensitivity_analysis = NA,
        ..cross_validation = NA,
        ..cv_folds = NA,
        ..parallel_processing = NA,
        ..seed_value = NA,
        ..show_summary = NA,
        ..show_model_space = NA,
        ..show_coefficients = NA,
        ..show_inclusion_probs = NA,
        ..show_top_models = NA,
        ..show_diagnostics = NA,
        ..show_predictions = NA,
        ..plot_model_probs = NA,
        ..plot_inclusion_probs = NA,
        ..plot_coefficients = NA,
        ..plot_convergence = NA,
        ..plot_model_space = NA,
        ..plot_predictions = NA,
        ..showExplanations = NA)
)

bayesianmaResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesianmaResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        todo = function() private$.items[["todo"]],
        summary = function() private$.items[["summary"]],
        modelSpace = function() private$.items[["modelSpace"]],
        averagedCoefficients = function() private$.items[["averagedCoefficients"]],
        inclusionProbabilities = function() private$.items[["inclusionProbabilities"]],
        topModels = function() private$.items[["topModels"]],
        mcmcDiagnostics = function() private$.items[["mcmcDiagnostics"]],
        selectedModel = function() private$.items[["selectedModel"]],
        uncertaintyQuantification = function() private$.items[["uncertaintyQuantification"]],
        sensitivityAnalysis = function() private$.items[["sensitivityAnalysis"]],
        crossValidation = function() private$.items[["crossValidation"]],
        modelProbsPlot = function() private$.items[["modelProbsPlot"]],
        inclusionProbsPlot = function() private$.items[["inclusionProbsPlot"]],
        coefficientsPlot = function() private$.items[["coefficientsPlot"]],
        convergencePlot = function() private$.items[["convergencePlot"]],
        modelSpacePlot = function() private$.items[["modelSpacePlot"]],
        predictionsPlot = function() private$.items[["predictionsPlot"]],
        explanations = function() private$.items[["explanations"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Analysis Results",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=FALSE))
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="Analysis Todo",
                visible=FALSE))
            self$add(jmvcore::Table$new(
                options=options,
                name="summary",
                title="Bayesian Model Averaging Summary",
                visible="(show_summary)",
                clearWith=list(
                    "time_var",
                    "event_var",
                    "pred_vars",
                    "prior_type",
                    "mcmc_method"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelSpace",
                title="Model Space Exploration",
                visible="(show_model_space)",
                clearWith=list(
                    "mcmc_iterations",
                    "mcmc_chains",
                    "prior_type"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="averagedCoefficients",
                title="Model-Averaged Coefficients",
                visible="(show_coefficients)",
                clearWith=list(
                    "pred_vars",
                    "mcmc_iterations",
                    "credible_level"),
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="posterior_mean", 
                        `title`="Posterior Mean", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="posterior_sd", 
                        `title`="Posterior SD", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="credible_lower", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="credible_upper", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hazard_ratio", 
                        `title`="Hazard Ratio", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hr_lower", 
                        `title`="HR Lower CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hr_upper", 
                        `title`="HR Upper CI", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="inclusionProbabilities",
                title="Posterior Inclusion Probabilities",
                visible="(show_inclusion_probs)",
                clearWith=list(
                    "pred_vars",
                    "mcmc_iterations",
                    "variable_selection_threshold"),
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="inclusion_prob", 
                        `title`="Inclusion Probability", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="bayes_factor", 
                        `title`="Bayes Factor", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="log_bayes_factor", 
                        `title`="Log BF", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="evidence_strength", 
                        `title`="Evidence Strength", 
                        `type`="text"),
                    list(
                        `name`="selected", 
                        `title`="Selected", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="topModels",
                title="Top Probability Models",
                visible="(show_top_models)",
                clearWith=list(
                    "mcmc_iterations",
                    "model_selection_method"),
                columns=list(
                    list(
                        `name`="model_rank", 
                        `title`="Rank", 
                        `type`="integer"),
                    list(
                        `name`="posterior_prob", 
                        `title`="Posterior Probability", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="log_marginal_likelihood", 
                        `title`="Log Marginal Likelihood", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="model_size", 
                        `title`="Model Size", 
                        `type`="integer"),
                    list(
                        `name`="variables_included", 
                        `title`="Variables Included", 
                        `type`="text"),
                    list(
                        `name`="cumulative_prob", 
                        `title`="Cumulative Probability", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="mcmcDiagnostics",
                title="MCMC Convergence Diagnostics",
                visible="(show_diagnostics)",
                clearWith=list(
                    "mcmc_chains",
                    "mcmc_iterations",
                    "convergence_diagnostic"),
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="diagnostic_value", 
                        `title`="Diagnostic Value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="convergence_status", 
                        `title`="Convergence", 
                        `type`="text"),
                    list(
                        `name`="effective_sample_size", 
                        `title`="Effective Sample Size", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="selectedModel",
                title="Selected Model Details",
                visible="(show_top_models)",
                clearWith=list(
                    "model_selection_method",
                    "variable_selection_threshold"),
                columns=list(
                    list(
                        `name`="selection_method", 
                        `title`="Selection Method", 
                        `type`="text"),
                    list(
                        `name`="model_probability", 
                        `title`="Model Probability", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="model_size", 
                        `title`="Model Size", 
                        `type`="integer"),
                    list(
                        `name`="log_likelihood", 
                        `title`="Log Likelihood", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="deviance", 
                        `title`="Deviance", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="dic", 
                        `title`="DIC", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="uncertaintyQuantification",
                title="Uncertainty Quantification",
                visible="(uncertainty_quantification)",
                clearWith=list(
                    "mcmc_iterations",
                    "credible_level"),
                columns=list(
                    list(
                        `name`="quantity", 
                        `title`="Quantity", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="model_uncertainty", 
                        `title`="Model Uncertainty", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="parameter_uncertainty", 
                        `title`="Parameter Uncertainty", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="total_uncertainty", 
                        `title`="Total Uncertainty", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="sensitivityAnalysis",
                title="Prior Sensitivity Analysis",
                visible="(sensitivity_analysis)",
                clearWith=list(
                    "prior_type",
                    "sensitivity_analysis"),
                columns=list(
                    list(
                        `name`="prior_specification", 
                        `title`="Prior Specification", 
                        `type`="text"),
                    list(
                        `name`="posterior_prob_change", 
                        `title`="Posterior Prob Change", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="inclusion_prob_change", 
                        `title`="Inclusion Prob Change", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="sensitivity_measure", 
                        `title`="Sensitivity Measure", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="robustness", 
                        `title`="Robustness", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="crossValidation",
                title="Cross-Validation Results",
                visible="(cross_validation)",
                clearWith=list(
                    "cross_validation",
                    "cv_folds"),
                columns=list(
                    list(
                        `name`="fold", 
                        `title`="Fold", 
                        `type`="integer"),
                    list(
                        `name`="log_predictive_score", 
                        `title`="Log Predictive Score", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="deviance", 
                        `title`="Deviance", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="c_index", 
                        `title`="C-Index", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="calibration", 
                        `title`="Calibration", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="modelProbsPlot",
                title="Model Posterior Probabilities",
                width=600,
                height=400,
                visible="(plot_model_probs)",
                requiresData=TRUE,
                clearWith=list(
                    "mcmc_iterations",
                    "model_selection_method")))
            self$add(jmvcore::Image$new(
                options=options,
                name="inclusionProbsPlot",
                title="Variable Inclusion Probabilities",
                width=600,
                height=500,
                visible="(plot_inclusion_probs)",
                requiresData=TRUE,
                clearWith=list(
                    "pred_vars",
                    "variable_selection_threshold")))
            self$add(jmvcore::Image$new(
                options=options,
                name="coefficientsPlot",
                title="Posterior Coefficient Distributions",
                width=700,
                height=600,
                visible="(plot_coefficients)",
                requiresData=TRUE,
                clearWith=list(
                    "pred_vars",
                    "credible_level")))
            self$add(jmvcore::Image$new(
                options=options,
                name="convergencePlot",
                title="MCMC Convergence Diagnostics",
                width=800,
                height=600,
                visible="(plot_convergence)",
                requiresData=TRUE,
                clearWith=list(
                    "mcmc_chains",
                    "mcmc_iterations")))
            self$add(jmvcore::Image$new(
                options=options,
                name="modelSpacePlot",
                title="Model Space Exploration",
                width=600,
                height=400,
                visible="(plot_model_space)",
                requiresData=TRUE,
                clearWith=list(
                    "mcmc_iterations",
                    "prior_type")))
            self$add(jmvcore::Image$new(
                options=options,
                name="predictionsPlot",
                title="Model-Averaged Predictions",
                width=600,
                height=400,
                visible="(plot_predictions)",
                requiresData=TRUE,
                clearWith=list(
                    "prediction_intervals",
                    "credible_level")))
            self$add(jmvcore::Html$new(
                options=options,
                name="explanations",
                title="Bayesian Model Averaging Explanations",
                visible="(showExplanations)"))}))

bayesianmaBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesianmaBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "bayesianma",
                version = c(1,0,0),
                options = options,
                results = bayesianmaResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Bayesian Model Averaging
#'
#' Bayesian Model Averaging for survival analysis
#'
#' @examples
#' data('histopathology', package='ClinicoPath')
#'
#' bayesianma(data = histopathology,
#'           time_var = 'OverallSurvival',
#'           event_var = 'Death',
#'           pred_vars = c('Age', 'Grade', 'LVI', 'PNI'),
#'           prior_type = 'uniform',
#'           mcmc_chains = 3,
#'           mcmc_iterations = 5000)
#'
#' @param data the data as a data frame
#' @param time_var the time-to-event variable
#' @param event_var the event indicator variable (0/1 or FALSE/TRUE)
#' @param pred_vars the predictor variables for model averaging
#' @param prior_type type of prior distribution for model space
#' @param prior_inclusion_prob prior probability of variable inclusion (for
#'   uniform/beta-binomial priors)
#' @param beta_alpha alpha parameter for beta-binomial prior
#' @param beta_beta beta parameter for beta-binomial prior
#' @param complexity_penalty penalty parameter for complexity prior
#' @param mcmc_method MCMC sampling method for model space exploration
#' @param mcmc_chains number of MCMC chains
#' @param mcmc_iterations number of MCMC iterations per chain
#' @param burn_in number of burn-in iterations
#' @param thinning thinning interval for MCMC samples
#' @param convergence_diagnostic convergence diagnostic method
#' @param model_selection_method method for selecting representative model
#' @param occam_ratio ratio for Occam's window model selection
#' @param temperature_ladder temperature ladder for MCÂ³ (comma-separated
#'   values). Higher temperatures enable better mixing
#' @param proposal_variance variance for parameter proposal distributions
#' @param variable_selection_threshold posterior probability threshold for
#'   variable selection
#' @param uncertainty_quantification whether to perform comprehensive
#'   uncertainty quantification
#' @param prediction_intervals whether to compute prediction intervals
#' @param credible_level level for credible intervals
#' @param model_diagnostics whether to perform comprehensive model diagnostics
#' @param sensitivity_analysis whether to perform prior sensitivity analysis
#' @param cross_validation whether to perform cross-validation assessment
#' @param cv_folds number of folds for cross-validation
#' @param parallel_processing whether to use parallel processing for MCMC
#' @param seed_value random seed for reproducible results
#' @param show_summary show model averaging summary
#' @param show_model_space show model space exploration results
#' @param show_coefficients show model-averaged coefficient estimates
#' @param show_inclusion_probs show posterior inclusion probabilities
#' @param show_top_models show highest probability models
#' @param show_diagnostics show MCMC convergence diagnostics
#' @param show_predictions show model-averaged predictions
#' @param plot_model_probs plot model posterior probabilities
#' @param plot_inclusion_probs plot variable inclusion probabilities
#' @param plot_coefficients plot posterior coefficient distributions
#' @param plot_convergence plot MCMC convergence diagnostics
#' @param plot_model_space plot model space exploration
#' @param plot_predictions plot model-averaged predictions
#' @param showExplanations show explanations for the analysis
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$todo} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$summary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$modelSpace} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$averagedCoefficients} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$inclusionProbabilities} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$topModels} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$mcmcDiagnostics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$selectedModel} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$uncertaintyQuantification} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$sensitivityAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$crossValidation} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$modelProbsPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$inclusionProbsPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$coefficientsPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$convergencePlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$modelSpacePlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$predictionsPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$explanations} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$summary$asDF}
#'
#' \code{as.data.frame(results$summary)}
#'
#' @export
bayesianma <- function(
    data,
    time_var,
    event_var,
    pred_vars,
    prior_type = "uniform",
    prior_inclusion_prob = 0.5,
    beta_alpha = 1,
    beta_beta = 1,
    complexity_penalty = 1,
    mcmc_method = "mc3",
    mcmc_chains = 3,
    mcmc_iterations = 5000,
    burn_in = 1000,
    thinning = 1,
    convergence_diagnostic = "gelman_rubin",
    model_selection_method = "highest_posterior",
    occam_ratio = 20,
    temperature_ladder = "1.0,1.5,2.0,3.0",
    proposal_variance = 1,
    variable_selection_threshold = 0.5,
    uncertainty_quantification = TRUE,
    prediction_intervals = TRUE,
    credible_level = 0.95,
    model_diagnostics = TRUE,
    sensitivity_analysis = FALSE,
    cross_validation = FALSE,
    cv_folds = 5,
    parallel_processing = FALSE,
    seed_value = 42,
    show_summary = TRUE,
    show_model_space = TRUE,
    show_coefficients = TRUE,
    show_inclusion_probs = TRUE,
    show_top_models = TRUE,
    show_diagnostics = TRUE,
    show_predictions = FALSE,
    plot_model_probs = TRUE,
    plot_inclusion_probs = TRUE,
    plot_coefficients = TRUE,
    plot_convergence = TRUE,
    plot_model_space = FALSE,
    plot_predictions = FALSE,
    showExplanations = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("bayesianma requires jmvcore to be installed (restart may be required)")

    if ( ! missing(time_var)) time_var <- jmvcore::resolveQuo(jmvcore::enquo(time_var))
    if ( ! missing(event_var)) event_var <- jmvcore::resolveQuo(jmvcore::enquo(event_var))
    if ( ! missing(pred_vars)) pred_vars <- jmvcore::resolveQuo(jmvcore::enquo(pred_vars))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(time_var), time_var, NULL),
            `if`( ! missing(event_var), event_var, NULL),
            `if`( ! missing(pred_vars), pred_vars, NULL))


    options <- bayesianmaOptions$new(
        time_var = time_var,
        event_var = event_var,
        pred_vars = pred_vars,
        prior_type = prior_type,
        prior_inclusion_prob = prior_inclusion_prob,
        beta_alpha = beta_alpha,
        beta_beta = beta_beta,
        complexity_penalty = complexity_penalty,
        mcmc_method = mcmc_method,
        mcmc_chains = mcmc_chains,
        mcmc_iterations = mcmc_iterations,
        burn_in = burn_in,
        thinning = thinning,
        convergence_diagnostic = convergence_diagnostic,
        model_selection_method = model_selection_method,
        occam_ratio = occam_ratio,
        temperature_ladder = temperature_ladder,
        proposal_variance = proposal_variance,
        variable_selection_threshold = variable_selection_threshold,
        uncertainty_quantification = uncertainty_quantification,
        prediction_intervals = prediction_intervals,
        credible_level = credible_level,
        model_diagnostics = model_diagnostics,
        sensitivity_analysis = sensitivity_analysis,
        cross_validation = cross_validation,
        cv_folds = cv_folds,
        parallel_processing = parallel_processing,
        seed_value = seed_value,
        show_summary = show_summary,
        show_model_space = show_model_space,
        show_coefficients = show_coefficients,
        show_inclusion_probs = show_inclusion_probs,
        show_top_models = show_top_models,
        show_diagnostics = show_diagnostics,
        show_predictions = show_predictions,
        plot_model_probs = plot_model_probs,
        plot_inclusion_probs = plot_inclusion_probs,
        plot_coefficients = plot_coefficients,
        plot_convergence = plot_convergence,
        plot_model_space = plot_model_space,
        plot_predictions = plot_predictions,
        showExplanations = showExplanations)

    analysis <- bayesianmaClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

