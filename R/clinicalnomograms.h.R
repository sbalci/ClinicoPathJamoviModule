
# This file is automatically generated, you probably don't want to edit this

clinicalnomogramsOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalnomogramsOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            time_var = NULL,
            status_var = NULL,
            outcome_var = NULL,
            covariates = NULL,
            nomogram_type = "survival_nomogram",
            model_selection = "all_variables",
            prediction_times = "1,3,5,10",
            confidence_level = 0.95,
            validation_method = "bootstrap",
            bootstrap_samples = 1000,
            cv_folds = 10,
            nomogram_title = "Clinical Risk Assessment Nomogram",
            points_scale = 100,
            calibration_assessment = TRUE,
            discrimination_assessment = TRUE,
            decision_curve_analysis = TRUE,
            risk_groups = TRUE,
            risk_thresholds = "0.33,0.67",
            interactive_nomogram = TRUE,
            risk_calculator = TRUE,
            clinical_scenarios = TRUE,
            model_equation = TRUE,
            confidence_intervals = TRUE,
            external_validation = "",
            performance_metrics = TRUE,
            variable_importance = TRUE,
            sensitivity_analysis = FALSE,
            missing_data_handling = "complete_case",
            export_formats = TRUE,
            reporting_guidelines = "tripod",
            clinical_implementation = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="clinicalnomograms",
                requiresData=TRUE,
                ...)

            private$..time_var <- jmvcore::OptionVariable$new(
                "time_var",
                time_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..status_var <- jmvcore::OptionVariable$new(
                "status_var",
                status_var,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..outcome_var <- jmvcore::OptionVariable$new(
                "outcome_var",
                outcome_var,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..covariates <- jmvcore::OptionVariables$new(
                "covariates",
                covariates,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..nomogram_type <- jmvcore::OptionList$new(
                "nomogram_type",
                nomogram_type,
                options=list(
                    "survival_nomogram",
                    "logistic_nomogram",
                    "linear_nomogram",
                    "competing_risks",
                    "multi_state"),
                default="survival_nomogram")
            private$..model_selection <- jmvcore::OptionList$new(
                "model_selection",
                model_selection,
                options=list(
                    "all_variables",
                    "stepwise",
                    "lasso_selection",
                    "best_subset",
                    "clinical_judgment"),
                default="all_variables")
            private$..prediction_times <- jmvcore::OptionString$new(
                "prediction_times",
                prediction_times,
                default="1,3,5,10")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                min=0.5,
                max=0.99,
                default=0.95)
            private$..validation_method <- jmvcore::OptionList$new(
                "validation_method",
                validation_method,
                options=list(
                    "none",
                    "bootstrap",
                    "cross_validation",
                    "split_sample"),
                default="bootstrap")
            private$..bootstrap_samples <- jmvcore::OptionNumber$new(
                "bootstrap_samples",
                bootstrap_samples,
                min=100,
                max=5000,
                default=1000)
            private$..cv_folds <- jmvcore::OptionNumber$new(
                "cv_folds",
                cv_folds,
                min=3,
                max=20,
                default=10)
            private$..nomogram_title <- jmvcore::OptionString$new(
                "nomogram_title",
                nomogram_title,
                default="Clinical Risk Assessment Nomogram")
            private$..points_scale <- jmvcore::OptionNumber$new(
                "points_scale",
                points_scale,
                min=50,
                max=500,
                default=100)
            private$..calibration_assessment <- jmvcore::OptionBool$new(
                "calibration_assessment",
                calibration_assessment,
                default=TRUE)
            private$..discrimination_assessment <- jmvcore::OptionBool$new(
                "discrimination_assessment",
                discrimination_assessment,
                default=TRUE)
            private$..decision_curve_analysis <- jmvcore::OptionBool$new(
                "decision_curve_analysis",
                decision_curve_analysis,
                default=TRUE)
            private$..risk_groups <- jmvcore::OptionBool$new(
                "risk_groups",
                risk_groups,
                default=TRUE)
            private$..risk_thresholds <- jmvcore::OptionString$new(
                "risk_thresholds",
                risk_thresholds,
                default="0.33,0.67")
            private$..interactive_nomogram <- jmvcore::OptionBool$new(
                "interactive_nomogram",
                interactive_nomogram,
                default=TRUE)
            private$..risk_calculator <- jmvcore::OptionBool$new(
                "risk_calculator",
                risk_calculator,
                default=TRUE)
            private$..clinical_scenarios <- jmvcore::OptionBool$new(
                "clinical_scenarios",
                clinical_scenarios,
                default=TRUE)
            private$..model_equation <- jmvcore::OptionBool$new(
                "model_equation",
                model_equation,
                default=TRUE)
            private$..confidence_intervals <- jmvcore::OptionBool$new(
                "confidence_intervals",
                confidence_intervals,
                default=TRUE)
            private$..external_validation <- jmvcore::OptionString$new(
                "external_validation",
                external_validation,
                default="")
            private$..performance_metrics <- jmvcore::OptionBool$new(
                "performance_metrics",
                performance_metrics,
                default=TRUE)
            private$..variable_importance <- jmvcore::OptionBool$new(
                "variable_importance",
                variable_importance,
                default=TRUE)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=FALSE)
            private$..missing_data_handling <- jmvcore::OptionList$new(
                "missing_data_handling",
                missing_data_handling,
                options=list(
                    "complete_case",
                    "multiple_imputation",
                    "median_mode",
                    "missforest"),
                default="complete_case")
            private$..export_formats <- jmvcore::OptionBool$new(
                "export_formats",
                export_formats,
                default=TRUE)
            private$..reporting_guidelines <- jmvcore::OptionList$new(
                "reporting_guidelines",
                reporting_guidelines,
                options=list(
                    "tripod",
                    "remark",
                    "transparent",
                    "custom"),
                default="tripod")
            private$..clinical_implementation <- jmvcore::OptionBool$new(
                "clinical_implementation",
                clinical_implementation,
                default=TRUE)

            self$.addOption(private$..time_var)
            self$.addOption(private$..status_var)
            self$.addOption(private$..outcome_var)
            self$.addOption(private$..covariates)
            self$.addOption(private$..nomogram_type)
            self$.addOption(private$..model_selection)
            self$.addOption(private$..prediction_times)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..validation_method)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..cv_folds)
            self$.addOption(private$..nomogram_title)
            self$.addOption(private$..points_scale)
            self$.addOption(private$..calibration_assessment)
            self$.addOption(private$..discrimination_assessment)
            self$.addOption(private$..decision_curve_analysis)
            self$.addOption(private$..risk_groups)
            self$.addOption(private$..risk_thresholds)
            self$.addOption(private$..interactive_nomogram)
            self$.addOption(private$..risk_calculator)
            self$.addOption(private$..clinical_scenarios)
            self$.addOption(private$..model_equation)
            self$.addOption(private$..confidence_intervals)
            self$.addOption(private$..external_validation)
            self$.addOption(private$..performance_metrics)
            self$.addOption(private$..variable_importance)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..missing_data_handling)
            self$.addOption(private$..export_formats)
            self$.addOption(private$..reporting_guidelines)
            self$.addOption(private$..clinical_implementation)
        }),
    active = list(
        time_var = function() private$..time_var$value,
        status_var = function() private$..status_var$value,
        outcome_var = function() private$..outcome_var$value,
        covariates = function() private$..covariates$value,
        nomogram_type = function() private$..nomogram_type$value,
        model_selection = function() private$..model_selection$value,
        prediction_times = function() private$..prediction_times$value,
        confidence_level = function() private$..confidence_level$value,
        validation_method = function() private$..validation_method$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        cv_folds = function() private$..cv_folds$value,
        nomogram_title = function() private$..nomogram_title$value,
        points_scale = function() private$..points_scale$value,
        calibration_assessment = function() private$..calibration_assessment$value,
        discrimination_assessment = function() private$..discrimination_assessment$value,
        decision_curve_analysis = function() private$..decision_curve_analysis$value,
        risk_groups = function() private$..risk_groups$value,
        risk_thresholds = function() private$..risk_thresholds$value,
        interactive_nomogram = function() private$..interactive_nomogram$value,
        risk_calculator = function() private$..risk_calculator$value,
        clinical_scenarios = function() private$..clinical_scenarios$value,
        model_equation = function() private$..model_equation$value,
        confidence_intervals = function() private$..confidence_intervals$value,
        external_validation = function() private$..external_validation$value,
        performance_metrics = function() private$..performance_metrics$value,
        variable_importance = function() private$..variable_importance$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        missing_data_handling = function() private$..missing_data_handling$value,
        export_formats = function() private$..export_formats$value,
        reporting_guidelines = function() private$..reporting_guidelines$value,
        clinical_implementation = function() private$..clinical_implementation$value),
    private = list(
        ..time_var = NA,
        ..status_var = NA,
        ..outcome_var = NA,
        ..covariates = NA,
        ..nomogram_type = NA,
        ..model_selection = NA,
        ..prediction_times = NA,
        ..confidence_level = NA,
        ..validation_method = NA,
        ..bootstrap_samples = NA,
        ..cv_folds = NA,
        ..nomogram_title = NA,
        ..points_scale = NA,
        ..calibration_assessment = NA,
        ..discrimination_assessment = NA,
        ..decision_curve_analysis = NA,
        ..risk_groups = NA,
        ..risk_thresholds = NA,
        ..interactive_nomogram = NA,
        ..risk_calculator = NA,
        ..clinical_scenarios = NA,
        ..model_equation = NA,
        ..confidence_intervals = NA,
        ..external_validation = NA,
        ..performance_metrics = NA,
        ..variable_importance = NA,
        ..sensitivity_analysis = NA,
        ..missing_data_handling = NA,
        ..export_formats = NA,
        ..reporting_guidelines = NA,
        ..clinical_implementation = NA)
)

clinicalnomogramsResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalnomogramsResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        modelSummary = function() private$.items[["modelSummary"]],
        variableSelection = function() private$.items[["variableSelection"]],
        modelPerformance = function() private$.items[["modelPerformance"]],
        nomogramEquation = function() private$.items[["nomogramEquation"]],
        riskCalculatorTable = function() private$.items[["riskCalculatorTable"]],
        riskGroupAnalysis = function() private$.items[["riskGroupAnalysis"]],
        calibrationResults = function() private$.items[["calibrationResults"]],
        discriminationResults = function() private$.items[["discriminationResults"]],
        decisionCurveResults = function() private$.items[["decisionCurveResults"]],
        variableImportance = function() private$.items[["variableImportance"]],
        clinicalScenarios = function() private$.items[["clinicalScenarios"]],
        nomogramPlot = function() private$.items[["nomogramPlot"]],
        calibrationPlot = function() private$.items[["calibrationPlot"]],
        discriminationPlot = function() private$.items[["discriminationPlot"]],
        decisionCurvePlot = function() private$.items[["decisionCurvePlot"]],
        riskGroupPlot = function() private$.items[["riskGroupPlot"]],
        variableImportancePlot = function() private$.items[["variableImportancePlot"]],
        interactiveNomogram = function() private$.items[["interactiveNomogram"]],
        validationReport = function() private$.items[["validationReport"]],
        implementationGuide = function() private$.items[["implementationGuide"]],
        reportingChecklist = function() private$.items[["reportingChecklist"]],
        diagnostics = function() private$.items[["diagnostics"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Clinical Nomograms & Risk Calculators",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Html$new(
                options=options,
                name="modelSummary",
                title="Model Summary",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="variableSelection",
                title="Variable Selection Results",
                visible=TRUE,
                refs=list(
                    "leaps",
                    "glmnet"),
                clearWith=list(
                    "covariates",
                    "model_selection"),
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="se", 
                        `title`="Standard Error", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="z_value", 
                        `title`="Z-value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="selected", 
                        `title`="Selected", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelPerformance",
                title="Model Performance",
                visible="(performance_metrics)",
                refs=list(
                    "rms",
                    "survival"),
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates",
                    "validation_method"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Performance Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="nomogramEquation",
                title="Model Equation",
                visible="(model_equation)",
                refs=list(
                    "rms"),
                clearWith=list(
                    "covariates",
                    "nomogram_type")))
            self$add(jmvcore::Table$new(
                options=options,
                name="riskCalculatorTable",
                title="Risk Calculator Reference Table",
                visible="(risk_calculator)",
                refs=list(
                    "rms"),
                clearWith=list(
                    "covariates",
                    "prediction_times",
                    "points_scale"),
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="level", 
                        `title`="Level/Value", 
                        `type`="text"),
                    list(
                        `name`="points", 
                        `title`="Points", 
                        `type`="number"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="riskGroupAnalysis",
                title="Risk Group Analysis",
                visible="(risk_groups)",
                refs=list(
                    "survival"),
                clearWith=list(
                    "risk_thresholds",
                    "time_var",
                    "status_var"),
                columns=list(
                    list(
                        `name`="risk_group", 
                        `title`="Risk Group", 
                        `type`="text"),
                    list(
                        `name`="n_patients", 
                        `title`="N Patients", 
                        `type`="integer"),
                    list(
                        `name`="n_events", 
                        `title`="N Events", 
                        `type`="integer"),
                    list(
                        `name`="event_rate", 
                        `title`="Event Rate (%)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="median_survival", 
                        `title`="Median Survival", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="survival_1yr", 
                        `title`="1-Year Survival (%)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="survival_5yr", 
                        `title`="5-Year Survival (%)", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="calibrationResults",
                title="Calibration Assessment",
                visible="(calibration_assessment)",
                refs=list(
                    "rms",
                    "survival"),
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates",
                    "validation_method"),
                columns=list(
                    list(
                        `name`="time_point", 
                        `title`="Time Point", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="slope", 
                        `title`="Calibration Slope", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="intercept", 
                        `title`="Calibration Intercept", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="chi_square", 
                        `title`="\u03C7\u00B2 Statistic", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="discriminationResults",
                title="Discrimination Assessment",
                visible="(discrimination_assessment)",
                refs=list(
                    "survival",
                    "timeROC"),
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates",
                    "prediction_times"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Discrimination Metric", 
                        `type`="text"),
                    list(
                        `name`="time_point", 
                        `title`="Time Point", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="decisionCurveResults",
                title="Decision Curve Analysis",
                visible="(decision_curve_analysis)",
                refs=list(
                    "dcurves",
                    "rmda"),
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates"),
                columns=list(
                    list(
                        `name`="threshold", 
                        `title`="Risk Threshold", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="net_benefit", 
                        `title`="Net Benefit", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="net_benefit_all", 
                        `title`="Net Benefit (Treat All)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="net_benefit_none", 
                        `title`="Net Benefit (Treat None)", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="variableImportance",
                title="Variable Importance",
                visible="(variable_importance)",
                refs=list(
                    "rms"),
                clearWith=list(
                    "covariates",
                    "nomogram_type"),
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="importance", 
                        `title`="Importance Score", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rank", 
                        `title`="Rank", 
                        `type`="integer"),
                    list(
                        `name`="contribution", 
                        `title`="Contribution (%)", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalScenarios",
                title="Clinical Scenarios",
                visible="(clinical_scenarios)",
                refs=list(
                    "rms"),
                clearWith=list(
                    "covariates",
                    "prediction_times")))
            self$add(jmvcore::Image$new(
                options=options,
                name="nomogramPlot",
                title="Clinical Nomogram",
                visible=TRUE,
                refs=list(
                    "rms",
                    "regplot"),
                width=800,
                height=600,
                renderFun=".plotNomogram",
                clearWith=list(
                    "covariates",
                    "nomogram_type",
                    "points_scale",
                    "nomogram_title")))
            self$add(jmvcore::Image$new(
                options=options,
                name="calibrationPlot",
                title="Calibration Plot",
                visible="(calibration_assessment)",
                refs=list(
                    "rms",
                    "ggplot2"),
                width=600,
                height=400,
                renderFun=".plotCalibration",
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates",
                    "validation_method")))
            self$add(jmvcore::Image$new(
                options=options,
                name="discriminationPlot",
                title="Discrimination Plot",
                visible="(discrimination_assessment)",
                refs=list(
                    "timeROC",
                    "ggplot2"),
                width=600,
                height=400,
                renderFun=".plotDiscrimination",
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates",
                    "prediction_times")))
            self$add(jmvcore::Image$new(
                options=options,
                name="decisionCurvePlot",
                title="Decision Curve Analysis Plot",
                visible="(decision_curve_analysis)",
                refs=list(
                    "dcurves",
                    "ggplot2"),
                width=600,
                height=400,
                renderFun=".plotDecisionCurve",
                clearWith=list(
                    "time_var",
                    "status_var",
                    "covariates")))
            self$add(jmvcore::Image$new(
                options=options,
                name="riskGroupPlot",
                title="Risk Group Survival Curves",
                visible="(risk_groups)",
                refs=list(
                    "survival",
                    "survminer"),
                width=600,
                height=400,
                renderFun=".plotRiskGroups",
                clearWith=list(
                    "time_var",
                    "status_var",
                    "risk_thresholds")))
            self$add(jmvcore::Image$new(
                options=options,
                name="variableImportancePlot",
                title="Variable Importance Plot",
                visible="(variable_importance)",
                refs=list(
                    "ggplot2"),
                width=600,
                height=400,
                renderFun=".plotVariableImportance",
                clearWith=list(
                    "covariates",
                    "nomogram_type")))
            self$add(jmvcore::Html$new(
                options=options,
                name="interactiveNomogram",
                title="Interactive Nomogram",
                visible="(interactive_nomogram)",
                refs=list(
                    "DT",
                    "plotly",
                    "shiny"),
                clearWith=list(
                    "covariates",
                    "nomogram_type",
                    "prediction_times")))
            self$add(jmvcore::Html$new(
                options=options,
                name="validationReport",
                title="Validation Report",
                visible=TRUE,
                refs=list(
                    "rms",
                    "knitr"),
                clearWith=list(
                    "validation_method",
                    "bootstrap_samples",
                    "cv_folds")))
            self$add(jmvcore::Html$new(
                options=options,
                name="implementationGuide",
                title="Clinical Implementation Guide",
                visible="(clinical_implementation)",
                clearWith=list(
                    "nomogram_type",
                    "reporting_guidelines")))
            self$add(jmvcore::Html$new(
                options=options,
                name="reportingChecklist",
                title="Reporting Guidelines Checklist",
                visible=TRUE,
                refs=list(
                    "tripod",
                    "remark"),
                clearWith=list(
                    "reporting_guidelines")))
            self$add(jmvcore::Html$new(
                options=options,
                name="diagnostics",
                title="Model Diagnostics",
                visible=TRUE))}))

clinicalnomogramsBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalnomogramsBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "clinicalnomograms",
                version = c(1,0,0),
                options = options,
                results = clinicalnomogramsResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Clinical Nomograms & Risk Calculators
#'
#' Comprehensive toolkit for developing clinical nomograms, risk score 
#' calculators, 
#' and decision support tools. Transforms statistical models into practical 
#' clinical 
#' instruments for personalized risk assessment and treatment planning.
#' 
#'
#' @examples
#' \donttest{
#' # Example: Cox model nomogram
#' clinicalnomograms(
#'     data = clinical_data,
#'     time = survival_months,
#'     status = death_event,
#'     covariates = c("age", "stage", "grade"),
#'     nomogram_type = "survival_nomogram"
#' )
#'}
#' @param data The data as a data frame.
#' @param time_var Time to event or censoring
#' @param status_var Event indicator variable
#' @param outcome_var Binary or continuous outcome
#' @param covariates Predictor variables for model building
#' @param nomogram_type Nomogram model specification
#' @param model_selection Variable selection approach
#' @param prediction_times Times for survival probability estimation
#' @param confidence_level CI level for nomogram
#' @param validation_method Validation approach
#' @param bootstrap_samples Bootstrap iteration count
#' @param cv_folds CV fold specification
#' @param nomogram_title Nomogram plot title
#' @param points_scale Point scale range
#' @param calibration_assessment Enable calibration evaluation
#' @param discrimination_assessment Enable discrimination analysis
#' @param decision_curve_analysis Enable DCA analysis
#' @param risk_groups Enable risk stratification
#' @param risk_thresholds Risk stratification cutpoints
#' @param interactive_nomogram Enable interactive visualization
#' @param risk_calculator Create lookup table
#' @param clinical_scenarios Generate clinical examples
#' @param model_equation Display regression equation
#' @param confidence_intervals Display prediction intervals
#' @param external_validation External validation data source
#' @param performance_metrics Enable performance assessment
#' @param variable_importance Calculate variable contributions
#' @param sensitivity_analysis Enable sensitivity testing
#' @param missing_data_handling Missing data strategy
#' @param export_formats Enable multi-format export
#' @param reporting_guidelines Structured reporting standard
#' @param clinical_implementation Create implementation recommendations
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab Analysis instructions and overview \cr
#'   \code{results$modelSummary} \tab \tab \tab \tab \tab Summary of the fitted model for nomogram \cr
#'   \code{results$variableSelection} \tab \tab \tab \tab \tab Results of variable selection process \cr
#'   \code{results$modelPerformance} \tab \tab \tab \tab \tab Model performance metrics \cr
#'   \code{results$nomogramEquation} \tab \tab \tab \tab \tab Mathematical equation underlying the nomogram \cr
#'   \code{results$riskCalculatorTable} \tab \tab \tab \tab \tab Reference table for risk calculation \cr
#'   \code{results$riskGroupAnalysis} \tab \tab \tab \tab \tab Risk stratification analysis \cr
#'   \code{results$calibrationResults} \tab \tab \tab \tab \tab Model calibration analysis \cr
#'   \code{results$discriminationResults} \tab \tab \tab \tab \tab Model discrimination analysis \cr
#'   \code{results$decisionCurveResults} \tab \tab \tab \tab \tab Clinical utility assessment \cr
#'   \code{results$variableImportance} \tab \tab \tab \tab \tab Relative importance of predictor variables \cr
#'   \code{results$clinicalScenarios} \tab \tab \tab \tab \tab Example clinical scenarios with risk calculations \cr
#'   \code{results$nomogramPlot} \tab \tab \tab \tab \tab Visual nomogram for risk assessment \cr
#'   \code{results$calibrationPlot} \tab \tab \tab \tab \tab Calibration assessment visualization \cr
#'   \code{results$discriminationPlot} \tab \tab \tab \tab \tab ROC curves and discrimination assessment \cr
#'   \code{results$decisionCurvePlot} \tab \tab \tab \tab \tab Clinical utility visualization \cr
#'   \code{results$riskGroupPlot} \tab \tab \tab \tab \tab Survival curves by risk groups \cr
#'   \code{results$variableImportancePlot} \tab \tab \tab \tab \tab Variable importance visualization \cr
#'   \code{results$interactiveNomogram} \tab \tab \tab \tab \tab Interactive web-based nomogram calculator \cr
#'   \code{results$validationReport} \tab \tab \tab \tab \tab Comprehensive model validation report \cr
#'   \code{results$implementationGuide} \tab \tab \tab \tab \tab Guidance for clinical implementation \cr
#'   \code{results$reportingChecklist} \tab \tab \tab \tab \tab Structured reporting checklist \cr
#'   \code{results$diagnostics} \tab \tab \tab \tab \tab Diagnostic information and warnings \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$variableSelection$asDF}
#'
#' \code{as.data.frame(results$variableSelection)}
#'
#' @export
clinicalnomograms <- function(
    data,
    time_var,
    status_var,
    outcome_var,
    covariates,
    nomogram_type = "survival_nomogram",
    model_selection = "all_variables",
    prediction_times = "1,3,5,10",
    confidence_level = 0.95,
    validation_method = "bootstrap",
    bootstrap_samples = 1000,
    cv_folds = 10,
    nomogram_title = "Clinical Risk Assessment Nomogram",
    points_scale = 100,
    calibration_assessment = TRUE,
    discrimination_assessment = TRUE,
    decision_curve_analysis = TRUE,
    risk_groups = TRUE,
    risk_thresholds = "0.33,0.67",
    interactive_nomogram = TRUE,
    risk_calculator = TRUE,
    clinical_scenarios = TRUE,
    model_equation = TRUE,
    confidence_intervals = TRUE,
    external_validation = "",
    performance_metrics = TRUE,
    variable_importance = TRUE,
    sensitivity_analysis = FALSE,
    missing_data_handling = "complete_case",
    export_formats = TRUE,
    reporting_guidelines = "tripod",
    clinical_implementation = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("clinicalnomograms requires jmvcore to be installed (restart may be required)")

    if ( ! missing(time_var)) time_var <- jmvcore::resolveQuo(jmvcore::enquo(time_var))
    if ( ! missing(status_var)) status_var <- jmvcore::resolveQuo(jmvcore::enquo(status_var))
    if ( ! missing(outcome_var)) outcome_var <- jmvcore::resolveQuo(jmvcore::enquo(outcome_var))
    if ( ! missing(covariates)) covariates <- jmvcore::resolveQuo(jmvcore::enquo(covariates))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(time_var), time_var, NULL),
            `if`( ! missing(status_var), status_var, NULL),
            `if`( ! missing(outcome_var), outcome_var, NULL),
            `if`( ! missing(covariates), covariates, NULL))


    options <- clinicalnomogramsOptions$new(
        time_var = time_var,
        status_var = status_var,
        outcome_var = outcome_var,
        covariates = covariates,
        nomogram_type = nomogram_type,
        model_selection = model_selection,
        prediction_times = prediction_times,
        confidence_level = confidence_level,
        validation_method = validation_method,
        bootstrap_samples = bootstrap_samples,
        cv_folds = cv_folds,
        nomogram_title = nomogram_title,
        points_scale = points_scale,
        calibration_assessment = calibration_assessment,
        discrimination_assessment = discrimination_assessment,
        decision_curve_analysis = decision_curve_analysis,
        risk_groups = risk_groups,
        risk_thresholds = risk_thresholds,
        interactive_nomogram = interactive_nomogram,
        risk_calculator = risk_calculator,
        clinical_scenarios = clinical_scenarios,
        model_equation = model_equation,
        confidence_intervals = confidence_intervals,
        external_validation = external_validation,
        performance_metrics = performance_metrics,
        variable_importance = variable_importance,
        sensitivity_analysis = sensitivity_analysis,
        missing_data_handling = missing_data_handling,
        export_formats = export_formats,
        reporting_guidelines = reporting_guidelines,
        clinical_implementation = clinical_implementation)

    analysis <- clinicalnomogramsClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

