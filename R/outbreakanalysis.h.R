
# This file is automatically generated, you probably don't want to edit this

outbreakanalysisOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "outbreakanalysisOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            case_status = NULL,
            exposure_vars = NULL,
            date_onset = NULL,
            location_var = NULL,
            person_id = NULL,
            age_var = NULL,
            sex_var = NULL,
            additional_vars = NULL,
            outbreak_type = "unknown",
            analysis_type = "combined",
            epidemic_curve_unit = "auto",
            attack_rate_analysis = TRUE,
            risk_factor_analysis = TRUE,
            dose_response_analysis = FALSE,
            temporal_analysis = TRUE,
            spatial_analysis = FALSE,
            statistical_tests = "all_tests",
            confidence_level = 0.95,
            multiple_testing_correction = "holm",
            stratified_analysis = FALSE,
            stratification_vars = NULL,
            case_definition = TRUE,
            incubation_period = FALSE,
            exposure_date_var = NULL,
            epidemic_curve_plot = TRUE,
            attack_rate_plot = TRUE,
            risk_factor_plot = TRUE,
            spatial_plot = FALSE,
            power_calculation = FALSE,
            sample_size_calculation = FALSE,
            sensitivity_analysis = FALSE,
            comprehensive_report = TRUE,
            public_health_summary = TRUE,
            surveillance_indicators = FALSE,
            data_quality_assessment = TRUE,
            strobe_compliance = TRUE,
            export_for_epiinfo = FALSE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="outbreakanalysis",
                requiresData=TRUE,
                ...)

            private$..case_status <- jmvcore::OptionVariable$new(
                "case_status",
                case_status,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..exposure_vars <- jmvcore::OptionVariables$new(
                "exposure_vars",
                exposure_vars,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..date_onset <- jmvcore::OptionVariable$new(
                "date_onset",
                date_onset,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..location_var <- jmvcore::OptionVariable$new(
                "location_var",
                location_var,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..person_id <- jmvcore::OptionVariable$new(
                "person_id",
                person_id,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "id"))
            private$..age_var <- jmvcore::OptionVariable$new(
                "age_var",
                age_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..sex_var <- jmvcore::OptionVariable$new(
                "sex_var",
                sex_var,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..additional_vars <- jmvcore::OptionVariables$new(
                "additional_vars",
                additional_vars,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..outbreak_type <- jmvcore::OptionList$new(
                "outbreak_type",
                outbreak_type,
                options=list(
                    "point_source",
                    "continuing_source",
                    "propagated",
                    "mixed",
                    "unknown"),
                default="unknown")
            private$..analysis_type <- jmvcore::OptionList$new(
                "analysis_type",
                analysis_type,
                options=list(
                    "descriptive",
                    "case_control",
                    "cohort",
                    "combined"),
                default="combined")
            private$..epidemic_curve_unit <- jmvcore::OptionList$new(
                "epidemic_curve_unit",
                epidemic_curve_unit,
                options=list(
                    "day",
                    "week",
                    "month",
                    "hour",
                    "auto"),
                default="auto")
            private$..attack_rate_analysis <- jmvcore::OptionBool$new(
                "attack_rate_analysis",
                attack_rate_analysis,
                default=TRUE)
            private$..risk_factor_analysis <- jmvcore::OptionBool$new(
                "risk_factor_analysis",
                risk_factor_analysis,
                default=TRUE)
            private$..dose_response_analysis <- jmvcore::OptionBool$new(
                "dose_response_analysis",
                dose_response_analysis,
                default=FALSE)
            private$..temporal_analysis <- jmvcore::OptionBool$new(
                "temporal_analysis",
                temporal_analysis,
                default=TRUE)
            private$..spatial_analysis <- jmvcore::OptionBool$new(
                "spatial_analysis",
                spatial_analysis,
                default=FALSE)
            private$..statistical_tests <- jmvcore::OptionList$new(
                "statistical_tests",
                statistical_tests,
                options=list(
                    "chi_square",
                    "fisher_exact",
                    "mcnemar",
                    "mantel_haenszel",
                    "all_tests"),
                default="all_tests")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                min=0.8,
                max=0.99,
                default=0.95)
            private$..multiple_testing_correction <- jmvcore::OptionList$new(
                "multiple_testing_correction",
                multiple_testing_correction,
                options=list(
                    "none",
                    "bonferroni",
                    "holm",
                    "fdr"),
                default="holm")
            private$..stratified_analysis <- jmvcore::OptionBool$new(
                "stratified_analysis",
                stratified_analysis,
                default=FALSE)
            private$..stratification_vars <- jmvcore::OptionVariables$new(
                "stratification_vars",
                stratification_vars,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..case_definition <- jmvcore::OptionBool$new(
                "case_definition",
                case_definition,
                default=TRUE)
            private$..incubation_period <- jmvcore::OptionBool$new(
                "incubation_period",
                incubation_period,
                default=FALSE)
            private$..exposure_date_var <- jmvcore::OptionVariable$new(
                "exposure_date_var",
                exposure_date_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..epidemic_curve_plot <- jmvcore::OptionBool$new(
                "epidemic_curve_plot",
                epidemic_curve_plot,
                default=TRUE)
            private$..attack_rate_plot <- jmvcore::OptionBool$new(
                "attack_rate_plot",
                attack_rate_plot,
                default=TRUE)
            private$..risk_factor_plot <- jmvcore::OptionBool$new(
                "risk_factor_plot",
                risk_factor_plot,
                default=TRUE)
            private$..spatial_plot <- jmvcore::OptionBool$new(
                "spatial_plot",
                spatial_plot,
                default=FALSE)
            private$..power_calculation <- jmvcore::OptionBool$new(
                "power_calculation",
                power_calculation,
                default=FALSE)
            private$..sample_size_calculation <- jmvcore::OptionBool$new(
                "sample_size_calculation",
                sample_size_calculation,
                default=FALSE)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=FALSE)
            private$..comprehensive_report <- jmvcore::OptionBool$new(
                "comprehensive_report",
                comprehensive_report,
                default=TRUE)
            private$..public_health_summary <- jmvcore::OptionBool$new(
                "public_health_summary",
                public_health_summary,
                default=TRUE)
            private$..surveillance_indicators <- jmvcore::OptionBool$new(
                "surveillance_indicators",
                surveillance_indicators,
                default=FALSE)
            private$..data_quality_assessment <- jmvcore::OptionBool$new(
                "data_quality_assessment",
                data_quality_assessment,
                default=TRUE)
            private$..strobe_compliance <- jmvcore::OptionBool$new(
                "strobe_compliance",
                strobe_compliance,
                default=TRUE)
            private$..export_for_epiinfo <- jmvcore::OptionBool$new(
                "export_for_epiinfo",
                export_for_epiinfo,
                default=FALSE)

            self$.addOption(private$..case_status)
            self$.addOption(private$..exposure_vars)
            self$.addOption(private$..date_onset)
            self$.addOption(private$..location_var)
            self$.addOption(private$..person_id)
            self$.addOption(private$..age_var)
            self$.addOption(private$..sex_var)
            self$.addOption(private$..additional_vars)
            self$.addOption(private$..outbreak_type)
            self$.addOption(private$..analysis_type)
            self$.addOption(private$..epidemic_curve_unit)
            self$.addOption(private$..attack_rate_analysis)
            self$.addOption(private$..risk_factor_analysis)
            self$.addOption(private$..dose_response_analysis)
            self$.addOption(private$..temporal_analysis)
            self$.addOption(private$..spatial_analysis)
            self$.addOption(private$..statistical_tests)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..multiple_testing_correction)
            self$.addOption(private$..stratified_analysis)
            self$.addOption(private$..stratification_vars)
            self$.addOption(private$..case_definition)
            self$.addOption(private$..incubation_period)
            self$.addOption(private$..exposure_date_var)
            self$.addOption(private$..epidemic_curve_plot)
            self$.addOption(private$..attack_rate_plot)
            self$.addOption(private$..risk_factor_plot)
            self$.addOption(private$..spatial_plot)
            self$.addOption(private$..power_calculation)
            self$.addOption(private$..sample_size_calculation)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..comprehensive_report)
            self$.addOption(private$..public_health_summary)
            self$.addOption(private$..surveillance_indicators)
            self$.addOption(private$..data_quality_assessment)
            self$.addOption(private$..strobe_compliance)
            self$.addOption(private$..export_for_epiinfo)
        }),
    active = list(
        case_status = function() private$..case_status$value,
        exposure_vars = function() private$..exposure_vars$value,
        date_onset = function() private$..date_onset$value,
        location_var = function() private$..location_var$value,
        person_id = function() private$..person_id$value,
        age_var = function() private$..age_var$value,
        sex_var = function() private$..sex_var$value,
        additional_vars = function() private$..additional_vars$value,
        outbreak_type = function() private$..outbreak_type$value,
        analysis_type = function() private$..analysis_type$value,
        epidemic_curve_unit = function() private$..epidemic_curve_unit$value,
        attack_rate_analysis = function() private$..attack_rate_analysis$value,
        risk_factor_analysis = function() private$..risk_factor_analysis$value,
        dose_response_analysis = function() private$..dose_response_analysis$value,
        temporal_analysis = function() private$..temporal_analysis$value,
        spatial_analysis = function() private$..spatial_analysis$value,
        statistical_tests = function() private$..statistical_tests$value,
        confidence_level = function() private$..confidence_level$value,
        multiple_testing_correction = function() private$..multiple_testing_correction$value,
        stratified_analysis = function() private$..stratified_analysis$value,
        stratification_vars = function() private$..stratification_vars$value,
        case_definition = function() private$..case_definition$value,
        incubation_period = function() private$..incubation_period$value,
        exposure_date_var = function() private$..exposure_date_var$value,
        epidemic_curve_plot = function() private$..epidemic_curve_plot$value,
        attack_rate_plot = function() private$..attack_rate_plot$value,
        risk_factor_plot = function() private$..risk_factor_plot$value,
        spatial_plot = function() private$..spatial_plot$value,
        power_calculation = function() private$..power_calculation$value,
        sample_size_calculation = function() private$..sample_size_calculation$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        comprehensive_report = function() private$..comprehensive_report$value,
        public_health_summary = function() private$..public_health_summary$value,
        surveillance_indicators = function() private$..surveillance_indicators$value,
        data_quality_assessment = function() private$..data_quality_assessment$value,
        strobe_compliance = function() private$..strobe_compliance$value,
        export_for_epiinfo = function() private$..export_for_epiinfo$value),
    private = list(
        ..case_status = NA,
        ..exposure_vars = NA,
        ..date_onset = NA,
        ..location_var = NA,
        ..person_id = NA,
        ..age_var = NA,
        ..sex_var = NA,
        ..additional_vars = NA,
        ..outbreak_type = NA,
        ..analysis_type = NA,
        ..epidemic_curve_unit = NA,
        ..attack_rate_analysis = NA,
        ..risk_factor_analysis = NA,
        ..dose_response_analysis = NA,
        ..temporal_analysis = NA,
        ..spatial_analysis = NA,
        ..statistical_tests = NA,
        ..confidence_level = NA,
        ..multiple_testing_correction = NA,
        ..stratified_analysis = NA,
        ..stratification_vars = NA,
        ..case_definition = NA,
        ..incubation_period = NA,
        ..exposure_date_var = NA,
        ..epidemic_curve_plot = NA,
        ..attack_rate_plot = NA,
        ..risk_factor_plot = NA,
        ..spatial_plot = NA,
        ..power_calculation = NA,
        ..sample_size_calculation = NA,
        ..sensitivity_analysis = NA,
        ..comprehensive_report = NA,
        ..public_health_summary = NA,
        ..surveillance_indicators = NA,
        ..data_quality_assessment = NA,
        ..strobe_compliance = NA,
        ..export_for_epiinfo = NA)
)

outbreakanalysisResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "outbreakanalysisResults",
    inherit = jmvcore::Group,
    active = list(
        outbreak_overview = function() private$.items[["outbreak_overview"]],
        descriptive_summary = function() private$.items[["descriptive_summary"]],
        risk_factor_analysis = function() private$.items[["risk_factor_analysis"]],
        temporal_analysis = function() private$.items[["temporal_analysis"]],
        epidemic_curve_stats = function() private$.items[["epidemic_curve_stats"]],
        spatial_analysis_results = function() private$.items[["spatial_analysis_results"]],
        dose_response_analysis = function() private$.items[["dose_response_analysis"]],
        stratified_analysis_results = function() private$.items[["stratified_analysis_results"]],
        incubation_period_stats = function() private$.items[["incubation_period_stats"]],
        case_definition_analysis = function() private$.items[["case_definition_analysis"]],
        data_quality_report = function() private$.items[["data_quality_report"]],
        power_analysis_results = function() private$.items[["power_analysis_results"]],
        surveillance_indicators = function() private$.items[["surveillance_indicators"]],
        epidemic_curve_plot = function() private$.items[["epidemic_curve_plot"]],
        attack_rate_plot = function() private$.items[["attack_rate_plot"]],
        risk_factor_forest_plot = function() private$.items[["risk_factor_forest_plot"]],
        spatial_distribution_plot = function() private$.items[["spatial_distribution_plot"]],
        dose_response_plot = function() private$.items[["dose_response_plot"]],
        outbreak_timeline_plot = function() private$.items[["outbreak_timeline_plot"]],
        comprehensive_report = function() private$.items[["comprehensive_report"]],
        public_health_summary = function() private$.items[["public_health_summary"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Outbreak Analysis & Epidemiological Investigation")
            self$add(jmvcore::Table$new(
                options=options,
                name="outbreak_overview",
                title="Outbreak Investigation Overview",
                columns=list(
                    list(
                        `name`="characteristic", 
                        `title`="Characteristic", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="descriptive_summary",
                title="Descriptive Summary Statistics",
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="cases_n", 
                        `title`="Cases (N)", 
                        `type`="integer"),
                    list(
                        `name`="cases_percent", 
                        `title`="Cases (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="non_cases_n", 
                        `title`="Non-Cases (N)", 
                        `type`="integer"),
                    list(
                        `name`="non_cases_percent", 
                        `title`="Non-Cases (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="total_n", 
                        `title`="Total (N)", 
                        `type`="integer"),
                    list(
                        `name`="attack_rate", 
                        `title`="Attack Rate", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="attack_rate_ci", 
                        `title`="Attack Rate 95% CI", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="risk_factor_analysis",
                title="Risk Factor Analysis Results",
                visible="(risk_factor_analysis)",
                columns=list(
                    list(
                        `name`="exposure", 
                        `title`="Exposure/Risk Factor", 
                        `type`="text"),
                    list(
                        `name`="exposed_cases", 
                        `title`="Exposed Cases", 
                        `type`="integer"),
                    list(
                        `name`="exposed_total", 
                        `title`="Exposed Total", 
                        `type`="integer"),
                    list(
                        `name`="unexposed_cases", 
                        `title`="Unexposed Cases", 
                        `type`="integer"),
                    list(
                        `name`="unexposed_total", 
                        `title`="Unexposed Total", 
                        `type`="integer"),
                    list(
                        `name`="attack_rate_exposed", 
                        `title`="AR Exposed (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="attack_rate_unexposed", 
                        `title`="AR Unexposed (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="relative_risk", 
                        `title`="Relative Risk", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_lower", 
                        `title`="RR 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_upper", 
                        `title`="RR 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="odds_ratio", 
                        `title`="Odds Ratio", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="or_ci_lower", 
                        `title`="OR 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="or_ci_upper", 
                        `title`="OR 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="adjusted_p", 
                        `title`="Adjusted p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="temporal_analysis",
                title="Temporal Pattern Analysis",
                visible="(temporal_analysis)",
                columns=list(
                    list(
                        `name`="time_period", 
                        `title`="Time Period", 
                        `type`="text"),
                    list(
                        `name`="cases_n", 
                        `title`="Number of Cases", 
                        `type`="integer"),
                    list(
                        `name`="cumulative_cases", 
                        `title`="Cumulative Cases", 
                        `type`="integer"),
                    list(
                        `name`="incidence_rate", 
                        `title`="Incidence Rate", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="doubling_time", 
                        `title`="Doubling Time (days)", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="epidemic_curve_stats",
                title="Epidemic Curve Characteristics",
                visible="(temporal_analysis)",
                columns=list(
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="spatial_analysis_results",
                title="Spatial Analysis Results",
                visible="(spatial_analysis && location_var)",
                columns=list(
                    list(
                        `name`="location", 
                        `title`="Location", 
                        `type`="text"),
                    list(
                        `name`="cases_n", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="population", 
                        `title`="Population", 
                        `type`="integer"),
                    list(
                        `name`="attack_rate", 
                        `title`="Attack Rate (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="relative_risk", 
                        `title`="Relative Risk", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_lower", 
                        `title`="RR 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_upper", 
                        `title`="RR 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="clustering_index", 
                        `title`="Clustering Index", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="dose_response_analysis",
                title="Dose-Response Analysis",
                visible="(dose_response_analysis)",
                columns=list(
                    list(
                        `name`="exposure_level", 
                        `title`="Exposure Level", 
                        `type`="text"),
                    list(
                        `name`="cases_n", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="total_n", 
                        `title`="Total", 
                        `type`="integer"),
                    list(
                        `name`="attack_rate", 
                        `title`="Attack Rate (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="odds_ratio", 
                        `title`="Odds Ratio", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="or_ci_lower", 
                        `title`="OR 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="or_ci_upper", 
                        `title`="OR 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="trend_p_value", 
                        `title`="Trend p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="stratified_analysis_results",
                title="Stratified Analysis Results",
                visible="(stratified_analysis)",
                columns=list(
                    list(
                        `name`="stratum", 
                        `title`="Stratum", 
                        `type`="text"),
                    list(
                        `name`="exposure", 
                        `title`="Exposure", 
                        `type`="text"),
                    list(
                        `name`="relative_risk", 
                        `title`="Relative Risk", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_lower", 
                        `title`="RR 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="rr_ci_upper", 
                        `title`="RR 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="homogeneity_p", 
                        `title`="Homogeneity p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="incubation_period_stats",
                title="Incubation Period Analysis",
                visible="(incubation_period && exposure_date_var)",
                columns=list(
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="days", 
                        `title`="Days", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="hours", 
                        `title`="Hours", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="interpretation", 
                        `title`="Clinical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="case_definition_analysis",
                title="Case Definition Performance",
                visible="(case_definition)",
                columns=list(
                    list(
                        `name`="criterion", 
                        `title`="Case Definition Criterion", 
                        `type`="text"),
                    list(
                        `name`="sensitivity", 
                        `title`="Sensitivity (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="specificity", 
                        `title`="Specificity (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="ppv", 
                        `title`="PPV (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="npv", 
                        `title`="NPV (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="cases_identified", 
                        `title`="Cases Identified", 
                        `type`="integer"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="data_quality_report",
                title="Data Quality Assessment",
                visible="(data_quality_assessment)",
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="completeness", 
                        `title`="Completeness (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="missing_n", 
                        `title`="Missing (N)", 
                        `type`="integer"),
                    list(
                        `name`="invalid_n", 
                        `title`="Invalid Values (N)", 
                        `type`="integer"),
                    list(
                        `name`="quality_grade", 
                        `title`="Quality Grade", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="power_analysis_results",
                title="Statistical Power Analysis",
                visible="(power_calculation)",
                columns=list(
                    list(
                        `name`="exposure", 
                        `title`="Exposure", 
                        `type`="text"),
                    list(
                        `name`="effect_size", 
                        `title`="Observed Effect Size", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="power", 
                        `title`="Statistical Power", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="sample_size_current", 
                        `title`="Current Sample Size", 
                        `type`="integer"),
                    list(
                        `name`="sample_size_80_power", 
                        `title`="N for 80% Power", 
                        `type`="integer"),
                    list(
                        `name`="interpretation", 
                        `title`="Power Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="surveillance_indicators",
                title="Surveillance Quality Indicators",
                visible="(surveillance_indicators)",
                columns=list(
                    list(
                        `name`="indicator", 
                        `title`="Surveillance Indicator", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="target", 
                        `title`="Target/Standard", 
                        `type`="text"),
                    list(
                        `name`="performance", 
                        `title`="Performance Assessment", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="epidemic_curve_plot",
                title="Epidemic Curve",
                visible="(epidemic_curve_plot && date_onset)",
                width=600,
                height=400,
                requiresData=TRUE))
            self$add(jmvcore::Image$new(
                options=options,
                name="attack_rate_plot",
                title="Attack Rate Comparison",
                visible="(attack_rate_plot)",
                width=600,
                height=400,
                requiresData=TRUE))
            self$add(jmvcore::Image$new(
                options=options,
                name="risk_factor_forest_plot",
                title="Risk Factors Forest Plot",
                visible="(risk_factor_plot && risk_factor_analysis)",
                width=600,
                height=400,
                requiresData=TRUE))
            self$add(jmvcore::Image$new(
                options=options,
                name="spatial_distribution_plot",
                title="Spatial Distribution Map",
                visible="(spatial_plot && spatial_analysis && location_var)",
                width=600,
                height=400,
                requiresData=TRUE))
            self$add(jmvcore::Image$new(
                options=options,
                name="dose_response_plot",
                title="Dose-Response Relationship",
                visible="(dose_response_analysis)",
                width=600,
                height=400,
                requiresData=TRUE))
            self$add(jmvcore::Image$new(
                options=options,
                name="outbreak_timeline_plot",
                title="Outbreak Investigation Timeline",
                visible="(temporal_analysis)",
                width=800,
                height=300,
                requiresData=TRUE))
            self$add(jmvcore::Html$new(
                options=options,
                name="comprehensive_report",
                title="Comprehensive Outbreak Investigation Report",
                visible="(comprehensive_report)",
                clearWith=list(
                    "case_status",
                    "exposure_vars",
                    "date_onset")))
            self$add(jmvcore::Html$new(
                options=options,
                name="public_health_summary",
                title="Public Health Action Summary",
                visible="(public_health_summary)",
                clearWith=list(
                    "case_status",
                    "exposure_vars")))}))

outbreakanalysisBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "outbreakanalysisBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "outbreakanalysis",
                version = c(1,0,0),
                options = options,
                results = outbreakanalysisResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Outbreak Analysis & Epidemiological Investigation
#'
#' Comprehensive outbreak analysis and epidemiological investigation for 
#' infectious disease surveillance
#' and public health research. Analyzes tabular outbreak data to identify 
#' attack rates, risk factors,
#' epidemic curves, case-control associations, and spatial-temporal patterns. 
#' Essential for outbreak
#' investigation, surveillance analysis, and epidemiological research with 
#' robust statistical methods
#' for public health decision-making and intervention planning.
#' 
#'
#' @examples
#' data('outbreak_data')
#'
#' outbreakanalysis(
#'     data = outbreak_data,
#'     case_status = "case",
#'     exposure_vars = c("food_a", "food_b", "water"),
#'     date_onset = "onset_date",
#'     location_var = "location"
#' )
#'
#' @param data the data as a data frame
#' @param case_status Binary variable indicating case (1) vs control (0) or
#'   case vs non-case
#' @param exposure_vars Variables representing potential exposures or risk
#'   factors
#' @param date_onset Date of symptom onset or case identification
#' @param location_var Geographic location or administrative unit
#' @param person_id Unique identifier for each individual
#' @param age_var Age of individuals for demographic analysis
#' @param sex_var Sex/gender variable for demographic analysis
#' @param additional_vars Additional variables for descriptive analysis
#' @param outbreak_type Type of outbreak pattern expected
#' @param analysis_type Primary analytical approach for outbreak investigation
#' @param epidemic_curve_unit Time unit for epidemic curve construction
#' @param attack_rate_analysis Calculate attack rates and 95\% confidence
#'   intervals
#' @param risk_factor_analysis Perform risk factor analysis with odds ratios
#'   and relative risks
#' @param dose_response_analysis Analyze dose-response relationships for
#'   quantitative exposures
#' @param temporal_analysis Analyze temporal patterns and epidemic curve
#'   characteristics
#' @param spatial_analysis Perform spatial analysis and clustering detection
#' @param statistical_tests Statistical tests for association analysis
#' @param confidence_level Confidence level for confidence intervals
#' @param multiple_testing_correction Multiple testing correction method
#' @param stratified_analysis Perform stratified analysis by demographic
#'   variables
#' @param stratification_vars Variables for stratified analysis
#' @param case_definition Analyze case definition sensitivity and specificity
#' @param incubation_period Calculate incubation period statistics
#' @param exposure_date_var Date of exposure for incubation period calculation
#' @param epidemic_curve_plot Generate epidemic curve visualization
#' @param attack_rate_plot Generate attack rate comparison plots
#' @param risk_factor_plot Generate forest plot of risk factors
#' @param spatial_plot Generate spatial distribution maps
#' @param power_calculation Calculate statistical power for detected
#'   associations
#' @param sample_size_calculation Provide sample size recommendations for
#'   future studies
#' @param sensitivity_analysis Perform sensitivity analysis for case
#'   definitions
#' @param comprehensive_report Generate comprehensive outbreak investigation
#'   report
#' @param public_health_summary Generate public health summary with
#'   recommendations
#' @param surveillance_indicators Calculate surveillance system quality
#'   indicators
#' @param data_quality_assessment Assess data completeness and quality issues
#' @param strobe_compliance Ensure STROBE guideline compliance for
#'   epidemiological reporting
#' @param export_for_epiinfo Export results in EpiInfo compatible format
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$outbreak_overview} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$descriptive_summary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$risk_factor_analysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$temporal_analysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$epidemic_curve_stats} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$spatial_analysis_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$dose_response_analysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stratified_analysis_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$incubation_period_stats} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$case_definition_analysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$data_quality_report} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$power_analysis_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$surveillance_indicators} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$epidemic_curve_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$attack_rate_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$risk_factor_forest_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$spatial_distribution_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$dose_response_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$outbreak_timeline_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$comprehensive_report} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$public_health_summary} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$outbreak_overview$asDF}
#'
#' \code{as.data.frame(results$outbreak_overview)}
#'
#' @export
outbreakanalysis <- function(
    data,
    case_status,
    exposure_vars,
    date_onset,
    location_var,
    person_id,
    age_var,
    sex_var,
    additional_vars,
    outbreak_type = "unknown",
    analysis_type = "combined",
    epidemic_curve_unit = "auto",
    attack_rate_analysis = TRUE,
    risk_factor_analysis = TRUE,
    dose_response_analysis = FALSE,
    temporal_analysis = TRUE,
    spatial_analysis = FALSE,
    statistical_tests = "all_tests",
    confidence_level = 0.95,
    multiple_testing_correction = "holm",
    stratified_analysis = FALSE,
    stratification_vars,
    case_definition = TRUE,
    incubation_period = FALSE,
    exposure_date_var,
    epidemic_curve_plot = TRUE,
    attack_rate_plot = TRUE,
    risk_factor_plot = TRUE,
    spatial_plot = FALSE,
    power_calculation = FALSE,
    sample_size_calculation = FALSE,
    sensitivity_analysis = FALSE,
    comprehensive_report = TRUE,
    public_health_summary = TRUE,
    surveillance_indicators = FALSE,
    data_quality_assessment = TRUE,
    strobe_compliance = TRUE,
    export_for_epiinfo = FALSE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("outbreakanalysis requires jmvcore to be installed (restart may be required)")

    if ( ! missing(case_status)) case_status <- jmvcore::resolveQuo(jmvcore::enquo(case_status))
    if ( ! missing(exposure_vars)) exposure_vars <- jmvcore::resolveQuo(jmvcore::enquo(exposure_vars))
    if ( ! missing(date_onset)) date_onset <- jmvcore::resolveQuo(jmvcore::enquo(date_onset))
    if ( ! missing(location_var)) location_var <- jmvcore::resolveQuo(jmvcore::enquo(location_var))
    if ( ! missing(person_id)) person_id <- jmvcore::resolveQuo(jmvcore::enquo(person_id))
    if ( ! missing(age_var)) age_var <- jmvcore::resolveQuo(jmvcore::enquo(age_var))
    if ( ! missing(sex_var)) sex_var <- jmvcore::resolveQuo(jmvcore::enquo(sex_var))
    if ( ! missing(additional_vars)) additional_vars <- jmvcore::resolveQuo(jmvcore::enquo(additional_vars))
    if ( ! missing(stratification_vars)) stratification_vars <- jmvcore::resolveQuo(jmvcore::enquo(stratification_vars))
    if ( ! missing(exposure_date_var)) exposure_date_var <- jmvcore::resolveQuo(jmvcore::enquo(exposure_date_var))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(case_status), case_status, NULL),
            `if`( ! missing(exposure_vars), exposure_vars, NULL),
            `if`( ! missing(date_onset), date_onset, NULL),
            `if`( ! missing(location_var), location_var, NULL),
            `if`( ! missing(person_id), person_id, NULL),
            `if`( ! missing(age_var), age_var, NULL),
            `if`( ! missing(sex_var), sex_var, NULL),
            `if`( ! missing(additional_vars), additional_vars, NULL),
            `if`( ! missing(stratification_vars), stratification_vars, NULL),
            `if`( ! missing(exposure_date_var), exposure_date_var, NULL))

    for (v in case_status) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in location_var) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in sex_var) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in stratification_vars) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- outbreakanalysisOptions$new(
        case_status = case_status,
        exposure_vars = exposure_vars,
        date_onset = date_onset,
        location_var = location_var,
        person_id = person_id,
        age_var = age_var,
        sex_var = sex_var,
        additional_vars = additional_vars,
        outbreak_type = outbreak_type,
        analysis_type = analysis_type,
        epidemic_curve_unit = epidemic_curve_unit,
        attack_rate_analysis = attack_rate_analysis,
        risk_factor_analysis = risk_factor_analysis,
        dose_response_analysis = dose_response_analysis,
        temporal_analysis = temporal_analysis,
        spatial_analysis = spatial_analysis,
        statistical_tests = statistical_tests,
        confidence_level = confidence_level,
        multiple_testing_correction = multiple_testing_correction,
        stratified_analysis = stratified_analysis,
        stratification_vars = stratification_vars,
        case_definition = case_definition,
        incubation_period = incubation_period,
        exposure_date_var = exposure_date_var,
        epidemic_curve_plot = epidemic_curve_plot,
        attack_rate_plot = attack_rate_plot,
        risk_factor_plot = risk_factor_plot,
        spatial_plot = spatial_plot,
        power_calculation = power_calculation,
        sample_size_calculation = sample_size_calculation,
        sensitivity_analysis = sensitivity_analysis,
        comprehensive_report = comprehensive_report,
        public_health_summary = public_health_summary,
        surveillance_indicators = surveillance_indicators,
        data_quality_assessment = data_quality_assessment,
        strobe_compliance = strobe_compliance,
        export_for_epiinfo = export_for_epiinfo)

    analysis <- outbreakanalysisClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

