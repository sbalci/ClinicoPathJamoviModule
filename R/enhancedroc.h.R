
# This file is automatically generated, you probably don't want to edit this

enhancedROCOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "enhancedROCOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            outcome = NULL,
            positiveClass = NULL,
            predictors = NULL,
            analysisType = "single",
            direction = "auto",
            youdenOptimization = TRUE,
            customCutoffs = NULL,
            sensitivityThreshold = 0.8,
            specificityThreshold = 0.8,
            confidenceLevel = 95,
            bootstrapSamples = 1000,
            useBootstrap = TRUE,
            pairwiseComparisons = TRUE,
            comparisonMethod = "delong",
            rocCurve = TRUE,
            aucTable = TRUE,
            cutoffTable = TRUE,
            optimalCutoffs = TRUE,
            diagnosticMetrics = TRUE,
            clinicalMetrics = TRUE,
            smoothMethod = "none",
            partialAuc = FALSE,
            partialRange = "0.8,1.0",
            prevalence = 0.1,
            clinicalContext = "general",
            clinicalPresets = "custom",
            comprehensive_output = FALSE,
            clinical_interpretation = TRUE,
            plotTheme = "clinical",
            plotWidth = 600,
            plotHeight = 600,
            showCutoffPoints = TRUE,
            showConfidenceBands = FALSE,
            showMetricsDiff = TRUE,
            statisticalComparison = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="enhancedROC",
                requiresData=TRUE,
                ...)

            private$..outcome <- jmvcore::OptionVariable$new(
                "outcome",
                outcome,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..positiveClass <- jmvcore::OptionLevel$new(
                "positiveClass",
                positiveClass,
                variable="(outcome)")
            private$..predictors <- jmvcore::OptionVariables$new(
                "predictors",
                predictors,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..analysisType <- jmvcore::OptionList$new(
                "analysisType",
                analysisType,
                options=list(
                    "single",
                    "comparative",
                    "comprehensive"),
                default="single")
            private$..direction <- jmvcore::OptionList$new(
                "direction",
                direction,
                options=list(
                    "auto",
                    "higher",
                    "lower"),
                default="auto")
            private$..youdenOptimization <- jmvcore::OptionBool$new(
                "youdenOptimization",
                youdenOptimization,
                default=TRUE)
            private$..customCutoffs <- jmvcore::OptionString$new(
                "customCutoffs",
                customCutoffs)
            private$..sensitivityThreshold <- jmvcore::OptionNumber$new(
                "sensitivityThreshold",
                sensitivityThreshold,
                default=0.8,
                min=0.1,
                max=1)
            private$..specificityThreshold <- jmvcore::OptionNumber$new(
                "specificityThreshold",
                specificityThreshold,
                default=0.8,
                min=0.1,
                max=1)
            private$..confidenceLevel <- jmvcore::OptionNumber$new(
                "confidenceLevel",
                confidenceLevel,
                default=95,
                min=50,
                max=99.9)
            private$..bootstrapSamples <- jmvcore::OptionInteger$new(
                "bootstrapSamples",
                bootstrapSamples,
                default=1000,
                min=100,
                max=10000)
            private$..useBootstrap <- jmvcore::OptionBool$new(
                "useBootstrap",
                useBootstrap,
                default=TRUE)
            private$..pairwiseComparisons <- jmvcore::OptionBool$new(
                "pairwiseComparisons",
                pairwiseComparisons,
                default=TRUE)
            private$..comparisonMethod <- jmvcore::OptionList$new(
                "comparisonMethod",
                comparisonMethod,
                options=list(
                    "delong",
                    "bootstrap",
                    "venkatraman"),
                default="delong")
            private$..rocCurve <- jmvcore::OptionBool$new(
                "rocCurve",
                rocCurve,
                default=TRUE)
            private$..aucTable <- jmvcore::OptionBool$new(
                "aucTable",
                aucTable,
                default=TRUE)
            private$..cutoffTable <- jmvcore::OptionBool$new(
                "cutoffTable",
                cutoffTable,
                default=TRUE)
            private$..optimalCutoffs <- jmvcore::OptionBool$new(
                "optimalCutoffs",
                optimalCutoffs,
                default=TRUE)
            private$..diagnosticMetrics <- jmvcore::OptionBool$new(
                "diagnosticMetrics",
                diagnosticMetrics,
                default=TRUE)
            private$..clinicalMetrics <- jmvcore::OptionBool$new(
                "clinicalMetrics",
                clinicalMetrics,
                default=TRUE)
            private$..smoothMethod <- jmvcore::OptionList$new(
                "smoothMethod",
                smoothMethod,
                options=list(
                    "none",
                    "binormal",
                    "kernel"),
                default="none")
            private$..partialAuc <- jmvcore::OptionBool$new(
                "partialAuc",
                partialAuc,
                default=FALSE)
            private$..partialRange <- jmvcore::OptionString$new(
                "partialRange",
                partialRange,
                default="0.8,1.0")
            private$..prevalence <- jmvcore::OptionNumber$new(
                "prevalence",
                prevalence,
                default=0.1,
                min=0.001,
                max=0.999)
            private$..clinicalContext <- jmvcore::OptionList$new(
                "clinicalContext",
                clinicalContext,
                options=list(
                    "screening",
                    "diagnosis",
                    "prognosis",
                    "monitoring",
                    "general"),
                default="general")
            private$..clinicalPresets <- jmvcore::OptionList$new(
                "clinicalPresets",
                clinicalPresets,
                options=list(
                    "custom",
                    "biomarker_screening",
                    "diagnostic_validation",
                    "confirmatory_testing",
                    "research_comprehensive"),
                default="custom")
            private$..comprehensive_output <- jmvcore::OptionBool$new(
                "comprehensive_output",
                comprehensive_output,
                default=FALSE)
            private$..clinical_interpretation <- jmvcore::OptionBool$new(
                "clinical_interpretation",
                clinical_interpretation,
                default=TRUE)
            private$..plotTheme <- jmvcore::OptionList$new(
                "plotTheme",
                plotTheme,
                options=list(
                    "classic",
                    "modern",
                    "clinical"),
                default="clinical")
            private$..plotWidth <- jmvcore::OptionInteger$new(
                "plotWidth",
                plotWidth,
                default=600,
                min=300,
                max=1200)
            private$..plotHeight <- jmvcore::OptionInteger$new(
                "plotHeight",
                plotHeight,
                default=600,
                min=300,
                max=1200)
            private$..showCutoffPoints <- jmvcore::OptionBool$new(
                "showCutoffPoints",
                showCutoffPoints,
                default=TRUE)
            private$..showConfidenceBands <- jmvcore::OptionBool$new(
                "showConfidenceBands",
                showConfidenceBands,
                default=FALSE)
            private$..showMetricsDiff <- jmvcore::OptionBool$new(
                "showMetricsDiff",
                showMetricsDiff,
                default=TRUE)
            private$..statisticalComparison <- jmvcore::OptionBool$new(
                "statisticalComparison",
                statisticalComparison,
                default=TRUE)

            self$.addOption(private$..outcome)
            self$.addOption(private$..positiveClass)
            self$.addOption(private$..predictors)
            self$.addOption(private$..analysisType)
            self$.addOption(private$..direction)
            self$.addOption(private$..youdenOptimization)
            self$.addOption(private$..customCutoffs)
            self$.addOption(private$..sensitivityThreshold)
            self$.addOption(private$..specificityThreshold)
            self$.addOption(private$..confidenceLevel)
            self$.addOption(private$..bootstrapSamples)
            self$.addOption(private$..useBootstrap)
            self$.addOption(private$..pairwiseComparisons)
            self$.addOption(private$..comparisonMethod)
            self$.addOption(private$..rocCurve)
            self$.addOption(private$..aucTable)
            self$.addOption(private$..cutoffTable)
            self$.addOption(private$..optimalCutoffs)
            self$.addOption(private$..diagnosticMetrics)
            self$.addOption(private$..clinicalMetrics)
            self$.addOption(private$..smoothMethod)
            self$.addOption(private$..partialAuc)
            self$.addOption(private$..partialRange)
            self$.addOption(private$..prevalence)
            self$.addOption(private$..clinicalContext)
            self$.addOption(private$..clinicalPresets)
            self$.addOption(private$..comprehensive_output)
            self$.addOption(private$..clinical_interpretation)
            self$.addOption(private$..plotTheme)
            self$.addOption(private$..plotWidth)
            self$.addOption(private$..plotHeight)
            self$.addOption(private$..showCutoffPoints)
            self$.addOption(private$..showConfidenceBands)
            self$.addOption(private$..showMetricsDiff)
            self$.addOption(private$..statisticalComparison)
        }),
    active = list(
        outcome = function() private$..outcome$value,
        positiveClass = function() private$..positiveClass$value,
        predictors = function() private$..predictors$value,
        analysisType = function() private$..analysisType$value,
        direction = function() private$..direction$value,
        youdenOptimization = function() private$..youdenOptimization$value,
        customCutoffs = function() private$..customCutoffs$value,
        sensitivityThreshold = function() private$..sensitivityThreshold$value,
        specificityThreshold = function() private$..specificityThreshold$value,
        confidenceLevel = function() private$..confidenceLevel$value,
        bootstrapSamples = function() private$..bootstrapSamples$value,
        useBootstrap = function() private$..useBootstrap$value,
        pairwiseComparisons = function() private$..pairwiseComparisons$value,
        comparisonMethod = function() private$..comparisonMethod$value,
        rocCurve = function() private$..rocCurve$value,
        aucTable = function() private$..aucTable$value,
        cutoffTable = function() private$..cutoffTable$value,
        optimalCutoffs = function() private$..optimalCutoffs$value,
        diagnosticMetrics = function() private$..diagnosticMetrics$value,
        clinicalMetrics = function() private$..clinicalMetrics$value,
        smoothMethod = function() private$..smoothMethod$value,
        partialAuc = function() private$..partialAuc$value,
        partialRange = function() private$..partialRange$value,
        prevalence = function() private$..prevalence$value,
        clinicalContext = function() private$..clinicalContext$value,
        clinicalPresets = function() private$..clinicalPresets$value,
        comprehensive_output = function() private$..comprehensive_output$value,
        clinical_interpretation = function() private$..clinical_interpretation$value,
        plotTheme = function() private$..plotTheme$value,
        plotWidth = function() private$..plotWidth$value,
        plotHeight = function() private$..plotHeight$value,
        showCutoffPoints = function() private$..showCutoffPoints$value,
        showConfidenceBands = function() private$..showConfidenceBands$value,
        showMetricsDiff = function() private$..showMetricsDiff$value,
        statisticalComparison = function() private$..statisticalComparison$value),
    private = list(
        ..outcome = NA,
        ..positiveClass = NA,
        ..predictors = NA,
        ..analysisType = NA,
        ..direction = NA,
        ..youdenOptimization = NA,
        ..customCutoffs = NA,
        ..sensitivityThreshold = NA,
        ..specificityThreshold = NA,
        ..confidenceLevel = NA,
        ..bootstrapSamples = NA,
        ..useBootstrap = NA,
        ..pairwiseComparisons = NA,
        ..comparisonMethod = NA,
        ..rocCurve = NA,
        ..aucTable = NA,
        ..cutoffTable = NA,
        ..optimalCutoffs = NA,
        ..diagnosticMetrics = NA,
        ..clinicalMetrics = NA,
        ..smoothMethod = NA,
        ..partialAuc = NA,
        ..partialRange = NA,
        ..prevalence = NA,
        ..clinicalContext = NA,
        ..clinicalPresets = NA,
        ..comprehensive_output = NA,
        ..clinical_interpretation = NA,
        ..plotTheme = NA,
        ..plotWidth = NA,
        ..plotHeight = NA,
        ..showCutoffPoints = NA,
        ..showConfidenceBands = NA,
        ..showMetricsDiff = NA,
        ..statisticalComparison = NA)
)

enhancedROCResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "enhancedROCResults",
    inherit = jmvcore::Group,
    active = list(
        results = function() private$.items[["results"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Clinical ROC Analysis Results",
                refs=list(
                    "ClinicoPathJamoviModule",
                    "BlueSky"))
            self$add(R6::R6Class(
                inherit = jmvcore::Group,
                active = list(
                    instructions = function() private$.items[["instructions"]],
                    analysisSummary = function() private$.items[["analysisSummary"]],
                    clinicalReport = function() private$.items[["clinicalReport"]],
                    aucSummary = function() private$.items[["aucSummary"]],
                    rocComparisons = function() private$.items[["rocComparisons"]],
                    detailedComparison = function() private$.items[["detailedComparison"]],
                    statisticalSummary = function() private$.items[["statisticalSummary"]],
                    optimalCutoffSummary = function() private$.items[["optimalCutoffSummary"]],
                    cutoffAnalysis = function() private$.items[["cutoffAnalysis"]],
                    diagnosticPerformance = function() private$.items[["diagnosticPerformance"]],
                    clinicalApplicationMetrics = function() private$.items[["clinicalApplicationMetrics"]],
                    partialAucAnalysis = function() private$.items[["partialAucAnalysis"]],
                    comprehensiveAnalysisSummary = function() private$.items[["comprehensiveAnalysisSummary"]],
                    clinicalInterpretationGuide = function() private$.items[["clinicalInterpretationGuide"]],
                    methodsExplanation = function() private$.items[["methodsExplanation"]],
                    rocCurvePlot = function() private$.items[["rocCurvePlot"]],
                    comparativeROCPlot = function() private$.items[["comparativeROCPlot"]],
                    cutoffAnalysisPlot = function() private$.items[["cutoffAnalysisPlot"]],
                    youdenIndexPlot = function() private$.items[["youdenIndexPlot"]],
                    clinicalDecisionPlot = function() private$.items[["clinicalDecisionPlot"]]),
                private = list(),
                public=list(
                    initialize=function(options) {
                        super$initialize(
                            options=options,
                            name="results",
                            title="Analysis Results")
                        self$add(jmvcore::Html$new(
                            options=options,
                            name="instructions",
                            title="Instructions",
                            visible=TRUE))
                        self$add(jmvcore::Html$new(
                            options=options,
                            name="analysisSummary",
                            title="Analysis Summary",
                            visible=TRUE))
                        self$add(jmvcore::Html$new(
                            options=options,
                            name="clinicalReport",
                            title="Clinical Report Sentences",
                            visible=TRUE))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="aucSummary",
                            title="Area Under the Curve (AUC) Summary",
                            visible="(aucTable)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="auc", 
                                    `title`="AUC", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="auc_lower", 
                                    `title`="AUC Lower CI", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="auc_upper", 
                                    `title`="AUC Upper CI", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="std_error", 
                                    `title`="Standard Error", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="auc_interpretation", 
                                    `title`="AUC Interpretation", 
                                    `type`="text"),
                                list(
                                    `name`="clinical_utility", 
                                    `title`="Clinical Utility", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="rocComparisons",
                            title="ROC Curve Comparisons",
                            visible="(pairwiseComparisons && analysisType:comparative)",
                            columns=list(
                                list(
                                    `name`="predictor1", 
                                    `title`="Predictor 1", 
                                    `type`="text"),
                                list(
                                    `name`="predictor2", 
                                    `title`="Predictor 2", 
                                    `type`="text"),
                                list(
                                    `name`="auc_difference", 
                                    `title`="AUC Difference", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="test_statistic", 
                                    `title`="Test Statistic", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="p_value", 
                                    `title`="p-value", 
                                    `type`="number", 
                                    `format`="zto;pvalue"),
                                list(
                                    `name`="result", 
                                    `title`="Result", 
                                    `type`="text"),
                                list(
                                    `name`="clinical_significance", 
                                    `title`="Clinical Significance", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="detailedComparison",
                            title="Detailed Model Comparison",
                            visible="(showMetricsDiff && analysisType:comparative)",
                            columns=list(
                                list(
                                    `name`="metric", 
                                    `title`="Metric", 
                                    `type`="text"),
                                list(
                                    `name`="model1_value", 
                                    `title`="Model 1 Value", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="model2_value", 
                                    `title`="Model 2 Value", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="difference", 
                                    `title`="Difference", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="percent_change", 
                                    `title`="% Change", 
                                    `type`="number", 
                                    `format`="pc"),
                                list(
                                    `name`="p_value", 
                                    `title`="p-value", 
                                    `type`="number", 
                                    `format`="zto;pvalue"),
                                list(
                                    `name`="effect_size", 
                                    `title`="Effect Size", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="interpretation", 
                                    `title`="Clinical Interpretation", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="statisticalSummary",
                            title="Statistical Comparison Summary",
                            visible="(statisticalComparison && analysisType:comparative)",
                            columns=list(
                                list(
                                    `name`="test_name", 
                                    `title`="Statistical Test", 
                                    `type`="text"),
                                list(
                                    `name`="test_statistic", 
                                    `title`="Test Statistic", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="p_value", 
                                    `title`="p-value", 
                                    `type`="number", 
                                    `format`="zto;pvalue"),
                                list(
                                    `name`="conclusion", 
                                    `title`="Statistical Conclusion", 
                                    `type`="text"),
                                list(
                                    `name`="effect_magnitude", 
                                    `title`="Effect Magnitude", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="optimalCutoffSummary",
                            title="Optimal Cutoff Analysis",
                            visible="(optimalCutoffs)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="optimal_cutoff", 
                                    `title`="Optimal Cutoff", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="youden_index", 
                                    `title`="Youden Index", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="sensitivity", 
                                    `title`="Sensitivity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="specificity", 
                                    `title`="Specificity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="accuracy", 
                                    `title`="Accuracy", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="clinical_recommendation", 
                                    `title`="Clinical Recommendation", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="cutoffAnalysis",
                            title="Detailed Cutoff Analysis",
                            visible="(cutoffTable)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="cutoff", 
                                    `title`="Cutoff", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="cutoff_type", 
                                    `title`="Cutoff Type", 
                                    `type`="text"),
                                list(
                                    `name`="sensitivity", 
                                    `title`="Sensitivity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="specificity", 
                                    `title`="Specificity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="one_minus_specificity", 
                                    `title`="1-Specificity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="youden_index", 
                                    `title`="Youden Index", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="true_positive", 
                                    `title`="True Positive", 
                                    `type`="integer"),
                                list(
                                    `name`="true_negative", 
                                    `title`="True Negative", 
                                    `type`="integer"),
                                list(
                                    `name`="false_positive", 
                                    `title`="False Positive", 
                                    `type`="integer"),
                                list(
                                    `name`="false_negative", 
                                    `title`="False Negative", 
                                    `type`="integer"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="diagnosticPerformance",
                            title="Diagnostic Performance Metrics",
                            visible="(diagnosticMetrics)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="cutoff", 
                                    `title`="Cutoff", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="sensitivity", 
                                    `title`="Sensitivity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="sensitivity_ci", 
                                    `title`="Sensitivity 95% CI", 
                                    `type`="text"),
                                list(
                                    `name`="specificity", 
                                    `title`="Specificity", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="specificity_ci", 
                                    `title`="Specificity 95% CI", 
                                    `type`="text"),
                                list(
                                    `name`="accuracy", 
                                    `title`="Accuracy", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="balanced_accuracy", 
                                    `title`="Balanced Accuracy", 
                                    `type`="number", 
                                    `format`="zto"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="clinicalApplicationMetrics",
                            title="Clinical Application Metrics",
                            visible="(clinicalMetrics)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="prevalence", 
                                    `title`="Prevalence", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="ppv", 
                                    `title`="PPV", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="npv", 
                                    `title`="NPV", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="lr_positive", 
                                    `title`="LR+", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="lr_negative", 
                                    `title`="LR-", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="diagnostic_odds_ratio", 
                                    `title`="Diagnostic OR", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="clinical_interpretation", 
                                    `title`="Clinical Interpretation", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="partialAucAnalysis",
                            title="Partial AUC Analysis",
                            visible="(partialAuc)",
                            columns=list(
                                list(
                                    `name`="predictor", 
                                    `title`="Predictor", 
                                    `type`="text"),
                                list(
                                    `name`="range_type", 
                                    `title`="Range Type", 
                                    `type`="text"),
                                list(
                                    `name`="range_min", 
                                    `title`="Range Min", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="range_max", 
                                    `title`="Range Max", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="partial_auc", 
                                    `title`="Partial AUC", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="normalized_pauc", 
                                    `title`="Normalized pAUC", 
                                    `type`="number", 
                                    `format`="zto"),
                                list(
                                    `name`="clinical_relevance", 
                                    `title`="Clinical Relevance", 
                                    `type`="text"))))
                        self$add(jmvcore::Table$new(
                            options=options,
                            name="comprehensiveAnalysisSummary",
                            title="Comprehensive ROC Analysis Summary",
                            visible="(comprehensive_output)",
                            columns=list(
                                list(
                                    `name`="measure", 
                                    `title`="Measure", 
                                    `type`="text"),
                                list(
                                    `name`="value", 
                                    `title`="Value", 
                                    `type`="text"),
                                list(
                                    `name`="interpretation", 
                                    `title`="Interpretation", 
                                    `type`="text"),
                                list(
                                    `name`="clinical_significance", 
                                    `title`="Clinical Significance", 
                                    `type`="text"))))
                        self$add(jmvcore::Html$new(
                            options=options,
                            name="clinicalInterpretationGuide",
                            title="Clinical Application Guidance",
                            visible="(clinical_interpretation)"))
                        self$add(jmvcore::Html$new(
                            options=options,
                            name="methodsExplanation",
                            title="Statistical Methods and References",
                            visible="(comprehensive_output)"))
                        self$add(jmvcore::Image$new(
                            options=options,
                            name="rocCurvePlot",
                            title="ROC Curve Analysis",
                            visible="(rocCurve)",
                            renderFun=".plotROCCurve",
                            width=600,
                            height=600))
                        self$add(jmvcore::Image$new(
                            options=options,
                            name="comparativeROCPlot",
                            title="Comparative ROC Analysis",
                            visible="(rocCurve && analysisType:comparative)",
                            renderFun=".plotComparativeROC",
                            width=600,
                            height=600))
                        self$add(jmvcore::Image$new(
                            options=options,
                            name="cutoffAnalysisPlot",
                            title="Cutoff Analysis Plot",
                            visible="(cutoffTable)",
                            renderFun=".plotCutoffAnalysis",
                            width=600,
                            height=600))
                        self$add(jmvcore::Image$new(
                            options=options,
                            name="youdenIndexPlot",
                            title="Youden Index Optimization Plot",
                            visible="(youdenOptimization)",
                            renderFun=".plotYoudenIndex",
                            width=600,
                            height=600))
                        self$add(jmvcore::Image$new(
                            options=options,
                            name="clinicalDecisionPlot",
                            title="Clinical Decision Analysis Plot",
                            visible="(clinicalMetrics)",
                            renderFun=".plotClinicalDecision",
                            width=600,
                            height=600))}))$new(options=options))}))

enhancedROCBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "enhancedROCBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "enhancedROC",
                version = c(0,0,31),
                options = options,
                results = enhancedROCResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Clinical ROC Analysis
#'
#' Clinical ROC analysis toolkit for comprehensive diagnostic performance 
#' evaluation. Includes ROC curve analysis, Youden Index optimization, 
#' sensitivity/specificity analysis, optimal cutoff determination, and 
#' comparative ROC analysis. Essential for biomarker validation, diagnostic
#' test evaluation, and clinical decision support in medical research.
#' 
#' @param data The data as a data frame.
#' @param outcome Binary outcome variable (disease status)
#' @param positiveClass Select which level represents the positive class
#'   (disease/condition present)
#' @param predictors Numeric predictor variables for ROC analysis
#' @param analysisType Type of ROC analysis to perform
#' @param direction Direction of the predictor-outcome relationship
#' @param youdenOptimization Find optimal cutoff using Youden Index
#'   (Sensitivity + Specificity - 1)
#' @param customCutoffs Comma-separated list of custom cutoffs to evaluate
#'   (e.g., 0.1, 0.5, 0.9)
#' @param sensitivityThreshold Minimum required sensitivity for screening
#'   applications
#' @param specificityThreshold Minimum required specificity for confirmatory
#'   testing
#' @param confidenceLevel Confidence level for AUC confidence intervals
#' @param bootstrapSamples Number of bootstrap samples for confidence
#'   intervals
#' @param useBootstrap Use bootstrap methods for confidence intervals
#' @param pairwiseComparisons Perform pairwise comparisons between ROC curves
#' @param comparisonMethod Method for comparing ROC curves
#' @param rocCurve Display ROC curve plot
#' @param aucTable Display AUC summary table
#' @param cutoffTable Display detailed cutoff analysis
#' @param optimalCutoffs Display optimal cutoff summary
#' @param diagnosticMetrics Display comprehensive diagnostic metrics
#' @param clinicalMetrics Display clinical application metrics (PPV, NPV, LR+,
#'   LR-)
#' @param smoothMethod Method for smoothing ROC curves
#' @param partialAuc Calculate partial AUC for specific
#'   sensitivity/specificity ranges
#' @param partialRange Range for partial AUC (specificity_min,specificity_max)
#' @param prevalence Disease prevalence for calculating predictive values
#' @param clinicalContext Clinical application context for interpretation
#' @param clinicalPresets Pre-configured settings for common clinical
#'   scenarios
#' @param comprehensive_output Include comprehensive statistical details
#' @param clinical_interpretation Provide clinical context for ROC analysis
#'   results
#' @param plotTheme Visual theme for ROC plots
#' @param plotWidth Width of ROC plots
#' @param plotHeight Height of ROC plots
#' @param showCutoffPoints Highlight optimal cutoff points on ROC curve
#' @param showConfidenceBands Display confidence bands around ROC curve
#' @param showMetricsDiff Display detailed differences between model metrics
#' @param statisticalComparison Perform comprehensive statistical comparison
#'   between models
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$results$analysisSummary} \tab \tab \tab \tab \tab Plain language summary of key findings \cr
#'   \code{results$results$clinicalReport} \tab \tab \tab \tab \tab Copy-ready clinical report sentences for publications and reports \cr
#'   \code{results$results$aucSummary} \tab \tab \tab \tab \tab AUC values with confidence intervals for each predictor \cr
#'   \code{results$results$rocComparisons} \tab \tab \tab \tab \tab Pairwise comparisons between ROC curves \cr
#'   \code{results$results$detailedComparison} \tab \tab \tab \tab \tab Comprehensive comparison of diagnostic metrics between models \cr
#'   \code{results$results$statisticalSummary} \tab \tab \tab \tab \tab Summary of statistical tests for model comparison \cr
#'   \code{results$results$optimalCutoffSummary} \tab \tab \tab \tab \tab Youden Index optimization results for each predictor \cr
#'   \code{results$results$cutoffAnalysis} \tab \tab \tab \tab \tab Comprehensive analysis across multiple cutoff values \cr
#'   \code{results$results$diagnosticPerformance} \tab \tab \tab \tab \tab Comprehensive diagnostic performance measures at optimal cutoff \cr
#'   \code{results$results$clinicalApplicationMetrics} \tab \tab \tab \tab \tab Clinical metrics including predictive values and likelihood ratios \cr
#'   \code{results$results$partialAucAnalysis} \tab \tab \tab \tab \tab Partial AUC analysis for specific sensitivity/specificity ranges \cr
#'   \code{results$results$comprehensiveAnalysisSummary} \tab \tab \tab \tab \tab Enhanced statistical summary for comprehensive output \cr
#'   \code{results$results$clinicalInterpretationGuide} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$results$methodsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$results$rocCurvePlot} \tab \tab \tab \tab \tab ROC curves with optimal cutoff points \cr
#'   \code{results$results$comparativeROCPlot} \tab \tab \tab \tab \tab Multiple ROC curves for comparison \cr
#'   \code{results$results$cutoffAnalysisPlot} \tab \tab \tab \tab \tab Sensitivity and specificity across cutoff values \cr
#'   \code{results$results$youdenIndexPlot} \tab \tab \tab \tab \tab Youden Index values across cutoff range \cr
#'   \code{results$results$clinicalDecisionPlot} \tab \tab \tab \tab \tab Clinical decision curves and threshold analysis \cr
#' }
#'
#' @export
enhancedROC <- function(
    data,
    outcome,
    positiveClass,
    predictors,
    analysisType = "single",
    direction = "auto",
    youdenOptimization = TRUE,
    customCutoffs,
    sensitivityThreshold = 0.8,
    specificityThreshold = 0.8,
    confidenceLevel = 95,
    bootstrapSamples = 1000,
    useBootstrap = TRUE,
    pairwiseComparisons = TRUE,
    comparisonMethod = "delong",
    rocCurve = TRUE,
    aucTable = TRUE,
    cutoffTable = TRUE,
    optimalCutoffs = TRUE,
    diagnosticMetrics = TRUE,
    clinicalMetrics = TRUE,
    smoothMethod = "none",
    partialAuc = FALSE,
    partialRange = "0.8,1.0",
    prevalence = 0.1,
    clinicalContext = "general",
    clinicalPresets = "custom",
    comprehensive_output = FALSE,
    clinical_interpretation = TRUE,
    plotTheme = "clinical",
    plotWidth = 600,
    plotHeight = 600,
    showCutoffPoints = TRUE,
    showConfidenceBands = FALSE,
    showMetricsDiff = TRUE,
    statisticalComparison = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("enhancedROC requires jmvcore to be installed (restart may be required)")

    if ( ! missing(outcome)) outcome <- jmvcore::resolveQuo(jmvcore::enquo(outcome))
    if ( ! missing(predictors)) predictors <- jmvcore::resolveQuo(jmvcore::enquo(predictors))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(outcome), outcome, NULL),
            `if`( ! missing(predictors), predictors, NULL))


    options <- enhancedROCOptions$new(
        outcome = outcome,
        positiveClass = positiveClass,
        predictors = predictors,
        analysisType = analysisType,
        direction = direction,
        youdenOptimization = youdenOptimization,
        customCutoffs = customCutoffs,
        sensitivityThreshold = sensitivityThreshold,
        specificityThreshold = specificityThreshold,
        confidenceLevel = confidenceLevel,
        bootstrapSamples = bootstrapSamples,
        useBootstrap = useBootstrap,
        pairwiseComparisons = pairwiseComparisons,
        comparisonMethod = comparisonMethod,
        rocCurve = rocCurve,
        aucTable = aucTable,
        cutoffTable = cutoffTable,
        optimalCutoffs = optimalCutoffs,
        diagnosticMetrics = diagnosticMetrics,
        clinicalMetrics = clinicalMetrics,
        smoothMethod = smoothMethod,
        partialAuc = partialAuc,
        partialRange = partialRange,
        prevalence = prevalence,
        clinicalContext = clinicalContext,
        clinicalPresets = clinicalPresets,
        comprehensive_output = comprehensive_output,
        clinical_interpretation = clinical_interpretation,
        plotTheme = plotTheme,
        plotWidth = plotWidth,
        plotHeight = plotHeight,
        showCutoffPoints = showCutoffPoints,
        showConfidenceBands = showConfidenceBands,
        showMetricsDiff = showMetricsDiff,
        statisticalComparison = statisticalComparison)

    analysis <- enhancedROCClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

