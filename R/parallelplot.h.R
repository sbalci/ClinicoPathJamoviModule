
# This file is automatically generated, you probably don't want to edit this

parallelplotOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "parallelplotOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            vars = NULL,
            group = NULL,
            scaling = "std",
            alpha = 0.7,
            showMissing = FALSE,
            colorPalette = "default", ...) {

            super$initialize(
                package="ClinicoPath",
                name="parallelplot",
                requiresData=TRUE,
                ...)

            private$..vars <- jmvcore::OptionVariables$new(
                "vars",
                vars)
            private$..group <- jmvcore::OptionVariable$new(
                "group",
                group,
                default=NULL)
            private$..scaling <- jmvcore::OptionList$new(
                "scaling",
                scaling,
                options=list(
                    "std",
                    "uniminmax",
                    "minmax",
                    "none"),
                default="std")
            private$..alpha <- jmvcore::OptionNumber$new(
                "alpha",
                alpha,
                min=0.1,
                max=1,
                default=0.7)
            private$..showMissing <- jmvcore::OptionBool$new(
                "showMissing",
                showMissing,
                default=FALSE)
            private$..colorPalette <- jmvcore::OptionList$new(
                "colorPalette",
                colorPalette,
                options=list(
                    "default",
                    "viridis",
                    "set1",
                    "clinical"),
                default="default")

            self$.addOption(private$..vars)
            self$.addOption(private$..group)
            self$.addOption(private$..scaling)
            self$.addOption(private$..alpha)
            self$.addOption(private$..showMissing)
            self$.addOption(private$..colorPalette)
        }),
    active = list(
        vars = function() private$..vars$value,
        group = function() private$..group$value,
        scaling = function() private$..scaling$value,
        alpha = function() private$..alpha$value,
        showMissing = function() private$..showMissing$value,
        colorPalette = function() private$..colorPalette$value),
    private = list(
        ..vars = NA,
        ..group = NA,
        ..scaling = NA,
        ..alpha = NA,
        ..showMissing = NA,
        ..colorPalette = NA)
)

parallelplotResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "parallelplotResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        plot = function() private$.items[["plot"]],
        summary = function() private$.items[["summary"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Parallel Coordinates Plot",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions"))
            self$add(jmvcore::Image$new(
                options=options,
                name="plot",
                title="Parallel Coordinates Plot",
                width=800,
                height=600,
                renderFun=".plot"))
            self$add(jmvcore::Table$new(
                options=options,
                name="summary",
                title="Variable Summary",
                rows="(vars)",
                columns=list(
                    list(
                        `name`="variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="n", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="missing", 
                        `title`="Missing", 
                        `type`="integer"),
                    list(
                        `name`="mean", 
                        `title`="Mean", 
                        `type`="number"),
                    list(
                        `name`="sd", 
                        `title`="SD", 
                        `type`="number"),
                    list(
                        `name`="min", 
                        `title`="Min", 
                        `type`="number"),
                    list(
                        `name`="max", 
                        `title`="Max", 
                        `type`="number"))))}))

parallelplotBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "parallelplotBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "parallelplot",
                version = c(0,0,31),
                options = options,
                results = parallelplotResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Parallel Coordinates Plot
#'
#' 
#' @param data .
#' @param vars Select multiple continuous variables for parallel coordinates
#' @param group Variable for coloring and grouping lines
#' @param scaling Method for scaling variables to comparable ranges
#' @param alpha Transparency level for parallel coordinate lines
#' @param showMissing Include cases with missing values
#' @param colorPalette Color scheme for grouping variable
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$summary} \tab \tab \tab \tab \tab a table \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$summary$asDF}
#'
#' \code{as.data.frame(results$summary)}
#'
#' @export
parallelplot <- function(
    data,
    vars,
    group = NULL,
    scaling = "std",
    alpha = 0.7,
    showMissing = FALSE,
    colorPalette = "default") {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("parallelplot requires jmvcore to be installed (restart may be required)")

    if ( ! missing(vars)) vars <- jmvcore::resolveQuo(jmvcore::enquo(vars))
    if ( ! missing(group)) group <- jmvcore::resolveQuo(jmvcore::enquo(group))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(vars), vars, NULL),
            `if`( ! missing(group), group, NULL))


    options <- parallelplotOptions$new(
        vars = vars,
        group = group,
        scaling = scaling,
        alpha = alpha,
        showMissing = showMissing,
        colorPalette = colorPalette)

    analysis <- parallelplotClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

