
# This file is automatically generated, you probably don't want to edit this

stagemigrationOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "stagemigrationOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            oldStage = NULL,
            newStage = NULL,
            survivalTime = NULL,
            event = NULL,
            eventLevel = NULL,
            analysisType = "comprehensive",
            confidenceLevel = 0.95,
            calculateNRI = FALSE,
            nriTimePoints = "12, 24, 60",
            calculateIDI = FALSE,
            performROCAnalysis = FALSE,
            rocTimePoints = "12, 24, 36, 60",
            performDCA = FALSE,
            performCalibration = FALSE,
            performBootstrap = FALSE,
            bootstrapReps = 1000,
            performCrossValidation = FALSE,
            cvFolds = 5,
            clinicalSignificanceThreshold = 0.02,
            nriClinicalThreshold = 0.2,
            performHomogeneityTests = FALSE,
            performTrendTests = FALSE,
            performLikelihoodTests = FALSE,
            calculatePseudoR2 = FALSE,
            showMigrationOverview = TRUE,
            showMigrationSummary = TRUE,
            showStageDistribution = TRUE,
            showMigrationMatrix = TRUE,
            showStatisticalComparison = TRUE,
            showConcordanceComparison = TRUE,
            showMigrationHeatmap = FALSE,
            showROCComparison = FALSE,
            showCalibrationPlots = FALSE,
            showDecisionCurves = FALSE,
            showForestPlot = FALSE,
            showWillRogersAnalysis = FALSE,
            showSurvivalCurves = FALSE,
            survivalPlotType = "separate",
            showConfidenceIntervals = FALSE,
            showRiskTables = FALSE,
            plotTimeRange = "auto",
            showClinicalInterpretation = FALSE,
            showStatisticalSummary = FALSE,
            showMethodologyNotes = FALSE,
            includeEffectSizes = FALSE,
            generateExecutiveSummary = FALSE,
            cancerType = "general",
            useOptimismCorrection = FALSE,
            enableMultifactorialAnalysis = FALSE,
            continuousCovariates = NULL,
            categoricalCovariates = NULL,
            multifactorialComparisonType = "comprehensive",
            baselineModel = "covariates_only",
            performInteractionTests = FALSE,
            stratifiedAnalysis = FALSE,
            showMultifactorialTables = FALSE,
            showAdjustedCIndexComparison = FALSE,
            showNestedModelTests = FALSE,
            showStepwiseResults = FALSE,
            showExplanations = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="stagemigration",
                requiresData=TRUE,
                ...)

            private$..oldStage <- jmvcore::OptionVariable$new(
                "oldStage",
                oldStage,
                suggested=list(
                    "ordinal",
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..newStage <- jmvcore::OptionVariable$new(
                "newStage",
                newStage,
                suggested=list(
                    "ordinal",
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..survivalTime <- jmvcore::OptionVariable$new(
                "survivalTime",
                survivalTime,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..event <- jmvcore::OptionVariable$new(
                "event",
                event,
                suggested=list(
                    "ordinal",
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..eventLevel <- jmvcore::OptionLevel$new(
                "eventLevel",
                eventLevel,
                variable="(event)")
            private$..analysisType <- jmvcore::OptionList$new(
                "analysisType",
                analysisType,
                options=list(
                    "basic",
                    "standard",
                    "comprehensive",
                    "publication"),
                default="comprehensive")
            private$..confidenceLevel <- jmvcore::OptionNumber$new(
                "confidenceLevel",
                confidenceLevel,
                min=0.8,
                max=0.99,
                default=0.95)
            private$..calculateNRI <- jmvcore::OptionBool$new(
                "calculateNRI",
                calculateNRI,
                default=FALSE)
            private$..nriTimePoints <- jmvcore::OptionString$new(
                "nriTimePoints",
                nriTimePoints,
                default="12, 24, 60")
            private$..calculateIDI <- jmvcore::OptionBool$new(
                "calculateIDI",
                calculateIDI,
                default=FALSE)
            private$..performROCAnalysis <- jmvcore::OptionBool$new(
                "performROCAnalysis",
                performROCAnalysis,
                default=FALSE)
            private$..rocTimePoints <- jmvcore::OptionString$new(
                "rocTimePoints",
                rocTimePoints,
                default="12, 24, 36, 60")
            private$..performDCA <- jmvcore::OptionBool$new(
                "performDCA",
                performDCA,
                default=FALSE)
            private$..performCalibration <- jmvcore::OptionBool$new(
                "performCalibration",
                performCalibration,
                default=FALSE)
            private$..performBootstrap <- jmvcore::OptionBool$new(
                "performBootstrap",
                performBootstrap,
                default=FALSE)
            private$..bootstrapReps <- jmvcore::OptionNumber$new(
                "bootstrapReps",
                bootstrapReps,
                min=100,
                max=2000,
                default=1000)
            private$..performCrossValidation <- jmvcore::OptionBool$new(
                "performCrossValidation",
                performCrossValidation,
                default=FALSE)
            private$..cvFolds <- jmvcore::OptionNumber$new(
                "cvFolds",
                cvFolds,
                min=3,
                max=10,
                default=5)
            private$..clinicalSignificanceThreshold <- jmvcore::OptionNumber$new(
                "clinicalSignificanceThreshold",
                clinicalSignificanceThreshold,
                min=0.01,
                max=0.1,
                default=0.02)
            private$..nriClinicalThreshold <- jmvcore::OptionNumber$new(
                "nriClinicalThreshold",
                nriClinicalThreshold,
                min=0.1,
                max=0.5,
                default=0.2)
            private$..performHomogeneityTests <- jmvcore::OptionBool$new(
                "performHomogeneityTests",
                performHomogeneityTests,
                default=FALSE)
            private$..performTrendTests <- jmvcore::OptionBool$new(
                "performTrendTests",
                performTrendTests,
                default=FALSE)
            private$..performLikelihoodTests <- jmvcore::OptionBool$new(
                "performLikelihoodTests",
                performLikelihoodTests,
                default=FALSE)
            private$..calculatePseudoR2 <- jmvcore::OptionBool$new(
                "calculatePseudoR2",
                calculatePseudoR2,
                default=FALSE)
            private$..showMigrationOverview <- jmvcore::OptionBool$new(
                "showMigrationOverview",
                showMigrationOverview,
                default=TRUE)
            private$..showMigrationSummary <- jmvcore::OptionBool$new(
                "showMigrationSummary",
                showMigrationSummary,
                default=TRUE)
            private$..showStageDistribution <- jmvcore::OptionBool$new(
                "showStageDistribution",
                showStageDistribution,
                default=TRUE)
            private$..showMigrationMatrix <- jmvcore::OptionBool$new(
                "showMigrationMatrix",
                showMigrationMatrix,
                default=TRUE)
            private$..showStatisticalComparison <- jmvcore::OptionBool$new(
                "showStatisticalComparison",
                showStatisticalComparison,
                default=TRUE)
            private$..showConcordanceComparison <- jmvcore::OptionBool$new(
                "showConcordanceComparison",
                showConcordanceComparison,
                default=TRUE)
            private$..showMigrationHeatmap <- jmvcore::OptionBool$new(
                "showMigrationHeatmap",
                showMigrationHeatmap,
                default=FALSE)
            private$..showROCComparison <- jmvcore::OptionBool$new(
                "showROCComparison",
                showROCComparison,
                default=FALSE)
            private$..showCalibrationPlots <- jmvcore::OptionBool$new(
                "showCalibrationPlots",
                showCalibrationPlots,
                default=FALSE)
            private$..showDecisionCurves <- jmvcore::OptionBool$new(
                "showDecisionCurves",
                showDecisionCurves,
                default=FALSE)
            private$..showForestPlot <- jmvcore::OptionBool$new(
                "showForestPlot",
                showForestPlot,
                default=FALSE)
            private$..showWillRogersAnalysis <- jmvcore::OptionBool$new(
                "showWillRogersAnalysis",
                showWillRogersAnalysis,
                default=FALSE)
            private$..showSurvivalCurves <- jmvcore::OptionBool$new(
                "showSurvivalCurves",
                showSurvivalCurves,
                default=FALSE)
            private$..survivalPlotType <- jmvcore::OptionList$new(
                "survivalPlotType",
                survivalPlotType,
                options=list(
                    "separate",
                    "sidebyside",
                    "overlay"),
                default="separate")
            private$..showConfidenceIntervals <- jmvcore::OptionBool$new(
                "showConfidenceIntervals",
                showConfidenceIntervals,
                default=FALSE)
            private$..showRiskTables <- jmvcore::OptionBool$new(
                "showRiskTables",
                showRiskTables,
                default=FALSE)
            private$..plotTimeRange <- jmvcore::OptionString$new(
                "plotTimeRange",
                plotTimeRange,
                default="auto")
            private$..showClinicalInterpretation <- jmvcore::OptionBool$new(
                "showClinicalInterpretation",
                showClinicalInterpretation,
                default=FALSE)
            private$..showStatisticalSummary <- jmvcore::OptionBool$new(
                "showStatisticalSummary",
                showStatisticalSummary,
                default=FALSE)
            private$..showMethodologyNotes <- jmvcore::OptionBool$new(
                "showMethodologyNotes",
                showMethodologyNotes,
                default=FALSE)
            private$..includeEffectSizes <- jmvcore::OptionBool$new(
                "includeEffectSizes",
                includeEffectSizes,
                default=FALSE)
            private$..generateExecutiveSummary <- jmvcore::OptionBool$new(
                "generateExecutiveSummary",
                generateExecutiveSummary,
                default=FALSE)
            private$..cancerType <- jmvcore::OptionList$new(
                "cancerType",
                cancerType,
                options=list(
                    "general",
                    "lung",
                    "breast",
                    "colorectal",
                    "prostate",
                    "headneck",
                    "melanoma",
                    "other"),
                default="general")
            private$..useOptimismCorrection <- jmvcore::OptionBool$new(
                "useOptimismCorrection",
                useOptimismCorrection,
                default=FALSE)
            private$..enableMultifactorialAnalysis <- jmvcore::OptionBool$new(
                "enableMultifactorialAnalysis",
                enableMultifactorialAnalysis,
                default=FALSE)
            private$..continuousCovariates <- jmvcore::OptionVariables$new(
                "continuousCovariates",
                continuousCovariates,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..categoricalCovariates <- jmvcore::OptionVariables$new(
                "categoricalCovariates",
                categoricalCovariates,
                suggested=list(
                    "ordinal",
                    "nominal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..multifactorialComparisonType <- jmvcore::OptionList$new(
                "multifactorialComparisonType",
                multifactorialComparisonType,
                options=list(
                    "adjusted_cindex",
                    "nested_models",
                    "stepwise",
                    "comprehensive"),
                default="comprehensive")
            private$..baselineModel <- jmvcore::OptionList$new(
                "baselineModel",
                baselineModel,
                options=list(
                    "covariates_only",
                    "original_plus_covariates",
                    "new_plus_covariates"),
                default="covariates_only")
            private$..performInteractionTests <- jmvcore::OptionBool$new(
                "performInteractionTests",
                performInteractionTests,
                default=FALSE)
            private$..stratifiedAnalysis <- jmvcore::OptionBool$new(
                "stratifiedAnalysis",
                stratifiedAnalysis,
                default=FALSE)
            private$..showMultifactorialTables <- jmvcore::OptionBool$new(
                "showMultifactorialTables",
                showMultifactorialTables,
                default=FALSE)
            private$..showAdjustedCIndexComparison <- jmvcore::OptionBool$new(
                "showAdjustedCIndexComparison",
                showAdjustedCIndexComparison,
                default=FALSE)
            private$..showNestedModelTests <- jmvcore::OptionBool$new(
                "showNestedModelTests",
                showNestedModelTests,
                default=FALSE)
            private$..showStepwiseResults <- jmvcore::OptionBool$new(
                "showStepwiseResults",
                showStepwiseResults,
                default=FALSE)
            private$..showExplanations <- jmvcore::OptionBool$new(
                "showExplanations",
                showExplanations,
                default=TRUE)

            self$.addOption(private$..oldStage)
            self$.addOption(private$..newStage)
            self$.addOption(private$..survivalTime)
            self$.addOption(private$..event)
            self$.addOption(private$..eventLevel)
            self$.addOption(private$..analysisType)
            self$.addOption(private$..confidenceLevel)
            self$.addOption(private$..calculateNRI)
            self$.addOption(private$..nriTimePoints)
            self$.addOption(private$..calculateIDI)
            self$.addOption(private$..performROCAnalysis)
            self$.addOption(private$..rocTimePoints)
            self$.addOption(private$..performDCA)
            self$.addOption(private$..performCalibration)
            self$.addOption(private$..performBootstrap)
            self$.addOption(private$..bootstrapReps)
            self$.addOption(private$..performCrossValidation)
            self$.addOption(private$..cvFolds)
            self$.addOption(private$..clinicalSignificanceThreshold)
            self$.addOption(private$..nriClinicalThreshold)
            self$.addOption(private$..performHomogeneityTests)
            self$.addOption(private$..performTrendTests)
            self$.addOption(private$..performLikelihoodTests)
            self$.addOption(private$..calculatePseudoR2)
            self$.addOption(private$..showMigrationOverview)
            self$.addOption(private$..showMigrationSummary)
            self$.addOption(private$..showStageDistribution)
            self$.addOption(private$..showMigrationMatrix)
            self$.addOption(private$..showStatisticalComparison)
            self$.addOption(private$..showConcordanceComparison)
            self$.addOption(private$..showMigrationHeatmap)
            self$.addOption(private$..showROCComparison)
            self$.addOption(private$..showCalibrationPlots)
            self$.addOption(private$..showDecisionCurves)
            self$.addOption(private$..showForestPlot)
            self$.addOption(private$..showWillRogersAnalysis)
            self$.addOption(private$..showSurvivalCurves)
            self$.addOption(private$..survivalPlotType)
            self$.addOption(private$..showConfidenceIntervals)
            self$.addOption(private$..showRiskTables)
            self$.addOption(private$..plotTimeRange)
            self$.addOption(private$..showClinicalInterpretation)
            self$.addOption(private$..showStatisticalSummary)
            self$.addOption(private$..showMethodologyNotes)
            self$.addOption(private$..includeEffectSizes)
            self$.addOption(private$..generateExecutiveSummary)
            self$.addOption(private$..cancerType)
            self$.addOption(private$..useOptimismCorrection)
            self$.addOption(private$..enableMultifactorialAnalysis)
            self$.addOption(private$..continuousCovariates)
            self$.addOption(private$..categoricalCovariates)
            self$.addOption(private$..multifactorialComparisonType)
            self$.addOption(private$..baselineModel)
            self$.addOption(private$..performInteractionTests)
            self$.addOption(private$..stratifiedAnalysis)
            self$.addOption(private$..showMultifactorialTables)
            self$.addOption(private$..showAdjustedCIndexComparison)
            self$.addOption(private$..showNestedModelTests)
            self$.addOption(private$..showStepwiseResults)
            self$.addOption(private$..showExplanations)
        }),
    active = list(
        oldStage = function() private$..oldStage$value,
        newStage = function() private$..newStage$value,
        survivalTime = function() private$..survivalTime$value,
        event = function() private$..event$value,
        eventLevel = function() private$..eventLevel$value,
        analysisType = function() private$..analysisType$value,
        confidenceLevel = function() private$..confidenceLevel$value,
        calculateNRI = function() private$..calculateNRI$value,
        nriTimePoints = function() private$..nriTimePoints$value,
        calculateIDI = function() private$..calculateIDI$value,
        performROCAnalysis = function() private$..performROCAnalysis$value,
        rocTimePoints = function() private$..rocTimePoints$value,
        performDCA = function() private$..performDCA$value,
        performCalibration = function() private$..performCalibration$value,
        performBootstrap = function() private$..performBootstrap$value,
        bootstrapReps = function() private$..bootstrapReps$value,
        performCrossValidation = function() private$..performCrossValidation$value,
        cvFolds = function() private$..cvFolds$value,
        clinicalSignificanceThreshold = function() private$..clinicalSignificanceThreshold$value,
        nriClinicalThreshold = function() private$..nriClinicalThreshold$value,
        performHomogeneityTests = function() private$..performHomogeneityTests$value,
        performTrendTests = function() private$..performTrendTests$value,
        performLikelihoodTests = function() private$..performLikelihoodTests$value,
        calculatePseudoR2 = function() private$..calculatePseudoR2$value,
        showMigrationOverview = function() private$..showMigrationOverview$value,
        showMigrationSummary = function() private$..showMigrationSummary$value,
        showStageDistribution = function() private$..showStageDistribution$value,
        showMigrationMatrix = function() private$..showMigrationMatrix$value,
        showStatisticalComparison = function() private$..showStatisticalComparison$value,
        showConcordanceComparison = function() private$..showConcordanceComparison$value,
        showMigrationHeatmap = function() private$..showMigrationHeatmap$value,
        showROCComparison = function() private$..showROCComparison$value,
        showCalibrationPlots = function() private$..showCalibrationPlots$value,
        showDecisionCurves = function() private$..showDecisionCurves$value,
        showForestPlot = function() private$..showForestPlot$value,
        showWillRogersAnalysis = function() private$..showWillRogersAnalysis$value,
        showSurvivalCurves = function() private$..showSurvivalCurves$value,
        survivalPlotType = function() private$..survivalPlotType$value,
        showConfidenceIntervals = function() private$..showConfidenceIntervals$value,
        showRiskTables = function() private$..showRiskTables$value,
        plotTimeRange = function() private$..plotTimeRange$value,
        showClinicalInterpretation = function() private$..showClinicalInterpretation$value,
        showStatisticalSummary = function() private$..showStatisticalSummary$value,
        showMethodologyNotes = function() private$..showMethodologyNotes$value,
        includeEffectSizes = function() private$..includeEffectSizes$value,
        generateExecutiveSummary = function() private$..generateExecutiveSummary$value,
        cancerType = function() private$..cancerType$value,
        useOptimismCorrection = function() private$..useOptimismCorrection$value,
        enableMultifactorialAnalysis = function() private$..enableMultifactorialAnalysis$value,
        continuousCovariates = function() private$..continuousCovariates$value,
        categoricalCovariates = function() private$..categoricalCovariates$value,
        multifactorialComparisonType = function() private$..multifactorialComparisonType$value,
        baselineModel = function() private$..baselineModel$value,
        performInteractionTests = function() private$..performInteractionTests$value,
        stratifiedAnalysis = function() private$..stratifiedAnalysis$value,
        showMultifactorialTables = function() private$..showMultifactorialTables$value,
        showAdjustedCIndexComparison = function() private$..showAdjustedCIndexComparison$value,
        showNestedModelTests = function() private$..showNestedModelTests$value,
        showStepwiseResults = function() private$..showStepwiseResults$value,
        showExplanations = function() private$..showExplanations$value),
    private = list(
        ..oldStage = NA,
        ..newStage = NA,
        ..survivalTime = NA,
        ..event = NA,
        ..eventLevel = NA,
        ..analysisType = NA,
        ..confidenceLevel = NA,
        ..calculateNRI = NA,
        ..nriTimePoints = NA,
        ..calculateIDI = NA,
        ..performROCAnalysis = NA,
        ..rocTimePoints = NA,
        ..performDCA = NA,
        ..performCalibration = NA,
        ..performBootstrap = NA,
        ..bootstrapReps = NA,
        ..performCrossValidation = NA,
        ..cvFolds = NA,
        ..clinicalSignificanceThreshold = NA,
        ..nriClinicalThreshold = NA,
        ..performHomogeneityTests = NA,
        ..performTrendTests = NA,
        ..performLikelihoodTests = NA,
        ..calculatePseudoR2 = NA,
        ..showMigrationOverview = NA,
        ..showMigrationSummary = NA,
        ..showStageDistribution = NA,
        ..showMigrationMatrix = NA,
        ..showStatisticalComparison = NA,
        ..showConcordanceComparison = NA,
        ..showMigrationHeatmap = NA,
        ..showROCComparison = NA,
        ..showCalibrationPlots = NA,
        ..showDecisionCurves = NA,
        ..showForestPlot = NA,
        ..showWillRogersAnalysis = NA,
        ..showSurvivalCurves = NA,
        ..survivalPlotType = NA,
        ..showConfidenceIntervals = NA,
        ..showRiskTables = NA,
        ..plotTimeRange = NA,
        ..showClinicalInterpretation = NA,
        ..showStatisticalSummary = NA,
        ..showMethodologyNotes = NA,
        ..includeEffectSizes = NA,
        ..generateExecutiveSummary = NA,
        ..cancerType = NA,
        ..useOptimismCorrection = NA,
        ..enableMultifactorialAnalysis = NA,
        ..continuousCovariates = NA,
        ..categoricalCovariates = NA,
        ..multifactorialComparisonType = NA,
        ..baselineModel = NA,
        ..performInteractionTests = NA,
        ..stratifiedAnalysis = NA,
        ..showMultifactorialTables = NA,
        ..showAdjustedCIndexComparison = NA,
        ..showNestedModelTests = NA,
        ..showStepwiseResults = NA,
        ..showExplanations = NA)
)

stagemigrationResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "stagemigrationResults",
    inherit = jmvcore::Group,
    active = list(
        welcomeMessage = function() private$.items[["welcomeMessage"]],
        mydataview = function() private$.items[["mydataview"]],
        mydataview2 = function() private$.items[["mydataview2"]],
        migrationOverviewExplanation = function() private$.items[["migrationOverviewExplanation"]],
        migrationOverview = function() private$.items[["migrationOverview"]],
        migrationMatrixExplanation = function() private$.items[["migrationMatrixExplanation"]],
        migrationMatrix = function() private$.items[["migrationMatrix"]],
        stageDistributionExplanation = function() private$.items[["stageDistributionExplanation"]],
        stageDistribution = function() private$.items[["stageDistribution"]],
        migrationSummaryExplanation = function() private$.items[["migrationSummaryExplanation"]],
        migrationSummary = function() private$.items[["migrationSummary"]],
        statisticalComparisonExplanation = function() private$.items[["statisticalComparisonExplanation"]],
        statisticalComparison = function() private$.items[["statisticalComparison"]],
        concordanceComparisonExplanation = function() private$.items[["concordanceComparisonExplanation"]],
        concordanceComparison = function() private$.items[["concordanceComparison"]],
        nriResultsExplanation = function() private$.items[["nriResultsExplanation"]],
        nriResults = function() private$.items[["nriResults"]],
        idiResultsExplanation = function() private$.items[["idiResultsExplanation"]],
        idiResults = function() private$.items[["idiResults"]],
        multifactorialAnalysisExplanation = function() private$.items[["multifactorialAnalysisExplanation"]],
        multifactorialResults = function() private$.items[["multifactorialResults"]],
        multifactorialResultsExplanation = function() private$.items[["multifactorialResultsExplanation"]],
        adjustedCIndexComparison = function() private$.items[["adjustedCIndexComparison"]],
        adjustedCIndexComparisonExplanation = function() private$.items[["adjustedCIndexComparisonExplanation"]],
        nestedModelTests = function() private$.items[["nestedModelTests"]],
        nestedModelTestsExplanation = function() private$.items[["nestedModelTestsExplanation"]],
        stepwiseResults = function() private$.items[["stepwiseResults"]],
        stepwiseResultsExplanation = function() private$.items[["stepwiseResultsExplanation"]],
        interactionTests = function() private$.items[["interactionTests"]],
        interactionTestsExplanation = function() private$.items[["interactionTestsExplanation"]],
        stratifiedAnalysis = function() private$.items[["stratifiedAnalysis"]],
        stratifiedAnalysisExplanation = function() private$.items[["stratifiedAnalysisExplanation"]],
        rocAnalysis = function() private$.items[["rocAnalysis"]],
        dcaResults = function() private$.items[["dcaResults"]],
        pseudoR2ResultsExplanation = function() private$.items[["pseudoR2ResultsExplanation"]],
        pseudoR2Results = function() private$.items[["pseudoR2Results"]],
        decisionCurvesExplanation = function() private$.items[["decisionCurvesExplanation"]],
        decisionCurves = function() private$.items[["decisionCurves"]],
        bootstrapResults = function() private$.items[["bootstrapResults"]],
        willRogersAnalysisExplanation = function() private$.items[["willRogersAnalysisExplanation"]],
        willRogersAnalysis = function() private$.items[["willRogersAnalysis"]],
        likelihoodTestsExplanation = function() private$.items[["likelihoodTestsExplanation"]],
        likelihoodTests = function() private$.items[["likelihoodTests"]],
        homogeneityTestsExplanation = function() private$.items[["homogeneityTestsExplanation"]],
        homogeneityTests = function() private$.items[["homogeneityTests"]],
        clinicalInterpretationExplanation = function() private$.items[["clinicalInterpretationExplanation"]],
        clinicalInterpretation = function() private$.items[["clinicalInterpretation"]],
        executiveSummaryExplanation = function() private$.items[["executiveSummaryExplanation"]],
        executiveSummary = function() private$.items[["executiveSummary"]],
        statisticalSummaryExplanation = function() private$.items[["statisticalSummaryExplanation"]],
        statisticalSummary = function() private$.items[["statisticalSummary"]],
        methodologyNotes = function() private$.items[["methodologyNotes"]],
        migrationHeatmapExplanation = function() private$.items[["migrationHeatmapExplanation"]],
        migrationHeatmap = function() private$.items[["migrationHeatmap"]],
        rocComparisonExplanation = function() private$.items[["rocComparisonExplanation"]],
        rocComparisonPlot = function() private$.items[["rocComparisonPlot"]],
        forestPlotExplanation = function() private$.items[["forestPlotExplanation"]],
        forestPlot = function() private$.items[["forestPlot"]],
        calibrationAnalysisExplanation = function() private$.items[["calibrationAnalysisExplanation"]],
        calibrationAnalysis = function() private$.items[["calibrationAnalysis"]],
        calibrationPlotsExplanation = function() private$.items[["calibrationPlotsExplanation"]],
        calibrationPlots = function() private$.items[["calibrationPlots"]],
        survivalCurvesExplanation = function() private$.items[["survivalCurvesExplanation"]],
        survivalCurves = function() private$.items[["survivalCurves"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Advanced TNM Stage Migration Analysis",
                refs=list(
                    "harrell2015",
                    "pencina2008",
                    "vickers2006",
                    "steyerberg2010",
                    "survival",
                    "survminer",
                    "ggplot2",
                    "timeROC",
                    "dcurves"))
            self$add(jmvcore::Html$new(
                options=options,
                name="welcomeMessage",
                title="Welcome",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel")))
            self$add(jmvcore::Preformatted$new(
                options=options,
                name="mydataview",
                title="mydataview",
                visible=FALSE))
            self$add(jmvcore::Preformatted$new(
                options=options,
                name="mydataview2",
                title="mydataview2",
                visible=FALSE))
            self$add(jmvcore::Html$new(
                options=options,
                name="migrationOverviewExplanation",
                title="Understanding the Migration Overview",
                visible="(showMigrationOverview && showExplanations)",
                clearWith=list(
                    "showMigrationOverview")))
            self$add(jmvcore::Table$new(
                options=options,
                name="migrationOverview",
                title="Migration Overview",
                visible="(showMigrationOverview)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel"),
                columns=list(
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="percentage", 
                        `title`="Percentage", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="migrationMatrixExplanation",
                title="Understanding the Migration Matrix",
                visible="(showMigrationMatrix && showExplanations)",
                clearWith=list(
                    "showMigrationMatrix")))
            self$add(jmvcore::Table$new(
                options=options,
                name="migrationMatrix",
                title="Stage Migration Matrix",
                visible="(showMigrationMatrix)",
                clearWith=list(
                    "oldStage",
                    "newStage"),
                columns=list(
                    list(
                        `name`=".name", 
                        `title`="Original Stage", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="stageDistributionExplanation",
                title="Understanding Stage Distribution Changes",
                visible="(showStageDistribution && showExplanations)",
                clearWith=list(
                    "showStageDistribution")))
            self$add(jmvcore::Table$new(
                options=options,
                name="stageDistribution",
                title="Stage Distribution Comparison",
                visible="(showStageDistribution)",
                clearWith=list(
                    "oldStage",
                    "newStage"),
                columns=list(
                    list(
                        `name`="stage", 
                        `title`="Stage", 
                        `type`="text"),
                    list(
                        `name`="oldCount", 
                        `title`="Original Count", 
                        `type`="integer"),
                    list(
                        `name`="oldPct", 
                        `title`="Original %", 
                        `type`="text"),
                    list(
                        `name`="newCount", 
                        `title`="New Count", 
                        `type`="integer"),
                    list(
                        `name`="newPct", 
                        `title`="New %", 
                        `type`="text"),
                    list(
                        `name`="change", 
                        `title`="Change", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="migrationSummaryExplanation",
                title="Understanding Statistical Tests for Migration",
                visible="(showMigrationSummary && showExplanations)",
                clearWith=list(
                    "showMigrationSummary")))
            self$add(jmvcore::Table$new(
                options=options,
                name="migrationSummary",
                title="Migration Summary",
                visible="(showMigrationSummary)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel"),
                columns=list(
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="statisticalComparisonExplanation",
                title="Understanding Statistical Comparison Metrics",
                visible="(showStatisticalComparison && showExplanations)",
                clearWith=list(
                    "showStatisticalComparison")))
            self$add(jmvcore::Table$new(
                options=options,
                name="statisticalComparison",
                title="Statistical Comparison",
                visible="(showStatisticalComparison)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="ci", 
                        `title`="95% CI", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="concordanceComparisonExplanation",
                title="Understanding Concordance (C-Index) Analysis",
                visible="(showConcordanceComparison && showExplanations)",
                clearWith=list(
                    "showConcordanceComparison")))
            self$add(jmvcore::Table$new(
                options=options,
                name="concordanceComparison",
                title="Discrimination Comparison (C-Index)",
                visible="(showConcordanceComparison)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel"),
                columns=list(
                    list(
                        `name`="Model", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="C_Index", 
                        `title`="C-Index", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="SE", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Difference", 
                        `title`="Difference", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="nriResultsExplanation",
                title="Understanding Net Reclassification Improvement (NRI)",
                visible="(calculateNRI && showExplanations)",
                clearWith=list(
                    "calculateNRI")))
            self$add(jmvcore::Table$new(
                options=options,
                name="nriResults",
                title="Net Reclassification Improvement (NRI)",
                visible="(calculateNRI)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "calculateNRI",
                    "nriTimePoints"),
                columns=list(
                    list(
                        `name`="TimePoint", 
                        `title`="Time Point (months)", 
                        `type`="text"),
                    list(
                        `name`="NRI", 
                        `title`="NRI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NRI_CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NRI_CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NRI_Plus", 
                        `title`="NRI+ (Events)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NRI_Minus", 
                        `title`="NRI- (Non-events)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="idiResultsExplanation",
                title="Understanding Integrated Discrimination Improvement (IDI)",
                visible="(calculateIDI && showExplanations)",
                clearWith=list(
                    "calculateIDI")))
            self$add(jmvcore::Table$new(
                options=options,
                name="idiResults",
                title="Integrated Discrimination Improvement (IDI)",
                visible="(calculateIDI)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "calculateIDI"),
                columns=list(
                    list(
                        `name`="IDI", 
                        `title`="IDI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="IDI_CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="IDI_CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="Interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="multifactorialAnalysisExplanation",
                title="Understanding Multifactorial Stage Migration Analysis",
                visible="(enableMultifactorialAnalysis && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis")))
            self$add(jmvcore::Table$new(
                options=options,
                name="multifactorialResults",
                title="Multifactorial Model Results",
                visible="(enableMultifactorialAnalysis && showMultifactorialTables)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "continuousCovariates",
                    "categoricalCovariates",
                    "multifactorialComparisonType",
                    "baselineModel"),
                columns=list(
                    list(
                        `name`="Model", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="C_Index", 
                        `title`="C-Index", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="SE", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="AIC", 
                        `title`="AIC", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="BIC", 
                        `title`="BIC", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="multifactorialResultsExplanation",
                title="Understanding Multifactorial Model Results",
                visible="(enableMultifactorialAnalysis && showMultifactorialTables && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "showMultifactorialTables")))
            self$add(jmvcore::Table$new(
                options=options,
                name="adjustedCIndexComparison",
                title="Adjusted C-Index Comparison (Multifactorial)",
                visible="(enableMultifactorialAnalysis && showAdjustedCIndexComparison)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "continuousCovariates",
                    "categoricalCovariates"),
                columns=list(
                    list(
                        `name`="Comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="C_Index_Difference", 
                        `title`="C-Index Difference", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="SE", 
                        `title`="SE", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="adjustedCIndexComparisonExplanation",
                title="Understanding Adjusted C-Index Comparison",
                visible="(enableMultifactorialAnalysis && showAdjustedCIndexComparison && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "showAdjustedCIndexComparison")))
            self$add(jmvcore::Table$new(
                options=options,
                name="nestedModelTests",
                title="Nested Model Tests",
                visible="(enableMultifactorialAnalysis && showNestedModelTests)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "continuousCovariates",
                    "categoricalCovariates"),
                columns=list(
                    list(
                        `name`="Model_Comparison", 
                        `title`="Model Comparison", 
                        `type`="text"),
                    list(
                        `name`="Chi_Square", 
                        `title`="Chi-Square", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="Decision", 
                        `title`="Decision", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="nestedModelTestsExplanation",
                title="Understanding Nested Model Tests",
                visible="(enableMultifactorialAnalysis && showNestedModelTests && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "showNestedModelTests")))
            self$add(jmvcore::Table$new(
                options=options,
                name="stepwiseResults",
                title="Stepwise Model Selection Results",
                visible="(enableMultifactorialAnalysis && showStepwiseResults)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "continuousCovariates",
                    "categoricalCovariates"),
                columns=list(
                    list(
                        `name`="Variable", 
                        `title`="Variable", 
                        `type`="text"),
                    list(
                        `name`="Step", 
                        `title`="Step", 
                        `type`="text"),
                    list(
                        `name`="Action", 
                        `title`="Action", 
                        `type`="text"),
                    list(
                        `name`="AIC", 
                        `title`="AIC", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="stepwiseResultsExplanation",
                title="Understanding Stepwise Selection Results",
                visible="(enableMultifactorialAnalysis && showStepwiseResults && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "showStepwiseResults")))
            self$add(jmvcore::Table$new(
                options=options,
                name="interactionTests",
                title="Stage-Covariate Interaction Tests",
                visible="(enableMultifactorialAnalysis && performInteractionTests)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "performInteractionTests",
                    "continuousCovariates",
                    "categoricalCovariates"),
                columns=list(
                    list(
                        `name`="Interaction", 
                        `title`="Interaction", 
                        `type`="text"),
                    list(
                        `name`="Chi_Square", 
                        `title`="Chi-Square", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="Interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="interactionTestsExplanation",
                title="Understanding Stage-Covariate Interaction Tests",
                visible="(enableMultifactorialAnalysis && performInteractionTests && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "performInteractionTests")))
            self$add(jmvcore::Table$new(
                options=options,
                name="stratifiedAnalysis",
                title="Stratified Analysis Results",
                visible="(enableMultifactorialAnalysis && stratifiedAnalysis)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "stratifiedAnalysis",
                    "categoricalCovariates"),
                columns=list(
                    list(
                        `name`="Stratum", 
                        `title`="Stratum", 
                        `type`="text"),
                    list(
                        `name`="N", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="C_Index_Old", 
                        `title`="C-Index (Original)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="C_Index_New", 
                        `title`="C-Index (New)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Difference", 
                        `title`="Difference", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="stratifiedAnalysisExplanation",
                title="Understanding Stratified Analysis",
                visible="(enableMultifactorialAnalysis && stratifiedAnalysis && showExplanations)",
                clearWith=list(
                    "enableMultifactorialAnalysis",
                    "stratifiedAnalysis")))
            self$add(jmvcore::Table$new(
                options=options,
                name="rocAnalysis",
                title="Time-dependent ROC Analysis",
                visible="(performROCAnalysis)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performROCAnalysis",
                    "rocTimePoints"),
                columns=list(
                    list(
                        `name`="TimePoint", 
                        `title`="Time Point (months)", 
                        `type`="text"),
                    list(
                        `name`="AUC_Old", 
                        `title`="AUC (Original)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="AUC_New", 
                        `title`="AUC (New)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="AUC_Difference", 
                        `title`="Difference", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="dcaResults",
                title="Decision Curve Analysis",
                visible="(performDCA)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performDCA"),
                columns=list(
                    list(
                        `name`="Threshold", 
                        `title`="Threshold", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NetBenefit_Old", 
                        `title`="Net Benefit (Original)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="NetBenefit_New", 
                        `title`="Net Benefit (New)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Improvement", 
                        `title`="Improvement", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="pseudoR2ResultsExplanation",
                title="Understanding Pseudo R-squared Measures",
                visible="(calculatePseudoR2 && showExplanations)",
                clearWith=list(
                    "calculatePseudoR2")))
            self$add(jmvcore::Table$new(
                options=options,
                name="pseudoR2Results",
                title="Pseudo R-squared Measures",
                visible="(calculatePseudoR2)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "calculatePseudoR2"),
                columns=list(
                    list(
                        `name`="Measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="Original", 
                        `title`="Original System", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="New", 
                        `title`="New System", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Improvement", 
                        `title`="Improvement", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="decisionCurvesExplanation",
                title="Understanding Decision Curve Analysis",
                visible="(showDecisionCurves && showExplanations)",
                clearWith=list(
                    "showDecisionCurves")))
            self$add(jmvcore::Image$new(
                options=options,
                name="decisionCurves",
                title="Decision Curves",
                width=700,
                height=500,
                renderFun=".plotDecisionCurves",
                visible="(showDecisionCurves)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showDecisionCurves",
                    "performDCA")))
            self$add(jmvcore::Table$new(
                options=options,
                name="bootstrapResults",
                title="Bootstrap Validation Results",
                visible="(performBootstrap)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performBootstrap",
                    "bootstrapReps"),
                columns=list(
                    list(
                        `name`="Metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="Original", 
                        `title`="Original", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Bootstrap_Mean", 
                        `title`="Bootstrap Mean", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Bootstrap_CI_Lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Bootstrap_CI_Upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Optimism", 
                        `title`="Optimism", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Corrected", 
                        `title`="Corrected", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="willRogersAnalysisExplanation",
                title="Understanding Will Rogers Phenomenon Analysis",
                visible="(showWillRogersAnalysis && showExplanations)",
                clearWith=list(
                    "showWillRogersAnalysis")))
            self$add(jmvcore::Table$new(
                options=options,
                name="willRogersAnalysis",
                title="Will Rogers Phenomenon Analysis",
                visible="(showWillRogersAnalysis)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showWillRogersAnalysis"),
                columns=list(
                    list(
                        `name`="Stage", 
                        `title`="Stage", 
                        `type`="text"),
                    list(
                        `name`="Unchanged_N", 
                        `title`="Unchanged N", 
                        `type`="integer"),
                    list(
                        `name`="Unchanged_Median", 
                        `title`="Unchanged Median", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Migrated_N", 
                        `title`="Migrated N", 
                        `type`="integer"),
                    list(
                        `name`="Migrated_Median", 
                        `title`="Migrated Median", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="likelihoodTestsExplanation",
                title="Understanding Likelihood Ratio Tests",
                visible="(performLikelihoodTests && showExplanations)",
                clearWith=list(
                    "performLikelihoodTests")))
            self$add(jmvcore::Table$new(
                options=options,
                name="likelihoodTests",
                title="Likelihood Ratio Tests",
                visible="(performLikelihoodTests)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performLikelihoodTests"),
                columns=list(
                    list(
                        `name`="Test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="Chi_Square", 
                        `title`="Chi-Square", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="homogeneityTestsExplanation",
                title="Understanding Stage Homogeneity Tests",
                visible="(performHomogeneityTests && showExplanations)",
                clearWith=list(
                    "performHomogeneityTests")))
            self$add(jmvcore::Table$new(
                options=options,
                name="homogeneityTests",
                title="Stage Homogeneity Tests",
                visible="(performHomogeneityTests)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performHomogeneityTests"),
                columns=list(
                    list(
                        `name`="Stage", 
                        `title`="Stage", 
                        `type`="text"),
                    list(
                        `name`="Test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="Statistic", 
                        `title`="Statistic", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalInterpretationExplanation",
                title="Understanding Clinical Interpretation Guide",
                visible="(showClinicalInterpretation && showExplanations)",
                clearWith=list(
                    "showClinicalInterpretation")))
            self$add(jmvcore::Table$new(
                options=options,
                name="clinicalInterpretation",
                title="Clinical Interpretation",
                visible="(showClinicalInterpretation)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showClinicalInterpretation",
                    "cancerType"),
                columns=list(
                    list(
                        `name`="Metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="Value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="Interpretation", 
                        `title`="Interpretation", 
                        `type`="text"),
                    list(
                        `name`="Recommendation", 
                        `title`="Recommendation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="executiveSummaryExplanation",
                title="Understanding the Executive Summary",
                visible="(generateExecutiveSummary && showExplanations)",
                clearWith=list(
                    "generateExecutiveSummary")))
            self$add(jmvcore::Table$new(
                options=options,
                name="executiveSummary",
                title="Executive Summary",
                visible="(generateExecutiveSummary)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "generateExecutiveSummary"),
                columns=list(
                    list(
                        `name`="Category", 
                        `title`="Category", 
                        `type`="text"),
                    list(
                        `name`="Finding", 
                        `title`="Finding", 
                        `type`="text"),
                    list(
                        `name`="Evidence", 
                        `title`="Evidence", 
                        `type`="text"),
                    list(
                        `name`="Strength", 
                        `title`="Strength", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="statisticalSummaryExplanation",
                title="Understanding the Statistical Summary",
                visible="(showStatisticalSummary && showExplanations)",
                clearWith=list(
                    "showStatisticalSummary")))
            self$add(jmvcore::Table$new(
                options=options,
                name="statisticalSummary",
                title="Statistical Summary",
                visible="(showStatisticalSummary)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showStatisticalSummary"),
                columns=list(
                    list(
                        `name`="Method", 
                        `title`="Method", 
                        `type`="text"),
                    list(
                        `name`="Result", 
                        `title`="Result", 
                        `type`="text"),
                    list(
                        `name`="CI", 
                        `title`="95% CI", 
                        `type`="text"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="Significance", 
                        `title`="Significance", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="methodologyNotes",
                title="Methodology Notes",
                visible="(showMethodologyNotes)",
                clearWith=list(
                    "showMethodologyNotes")))
            self$add(jmvcore::Html$new(
                options=options,
                name="migrationHeatmapExplanation",
                title="Interpreting the Migration Heatmap",
                visible="(showMigrationHeatmap && showExplanations)",
                clearWith=list(
                    "showMigrationHeatmap")))
            self$add(jmvcore::Image$new(
                options=options,
                name="migrationHeatmap",
                title="Migration Heatmap",
                width=700,
                height=500,
                renderFun=".plotMigrationHeatmap",
                visible="(showMigrationHeatmap)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "showMigrationHeatmap")))
            self$add(jmvcore::Html$new(
                options=options,
                name="rocComparisonExplanation",
                title="Understanding Time-dependent ROC Curves",
                visible="(showROCComparison && showExplanations)",
                clearWith=list(
                    "showROCComparison")))
            self$add(jmvcore::Image$new(
                options=options,
                name="rocComparisonPlot",
                title="Time-dependent ROC Curves",
                width=800,
                height=600,
                renderFun=".plotROCComparison",
                visible="(showROCComparison)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showROCComparison",
                    "rocTimePoints")))
            self$add(jmvcore::Html$new(
                options=options,
                name="forestPlotExplanation",
                title="Understanding Hazard Ratio Forest Plots",
                visible="(showForestPlot && showExplanations)",
                clearWith=list(
                    "showForestPlot")))
            self$add(jmvcore::Image$new(
                options=options,
                name="forestPlot",
                title="Hazard Ratio Forest Plot",
                width=700,
                height=600,
                renderFun=".plotForest",
                visible="(showForestPlot)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showForestPlot")))
            self$add(jmvcore::Html$new(
                options=options,
                name="calibrationAnalysisExplanation",
                title="Understanding Calibration Analysis",
                visible="(performCalibration && showExplanations)",
                clearWith=list(
                    "performCalibration")))
            self$add(jmvcore::Table$new(
                options=options,
                name="calibrationAnalysis",
                title="Calibration Analysis",
                visible="(performCalibration)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "performCalibration"),
                columns=list(
                    list(
                        `name`="Model", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="Hosmer_Lemeshow_Chi2", 
                        `title`="H-L Chi\u00B2", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Hosmer_Lemeshow_df", 
                        `title`="H-L df", 
                        `type`="integer"),
                    list(
                        `name`="Hosmer_Lemeshow_p", 
                        `title`="H-L p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="Calibration_Slope", 
                        `title`="Calibration Slope", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Calibration_Intercept", 
                        `title`="Calibration Intercept", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="C_Slope_CI_Lower", 
                        `title`="Slope 95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="C_Slope_CI_Upper", 
                        `title`="Slope 95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="Interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="calibrationPlotsExplanation",
                title="Understanding Calibration Plots",
                visible="(showCalibrationPlots && showExplanations)",
                clearWith=list(
                    "showCalibrationPlots")))
            self$add(jmvcore::Image$new(
                options=options,
                name="calibrationPlots",
                title="Calibration Plots",
                width=800,
                height=400,
                renderFun=".plotCalibration",
                visible="(showCalibrationPlots)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showCalibrationPlots",
                    "performCalibration")))
            self$add(jmvcore::Html$new(
                options=options,
                name="survivalCurvesExplanation",
                title="Understanding Survival Curves Comparison",
                visible="(showSurvivalCurves && showExplanations)",
                clearWith=list(
                    "showSurvivalCurves")))
            self$add(jmvcore::Image$new(
                options=options,
                name="survivalCurves",
                title="Survival Curves by Stage",
                width=900,
                height=700,
                renderFun=".plotSurvivalCurves",
                visible="(showSurvivalCurves)",
                clearWith=list(
                    "oldStage",
                    "newStage",
                    "survivalTime",
                    "event",
                    "eventLevel",
                    "showSurvivalCurves",
                    "survivalPlotType",
                    "showConfidenceIntervals",
                    "showRiskTables",
                    "plotTimeRange")))}))

stagemigrationBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "stagemigrationBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "stagemigration",
                version = c(0,0,3),
                options = options,
                results = stagemigrationResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Advanced TNM Stage Migration Analysis
#'
#' Comprehensive analysis for validating TNM staging system improvements using 
#' state-of-the-art  statistical methods. This analysis provides pathologists 
#' with robust tools to evaluate whether  a new staging system provides 
#' superior prognostic discrimination compared to existing systems.
#' Includes advanced metrics: Net Reclassification Improvement (NRI), 
#' Integrated Discrimination  Improvement (IDI), time-dependent ROC analysis, 
#' decision curve analysis, bootstrap validation,  and comprehensive clinical 
#' interpretation guidance.
#'
#' @examples
#' \donttest{
#' # Example analyzing TNM staging system migration:
#' # stagemigration(
#' #   data = cancer_cohort,
#' #   oldStage = "tnm7_stage",
#' #   newStage = "tnm8_stage",
#' #   survivalTime = "os_months",
#' #   event = "death_status",
#' #   eventLevel = "Dead",
#' #   analysisType = "comprehensive",
#' #   calculateNRI = TRUE,
#' #   calculateIDI = TRUE,
#' #   performBootstrap = TRUE,
#' #   bootstrapReps = 1000
#' # )
#'}
#' @param data The dataset containing staging and survival information for TNM
#'   validation analysis.
#' @param oldStage The original staging variable (e.g., TNM 7th edition, AJCC
#'   7th edition). Should be coded as ordered factor with appropriate stage
#'   levels.
#' @param newStage The proposed new staging variable (e.g., TNM 8th edition,
#'   revised staging). Should use the same coding structure as the original
#'   staging system.
#' @param survivalTime Time to event or censoring in consistent units (months
#'   recommended). For overall survival analysis, use time from diagnosis to
#'   death or last follow-up.
#' @param event Event indicator (1 = event occurred, 0 = censored) or factor
#'   with event levels. For overall survival, event = death from any cause.
#' @param eventLevel The level indicating event occurrence when using factor
#'   variables.
#' @param analysisType Determines the scope of statistical analysis performed.
#'   Comprehensive analysis includes all available methods for thorough staging
#'   system validation.
#' @param confidenceLevel Confidence level for all confidence intervals and
#'   hypothesis tests.
#' @param calculateNRI Calculate Net Reclassification Improvement to quantify
#'   improvement in  risk classification between staging systems. Essential for
#'   staging validation.
#' @param nriTimePoints Comma-separated time points for NRI calculation (e.g.,
#'   "12, 24, 60" for  1, 2, and 5-year survival). Use clinically relevant time
#'   points.
#' @param calculateIDI Calculate Integrated Discrimination Improvement to
#'   measure improvement  in risk prediction accuracy between staging systems.
#' @param performROCAnalysis Perform time-dependent ROC analysis to compare
#'   discriminative ability of staging systems over time.
#' @param rocTimePoints Time points for ROC analysis. Should include
#'   clinically important survival milestones for the specific cancer type.
#' @param performDCA Perform Decision Curve Analysis to assess clinical
#'   utility and net benefit of the new staging system for clinical decision
#'   making.
#' @param performCalibration Assess calibration of risk predictions from both
#'   staging systems. Important for validating accuracy of survival predictions.
#' @param performBootstrap Perform bootstrap validation with optimism
#'   correction to assess internal validity of results. Recommended for all
#'   staging validation studies.
#' @param bootstrapReps Number of bootstrap repetitions for internal
#'   validation.  1000 repetitions recommended for stable results.
#' @param performCrossValidation Perform k-fold cross-validation for
#'   additional validation. Computationally intensive but provides robust
#'   validation.
#' @param cvFolds Number of folds for cross-validation when enabled.
#' @param clinicalSignificanceThreshold Minimum improvement in C-index
#'   considered clinically significant. Default 0.02 based on oncology
#'   literature recommendations.
#' @param nriClinicalThreshold Minimum NRI improvement considered clinically
#'   meaningful. Default 0.20 (20\% net reclassification improvement).
#' @param performHomogeneityTests Test homogeneity within stages and monotonic
#'   trend across stages. Essential for validating stage ordering and grouping.
#' @param performTrendTests Test for monotonic trend in survival across stage
#'   levels. Validates that higher stages consistently have worse prognosis.
#' @param performLikelihoodTests Perform formal likelihood ratio tests
#'   comparing nested staging models. Provides statistical significance testing
#'   for staging improvement.
#' @param calculatePseudoR2 Calculate multiple pseudo R-squared measures for
#'   model comparison (Nagelkerke, McFadden, Cox-Snell).
#' @param showMigrationOverview Display overview table showing the fundamental
#'   migration statistics including: total number of patients, number and
#'   percentage of patients who migrated stages, direction of migration
#'   (upstaged vs downstaged), and net migration effect. This is the essential
#'   first table for understanding the overall impact of the new staging system.
#' @param showMigrationSummary Display statistical summary of migration
#'   patterns including overall migration rate and formal statistical tests.
#'   Shows Chi-square test results for independence and Fisher's exact test
#'   p-values to determine if the migration patterns are statistically
#'   significant. Essential for validating whether observed changes are due to
#'   genuine staging improvements or random variation.
#' @param showStageDistribution Display side-by-side comparison of how
#'   patients are distributed across stages in both the original and new staging
#'   systems. Shows the count and percentage of patients in each stage, along
#'   with the net change. This helps identify which stages are gaining or losing
#'   patients and whether the new system creates better separation between
#'   prognostic groups.
#' @param showMigrationMatrix Display detailed cross-tabulation matrix showing
#'   exactly how patients moved between stages. Rows represent the original
#'   staging system and columns represent the new staging system. Diagonal
#'   values indicate patients who remained in the same stage, while off-diagonal
#'   values show stage migrations. This is essential for understanding the
#'   specific migration patterns and identifying which stages are most affected
#'   by the new criteria.
#' @param showStatisticalComparison Display table with C-index comparisons and
#'   other statistical metrics.
#' @param showConcordanceComparison Display detailed concordance comparison
#'   between staging systems.
#' @param showMigrationHeatmap Display a color-coded heatmap visualization of
#'   the migration matrix.  Darker colors indicate more patients, with the
#'   diagonal showing patients  who remained in the same stage. This visual
#'   representation makes it easy  to identify migration patterns at a glance -
#'   upstaging appears above the  diagonal, downstaging below. Essential for
#'   presentations and publications.
#' @param showROCComparison Display time-dependent ROC curves comparing
#'   staging systems.
#' @param showCalibrationPlots Display calibration plots for both staging
#'   systems.
#' @param showDecisionCurves Display decision curves showing net benefit of
#'   staging systems.
#' @param showForestPlot Display forest plot with stage-specific hazard ratios
#'   and confidence intervals.
#' @param showWillRogersAnalysis Detailed analysis of Will Rogers phenomenon
#'   with survival comparisons between migrated and non-migrated patients within
#'   stages.
#' @param showSurvivalCurves Display survival curves comparing the staging
#'   systems.
#' @param survivalPlotType Controls display of survival curves for staging
#'   system comparison.
#' @param showConfidenceIntervals Display confidence intervals around survival
#'   curves and other estimates.
#' @param showRiskTables Display at-risk tables below survival curves.
#' @param plotTimeRange Maximum time for survival plots. Use "auto" for
#'   automatic range or specify maximum months (e.g., "60" for 5-year
#'   follow-up).
#' @param showClinicalInterpretation Display comprehensive clinical
#'   interpretation of all statistical results with guidance for staging system
#'   adoption decisions.
#' @param showStatisticalSummary Display comprehensive table summarizing all
#'   statistical comparisons.
#' @param showMethodologyNotes Display detailed notes on statistical methods
#'   used and their interpretation.
#' @param includeEffectSizes Calculate and display effect sizes for all
#'   comparisons to assess practical significance beyond statistical
#'   significance.
#' @param generateExecutiveSummary Generate executive summary with key
#'   findings and recommendations for clinical and research stakeholders.
#' @param cancerType Optional cancer type specification for customized
#'   thresholds and  interpretation guidelines based on cancer-specific
#'   literature.
#' @param useOptimismCorrection Apply optimism correction to performance
#'   metrics using bootstrap validation to avoid overly optimistic estimates.
#' @param enableMultifactorialAnalysis Enable advanced multifactorial stage
#'   migration analysis that includes additional covariates in the comparison.
#'   This allows for adjusted comparisons between staging systems after
#'   accounting for other prognostic factors.
#' @param continuousCovariates Continuous variables to include as covariates
#'   in the multifactorial analysis (e.g., age, tumor size, biomarker levels).
#'   These will be included in Cox regression models for both staging systems.
#' @param categoricalCovariates Categorical variables to include as covariates
#'   in the multifactorial analysis (e.g., sex, histology, treatment type).
#'   These will be included in Cox regression models for both staging systems.
#' @param multifactorialComparisonType Type of multifactorial comparison to
#'   perform. Comprehensive includes all methods for thorough evaluation of
#'   staging systems in the context of other prognostic factors.
#' @param baselineModel Baseline model for multifactorial comparisons. This
#'   determines the reference model against which staging systems are compared.
#' @param performInteractionTests Test for interactions between staging
#'   systems and covariates. This helps identify if the staging system
#'   performance varies across different patient subgroups.
#' @param stratifiedAnalysis Perform stratified analysis by categorical
#'   covariates to evaluate staging system performance within subgroups.
#' @param showMultifactorialTables Display detailed tables showing
#'   multifactorial model results, including adjusted hazard ratios and model
#'   comparison statistics.
#' @param showAdjustedCIndexComparison Display comparison of C-indices for
#'   staging systems adjusted for covariates. This shows the discriminative
#'   ability of each staging system after accounting for other prognostic
#'   factors.
#' @param showNestedModelTests Display likelihood ratio tests comparing nested
#'   models to formally test the added value of each staging system over the
#'   baseline model.
#' @param showStepwiseResults Display results of stepwise model selection
#'   showing which variables (including staging systems) are selected in the
#'   final model.
#' @param showExplanations Include detailed explanations for results.
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$welcomeMessage} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$mydataview} \tab \tab \tab \tab \tab a preformatted \cr
#'   \code{results$mydataview2} \tab \tab \tab \tab \tab a preformatted \cr
#'   \code{results$migrationOverviewExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$migrationOverview} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$migrationMatrixExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$migrationMatrix} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stageDistributionExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$stageDistribution} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$migrationSummaryExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$migrationSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$statisticalComparisonExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$statisticalComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$concordanceComparisonExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$concordanceComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$nriResultsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$nriResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$idiResultsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$idiResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$multifactorialAnalysisExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$multifactorialResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$multifactorialResultsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$adjustedCIndexComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$adjustedCIndexComparisonExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$nestedModelTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$nestedModelTestsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$stepwiseResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stepwiseResultsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$interactionTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$interactionTestsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$stratifiedAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stratifiedAnalysisExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$rocAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$dcaResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$pseudoR2ResultsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$pseudoR2Results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$decisionCurvesExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$decisionCurves} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$bootstrapResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$willRogersAnalysisExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$willRogersAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$likelihoodTestsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$likelihoodTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$homogeneityTestsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$homogeneityTests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$clinicalInterpretationExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$clinicalInterpretation} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$executiveSummaryExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$executiveSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$statisticalSummaryExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$statisticalSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$methodologyNotes} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$migrationHeatmapExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$migrationHeatmap} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$rocComparisonExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$rocComparisonPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$forestPlotExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$forestPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$calibrationAnalysisExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$calibrationAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$calibrationPlotsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$calibrationPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$survivalCurvesExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$survivalCurves} \tab \tab \tab \tab \tab an image \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$migrationOverview$asDF}
#'
#' \code{as.data.frame(results$migrationOverview)}
#'
#' @export
stagemigration <- function(
    data,
    oldStage,
    newStage,
    survivalTime,
    event,
    eventLevel,
    analysisType = "comprehensive",
    confidenceLevel = 0.95,
    calculateNRI = FALSE,
    nriTimePoints = "12, 24, 60",
    calculateIDI = FALSE,
    performROCAnalysis = FALSE,
    rocTimePoints = "12, 24, 36, 60",
    performDCA = FALSE,
    performCalibration = FALSE,
    performBootstrap = FALSE,
    bootstrapReps = 1000,
    performCrossValidation = FALSE,
    cvFolds = 5,
    clinicalSignificanceThreshold = 0.02,
    nriClinicalThreshold = 0.2,
    performHomogeneityTests = FALSE,
    performTrendTests = FALSE,
    performLikelihoodTests = FALSE,
    calculatePseudoR2 = FALSE,
    showMigrationOverview = TRUE,
    showMigrationSummary = TRUE,
    showStageDistribution = TRUE,
    showMigrationMatrix = TRUE,
    showStatisticalComparison = TRUE,
    showConcordanceComparison = TRUE,
    showMigrationHeatmap = FALSE,
    showROCComparison = FALSE,
    showCalibrationPlots = FALSE,
    showDecisionCurves = FALSE,
    showForestPlot = FALSE,
    showWillRogersAnalysis = FALSE,
    showSurvivalCurves = FALSE,
    survivalPlotType = "separate",
    showConfidenceIntervals = FALSE,
    showRiskTables = FALSE,
    plotTimeRange = "auto",
    showClinicalInterpretation = FALSE,
    showStatisticalSummary = FALSE,
    showMethodologyNotes = FALSE,
    includeEffectSizes = FALSE,
    generateExecutiveSummary = FALSE,
    cancerType = "general",
    useOptimismCorrection = FALSE,
    enableMultifactorialAnalysis = FALSE,
    continuousCovariates = NULL,
    categoricalCovariates = NULL,
    multifactorialComparisonType = "comprehensive",
    baselineModel = "covariates_only",
    performInteractionTests = FALSE,
    stratifiedAnalysis = FALSE,
    showMultifactorialTables = FALSE,
    showAdjustedCIndexComparison = FALSE,
    showNestedModelTests = FALSE,
    showStepwiseResults = FALSE,
    showExplanations = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("stagemigration requires jmvcore to be installed (restart may be required)")

    if ( ! missing(oldStage)) oldStage <- jmvcore::resolveQuo(jmvcore::enquo(oldStage))
    if ( ! missing(newStage)) newStage <- jmvcore::resolveQuo(jmvcore::enquo(newStage))
    if ( ! missing(survivalTime)) survivalTime <- jmvcore::resolveQuo(jmvcore::enquo(survivalTime))
    if ( ! missing(event)) event <- jmvcore::resolveQuo(jmvcore::enquo(event))
    if ( ! missing(continuousCovariates)) continuousCovariates <- jmvcore::resolveQuo(jmvcore::enquo(continuousCovariates))
    if ( ! missing(categoricalCovariates)) categoricalCovariates <- jmvcore::resolveQuo(jmvcore::enquo(categoricalCovariates))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(oldStage), oldStage, NULL),
            `if`( ! missing(newStage), newStage, NULL),
            `if`( ! missing(survivalTime), survivalTime, NULL),
            `if`( ! missing(event), event, NULL),
            `if`( ! missing(continuousCovariates), continuousCovariates, NULL),
            `if`( ! missing(categoricalCovariates), categoricalCovariates, NULL))

    for (v in oldStage) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in newStage) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in categoricalCovariates) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- stagemigrationOptions$new(
        oldStage = oldStage,
        newStage = newStage,
        survivalTime = survivalTime,
        event = event,
        eventLevel = eventLevel,
        analysisType = analysisType,
        confidenceLevel = confidenceLevel,
        calculateNRI = calculateNRI,
        nriTimePoints = nriTimePoints,
        calculateIDI = calculateIDI,
        performROCAnalysis = performROCAnalysis,
        rocTimePoints = rocTimePoints,
        performDCA = performDCA,
        performCalibration = performCalibration,
        performBootstrap = performBootstrap,
        bootstrapReps = bootstrapReps,
        performCrossValidation = performCrossValidation,
        cvFolds = cvFolds,
        clinicalSignificanceThreshold = clinicalSignificanceThreshold,
        nriClinicalThreshold = nriClinicalThreshold,
        performHomogeneityTests = performHomogeneityTests,
        performTrendTests = performTrendTests,
        performLikelihoodTests = performLikelihoodTests,
        calculatePseudoR2 = calculatePseudoR2,
        showMigrationOverview = showMigrationOverview,
        showMigrationSummary = showMigrationSummary,
        showStageDistribution = showStageDistribution,
        showMigrationMatrix = showMigrationMatrix,
        showStatisticalComparison = showStatisticalComparison,
        showConcordanceComparison = showConcordanceComparison,
        showMigrationHeatmap = showMigrationHeatmap,
        showROCComparison = showROCComparison,
        showCalibrationPlots = showCalibrationPlots,
        showDecisionCurves = showDecisionCurves,
        showForestPlot = showForestPlot,
        showWillRogersAnalysis = showWillRogersAnalysis,
        showSurvivalCurves = showSurvivalCurves,
        survivalPlotType = survivalPlotType,
        showConfidenceIntervals = showConfidenceIntervals,
        showRiskTables = showRiskTables,
        plotTimeRange = plotTimeRange,
        showClinicalInterpretation = showClinicalInterpretation,
        showStatisticalSummary = showStatisticalSummary,
        showMethodologyNotes = showMethodologyNotes,
        includeEffectSizes = includeEffectSizes,
        generateExecutiveSummary = generateExecutiveSummary,
        cancerType = cancerType,
        useOptimismCorrection = useOptimismCorrection,
        enableMultifactorialAnalysis = enableMultifactorialAnalysis,
        continuousCovariates = continuousCovariates,
        categoricalCovariates = categoricalCovariates,
        multifactorialComparisonType = multifactorialComparisonType,
        baselineModel = baselineModel,
        performInteractionTests = performInteractionTests,
        stratifiedAnalysis = stratifiedAnalysis,
        showMultifactorialTables = showMultifactorialTables,
        showAdjustedCIndexComparison = showAdjustedCIndexComparison,
        showNestedModelTests = showNestedModelTests,
        showStepwiseResults = showStepwiseResults,
        showExplanations = showExplanations)

    analysis <- stagemigrationClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

