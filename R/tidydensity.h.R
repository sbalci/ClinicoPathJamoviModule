
# This file is automatically generated, you probably don't want to edit this

tidydensityOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "tidydensityOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            distribution_type = "normal",
            n_observations = 100,
            n_simulations = 1,
            normal_mean = 0,
            normal_sd = 1,
            beta_shape1 = 2,
            beta_shape2 = 5,
            gamma_shape = 2,
            gamma_scale = 1,
            exponential_rate = 1,
            uniform_min = 0,
            uniform_max = 1,
            chisq_df = 3,
            t_df = 5,
            f_df1 = 5,
            f_df2 = 10,
            binomial_size = 10,
            binomial_prob = 0.5,
            poisson_lambda = 3,
            weibull_shape = 2,
            weibull_scale = 1,
            lognormal_meanlog = 0,
            lognormal_sdlog = 1,
            logistic_location = 0,
            logistic_scale = 1,
            cauchy_location = 0,
            cauchy_scale = 1,
            plot_type = "density",
            plot_enhancements = FALSE,
            show_statistics = TRUE,
            show_summary_table = TRUE,
            show_parameter_info = TRUE,
            show_interpretation = TRUE,
            economist_theme = TRUE,
            economist_colors = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="tidydensity",
                requiresData=TRUE,
                ...)

            private$..distribution_type <- jmvcore::OptionList$new(
                "distribution_type",
                distribution_type,
                options=list(
                    "normal",
                    "beta",
                    "gamma",
                    "exponential",
                    "uniform",
                    "chisquare",
                    "t",
                    "f",
                    "binomial",
                    "poisson",
                    "weibull",
                    "lognormal",
                    "logistic",
                    "cauchy"),
                default="normal")
            private$..n_observations <- jmvcore::OptionNumber$new(
                "n_observations",
                n_observations,
                min=10,
                max=10000,
                default=100)
            private$..n_simulations <- jmvcore::OptionNumber$new(
                "n_simulations",
                n_simulations,
                min=1,
                max=20,
                default=1)
            private$..normal_mean <- jmvcore::OptionNumber$new(
                "normal_mean",
                normal_mean,
                default=0)
            private$..normal_sd <- jmvcore::OptionNumber$new(
                "normal_sd",
                normal_sd,
                min=0.01,
                default=1)
            private$..beta_shape1 <- jmvcore::OptionNumber$new(
                "beta_shape1",
                beta_shape1,
                min=0.1,
                default=2)
            private$..beta_shape2 <- jmvcore::OptionNumber$new(
                "beta_shape2",
                beta_shape2,
                min=0.1,
                default=5)
            private$..gamma_shape <- jmvcore::OptionNumber$new(
                "gamma_shape",
                gamma_shape,
                min=0.1,
                default=2)
            private$..gamma_scale <- jmvcore::OptionNumber$new(
                "gamma_scale",
                gamma_scale,
                min=0.1,
                default=1)
            private$..exponential_rate <- jmvcore::OptionNumber$new(
                "exponential_rate",
                exponential_rate,
                min=0.01,
                default=1)
            private$..uniform_min <- jmvcore::OptionNumber$new(
                "uniform_min",
                uniform_min,
                default=0)
            private$..uniform_max <- jmvcore::OptionNumber$new(
                "uniform_max",
                uniform_max,
                default=1)
            private$..chisq_df <- jmvcore::OptionNumber$new(
                "chisq_df",
                chisq_df,
                min=1,
                default=3)
            private$..t_df <- jmvcore::OptionNumber$new(
                "t_df",
                t_df,
                min=1,
                default=5)
            private$..f_df1 <- jmvcore::OptionNumber$new(
                "f_df1",
                f_df1,
                min=1,
                default=5)
            private$..f_df2 <- jmvcore::OptionNumber$new(
                "f_df2",
                f_df2,
                min=1,
                default=10)
            private$..binomial_size <- jmvcore::OptionNumber$new(
                "binomial_size",
                binomial_size,
                min=1,
                default=10)
            private$..binomial_prob <- jmvcore::OptionNumber$new(
                "binomial_prob",
                binomial_prob,
                min=0.01,
                max=0.99,
                default=0.5)
            private$..poisson_lambda <- jmvcore::OptionNumber$new(
                "poisson_lambda",
                poisson_lambda,
                min=0.1,
                default=3)
            private$..weibull_shape <- jmvcore::OptionNumber$new(
                "weibull_shape",
                weibull_shape,
                min=0.1,
                default=2)
            private$..weibull_scale <- jmvcore::OptionNumber$new(
                "weibull_scale",
                weibull_scale,
                min=0.1,
                default=1)
            private$..lognormal_meanlog <- jmvcore::OptionNumber$new(
                "lognormal_meanlog",
                lognormal_meanlog,
                default=0)
            private$..lognormal_sdlog <- jmvcore::OptionNumber$new(
                "lognormal_sdlog",
                lognormal_sdlog,
                min=0.01,
                default=1)
            private$..logistic_location <- jmvcore::OptionNumber$new(
                "logistic_location",
                logistic_location,
                default=0)
            private$..logistic_scale <- jmvcore::OptionNumber$new(
                "logistic_scale",
                logistic_scale,
                min=0.01,
                default=1)
            private$..cauchy_location <- jmvcore::OptionNumber$new(
                "cauchy_location",
                cauchy_location,
                default=0)
            private$..cauchy_scale <- jmvcore::OptionNumber$new(
                "cauchy_scale",
                cauchy_scale,
                min=0.01,
                default=1)
            private$..plot_type <- jmvcore::OptionList$new(
                "plot_type",
                plot_type,
                options=list(
                    "density",
                    "quantile",
                    "probability",
                    "qq",
                    "economist"),
                default="density")
            private$..plot_enhancements <- jmvcore::OptionBool$new(
                "plot_enhancements",
                plot_enhancements,
                default=FALSE)
            private$..show_statistics <- jmvcore::OptionBool$new(
                "show_statistics",
                show_statistics,
                default=TRUE)
            private$..show_summary_table <- jmvcore::OptionBool$new(
                "show_summary_table",
                show_summary_table,
                default=TRUE)
            private$..show_parameter_info <- jmvcore::OptionBool$new(
                "show_parameter_info",
                show_parameter_info,
                default=TRUE)
            private$..show_interpretation <- jmvcore::OptionBool$new(
                "show_interpretation",
                show_interpretation,
                default=TRUE)
            private$..economist_theme <- jmvcore::OptionBool$new(
                "economist_theme",
                economist_theme,
                default=TRUE)
            private$..economist_colors <- jmvcore::OptionBool$new(
                "economist_colors",
                economist_colors,
                default=TRUE)

            self$.addOption(private$..distribution_type)
            self$.addOption(private$..n_observations)
            self$.addOption(private$..n_simulations)
            self$.addOption(private$..normal_mean)
            self$.addOption(private$..normal_sd)
            self$.addOption(private$..beta_shape1)
            self$.addOption(private$..beta_shape2)
            self$.addOption(private$..gamma_shape)
            self$.addOption(private$..gamma_scale)
            self$.addOption(private$..exponential_rate)
            self$.addOption(private$..uniform_min)
            self$.addOption(private$..uniform_max)
            self$.addOption(private$..chisq_df)
            self$.addOption(private$..t_df)
            self$.addOption(private$..f_df1)
            self$.addOption(private$..f_df2)
            self$.addOption(private$..binomial_size)
            self$.addOption(private$..binomial_prob)
            self$.addOption(private$..poisson_lambda)
            self$.addOption(private$..weibull_shape)
            self$.addOption(private$..weibull_scale)
            self$.addOption(private$..lognormal_meanlog)
            self$.addOption(private$..lognormal_sdlog)
            self$.addOption(private$..logistic_location)
            self$.addOption(private$..logistic_scale)
            self$.addOption(private$..cauchy_location)
            self$.addOption(private$..cauchy_scale)
            self$.addOption(private$..plot_type)
            self$.addOption(private$..plot_enhancements)
            self$.addOption(private$..show_statistics)
            self$.addOption(private$..show_summary_table)
            self$.addOption(private$..show_parameter_info)
            self$.addOption(private$..show_interpretation)
            self$.addOption(private$..economist_theme)
            self$.addOption(private$..economist_colors)
        }),
    active = list(
        distribution_type = function() private$..distribution_type$value,
        n_observations = function() private$..n_observations$value,
        n_simulations = function() private$..n_simulations$value,
        normal_mean = function() private$..normal_mean$value,
        normal_sd = function() private$..normal_sd$value,
        beta_shape1 = function() private$..beta_shape1$value,
        beta_shape2 = function() private$..beta_shape2$value,
        gamma_shape = function() private$..gamma_shape$value,
        gamma_scale = function() private$..gamma_scale$value,
        exponential_rate = function() private$..exponential_rate$value,
        uniform_min = function() private$..uniform_min$value,
        uniform_max = function() private$..uniform_max$value,
        chisq_df = function() private$..chisq_df$value,
        t_df = function() private$..t_df$value,
        f_df1 = function() private$..f_df1$value,
        f_df2 = function() private$..f_df2$value,
        binomial_size = function() private$..binomial_size$value,
        binomial_prob = function() private$..binomial_prob$value,
        poisson_lambda = function() private$..poisson_lambda$value,
        weibull_shape = function() private$..weibull_shape$value,
        weibull_scale = function() private$..weibull_scale$value,
        lognormal_meanlog = function() private$..lognormal_meanlog$value,
        lognormal_sdlog = function() private$..lognormal_sdlog$value,
        logistic_location = function() private$..logistic_location$value,
        logistic_scale = function() private$..logistic_scale$value,
        cauchy_location = function() private$..cauchy_location$value,
        cauchy_scale = function() private$..cauchy_scale$value,
        plot_type = function() private$..plot_type$value,
        plot_enhancements = function() private$..plot_enhancements$value,
        show_statistics = function() private$..show_statistics$value,
        show_summary_table = function() private$..show_summary_table$value,
        show_parameter_info = function() private$..show_parameter_info$value,
        show_interpretation = function() private$..show_interpretation$value,
        economist_theme = function() private$..economist_theme$value,
        economist_colors = function() private$..economist_colors$value),
    private = list(
        ..distribution_type = NA,
        ..n_observations = NA,
        ..n_simulations = NA,
        ..normal_mean = NA,
        ..normal_sd = NA,
        ..beta_shape1 = NA,
        ..beta_shape2 = NA,
        ..gamma_shape = NA,
        ..gamma_scale = NA,
        ..exponential_rate = NA,
        ..uniform_min = NA,
        ..uniform_max = NA,
        ..chisq_df = NA,
        ..t_df = NA,
        ..f_df1 = NA,
        ..f_df2 = NA,
        ..binomial_size = NA,
        ..binomial_prob = NA,
        ..poisson_lambda = NA,
        ..weibull_shape = NA,
        ..weibull_scale = NA,
        ..lognormal_meanlog = NA,
        ..lognormal_sdlog = NA,
        ..logistic_location = NA,
        ..logistic_scale = NA,
        ..cauchy_location = NA,
        ..cauchy_scale = NA,
        ..plot_type = NA,
        ..plot_enhancements = NA,
        ..show_statistics = NA,
        ..show_summary_table = NA,
        ..show_parameter_info = NA,
        ..show_interpretation = NA,
        ..economist_theme = NA,
        ..economist_colors = NA)
)

tidydensityResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "tidydensityResults",
    inherit = jmvcore::Group,
    active = list(
        todo = function() private$.items[["todo"]],
        main_plot = function() private$.items[["main_plot"]],
        distribution_statistics = function() private$.items[["distribution_statistics"]],
        summary_table = function() private$.items[["summary_table"]],
        parameter_info = function() private$.items[["parameter_info"]],
        interpretation = function() private$.items[["interpretation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Statistical Distribution Generator",
                refs=list(
                    "ClinicoPathJamoviModule",
                    "TidyDensity",
                    "stringr"))
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="Instructions",
                visible=FALSE))
            self$add(jmvcore::Image$new(
                options=options,
                name="main_plot",
                title="Distribution Visualization",
                width=800,
                height=600,
                renderFun=".plot",
                clearWith=list(
                    "distribution_type",
                    "n_observations",
                    "n_simulations",
                    "plot_type",
                    "plot_enhancements",
                    "normal_mean",
                    "normal_sd",
                    "beta_shape1",
                    "beta_shape2",
                    "gamma_shape",
                    "gamma_scale",
                    "exponential_rate",
                    "uniform_min",
                    "uniform_max",
                    "chisq_df",
                    "t_df",
                    "f_df1",
                    "f_df2",
                    "binomial_size",
                    "binomial_prob",
                    "poisson_lambda",
                    "weibull_shape",
                    "weibull_scale",
                    "lognormal_meanlog",
                    "lognormal_sdlog",
                    "logistic_location",
                    "logistic_scale",
                    "cauchy_location",
                    "cauchy_scale")))
            self$add(jmvcore::Html$new(
                options=options,
                name="distribution_statistics",
                title="Distribution Statistics",
                visible="(show_statistics)",
                clearWith=list(
                    "distribution_type",
                    "n_observations",
                    "n_simulations",
                    "normal_mean",
                    "normal_sd",
                    "beta_shape1",
                    "beta_shape2",
                    "gamma_shape",
                    "gamma_scale",
                    "exponential_rate",
                    "uniform_min",
                    "uniform_max",
                    "chisq_df",
                    "t_df",
                    "f_df1",
                    "f_df2",
                    "binomial_size",
                    "binomial_prob",
                    "poisson_lambda",
                    "weibull_shape",
                    "weibull_scale",
                    "lognormal_meanlog",
                    "lognormal_sdlog",
                    "logistic_location",
                    "logistic_scale",
                    "cauchy_location",
                    "cauchy_scale")))
            self$add(jmvcore::Html$new(
                options=options,
                name="summary_table",
                title="Summary Statistics Table",
                visible="(show_summary_table)",
                clearWith=list(
                    "distribution_type",
                    "n_observations",
                    "n_simulations",
                    "normal_mean",
                    "normal_sd",
                    "beta_shape1",
                    "beta_shape2",
                    "gamma_shape",
                    "gamma_scale",
                    "exponential_rate",
                    "uniform_min",
                    "uniform_max",
                    "chisq_df",
                    "t_df",
                    "f_df1",
                    "f_df2",
                    "binomial_size",
                    "binomial_prob",
                    "poisson_lambda",
                    "weibull_shape",
                    "weibull_scale",
                    "lognormal_meanlog",
                    "lognormal_sdlog",
                    "logistic_location",
                    "logistic_scale",
                    "cauchy_location",
                    "cauchy_scale")))
            self$add(jmvcore::Html$new(
                options=options,
                name="parameter_info",
                title="Distribution Parameters",
                visible="(show_parameter_info)",
                clearWith=list(
                    "distribution_type")))
            self$add(jmvcore::Html$new(
                options=options,
                name="interpretation",
                title="Usage Guide",
                visible="(show_interpretation)",
                clearWith=list(
                    "distribution_type")))}))

tidydensityBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "tidydensityBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "tidydensity",
                version = c(0,0,3),
                options = options,
                results = tidydensityResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Statistical Distribution Generator
#'
#' Statistical distribution generator and analyzer using TidyDensity package.
#' Generate random data from various statistical distributions with 
#' comprehensive 
#' visualization and analysis capabilities. Create density plots, quantile 
#' plots, 
#' probability plots, and Q-Q plots. Perfect for simulation studies, power 
#' analysis,
#' distribution comparison, and statistical education in clinical research.
#' 
#'
#' @examples
#' \donttest{
#' # Example:
#' # 1. Select distribution type (Normal, Gamma, Beta, etc.)
#' # 2. Configure distribution parameters (mean, sd, etc.)
#' # 3. Set number of observations and simulations
#' # 4. Choose visualization options and analysis type
#'}
#' @param data The data as a data frame.
#' @param distribution_type Type of statistical distribution to generate. Each
#'   distribution has specific parameters that can be configured.
#' @param n_observations Number of random observations to generate from the
#'   selected distribution.
#' @param n_simulations Number of simulation runs. Multiple simulations allow
#'   comparison of sampling variability.
#' @param normal_mean Mean parameter for Normal distribution.
#' @param normal_sd Standard deviation parameter for Normal distribution.
#' @param beta_shape1 First shape parameter for Beta distribution.
#' @param beta_shape2 Second shape parameter for Beta distribution.
#' @param gamma_shape Shape parameter for Gamma distribution.
#' @param gamma_scale Scale parameter for Gamma distribution.
#' @param exponential_rate Rate parameter for Exponential distribution.
#' @param uniform_min Minimum value for Uniform distribution.
#' @param uniform_max Maximum value for Uniform distribution.
#' @param chisq_df Degrees of freedom for Chi-Square distribution.
#' @param t_df Degrees of freedom for Student's t distribution.
#' @param f_df1 Numerator degrees of freedom for F distribution.
#' @param f_df2 Denominator degrees of freedom for F distribution.
#' @param binomial_size Number of trials for Binomial distribution.
#' @param binomial_prob Probability of success for Binomial distribution.
#' @param poisson_lambda Rate parameter for Poisson distribution.
#' @param weibull_shape Shape parameter for Weibull distribution.
#' @param weibull_scale Scale parameter for Weibull distribution.
#' @param lognormal_meanlog Mean of the logarithm for Log-Normal distribution.
#' @param lognormal_sdlog Standard deviation of the logarithm for Log-Normal
#'   distribution.
#' @param logistic_location Location parameter for Logistic distribution.
#' @param logistic_scale Scale parameter for Logistic distribution.
#' @param cauchy_location Location parameter for Cauchy distribution.
#' @param cauchy_scale Scale parameter for Cauchy distribution.
#' @param plot_type Type of visualization to generate for the distribution
#'   data.
#' @param plot_enhancements Add enhanced plot features like points, rug plots,
#'   and smooth lines.
#' @param show_statistics Display comprehensive statistics for the generated
#'   distribution.
#' @param show_summary_table Display summary table of generated data with key
#'   statistics.
#' @param show_parameter_info Display information about distribution
#'   parameters and their effects.
#' @param show_interpretation Display guidance on statistical distributions
#'   and their applications in clinical research.
#' @param economist_theme Apply The Economist's visual theme when using
#'   Economist-style plots.
#' @param economist_colors Apply The Economist's signature color scheme for
#'   distribution elements.
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$todo} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$main_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$distribution_statistics} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$summary_table} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$parameter_info} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' @export
tidydensity <- function(
    data,
    distribution_type = "normal",
    n_observations = 100,
    n_simulations = 1,
    normal_mean = 0,
    normal_sd = 1,
    beta_shape1 = 2,
    beta_shape2 = 5,
    gamma_shape = 2,
    gamma_scale = 1,
    exponential_rate = 1,
    uniform_min = 0,
    uniform_max = 1,
    chisq_df = 3,
    t_df = 5,
    f_df1 = 5,
    f_df2 = 10,
    binomial_size = 10,
    binomial_prob = 0.5,
    poisson_lambda = 3,
    weibull_shape = 2,
    weibull_scale = 1,
    lognormal_meanlog = 0,
    lognormal_sdlog = 1,
    logistic_location = 0,
    logistic_scale = 1,
    cauchy_location = 0,
    cauchy_scale = 1,
    plot_type = "density",
    plot_enhancements = FALSE,
    show_statistics = TRUE,
    show_summary_table = TRUE,
    show_parameter_info = TRUE,
    show_interpretation = TRUE,
    economist_theme = TRUE,
    economist_colors = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("tidydensity requires jmvcore to be installed (restart may be required)")

    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame())


    options <- tidydensityOptions$new(
        distribution_type = distribution_type,
        n_observations = n_observations,
        n_simulations = n_simulations,
        normal_mean = normal_mean,
        normal_sd = normal_sd,
        beta_shape1 = beta_shape1,
        beta_shape2 = beta_shape2,
        gamma_shape = gamma_shape,
        gamma_scale = gamma_scale,
        exponential_rate = exponential_rate,
        uniform_min = uniform_min,
        uniform_max = uniform_max,
        chisq_df = chisq_df,
        t_df = t_df,
        f_df1 = f_df1,
        f_df2 = f_df2,
        binomial_size = binomial_size,
        binomial_prob = binomial_prob,
        poisson_lambda = poisson_lambda,
        weibull_shape = weibull_shape,
        weibull_scale = weibull_scale,
        lognormal_meanlog = lognormal_meanlog,
        lognormal_sdlog = lognormal_sdlog,
        logistic_location = logistic_location,
        logistic_scale = logistic_scale,
        cauchy_location = cauchy_location,
        cauchy_scale = cauchy_scale,
        plot_type = plot_type,
        plot_enhancements = plot_enhancements,
        show_statistics = show_statistics,
        show_summary_table = show_summary_table,
        show_parameter_info = show_parameter_info,
        show_interpretation = show_interpretation,
        economist_theme = economist_theme,
        economist_colors = economist_colors)

    analysis <- tidydensityClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

