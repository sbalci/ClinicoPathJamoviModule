
# This file is automatically generated, you probably don't want to edit this

flexparametricadvancedOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "flexparametricadvancedOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            time = NULL,
            event = NULL,
            covariates = NULL,
            distribution = "weibull",
            baseline_splines = 3,
            time_varying_effects = NULL,
            spline_scale = "hazard",
            cure_model = FALSE,
            stratified_var = NULL,
            model_comparison = TRUE,
            goodness_of_fit = TRUE,
            prediction_times = "1, 2, 5, 10",
            confidence_level = 0.95,
            bootstrap_samples = 1000,
            extrapolation_time = 20,
            plot_survival = TRUE,
            plot_hazard = TRUE,
            plot_diagnostics = TRUE,
            export_predictions = FALSE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="flexparametricadvanced",
                requiresData=TRUE,
                ...)

            private$..time <- jmvcore::OptionVariable$new(
                "time",
                time,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..event <- jmvcore::OptionVariable$new(
                "event",
                event,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..covariates <- jmvcore::OptionVariables$new(
                "covariates",
                covariates,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..distribution <- jmvcore::OptionList$new(
                "distribution",
                distribution,
                options=list(
                    "weibull",
                    "exp",
                    "lnorm",
                    "llogis",
                    "gamma",
                    "gompertz",
                    "gengamma",
                    "spline"),
                default="weibull")
            private$..baseline_splines <- jmvcore::OptionNumber$new(
                "baseline_splines",
                baseline_splines,
                default=3,
                min=1,
                max=10)
            private$..time_varying_effects <- jmvcore::OptionVariables$new(
                "time_varying_effects",
                time_varying_effects,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..spline_scale <- jmvcore::OptionList$new(
                "spline_scale",
                spline_scale,
                options=list(
                    "hazard",
                    "odds",
                    "normal"),
                default="hazard")
            private$..cure_model <- jmvcore::OptionBool$new(
                "cure_model",
                cure_model,
                default=FALSE)
            private$..stratified_var <- jmvcore::OptionVariable$new(
                "stratified_var",
                stratified_var,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..model_comparison <- jmvcore::OptionBool$new(
                "model_comparison",
                model_comparison,
                default=TRUE)
            private$..goodness_of_fit <- jmvcore::OptionBool$new(
                "goodness_of_fit",
                goodness_of_fit,
                default=TRUE)
            private$..prediction_times <- jmvcore::OptionString$new(
                "prediction_times",
                prediction_times,
                default="1, 2, 5, 10")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.5,
                max=0.99)
            private$..bootstrap_samples <- jmvcore::OptionNumber$new(
                "bootstrap_samples",
                bootstrap_samples,
                default=1000,
                min=100,
                max=10000)
            private$..extrapolation_time <- jmvcore::OptionNumber$new(
                "extrapolation_time",
                extrapolation_time,
                default=20,
                min=1,
                max=50)
            private$..plot_survival <- jmvcore::OptionBool$new(
                "plot_survival",
                plot_survival,
                default=TRUE)
            private$..plot_hazard <- jmvcore::OptionBool$new(
                "plot_hazard",
                plot_hazard,
                default=TRUE)
            private$..plot_diagnostics <- jmvcore::OptionBool$new(
                "plot_diagnostics",
                plot_diagnostics,
                default=TRUE)
            private$..export_predictions <- jmvcore::OptionBool$new(
                "export_predictions",
                export_predictions,
                default=FALSE)

            self$.addOption(private$..time)
            self$.addOption(private$..event)
            self$.addOption(private$..covariates)
            self$.addOption(private$..distribution)
            self$.addOption(private$..baseline_splines)
            self$.addOption(private$..time_varying_effects)
            self$.addOption(private$..spline_scale)
            self$.addOption(private$..cure_model)
            self$.addOption(private$..stratified_var)
            self$.addOption(private$..model_comparison)
            self$.addOption(private$..goodness_of_fit)
            self$.addOption(private$..prediction_times)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..extrapolation_time)
            self$.addOption(private$..plot_survival)
            self$.addOption(private$..plot_hazard)
            self$.addOption(private$..plot_diagnostics)
            self$.addOption(private$..export_predictions)
        }),
    active = list(
        time = function() private$..time$value,
        event = function() private$..event$value,
        covariates = function() private$..covariates$value,
        distribution = function() private$..distribution$value,
        baseline_splines = function() private$..baseline_splines$value,
        time_varying_effects = function() private$..time_varying_effects$value,
        spline_scale = function() private$..spline_scale$value,
        cure_model = function() private$..cure_model$value,
        stratified_var = function() private$..stratified_var$value,
        model_comparison = function() private$..model_comparison$value,
        goodness_of_fit = function() private$..goodness_of_fit$value,
        prediction_times = function() private$..prediction_times$value,
        confidence_level = function() private$..confidence_level$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        extrapolation_time = function() private$..extrapolation_time$value,
        plot_survival = function() private$..plot_survival$value,
        plot_hazard = function() private$..plot_hazard$value,
        plot_diagnostics = function() private$..plot_diagnostics$value,
        export_predictions = function() private$..export_predictions$value),
    private = list(
        ..time = NA,
        ..event = NA,
        ..covariates = NA,
        ..distribution = NA,
        ..baseline_splines = NA,
        ..time_varying_effects = NA,
        ..spline_scale = NA,
        ..cure_model = NA,
        ..stratified_var = NA,
        ..model_comparison = NA,
        ..goodness_of_fit = NA,
        ..prediction_times = NA,
        ..confidence_level = NA,
        ..bootstrap_samples = NA,
        ..extrapolation_time = NA,
        ..plot_survival = NA,
        ..plot_hazard = NA,
        ..plot_diagnostics = NA,
        ..export_predictions = NA)
)

flexparametricadvancedResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "flexparametricadvancedResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        model_summary = function() private$.items[["model_summary"]],
        distribution_parameters = function() private$.items[["distribution_parameters"]],
        covariate_effects = function() private$.items[["covariate_effects"]],
        time_varying_effects = function() private$.items[["time_varying_effects"]],
        survival_predictions = function() private$.items[["survival_predictions"]],
        model_comparison_table = function() private$.items[["model_comparison_table"]],
        goodness_of_fit_tests = function() private$.items[["goodness_of_fit_tests"]],
        cure_model_results = function() private$.items[["cure_model_results"]],
        stratified_results = function() private$.items[["stratified_results"]],
        residual_analysis = function() private$.items[["residual_analysis"]],
        extrapolation_results = function() private$.items[["extrapolation_results"]],
        survival_curves_plot = function() private$.items[["survival_curves_plot"]],
        hazard_functions_plot = function() private$.items[["hazard_functions_plot"]],
        model_diagnostics_plot = function() private$.items[["model_diagnostics_plot"]],
        qq_plot = function() private$.items[["qq_plot"]],
        time_varying_plot = function() private$.items[["time_varying_plot"]],
        model_comparison_plot = function() private$.items[["model_comparison_plot"]],
        clinical_interpretation = function() private$.items[["clinical_interpretation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Advanced Flexible Parametric Survival Results")
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="model_summary",
                title="Model Summary",
                rows=1,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="distribution", 
                        `title`="Distribution", 
                        `type`="text"),
                    list(
                        `name`="n_observations", 
                        `title`="N Observations", 
                        `type`="integer"),
                    list(
                        `name`="n_events", 
                        `title`="N Events", 
                        `type`="integer"),
                    list(
                        `name`="log_likelihood", 
                        `title`="Log-Likelihood", 
                        `type`="number"),
                    list(
                        `name`="aic", 
                        `title`="AIC", 
                        `type`="number"),
                    list(
                        `name`="bic", 
                        `title`="BIC", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="distribution_parameters",
                title="Distribution Parameters",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="Standard Error", 
                        `type`="number"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower 95% CI", 
                        `type`="number"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper 95% CI", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="covariate_effects",
                title="Covariate Effects",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="covariate", 
                        `title`="Covariate", 
                        `type`="text"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number"),
                    list(
                        `name`="hazard_ratio", 
                        `title`="Hazard Ratio", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="Standard Error", 
                        `type`="number"),
                    list(
                        `name`="z_value", 
                        `title`="Z-value", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number"),
                    list(
                        `name`="lower_ci", 
                        `title`="HR Lower 95% CI", 
                        `type`="number"),
                    list(
                        `name`="upper_ci", 
                        `title`="HR Upper 95% CI", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="time_varying_effects",
                title="Time-Varying Effects",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="covariate", 
                        `title`="Covariate", 
                        `type`="text"),
                    list(
                        `name`="time_interaction", 
                        `title`="Time Interaction", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="Standard Error", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number"),
                    list(
                        `name`="interpretation", 
                        `title`="Effect Pattern", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="survival_predictions",
                title="Survival Predictions at Key Time Points",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="time_point", 
                        `title`="Time Point", 
                        `type`="number"),
                    list(
                        `name`="survival_prob", 
                        `title`="Survival Probability", 
                        `type`="number"),
                    list(
                        `name`="hazard_rate", 
                        `title`="Hazard Rate", 
                        `type`="number"),
                    list(
                        `name`="survival_lower", 
                        `title`="Survival Lower CI", 
                        `type`="number"),
                    list(
                        `name`="survival_upper", 
                        `title`="Survival Upper CI", 
                        `type`="number"),
                    list(
                        `name`="median_survival", 
                        `title`="Median Survival", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="model_comparison_table",
                title="Model Comparison",
                rows=0,
                visible="(model_comparison)",
                columns=list(
                    list(
                        `name`="distribution", 
                        `title`="Distribution", 
                        `type`="text"),
                    list(
                        `name`="log_likelihood", 
                        `title`="Log-Likelihood", 
                        `type`="number"),
                    list(
                        `name`="aic", 
                        `title`="AIC", 
                        `type`="number"),
                    list(
                        `name`="bic", 
                        `title`="BIC", 
                        `type`="number"),
                    list(
                        `name`="aic_rank", 
                        `title`="AIC Rank", 
                        `type`="integer"),
                    list(
                        `name`="convergence", 
                        `title`="Converged", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="goodness_of_fit_tests",
                title="Goodness of Fit Tests",
                rows=0,
                visible="(goodness_of_fit)",
                columns=list(
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Test Statistic", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="cure_model_results",
                title="Cure Model Parameters",
                rows=0,
                visible="(cure_model)",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="Standard Error", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number"),
                    list(
                        `name`="clinical_meaning", 
                        `title`="Clinical Meaning", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="stratified_results",
                title="Stratified Analysis Results",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="stratum", 
                        `title`="Stratum", 
                        `type`="text"),
                    list(
                        `name`="n_obs", 
                        `title`="N Obs", 
                        `type`="integer"),
                    list(
                        `name`="n_events", 
                        `title`="N Events", 
                        `type`="integer"),
                    list(
                        `name`="median_survival", 
                        `title`="Median Survival", 
                        `type`="number"),
                    list(
                        `name`="shape_parameter", 
                        `title`="Shape Parameter", 
                        `type`="number"),
                    list(
                        `name`="scale_parameter", 
                        `title`="Scale Parameter", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="residual_analysis",
                title="Residual Analysis",
                rows=0,
                visible="(goodness_of_fit)",
                columns=list(
                    list(
                        `name`="residual_type", 
                        `title`="Residual Type", 
                        `type`="text"),
                    list(
                        `name`="mean", 
                        `title`="Mean", 
                        `type`="number"),
                    list(
                        `name`="variance", 
                        `title`="Variance", 
                        `type`="number"),
                    list(
                        `name`="skewness", 
                        `title`="Skewness", 
                        `type`="number"),
                    list(
                        `name`="normality_test_p", 
                        `title`="Normality Test P-value", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="extrapolation_results",
                title="Long-term Extrapolation",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="time_horizon", 
                        `title`="Time Horizon", 
                        `type`="number"),
                    list(
                        `name`="extrapolated_survival", 
                        `title`="Extrapolated Survival", 
                        `type`="number"),
                    list(
                        `name`="uncertainty_lower", 
                        `title`="Uncertainty Lower", 
                        `type`="number"),
                    list(
                        `name`="uncertainty_upper", 
                        `title`="Uncertainty Upper", 
                        `type`="number"),
                    list(
                        `name`="reliability_score", 
                        `title`="Reliability Score", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="survival_curves_plot",
                title="Parametric Survival Curves",
                width=600,
                height=450,
                visible="(plot_survival)",
                renderFun=".plot_parametric_survival"))
            self$add(jmvcore::Image$new(
                options=options,
                name="hazard_functions_plot",
                title="Parametric Hazard Functions",
                width=600,
                height=450,
                visible="(plot_hazard)",
                renderFun=".plot_parametric_hazard"))
            self$add(jmvcore::Image$new(
                options=options,
                name="model_diagnostics_plot",
                title="Model Diagnostic Plots",
                width=800,
                height=600,
                visible="(plot_diagnostics)",
                renderFun=".plot_model_diagnostics"))
            self$add(jmvcore::Image$new(
                options=options,
                name="qq_plot",
                title="Q-Q Plot for Model Fit",
                width=600,
                height=450,
                visible="(goodness_of_fit)",
                renderFun=".plot_qq_diagnostics"))
            self$add(jmvcore::Image$new(
                options=options,
                name="time_varying_plot",
                title="Time-Varying Effects Plot",
                width=600,
                height=450,
                visible=TRUE,
                renderFun=".plot_time_varying_effects"))
            self$add(jmvcore::Image$new(
                options=options,
                name="model_comparison_plot",
                title="Model Comparison Plot",
                width=600,
                height=450,
                visible="(model_comparison)",
                renderFun=".plot_model_comparison"))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinical_interpretation",
                title="Clinical Interpretation and Health Economic Implications",
                visible=TRUE))}))

flexparametricadvancedBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "flexparametricadvancedBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "flexparametricadvanced",
                version = c(1,0,0),
                options = options,
                results = flexparametricadvancedResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Advanced Flexible Parametric Survival Models
#'
#' Advanced flexible parametric survival models with customizable baseline 
#' hazard distributions.
#' Supports multiple parametric distributions (Weibull, log-normal, 
#' log-logistic, gamma, 
#' Gompertz), spline-based flexible baseline hazards, time-varying effects, 
#' and cure models.
#' Provides superior modeling flexibility compared to Cox regression when 
#' parametric
#' assumptions are met, with improved extrapolation capabilities for health 
#' economic modeling.
#' 
#'
#' @examples
#' flexparametricadvanced(
#'     data = data,
#'     time = "time",
#'     event = "event",
#'     covariates = c("age", "treatment"),
#'     distribution = "weibull",
#'     baseline_splines = 3
#' )
#'
#' @param data the data as a data frame
#' @param time survival time variable
#' @param event event indicator (1=event, 0=censored)
#' @param covariates predictor variables
#' @param distribution parametric distribution for baseline hazard
#' @param baseline_splines number of spline knots for flexible baseline
#'   (spline distribution only)
#' @param time_varying_effects covariates with time-varying effects
#' @param spline_scale scale for spline-based models
#' @param cure_model fit cure model variant with long-term survivors
#' @param stratified_var variable for stratified baseline hazard
#' @param model_comparison compare multiple distributions automatically
#' @param goodness_of_fit perform goodness of fit diagnostics
#' @param prediction_times comma-separated time points for survival
#'   predictions
#' @param confidence_level confidence level for intervals
#' @param bootstrap_samples number of bootstrap samples for confidence
#'   intervals
#' @param extrapolation_time maximum time for survival curve extrapolation
#' @param plot_survival display parametric survival curves
#' @param plot_hazard display parametric hazard functions
#' @param plot_diagnostics display model diagnostic plots
#' @param export_predictions export individual survival predictions
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$model_summary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$distribution_parameters} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$covariate_effects} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$time_varying_effects} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$survival_predictions} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$model_comparison_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$goodness_of_fit_tests} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$cure_model_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stratified_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$residual_analysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$extrapolation_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$survival_curves_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$hazard_functions_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$model_diagnostics_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$qq_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$time_varying_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$model_comparison_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$clinical_interpretation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$model_summary$asDF}
#'
#' \code{as.data.frame(results$model_summary)}
#'
#' @export
flexparametricadvanced <- function(
    data,
    time,
    event,
    covariates,
    distribution = "weibull",
    baseline_splines = 3,
    time_varying_effects,
    spline_scale = "hazard",
    cure_model = FALSE,
    stratified_var,
    model_comparison = TRUE,
    goodness_of_fit = TRUE,
    prediction_times = "1, 2, 5, 10",
    confidence_level = 0.95,
    bootstrap_samples = 1000,
    extrapolation_time = 20,
    plot_survival = TRUE,
    plot_hazard = TRUE,
    plot_diagnostics = TRUE,
    export_predictions = FALSE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("flexparametricadvanced requires jmvcore to be installed (restart may be required)")

    if ( ! missing(time)) time <- jmvcore::resolveQuo(jmvcore::enquo(time))
    if ( ! missing(event)) event <- jmvcore::resolveQuo(jmvcore::enquo(event))
    if ( ! missing(covariates)) covariates <- jmvcore::resolveQuo(jmvcore::enquo(covariates))
    if ( ! missing(time_varying_effects)) time_varying_effects <- jmvcore::resolveQuo(jmvcore::enquo(time_varying_effects))
    if ( ! missing(stratified_var)) stratified_var <- jmvcore::resolveQuo(jmvcore::enquo(stratified_var))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(time), time, NULL),
            `if`( ! missing(event), event, NULL),
            `if`( ! missing(covariates), covariates, NULL),
            `if`( ! missing(time_varying_effects), time_varying_effects, NULL),
            `if`( ! missing(stratified_var), stratified_var, NULL))

    for (v in event) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in stratified_var) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- flexparametricadvancedOptions$new(
        time = time,
        event = event,
        covariates = covariates,
        distribution = distribution,
        baseline_splines = baseline_splines,
        time_varying_effects = time_varying_effects,
        spline_scale = spline_scale,
        cure_model = cure_model,
        stratified_var = stratified_var,
        model_comparison = model_comparison,
        goodness_of_fit = goodness_of_fit,
        prediction_times = prediction_times,
        confidence_level = confidence_level,
        bootstrap_samples = bootstrap_samples,
        extrapolation_time = extrapolation_time,
        plot_survival = plot_survival,
        plot_hazard = plot_hazard,
        plot_diagnostics = plot_diagnostics,
        export_predictions = export_predictions)

    analysis <- flexparametricadvancedClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

