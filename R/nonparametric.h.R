
# This file is automatically generated, you probably don't want to edit this

nonparametricOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "nonparametricOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            outcome = NULL,
            groups = NULL,
            paired_variable = NULL,
            blocking_variable = NULL,
            test_type = "kruskal_wallis",
            post_hoc = TRUE,
            post_hoc_method = "dunn",
            p_adjustment = "holm",
            robust_method = "standard",
            trim_proportion = 0.1,
            winsorize_proportion = 0.1,
            effect_size = TRUE,
            effect_size_method = "eta_squared",
            confidence_level = 0.95,
            bootstrap_ci = FALSE,
            bootstrap_samples = 1000,
            test_assumptions = TRUE,
            homogeneity_test = "levene",
            show_boxplots = TRUE,
            show_violin_plots = FALSE,
            show_rank_plots = FALSE,
            show_effect_plots = TRUE,
            show_descriptives = TRUE,
            show_test_statistics = TRUE,
            show_post_hoc_table = TRUE,
            show_effect_sizes = TRUE,
            show_assumptions = TRUE,
            show_interpretation = TRUE,
            exact_p_values = TRUE,
            ties_method = "average",
            clinical_context = "general",
            set_seed = TRUE,
            seed_value = 42, ...) {

            super$initialize(
                package="ClinicoPath",
                name="nonparametric",
                requiresData=TRUE,
                ...)

            private$..outcome <- jmvcore::OptionVariable$new(
                "outcome",
                outcome,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..groups <- jmvcore::OptionVariable$new(
                "groups",
                groups,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..paired_variable <- jmvcore::OptionVariable$new(
                "paired_variable",
                paired_variable,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..blocking_variable <- jmvcore::OptionVariable$new(
                "blocking_variable",
                blocking_variable,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..test_type <- jmvcore::OptionList$new(
                "test_type",
                test_type,
                options=list(
                    "kruskal_wallis",
                    "friedman",
                    "mann_whitney",
                    "wilcoxon_signed",
                    "median_test",
                    "van_der_waerden",
                    "mood_median"),
                default="kruskal_wallis")
            private$..post_hoc <- jmvcore::OptionBool$new(
                "post_hoc",
                post_hoc,
                default=TRUE)
            private$..post_hoc_method <- jmvcore::OptionList$new(
                "post_hoc_method",
                post_hoc_method,
                options=list(
                    "dunn",
                    "conover",
                    "steel_dwass",
                    "nemenyi",
                    "pairwise_wilcoxon"),
                default="dunn")
            private$..p_adjustment <- jmvcore::OptionList$new(
                "p_adjustment",
                p_adjustment,
                options=list(
                    "none",
                    "bonferroni",
                    "holm",
                    "hochberg",
                    "BH",
                    "BY"),
                default="holm")
            private$..robust_method <- jmvcore::OptionList$new(
                "robust_method",
                robust_method,
                options=list(
                    "standard",
                    "trimmed",
                    "winsorized",
                    "aligned",
                    "hodges_lehmann"),
                default="standard")
            private$..trim_proportion <- jmvcore::OptionNumber$new(
                "trim_proportion",
                trim_proportion,
                default=0.1,
                min=0.01,
                max=0.4)
            private$..winsorize_proportion <- jmvcore::OptionNumber$new(
                "winsorize_proportion",
                winsorize_proportion,
                default=0.1,
                min=0.01,
                max=0.4)
            private$..effect_size <- jmvcore::OptionBool$new(
                "effect_size",
                effect_size,
                default=TRUE)
            private$..effect_size_method <- jmvcore::OptionList$new(
                "effect_size_method",
                effect_size_method,
                options=list(
                    "eta_squared",
                    "epsilon_squared",
                    "rank_biserial",
                    "cles",
                    "vargha_delaney"),
                default="eta_squared")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.5,
                max=0.99)
            private$..bootstrap_ci <- jmvcore::OptionBool$new(
                "bootstrap_ci",
                bootstrap_ci,
                default=FALSE)
            private$..bootstrap_samples <- jmvcore::OptionInteger$new(
                "bootstrap_samples",
                bootstrap_samples,
                default=1000,
                min=100,
                max=10000)
            private$..test_assumptions <- jmvcore::OptionBool$new(
                "test_assumptions",
                test_assumptions,
                default=TRUE)
            private$..homogeneity_test <- jmvcore::OptionList$new(
                "homogeneity_test",
                homogeneity_test,
                options=list(
                    "levene",
                    "brown_forsythe",
                    "fligner",
                    "bartlett"),
                default="levene")
            private$..show_boxplots <- jmvcore::OptionBool$new(
                "show_boxplots",
                show_boxplots,
                default=TRUE)
            private$..show_violin_plots <- jmvcore::OptionBool$new(
                "show_violin_plots",
                show_violin_plots,
                default=FALSE)
            private$..show_rank_plots <- jmvcore::OptionBool$new(
                "show_rank_plots",
                show_rank_plots,
                default=FALSE)
            private$..show_effect_plots <- jmvcore::OptionBool$new(
                "show_effect_plots",
                show_effect_plots,
                default=TRUE)
            private$..show_descriptives <- jmvcore::OptionBool$new(
                "show_descriptives",
                show_descriptives,
                default=TRUE)
            private$..show_test_statistics <- jmvcore::OptionBool$new(
                "show_test_statistics",
                show_test_statistics,
                default=TRUE)
            private$..show_post_hoc_table <- jmvcore::OptionBool$new(
                "show_post_hoc_table",
                show_post_hoc_table,
                default=TRUE)
            private$..show_effect_sizes <- jmvcore::OptionBool$new(
                "show_effect_sizes",
                show_effect_sizes,
                default=TRUE)
            private$..show_assumptions <- jmvcore::OptionBool$new(
                "show_assumptions",
                show_assumptions,
                default=TRUE)
            private$..show_interpretation <- jmvcore::OptionBool$new(
                "show_interpretation",
                show_interpretation,
                default=TRUE)
            private$..exact_p_values <- jmvcore::OptionBool$new(
                "exact_p_values",
                exact_p_values,
                default=TRUE)
            private$..ties_method <- jmvcore::OptionList$new(
                "ties_method",
                ties_method,
                options=list(
                    "average",
                    "first",
                    "random",
                    "max",
                    "min"),
                default="average")
            private$..clinical_context <- jmvcore::OptionList$new(
                "clinical_context",
                clinical_context,
                options=list(
                    "general",
                    "treatment",
                    "biomarker",
                    "qol",
                    "diagnostic",
                    "pathological"),
                default="general")
            private$..set_seed <- jmvcore::OptionBool$new(
                "set_seed",
                set_seed,
                default=TRUE)
            private$..seed_value <- jmvcore::OptionInteger$new(
                "seed_value",
                seed_value,
                default=42,
                min=1,
                max=999999)

            self$.addOption(private$..outcome)
            self$.addOption(private$..groups)
            self$.addOption(private$..paired_variable)
            self$.addOption(private$..blocking_variable)
            self$.addOption(private$..test_type)
            self$.addOption(private$..post_hoc)
            self$.addOption(private$..post_hoc_method)
            self$.addOption(private$..p_adjustment)
            self$.addOption(private$..robust_method)
            self$.addOption(private$..trim_proportion)
            self$.addOption(private$..winsorize_proportion)
            self$.addOption(private$..effect_size)
            self$.addOption(private$..effect_size_method)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..bootstrap_ci)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..test_assumptions)
            self$.addOption(private$..homogeneity_test)
            self$.addOption(private$..show_boxplots)
            self$.addOption(private$..show_violin_plots)
            self$.addOption(private$..show_rank_plots)
            self$.addOption(private$..show_effect_plots)
            self$.addOption(private$..show_descriptives)
            self$.addOption(private$..show_test_statistics)
            self$.addOption(private$..show_post_hoc_table)
            self$.addOption(private$..show_effect_sizes)
            self$.addOption(private$..show_assumptions)
            self$.addOption(private$..show_interpretation)
            self$.addOption(private$..exact_p_values)
            self$.addOption(private$..ties_method)
            self$.addOption(private$..clinical_context)
            self$.addOption(private$..set_seed)
            self$.addOption(private$..seed_value)
        }),
    active = list(
        outcome = function() private$..outcome$value,
        groups = function() private$..groups$value,
        paired_variable = function() private$..paired_variable$value,
        blocking_variable = function() private$..blocking_variable$value,
        test_type = function() private$..test_type$value,
        post_hoc = function() private$..post_hoc$value,
        post_hoc_method = function() private$..post_hoc_method$value,
        p_adjustment = function() private$..p_adjustment$value,
        robust_method = function() private$..robust_method$value,
        trim_proportion = function() private$..trim_proportion$value,
        winsorize_proportion = function() private$..winsorize_proportion$value,
        effect_size = function() private$..effect_size$value,
        effect_size_method = function() private$..effect_size_method$value,
        confidence_level = function() private$..confidence_level$value,
        bootstrap_ci = function() private$..bootstrap_ci$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        test_assumptions = function() private$..test_assumptions$value,
        homogeneity_test = function() private$..homogeneity_test$value,
        show_boxplots = function() private$..show_boxplots$value,
        show_violin_plots = function() private$..show_violin_plots$value,
        show_rank_plots = function() private$..show_rank_plots$value,
        show_effect_plots = function() private$..show_effect_plots$value,
        show_descriptives = function() private$..show_descriptives$value,
        show_test_statistics = function() private$..show_test_statistics$value,
        show_post_hoc_table = function() private$..show_post_hoc_table$value,
        show_effect_sizes = function() private$..show_effect_sizes$value,
        show_assumptions = function() private$..show_assumptions$value,
        show_interpretation = function() private$..show_interpretation$value,
        exact_p_values = function() private$..exact_p_values$value,
        ties_method = function() private$..ties_method$value,
        clinical_context = function() private$..clinical_context$value,
        set_seed = function() private$..set_seed$value,
        seed_value = function() private$..seed_value$value),
    private = list(
        ..outcome = NA,
        ..groups = NA,
        ..paired_variable = NA,
        ..blocking_variable = NA,
        ..test_type = NA,
        ..post_hoc = NA,
        ..post_hoc_method = NA,
        ..p_adjustment = NA,
        ..robust_method = NA,
        ..trim_proportion = NA,
        ..winsorize_proportion = NA,
        ..effect_size = NA,
        ..effect_size_method = NA,
        ..confidence_level = NA,
        ..bootstrap_ci = NA,
        ..bootstrap_samples = NA,
        ..test_assumptions = NA,
        ..homogeneity_test = NA,
        ..show_boxplots = NA,
        ..show_violin_plots = NA,
        ..show_rank_plots = NA,
        ..show_effect_plots = NA,
        ..show_descriptives = NA,
        ..show_test_statistics = NA,
        ..show_post_hoc_table = NA,
        ..show_effect_sizes = NA,
        ..show_assumptions = NA,
        ..show_interpretation = NA,
        ..exact_p_values = NA,
        ..ties_method = NA,
        ..clinical_context = NA,
        ..set_seed = NA,
        ..seed_value = NA)
)

nonparametricResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "nonparametricResults",
    inherit = jmvcore::Group,
    active = list(
        descriptives = function() private$.items[["descriptives"]],
        testStatistics = function() private$.items[["testStatistics"]],
        postHocTable = function() private$.items[["postHocTable"]],
        effectSizesTable = function() private$.items[["effectSizesTable"]],
        assumptionsTable = function() private$.items[["assumptionsTable"]],
        robustStatistics = function() private$.items[["robustStatistics"]],
        clinicalInterpretation = function() private$.items[["clinicalInterpretation"]],
        methodsExplanation = function() private$.items[["methodsExplanation"]],
        boxPlots = function() private$.items[["boxPlots"]],
        violinPlots = function() private$.items[["violinPlots"]],
        rankPlots = function() private$.items[["rankPlots"]],
        effectSizePlots = function() private$.items[["effectSizePlots"]],
        powerAnalysis = function() private$.items[["powerAnalysis"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Analysis Results")
            self$add(jmvcore::Table$new(
                options=options,
                name="descriptives",
                title="Descriptive Statistics",
                columns=list(
                    list(
                        `name`="group", 
                        `title`="Group", 
                        `type`="text"),
                    list(
                        `name`="n", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="median", 
                        `title`="Median", 
                        `type`="number"),
                    list(
                        `name`="mad", 
                        `title`="MAD", 
                        `type`="number"),
                    list(
                        `name`="q1", 
                        `title`="Q1", 
                        `type`="number"),
                    list(
                        `name`="q3", 
                        `title`="Q3", 
                        `type`="number"),
                    list(
                        `name`="min", 
                        `title`="Min", 
                        `type`="number"),
                    list(
                        `name`="max", 
                        `title`="Max", 
                        `type`="number"),
                    list(
                        `name`="mean_rank", 
                        `title`="Mean Rank", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="testStatistics",
                title="Non-parametric Test Results",
                columns=list(
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="number"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p", 
                        `title`="p", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number"),
                    list(
                        `name`="effect_ci_lower", 
                        `title`="Effect Size CI Lower", 
                        `type`="number"),
                    list(
                        `name`="effect_ci_upper", 
                        `title`="Effect Size CI Upper", 
                        `type`="number"),
                    list(
                        `name`="interpretation", 
                        `title`="Statistical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="postHocTable",
                title="Post-hoc Comparisons",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="number"),
                    list(
                        `name`="p_raw", 
                        `title`="p (raw)", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="p_adjusted", 
                        `title`="p (adjusted)", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="effect_size", 
                        `title`="Effect Size", 
                        `type`="number"),
                    list(
                        `name`="effect_ci_lower", 
                        `title`="Effect Size CI Lower", 
                        `type`="number"),
                    list(
                        `name`="effect_ci_upper", 
                        `title`="Effect Size CI Upper", 
                        `type`="number"),
                    list(
                        `name`="significance", 
                        `title`="Significance", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="effectSizesTable",
                title="Effect Sizes Summary",
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Effect Size Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number"),
                    list(
                        `name`="ci_lower", 
                        `title`="CI Lower", 
                        `type`="number"),
                    list(
                        `name`="ci_upper", 
                        `title`="CI Upper", 
                        `type`="number"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"),
                    list(
                        `name`="clinical_relevance", 
                        `title`="Clinical Relevance", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="assumptionsTable",
                title="Assumption Tests",
                columns=list(
                    list(
                        `name`="assumption", 
                        `title`="Assumption", 
                        `type`="text"),
                    list(
                        `name`="test", 
                        `title`="Test", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="number"),
                    list(
                        `name`="df", 
                        `title`="df", 
                        `type`="integer"),
                    list(
                        `name`="p", 
                        `title`="p", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="result", 
                        `title`="Result", 
                        `type`="text"),
                    list(
                        `name`="implication", 
                        `title`="Implication", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="robustStatistics",
                title="Robust Statistics",
                columns=list(
                    list(
                        `name`="group", 
                        `title`="Group", 
                        `type`="text"),
                    list(
                        `name`="trimmed_mean", 
                        `title`="Trimmed Mean", 
                        `type`="number"),
                    list(
                        `name`="winsorized_mean", 
                        `title`="Winsorized Mean", 
                        `type`="number"),
                    list(
                        `name`="hodges_lehmann", 
                        `title`="Hodges-Lehmann", 
                        `type`="number"),
                    list(
                        `name`="robust_se", 
                        `title`="Robust SE", 
                        `type`="number"),
                    list(
                        `name`="robust_ci_lower", 
                        `title`="Robust CI Lower", 
                        `type`="number"),
                    list(
                        `name`="robust_ci_upper", 
                        `title`="Robust CI Upper", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalInterpretation",
                title="Clinical Interpretation and Guidelines"))
            self$add(jmvcore::Html$new(
                options=options,
                name="methodsExplanation",
                title="Statistical Methods and Assumptions"))
            self$add(jmvcore::Image$new(
                options=options,
                name="boxPlots",
                title="Box Plots by Group",
                width=500,
                height=350,
                renderFun=".plotBoxPlots"))
            self$add(jmvcore::Image$new(
                options=options,
                name="violinPlots",
                title="Violin Plots with Distribution",
                width=500,
                height=350,
                renderFun=".plotViolinPlots"))
            self$add(jmvcore::Image$new(
                options=options,
                name="rankPlots",
                title="Rank Distribution Plots",
                width=500,
                height=350,
                renderFun=".plotRankDistribution"))
            self$add(jmvcore::Image$new(
                options=options,
                name="effectSizePlots",
                title="Effect Size Visualization",
                width=500,
                height=350,
                renderFun=".plotEffectSizes"))
            self$add(jmvcore::Table$new(
                options=options,
                name="powerAnalysis",
                title="Post-hoc Power Analysis",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="observed_effect", 
                        `title`="Observed Effect", 
                        `type`="number"),
                    list(
                        `name`="power", 
                        `title`="Achieved Power", 
                        `type`="number"),
                    list(
                        `name`="required_n", 
                        `title`="Required N (80% power)", 
                        `type`="integer"),
                    list(
                        `name`="power_interpretation", 
                        `title`="Power Assessment", 
                        `type`="text"))))}))

nonparametricBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "nonparametricBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "nonparametric",
                version = c(0,0,31),
                options = options,
                results = nonparametricResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Non-parametric Statistical Methods
#'
#' Comprehensive non-parametric statistical methods including Kruskal-Wallis 
#' test,
#' Friedman test, robust alternatives to classical procedures, and 
#' distribution-free
#' methods designed for clinical research where normality assumptions are 
#' violated.
#' 
#'
#' @examples
#' # Kruskal-Wallis test with post-hoc comparisons
#' nonparametric(
#'     data = clinical_data,
#'     outcome = "biomarker_level",
#'     groups = "treatment_group",
#'     test_type = "kruskal_wallis",
#'     post_hoc = TRUE
#' )
#'
#' @param data The data as a data frame for non-parametric analysis.
#' @param outcome .
#' @param groups .
#' @param paired_variable .
#' @param blocking_variable .
#' @param test_type .
#' @param post_hoc .
#' @param post_hoc_method .
#' @param p_adjustment .
#' @param robust_method .
#' @param trim_proportion .
#' @param winsorize_proportion .
#' @param effect_size .
#' @param effect_size_method .
#' @param confidence_level .
#' @param bootstrap_ci .
#' @param bootstrap_samples .
#' @param test_assumptions .
#' @param homogeneity_test .
#' @param show_boxplots .
#' @param show_violin_plots .
#' @param show_rank_plots .
#' @param show_effect_plots .
#' @param show_descriptives .
#' @param show_test_statistics .
#' @param show_post_hoc_table .
#' @param show_effect_sizes .
#' @param show_assumptions .
#' @param show_interpretation .
#' @param exact_p_values .
#' @param ties_method .
#' @param clinical_context .
#' @param set_seed .
#' @param seed_value .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$descriptives} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$testStatistics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$postHocTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$effectSizesTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$assumptionsTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$robustStatistics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$clinicalInterpretation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$methodsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$boxPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$violinPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$rankPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$effectSizePlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$powerAnalysis} \tab \tab \tab \tab \tab a table \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$descriptives$asDF}
#'
#' \code{as.data.frame(results$descriptives)}
#'
#' @export
nonparametric <- function(
    data,
    outcome,
    groups,
    paired_variable = NULL,
    blocking_variable = NULL,
    test_type = "kruskal_wallis",
    post_hoc = TRUE,
    post_hoc_method = "dunn",
    p_adjustment = "holm",
    robust_method = "standard",
    trim_proportion = 0.1,
    winsorize_proportion = 0.1,
    effect_size = TRUE,
    effect_size_method = "eta_squared",
    confidence_level = 0.95,
    bootstrap_ci = FALSE,
    bootstrap_samples = 1000,
    test_assumptions = TRUE,
    homogeneity_test = "levene",
    show_boxplots = TRUE,
    show_violin_plots = FALSE,
    show_rank_plots = FALSE,
    show_effect_plots = TRUE,
    show_descriptives = TRUE,
    show_test_statistics = TRUE,
    show_post_hoc_table = TRUE,
    show_effect_sizes = TRUE,
    show_assumptions = TRUE,
    show_interpretation = TRUE,
    exact_p_values = TRUE,
    ties_method = "average",
    clinical_context = "general",
    set_seed = TRUE,
    seed_value = 42) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("nonparametric requires jmvcore to be installed (restart may be required)")

    if ( ! missing(outcome)) outcome <- jmvcore::resolveQuo(jmvcore::enquo(outcome))
    if ( ! missing(groups)) groups <- jmvcore::resolveQuo(jmvcore::enquo(groups))
    if ( ! missing(paired_variable)) paired_variable <- jmvcore::resolveQuo(jmvcore::enquo(paired_variable))
    if ( ! missing(blocking_variable)) blocking_variable <- jmvcore::resolveQuo(jmvcore::enquo(blocking_variable))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(outcome), outcome, NULL),
            `if`( ! missing(groups), groups, NULL),
            `if`( ! missing(paired_variable), paired_variable, NULL),
            `if`( ! missing(blocking_variable), blocking_variable, NULL))

    for (v in groups) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in paired_variable) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in blocking_variable) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- nonparametricOptions$new(
        outcome = outcome,
        groups = groups,
        paired_variable = paired_variable,
        blocking_variable = blocking_variable,
        test_type = test_type,
        post_hoc = post_hoc,
        post_hoc_method = post_hoc_method,
        p_adjustment = p_adjustment,
        robust_method = robust_method,
        trim_proportion = trim_proportion,
        winsorize_proportion = winsorize_proportion,
        effect_size = effect_size,
        effect_size_method = effect_size_method,
        confidence_level = confidence_level,
        bootstrap_ci = bootstrap_ci,
        bootstrap_samples = bootstrap_samples,
        test_assumptions = test_assumptions,
        homogeneity_test = homogeneity_test,
        show_boxplots = show_boxplots,
        show_violin_plots = show_violin_plots,
        show_rank_plots = show_rank_plots,
        show_effect_plots = show_effect_plots,
        show_descriptives = show_descriptives,
        show_test_statistics = show_test_statistics,
        show_post_hoc_table = show_post_hoc_table,
        show_effect_sizes = show_effect_sizes,
        show_assumptions = show_assumptions,
        show_interpretation = show_interpretation,
        exact_p_values = exact_p_values,
        ties_method = ties_method,
        clinical_context = clinical_context,
        set_seed = set_seed,
        seed_value = seed_value)

    analysis <- nonparametricClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

