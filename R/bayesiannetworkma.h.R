
# This file is automatically generated, you probably don't want to edit this

bayesiannetworkmaOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesiannetworkmaOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            study_id = NULL,
            treatment = NULL,
            outcome = NULL,
            sample_size = NULL,
            outcomeLevel = NULL,
            standard_error = NULL,
            control_rate = NULL,
            network_type = "mixed_evidence",
            outcome_type = "binary_or",
            reference_treatment = NULL,
            baseline_model = "exchangeable",
            random_effects_model = "random_univariate",
            heterogeneity_model = "common",
            correlation_structure = "unstructured",
            treatment_effect_prior = "vague_normal",
            heterogeneity_prior = "half_normal",
            prior_mean_effect = 0,
            prior_sd_effect = 10,
            prior_heterogeneity_sd = 1,
            assess_coherence = TRUE,
            coherence_method = "node_splitting",
            inconsistency_threshold = 0.05,
            mcmc_samples = 10000,
            mcmc_burnin = 5000,
            mcmc_thin = 2,
            mcmc_chains = 3,
            ranking_analysis = TRUE,
            ranking_measure = "sucra",
            pairwise_probabilities = TRUE,
            superiority_threshold = 0,
            model_selection = TRUE,
            model_comparison_criteria = "dic",
            network_plot = TRUE,
            network_layout = "spring",
            edge_weights = "n_studies",
            show_network_summary = TRUE,
            show_treatment_effects = TRUE,
            show_heterogeneity_analysis = TRUE,
            show_coherence_results = TRUE,
            show_ranking_results = TRUE,
            show_forest_plots = TRUE,
            show_league_table = TRUE,
            show_convergence_diagnostics = TRUE,
            show_interpretation = TRUE,
            meta_regression_covariates = NULL,
            treatment_classes = NULL,
            multi_arm_correction = TRUE,
            zero_events_correction = 0.5,
            clinical_context = "therapeutic",
            confidence_level = 0.95,
            set_seed = TRUE,
            seed_value = 42,
            parallel_processing = TRUE,
            n_cores = 2, ...) {

            super$initialize(
                package="ClinicoPath",
                name="bayesiannetworkma",
                requiresData=TRUE,
                ...)

            private$..study_id <- jmvcore::OptionVariable$new(
                "study_id",
                study_id,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..treatment <- jmvcore::OptionVariable$new(
                "treatment",
                treatment,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..outcome <- jmvcore::OptionVariable$new(
                "outcome",
                outcome,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..sample_size <- jmvcore::OptionVariable$new(
                "sample_size",
                sample_size,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..outcomeLevel <- jmvcore::OptionLevel$new(
                "outcomeLevel",
                outcomeLevel,
                variable="(outcome)")
            private$..standard_error <- jmvcore::OptionVariable$new(
                "standard_error",
                standard_error,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..control_rate <- jmvcore::OptionVariable$new(
                "control_rate",
                control_rate,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..network_type <- jmvcore::OptionList$new(
                "network_type",
                network_type,
                options=list(
                    "mixed_evidence",
                    "direct_only",
                    "indirect_only",
                    "contrast_based",
                    "arm_based"),
                default="mixed_evidence")
            private$..outcome_type <- jmvcore::OptionList$new(
                "outcome_type",
                outcome_type,
                options=list(
                    "binary_rr",
                    "binary_or",
                    "binary_rd",
                    "continuous_md",
                    "continuous_smd",
                    "rate_ratio",
                    "hazard_ratio"),
                default="binary_or")
            private$..reference_treatment <- jmvcore::OptionLevel$new(
                "reference_treatment",
                reference_treatment,
                variable="(treatment)")
            private$..baseline_model <- jmvcore::OptionList$new(
                "baseline_model",
                baseline_model,
                options=list(
                    "exchangeable",
                    "independent",
                    "regression",
                    "meta_regression"),
                default="exchangeable")
            private$..random_effects_model <- jmvcore::OptionList$new(
                "random_effects_model",
                random_effects_model,
                options=list(
                    "fixed",
                    "random_univariate",
                    "random_multivariate",
                    "hierarchical"),
                default="random_univariate")
            private$..heterogeneity_model <- jmvcore::OptionList$new(
                "heterogeneity_model",
                heterogeneity_model,
                options=list(
                    "common",
                    "comparison_specific",
                    "treatment_specific",
                    "class_specific"),
                default="common")
            private$..correlation_structure <- jmvcore::OptionList$new(
                "correlation_structure",
                correlation_structure,
                options=list(
                    "unstructured",
                    "exchangeable",
                    "compound_symmetry",
                    "ar1"),
                default="unstructured")
            private$..treatment_effect_prior <- jmvcore::OptionList$new(
                "treatment_effect_prior",
                treatment_effect_prior,
                options=list(
                    "vague_normal",
                    "informative_normal",
                    "hierarchical",
                    "skeptical"),
                default="vague_normal")
            private$..heterogeneity_prior <- jmvcore::OptionList$new(
                "heterogeneity_prior",
                heterogeneity_prior,
                options=list(
                    "vague_uniform",
                    "half_normal",
                    "inverse_gamma",
                    "log_normal",
                    "turner_predictive"),
                default="half_normal")
            private$..prior_mean_effect <- jmvcore::OptionNumber$new(
                "prior_mean_effect",
                prior_mean_effect,
                default=0,
                min=-10,
                max=10)
            private$..prior_sd_effect <- jmvcore::OptionNumber$new(
                "prior_sd_effect",
                prior_sd_effect,
                default=10,
                min=0.1,
                max=100)
            private$..prior_heterogeneity_sd <- jmvcore::OptionNumber$new(
                "prior_heterogeneity_sd",
                prior_heterogeneity_sd,
                default=1,
                min=0.1,
                max=10)
            private$..assess_coherence <- jmvcore::OptionBool$new(
                "assess_coherence",
                assess_coherence,
                default=TRUE)
            private$..coherence_method <- jmvcore::OptionList$new(
                "coherence_method",
                coherence_method,
                options=list(
                    "node_splitting",
                    "side_splitting",
                    "unrelated_mean_effects",
                    "inconsistency_model"),
                default="node_splitting")
            private$..inconsistency_threshold <- jmvcore::OptionNumber$new(
                "inconsistency_threshold",
                inconsistency_threshold,
                default=0.05,
                min=0.001,
                max=0.2)
            private$..mcmc_samples <- jmvcore::OptionInteger$new(
                "mcmc_samples",
                mcmc_samples,
                default=10000,
                min=2000,
                max=100000)
            private$..mcmc_burnin <- jmvcore::OptionInteger$new(
                "mcmc_burnin",
                mcmc_burnin,
                default=5000,
                min=1000,
                max=50000)
            private$..mcmc_thin <- jmvcore::OptionInteger$new(
                "mcmc_thin",
                mcmc_thin,
                default=2,
                min=1,
                max=50)
            private$..mcmc_chains <- jmvcore::OptionInteger$new(
                "mcmc_chains",
                mcmc_chains,
                default=3,
                min=1,
                max=8)
            private$..ranking_analysis <- jmvcore::OptionBool$new(
                "ranking_analysis",
                ranking_analysis,
                default=TRUE)
            private$..ranking_measure <- jmvcore::OptionList$new(
                "ranking_measure",
                ranking_measure,
                options=list(
                    "sucra",
                    "prob_ranking",
                    "mean_rank",
                    "p_score"),
                default="sucra")
            private$..pairwise_probabilities <- jmvcore::OptionBool$new(
                "pairwise_probabilities",
                pairwise_probabilities,
                default=TRUE)
            private$..superiority_threshold <- jmvcore::OptionNumber$new(
                "superiority_threshold",
                superiority_threshold,
                default=0,
                min=-10,
                max=10)
            private$..model_selection <- jmvcore::OptionBool$new(
                "model_selection",
                model_selection,
                default=TRUE)
            private$..model_comparison_criteria <- jmvcore::OptionList$new(
                "model_comparison_criteria",
                model_comparison_criteria,
                options=list(
                    "dic",
                    "waic",
                    "loo",
                    "leverage"),
                default="dic")
            private$..network_plot <- jmvcore::OptionBool$new(
                "network_plot",
                network_plot,
                default=TRUE)
            private$..network_layout <- jmvcore::OptionList$new(
                "network_layout",
                network_layout,
                options=list(
                    "circular",
                    "spring",
                    "hierarchical",
                    "force_directed"),
                default="spring")
            private$..edge_weights <- jmvcore::OptionList$new(
                "edge_weights",
                edge_weights,
                options=list(
                    "n_studies",
                    "sample_size",
                    "precision",
                    "equal"),
                default="n_studies")
            private$..show_network_summary <- jmvcore::OptionBool$new(
                "show_network_summary",
                show_network_summary,
                default=TRUE)
            private$..show_treatment_effects <- jmvcore::OptionBool$new(
                "show_treatment_effects",
                show_treatment_effects,
                default=TRUE)
            private$..show_heterogeneity_analysis <- jmvcore::OptionBool$new(
                "show_heterogeneity_analysis",
                show_heterogeneity_analysis,
                default=TRUE)
            private$..show_coherence_results <- jmvcore::OptionBool$new(
                "show_coherence_results",
                show_coherence_results,
                default=TRUE)
            private$..show_ranking_results <- jmvcore::OptionBool$new(
                "show_ranking_results",
                show_ranking_results,
                default=TRUE)
            private$..show_forest_plots <- jmvcore::OptionBool$new(
                "show_forest_plots",
                show_forest_plots,
                default=TRUE)
            private$..show_league_table <- jmvcore::OptionBool$new(
                "show_league_table",
                show_league_table,
                default=TRUE)
            private$..show_convergence_diagnostics <- jmvcore::OptionBool$new(
                "show_convergence_diagnostics",
                show_convergence_diagnostics,
                default=TRUE)
            private$..show_interpretation <- jmvcore::OptionBool$new(
                "show_interpretation",
                show_interpretation,
                default=TRUE)
            private$..meta_regression_covariates <- jmvcore::OptionVariables$new(
                "meta_regression_covariates",
                meta_regression_covariates,
                suggested=list(
                    "continuous",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"),
                default=NULL)
            private$..treatment_classes <- jmvcore::OptionVariable$new(
                "treatment_classes",
                treatment_classes,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"),
                default=NULL)
            private$..multi_arm_correction <- jmvcore::OptionBool$new(
                "multi_arm_correction",
                multi_arm_correction,
                default=TRUE)
            private$..zero_events_correction <- jmvcore::OptionNumber$new(
                "zero_events_correction",
                zero_events_correction,
                default=0.5,
                min=0.1,
                max=1)
            private$..clinical_context <- jmvcore::OptionList$new(
                "clinical_context",
                clinical_context,
                options=list(
                    "therapeutic",
                    "prevention",
                    "diagnostic",
                    "surgical",
                    "drug_development",
                    "hta"),
                default="therapeutic")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.8,
                max=0.99)
            private$..set_seed <- jmvcore::OptionBool$new(
                "set_seed",
                set_seed,
                default=TRUE)
            private$..seed_value <- jmvcore::OptionInteger$new(
                "seed_value",
                seed_value,
                default=42,
                min=1,
                max=999999)
            private$..parallel_processing <- jmvcore::OptionBool$new(
                "parallel_processing",
                parallel_processing,
                default=TRUE)
            private$..n_cores <- jmvcore::OptionInteger$new(
                "n_cores",
                n_cores,
                default=2,
                min=1,
                max=8)

            self$.addOption(private$..study_id)
            self$.addOption(private$..treatment)
            self$.addOption(private$..outcome)
            self$.addOption(private$..sample_size)
            self$.addOption(private$..outcomeLevel)
            self$.addOption(private$..standard_error)
            self$.addOption(private$..control_rate)
            self$.addOption(private$..network_type)
            self$.addOption(private$..outcome_type)
            self$.addOption(private$..reference_treatment)
            self$.addOption(private$..baseline_model)
            self$.addOption(private$..random_effects_model)
            self$.addOption(private$..heterogeneity_model)
            self$.addOption(private$..correlation_structure)
            self$.addOption(private$..treatment_effect_prior)
            self$.addOption(private$..heterogeneity_prior)
            self$.addOption(private$..prior_mean_effect)
            self$.addOption(private$..prior_sd_effect)
            self$.addOption(private$..prior_heterogeneity_sd)
            self$.addOption(private$..assess_coherence)
            self$.addOption(private$..coherence_method)
            self$.addOption(private$..inconsistency_threshold)
            self$.addOption(private$..mcmc_samples)
            self$.addOption(private$..mcmc_burnin)
            self$.addOption(private$..mcmc_thin)
            self$.addOption(private$..mcmc_chains)
            self$.addOption(private$..ranking_analysis)
            self$.addOption(private$..ranking_measure)
            self$.addOption(private$..pairwise_probabilities)
            self$.addOption(private$..superiority_threshold)
            self$.addOption(private$..model_selection)
            self$.addOption(private$..model_comparison_criteria)
            self$.addOption(private$..network_plot)
            self$.addOption(private$..network_layout)
            self$.addOption(private$..edge_weights)
            self$.addOption(private$..show_network_summary)
            self$.addOption(private$..show_treatment_effects)
            self$.addOption(private$..show_heterogeneity_analysis)
            self$.addOption(private$..show_coherence_results)
            self$.addOption(private$..show_ranking_results)
            self$.addOption(private$..show_forest_plots)
            self$.addOption(private$..show_league_table)
            self$.addOption(private$..show_convergence_diagnostics)
            self$.addOption(private$..show_interpretation)
            self$.addOption(private$..meta_regression_covariates)
            self$.addOption(private$..treatment_classes)
            self$.addOption(private$..multi_arm_correction)
            self$.addOption(private$..zero_events_correction)
            self$.addOption(private$..clinical_context)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..set_seed)
            self$.addOption(private$..seed_value)
            self$.addOption(private$..parallel_processing)
            self$.addOption(private$..n_cores)
        }),
    active = list(
        study_id = function() private$..study_id$value,
        treatment = function() private$..treatment$value,
        outcome = function() private$..outcome$value,
        sample_size = function() private$..sample_size$value,
        outcomeLevel = function() private$..outcomeLevel$value,
        standard_error = function() private$..standard_error$value,
        control_rate = function() private$..control_rate$value,
        network_type = function() private$..network_type$value,
        outcome_type = function() private$..outcome_type$value,
        reference_treatment = function() private$..reference_treatment$value,
        baseline_model = function() private$..baseline_model$value,
        random_effects_model = function() private$..random_effects_model$value,
        heterogeneity_model = function() private$..heterogeneity_model$value,
        correlation_structure = function() private$..correlation_structure$value,
        treatment_effect_prior = function() private$..treatment_effect_prior$value,
        heterogeneity_prior = function() private$..heterogeneity_prior$value,
        prior_mean_effect = function() private$..prior_mean_effect$value,
        prior_sd_effect = function() private$..prior_sd_effect$value,
        prior_heterogeneity_sd = function() private$..prior_heterogeneity_sd$value,
        assess_coherence = function() private$..assess_coherence$value,
        coherence_method = function() private$..coherence_method$value,
        inconsistency_threshold = function() private$..inconsistency_threshold$value,
        mcmc_samples = function() private$..mcmc_samples$value,
        mcmc_burnin = function() private$..mcmc_burnin$value,
        mcmc_thin = function() private$..mcmc_thin$value,
        mcmc_chains = function() private$..mcmc_chains$value,
        ranking_analysis = function() private$..ranking_analysis$value,
        ranking_measure = function() private$..ranking_measure$value,
        pairwise_probabilities = function() private$..pairwise_probabilities$value,
        superiority_threshold = function() private$..superiority_threshold$value,
        model_selection = function() private$..model_selection$value,
        model_comparison_criteria = function() private$..model_comparison_criteria$value,
        network_plot = function() private$..network_plot$value,
        network_layout = function() private$..network_layout$value,
        edge_weights = function() private$..edge_weights$value,
        show_network_summary = function() private$..show_network_summary$value,
        show_treatment_effects = function() private$..show_treatment_effects$value,
        show_heterogeneity_analysis = function() private$..show_heterogeneity_analysis$value,
        show_coherence_results = function() private$..show_coherence_results$value,
        show_ranking_results = function() private$..show_ranking_results$value,
        show_forest_plots = function() private$..show_forest_plots$value,
        show_league_table = function() private$..show_league_table$value,
        show_convergence_diagnostics = function() private$..show_convergence_diagnostics$value,
        show_interpretation = function() private$..show_interpretation$value,
        meta_regression_covariates = function() private$..meta_regression_covariates$value,
        treatment_classes = function() private$..treatment_classes$value,
        multi_arm_correction = function() private$..multi_arm_correction$value,
        zero_events_correction = function() private$..zero_events_correction$value,
        clinical_context = function() private$..clinical_context$value,
        confidence_level = function() private$..confidence_level$value,
        set_seed = function() private$..set_seed$value,
        seed_value = function() private$..seed_value$value,
        parallel_processing = function() private$..parallel_processing$value,
        n_cores = function() private$..n_cores$value),
    private = list(
        ..study_id = NA,
        ..treatment = NA,
        ..outcome = NA,
        ..sample_size = NA,
        ..outcomeLevel = NA,
        ..standard_error = NA,
        ..control_rate = NA,
        ..network_type = NA,
        ..outcome_type = NA,
        ..reference_treatment = NA,
        ..baseline_model = NA,
        ..random_effects_model = NA,
        ..heterogeneity_model = NA,
        ..correlation_structure = NA,
        ..treatment_effect_prior = NA,
        ..heterogeneity_prior = NA,
        ..prior_mean_effect = NA,
        ..prior_sd_effect = NA,
        ..prior_heterogeneity_sd = NA,
        ..assess_coherence = NA,
        ..coherence_method = NA,
        ..inconsistency_threshold = NA,
        ..mcmc_samples = NA,
        ..mcmc_burnin = NA,
        ..mcmc_thin = NA,
        ..mcmc_chains = NA,
        ..ranking_analysis = NA,
        ..ranking_measure = NA,
        ..pairwise_probabilities = NA,
        ..superiority_threshold = NA,
        ..model_selection = NA,
        ..model_comparison_criteria = NA,
        ..network_plot = NA,
        ..network_layout = NA,
        ..edge_weights = NA,
        ..show_network_summary = NA,
        ..show_treatment_effects = NA,
        ..show_heterogeneity_analysis = NA,
        ..show_coherence_results = NA,
        ..show_ranking_results = NA,
        ..show_forest_plots = NA,
        ..show_league_table = NA,
        ..show_convergence_diagnostics = NA,
        ..show_interpretation = NA,
        ..meta_regression_covariates = NA,
        ..treatment_classes = NA,
        ..multi_arm_correction = NA,
        ..zero_events_correction = NA,
        ..clinical_context = NA,
        ..confidence_level = NA,
        ..set_seed = NA,
        ..seed_value = NA,
        ..parallel_processing = NA,
        ..n_cores = NA)
)

bayesiannetworkmaResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesiannetworkmaResults",
    inherit = jmvcore::Group,
    active = list(
        networkSummary = function() private$.items[["networkSummary"]],
        networkCharacteristics = function() private$.items[["networkCharacteristics"]],
        treatmentEffects = function() private$.items[["treatmentEffects"]],
        heterogeneityAnalysis = function() private$.items[["heterogeneityAnalysis"]],
        coherenceAssessment = function() private$.items[["coherenceAssessment"]],
        treatmentRankings = function() private$.items[["treatmentRankings"]],
        pairwiseComparisons = function() private$.items[["pairwiseComparisons"]],
        leagueTable = function() private$.items[["leagueTable"]],
        modelComparison = function() private$.items[["modelComparison"]],
        convergenceDiagnostics = function() private$.items[["convergenceDiagnostics"]],
        metaRegressionResults = function() private$.items[["metaRegressionResults"]],
        sensitivityAnalysis = function() private$.items[["sensitivityAnalysis"]],
        clinicalInterpretation = function() private$.items[["clinicalInterpretation"]],
        methodsExplanation = function() private$.items[["methodsExplanation"]],
        networkPlot = function() private$.items[["networkPlot"]],
        forestPlots = function() private$.items[["forestPlots"]],
        rankingPlots = function() private$.items[["rankingPlots"]],
        heterogeneityPlots = function() private$.items[["heterogeneityPlots"]],
        coherencePlots = function() private$.items[["coherencePlots"]],
        posteriorDistributionPlots = function() private$.items[["posteriorDistributionPlots"]],
        convergencePlots = function() private$.items[["convergencePlots"]],
        comparisonMatrix = function() private$.items[["comparisonMatrix"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Analysis Results",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Table$new(
                options=options,
                name="networkSummary",
                title="Network Meta-Analysis Summary",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Network Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="networkCharacteristics",
                title="Network Characteristics",
                columns=list(
                    list(
                        `name`="treatment", 
                        `title`="Treatment", 
                        `type`="text"),
                    list(
                        `name`="n_studies", 
                        `title`="Number of Studies", 
                        `type`="integer"),
                    list(
                        `name`="n_participants", 
                        `title`="Total Participants", 
                        `type`="integer"),
                    list(
                        `name`="direct_comparisons", 
                        `title`="Direct Comparisons", 
                        `type`="integer"),
                    list(
                        `name`="indirect_evidence", 
                        `title`="Indirect Evidence", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="treatmentEffects",
                title="Network Treatment Effects",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="posterior_mean", 
                        `title`="Posterior Mean", 
                        `type`="number"),
                    list(
                        `name`="posterior_sd", 
                        `title`="Posterior SD", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_lower", 
                        `title`="CrI Lower", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_upper", 
                        `title`="CrI Upper", 
                        `type`="number"),
                    list(
                        `name`="prob_superiority", 
                        `title`="P(Superiority)", 
                        `type`="number"),
                    list(
                        `name`="evidence_type", 
                        `title`="Evidence Type", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="heterogeneityAnalysis",
                title="Between-Study Heterogeneity Assessment",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="posterior_mean", 
                        `title`="Posterior Mean", 
                        `type`="number"),
                    list(
                        `name`="posterior_sd", 
                        `title`="Posterior SD", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_lower", 
                        `title`="CrI Lower", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_upper", 
                        `title`="CrI Upper", 
                        `type`="number"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="coherenceAssessment",
                title="Network Coherence Assessment",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="direct_effect", 
                        `title`="Direct Effect", 
                        `type`="number"),
                    list(
                        `name`="indirect_effect", 
                        `title`="Indirect Effect", 
                        `type`="number"),
                    list(
                        `name`="inconsistency", 
                        `title`="Inconsistency", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="coherence_status", 
                        `title`="Coherence Status", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="treatmentRankings",
                title="Treatment Rankings",
                columns=list(
                    list(
                        `name`="treatment", 
                        `title`="Treatment", 
                        `type`="text"),
                    list(
                        `name`="mean_rank", 
                        `title`="Mean Rank", 
                        `type`="number"),
                    list(
                        `name`="sucra", 
                        `title`="SUCRA", 
                        `type`="number"),
                    list(
                        `name`="prob_best", 
                        `title`="P(Best)", 
                        `type`="number"),
                    list(
                        `name`="prob_worst", 
                        `title`="P(Worst)", 
                        `type`="number"),
                    list(
                        `name`="rank_95_credible", 
                        `title`="95% CrI Rank", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="pairwiseComparisons",
                title="All Pairwise Comparisons",
                columns=list(
                    list(
                        `name`="treatment_a", 
                        `title`="Treatment A", 
                        `type`="text"),
                    list(
                        `name`="treatment_b", 
                        `title`="Treatment B", 
                        `type`="text"),
                    list(
                        `name`="effect_estimate", 
                        `title`="Effect Estimate", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_lower", 
                        `title`="CrI Lower", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_upper", 
                        `title`="CrI Upper", 
                        `type`="number"),
                    list(
                        `name`="prob_a_better", 
                        `title`="P(A > B)", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="leagueTable",
                title="League Table Matrix",
                columns=list(
                    list(
                        `name`="comparison_matrix", 
                        `title`="Treatment Comparison Matrix", 
                        `type`="text"),
                    list(
                        `name`="lower_triangle", 
                        `title`="Effect Estimates (Lower)", 
                        `type`="text"),
                    list(
                        `name`="upper_triangle", 
                        `title`="Probabilities (Upper)", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelComparison",
                title="Model Selection and Comparison",
                columns=list(
                    list(
                        `name`="model", 
                        `title`="Model", 
                        `type`="text"),
                    list(
                        `name`="dic", 
                        `title`="DIC", 
                        `type`="number"),
                    list(
                        `name`="pd", 
                        `title`="pD", 
                        `type`="number"),
                    list(
                        `name`="waic", 
                        `title`="WAIC", 
                        `type`="number"),
                    list(
                        `name`="loo", 
                        `title`="LOO", 
                        `type`="number"),
                    list(
                        `name`="model_weight", 
                        `title`="Model Weight", 
                        `type`="number"),
                    list(
                        `name`="preferred", 
                        `title`="Preferred Model", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="convergenceDiagnostics",
                title="MCMC Convergence Diagnostics",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="rhat", 
                        `title`="R\u0302", 
                        `type`="number"),
                    list(
                        `name`="ess_bulk", 
                        `title`="Bulk ESS", 
                        `type`="integer"),
                    list(
                        `name`="ess_tail", 
                        `title`="Tail ESS", 
                        `type`="integer"),
                    list(
                        `name`="mcse", 
                        `title`="Monte Carlo SE", 
                        `type`="number"),
                    list(
                        `name`="convergence_status", 
                        `title`="Convergence Status", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="metaRegressionResults",
                title="Meta-Regression Results",
                columns=list(
                    list(
                        `name`="covariate", 
                        `title`="Covariate", 
                        `type`="text"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number"),
                    list(
                        `name`="posterior_sd", 
                        `title`="Posterior SD", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_lower", 
                        `title`="CrI Lower", 
                        `type`="number"),
                    list(
                        `name`="credible_interval_upper", 
                        `title`="CrI Upper", 
                        `type`="number"),
                    list(
                        `name`="prob_positive_effect", 
                        `title`="P(\u03B2 > 0)", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="sensitivityAnalysis",
                title="Sensitivity Analysis Results",
                columns=list(
                    list(
                        `name`="scenario", 
                        `title`="Scenario", 
                        `type`="text"),
                    list(
                        `name`="treatment_effect", 
                        `title`="Treatment Effect", 
                        `type`="number"),
                    list(
                        `name`="ranking_change", 
                        `title`="Ranking Change", 
                        `type`="text"),
                    list(
                        `name`="robustness_assessment", 
                        `title`="Robustness Assessment", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalInterpretation",
                title="Clinical Interpretation and Recommendations"))
            self$add(jmvcore::Html$new(
                options=options,
                name="methodsExplanation",
                title="Network Meta-Analysis Methods and Theory"))
            self$add(jmvcore::Image$new(
                options=options,
                name="networkPlot",
                title="Network Plot Visualization",
                width=600,
                height=500,
                renderFun=".plotNetwork"))
            self$add(jmvcore::Image$new(
                options=options,
                name="forestPlots",
                title="Network Forest Plots",
                width=700,
                height=600,
                renderFun=".plotForestPlots"))
            self$add(jmvcore::Image$new(
                options=options,
                name="rankingPlots",
                title="Treatment Ranking Visualization",
                width=600,
                height=450,
                renderFun=".plotRankings"))
            self$add(jmvcore::Image$new(
                options=options,
                name="heterogeneityPlots",
                title="Heterogeneity Assessment Plots",
                width=600,
                height=400,
                renderFun=".plotHeterogeneity"))
            self$add(jmvcore::Image$new(
                options=options,
                name="coherencePlots",
                title="Network Coherence Visualization",
                width=600,
                height=400,
                renderFun=".plotCoherence"))
            self$add(jmvcore::Image$new(
                options=options,
                name="posteriorDistributionPlots",
                title="Posterior Distribution Plots",
                width=700,
                height=500,
                renderFun=".plotPosteriorDistributions"))
            self$add(jmvcore::Image$new(
                options=options,
                name="convergencePlots",
                title="MCMC Convergence Plots",
                width=600,
                height=400,
                renderFun=".plotConvergence"))
            self$add(jmvcore::Image$new(
                options=options,
                name="comparisonMatrix",
                title="Treatment Comparison Heatmap",
                width=600,
                height=500,
                renderFun=".plotComparisonMatrix"))}))

bayesiannetworkmaBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "bayesiannetworkmaBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "bayesiannetworkma",
                version = c(0,0,31),
                options = options,
                results = bayesiannetworkmaResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Bayesian Network Meta-Analysis
#'
#' Advanced Bayesian network meta-analysis for multiple treatment comparisons
#' using network geometry. Supports direct and indirect comparisons, network
#' coherence assessment, and ranking of multiple interventions with 
#' uncertainty
#' quantification for clinical decision making.
#' 
#'
#' @examples
#' # Bayesian network meta-analysis
#' bayesiannetworkma(
#'     data = network_data,
#'     study_id = "study",
#'     treatment = "treatment",
#'     outcome = "response",
#'     sample_size = "n",
#'     network_type = "mixed_evidence"
#' )
#'
#' @param data The data as a data frame for Bayesian network meta-analysis.
#' @param study_id .
#' @param treatment .
#' @param outcome .
#' @param sample_size .
#' @param outcomeLevel .
#' @param standard_error For continuous outcomes
#' @param control_rate Baseline event rate for binary outcomes
#' @param network_type .
#' @param outcome_type .
#' @param reference_treatment Reference treatment for network comparisons
#' @param baseline_model .
#' @param random_effects_model .
#' @param heterogeneity_model .
#' @param correlation_structure .
#' @param treatment_effect_prior .
#' @param heterogeneity_prior .
#' @param prior_mean_effect .
#' @param prior_sd_effect .
#' @param prior_heterogeneity_sd .
#' @param assess_coherence .
#' @param coherence_method .
#' @param inconsistency_threshold .
#' @param mcmc_samples .
#' @param mcmc_burnin .
#' @param mcmc_thin .
#' @param mcmc_chains .
#' @param ranking_analysis .
#' @param ranking_measure .
#' @param pairwise_probabilities .
#' @param superiority_threshold Threshold for clinically meaningful
#'   superiority
#' @param model_selection .
#' @param model_comparison_criteria .
#' @param network_plot .
#' @param network_layout .
#' @param edge_weights .
#' @param show_network_summary .
#' @param show_treatment_effects .
#' @param show_heterogeneity_analysis .
#' @param show_coherence_results .
#' @param show_ranking_results .
#' @param show_forest_plots .
#' @param show_league_table .
#' @param show_convergence_diagnostics .
#' @param show_interpretation .
#' @param meta_regression_covariates .
#' @param treatment_classes For class-effect models
#' @param multi_arm_correction .
#' @param zero_events_correction .
#' @param clinical_context .
#' @param confidence_level .
#' @param set_seed .
#' @param seed_value .
#' @param parallel_processing .
#' @param n_cores .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$networkSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$networkCharacteristics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$treatmentEffects} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$heterogeneityAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$coherenceAssessment} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$treatmentRankings} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$pairwiseComparisons} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$leagueTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$modelComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$convergenceDiagnostics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$metaRegressionResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$sensitivityAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$clinicalInterpretation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$methodsExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$networkPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$forestPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$rankingPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$heterogeneityPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$coherencePlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$posteriorDistributionPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$convergencePlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$comparisonMatrix} \tab \tab \tab \tab \tab an image \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$networkSummary$asDF}
#'
#' \code{as.data.frame(results$networkSummary)}
#'
#' @export
bayesiannetworkma <- function(
    data,
    study_id,
    treatment,
    outcome,
    sample_size,
    outcomeLevel,
    standard_error = NULL,
    control_rate = NULL,
    network_type = "mixed_evidence",
    outcome_type = "binary_or",
    reference_treatment,
    baseline_model = "exchangeable",
    random_effects_model = "random_univariate",
    heterogeneity_model = "common",
    correlation_structure = "unstructured",
    treatment_effect_prior = "vague_normal",
    heterogeneity_prior = "half_normal",
    prior_mean_effect = 0,
    prior_sd_effect = 10,
    prior_heterogeneity_sd = 1,
    assess_coherence = TRUE,
    coherence_method = "node_splitting",
    inconsistency_threshold = 0.05,
    mcmc_samples = 10000,
    mcmc_burnin = 5000,
    mcmc_thin = 2,
    mcmc_chains = 3,
    ranking_analysis = TRUE,
    ranking_measure = "sucra",
    pairwise_probabilities = TRUE,
    superiority_threshold = 0,
    model_selection = TRUE,
    model_comparison_criteria = "dic",
    network_plot = TRUE,
    network_layout = "spring",
    edge_weights = "n_studies",
    show_network_summary = TRUE,
    show_treatment_effects = TRUE,
    show_heterogeneity_analysis = TRUE,
    show_coherence_results = TRUE,
    show_ranking_results = TRUE,
    show_forest_plots = TRUE,
    show_league_table = TRUE,
    show_convergence_diagnostics = TRUE,
    show_interpretation = TRUE,
    meta_regression_covariates = NULL,
    treatment_classes = NULL,
    multi_arm_correction = TRUE,
    zero_events_correction = 0.5,
    clinical_context = "therapeutic",
    confidence_level = 0.95,
    set_seed = TRUE,
    seed_value = 42,
    parallel_processing = TRUE,
    n_cores = 2) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("bayesiannetworkma requires jmvcore to be installed (restart may be required)")

    if ( ! missing(study_id)) study_id <- jmvcore::resolveQuo(jmvcore::enquo(study_id))
    if ( ! missing(treatment)) treatment <- jmvcore::resolveQuo(jmvcore::enquo(treatment))
    if ( ! missing(outcome)) outcome <- jmvcore::resolveQuo(jmvcore::enquo(outcome))
    if ( ! missing(sample_size)) sample_size <- jmvcore::resolveQuo(jmvcore::enquo(sample_size))
    if ( ! missing(standard_error)) standard_error <- jmvcore::resolveQuo(jmvcore::enquo(standard_error))
    if ( ! missing(control_rate)) control_rate <- jmvcore::resolveQuo(jmvcore::enquo(control_rate))
    if ( ! missing(meta_regression_covariates)) meta_regression_covariates <- jmvcore::resolveQuo(jmvcore::enquo(meta_regression_covariates))
    if ( ! missing(treatment_classes)) treatment_classes <- jmvcore::resolveQuo(jmvcore::enquo(treatment_classes))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(study_id), study_id, NULL),
            `if`( ! missing(treatment), treatment, NULL),
            `if`( ! missing(outcome), outcome, NULL),
            `if`( ! missing(sample_size), sample_size, NULL),
            `if`( ! missing(standard_error), standard_error, NULL),
            `if`( ! missing(control_rate), control_rate, NULL),
            `if`( ! missing(meta_regression_covariates), meta_regression_covariates, NULL),
            `if`( ! missing(treatment_classes), treatment_classes, NULL))

    for (v in treatment) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in treatment_classes) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- bayesiannetworkmaOptions$new(
        study_id = study_id,
        treatment = treatment,
        outcome = outcome,
        sample_size = sample_size,
        outcomeLevel = outcomeLevel,
        standard_error = standard_error,
        control_rate = control_rate,
        network_type = network_type,
        outcome_type = outcome_type,
        reference_treatment = reference_treatment,
        baseline_model = baseline_model,
        random_effects_model = random_effects_model,
        heterogeneity_model = heterogeneity_model,
        correlation_structure = correlation_structure,
        treatment_effect_prior = treatment_effect_prior,
        heterogeneity_prior = heterogeneity_prior,
        prior_mean_effect = prior_mean_effect,
        prior_sd_effect = prior_sd_effect,
        prior_heterogeneity_sd = prior_heterogeneity_sd,
        assess_coherence = assess_coherence,
        coherence_method = coherence_method,
        inconsistency_threshold = inconsistency_threshold,
        mcmc_samples = mcmc_samples,
        mcmc_burnin = mcmc_burnin,
        mcmc_thin = mcmc_thin,
        mcmc_chains = mcmc_chains,
        ranking_analysis = ranking_analysis,
        ranking_measure = ranking_measure,
        pairwise_probabilities = pairwise_probabilities,
        superiority_threshold = superiority_threshold,
        model_selection = model_selection,
        model_comparison_criteria = model_comparison_criteria,
        network_plot = network_plot,
        network_layout = network_layout,
        edge_weights = edge_weights,
        show_network_summary = show_network_summary,
        show_treatment_effects = show_treatment_effects,
        show_heterogeneity_analysis = show_heterogeneity_analysis,
        show_coherence_results = show_coherence_results,
        show_ranking_results = show_ranking_results,
        show_forest_plots = show_forest_plots,
        show_league_table = show_league_table,
        show_convergence_diagnostics = show_convergence_diagnostics,
        show_interpretation = show_interpretation,
        meta_regression_covariates = meta_regression_covariates,
        treatment_classes = treatment_classes,
        multi_arm_correction = multi_arm_correction,
        zero_events_correction = zero_events_correction,
        clinical_context = clinical_context,
        confidence_level = confidence_level,
        set_seed = set_seed,
        seed_value = seed_value,
        parallel_processing = parallel_processing,
        n_cores = n_cores)

    analysis <- bayesiannetworkmaClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

