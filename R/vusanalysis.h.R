
# This file is automatically generated, you probably don't want to edit this

vusanalysisOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "vusanalysisOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            predictor = NULL,
            multiclass_outcome = NULL,
            outcome_order = "",
            vus_method = "mann_whitney",
            confidence_intervals = TRUE,
            ci_method = "bootstrap",
            bootstrap_samples = 1000,
            confidence_level = 0.95,
            hypothesis_test = TRUE,
            test_method = "bootstrap",
            pairwise_auc = TRUE,
            pairwise_ci = TRUE,
            pairwise_tests = FALSE,
            min_class_size = 10,
            covariate_adjustment = FALSE,
            covariates = NULL,
            stratified_analysis = FALSE,
            stratify_by = NULL,
            plot_3d_surface = FALSE,
            plot_pairwise_rocs = TRUE,
            plot_class_distributions = TRUE,
            plot_type = "boxplot",
            handle_ties = "average",
            random_seed = 12345, ...) {

            super$initialize(
                package="ClinicoPath",
                name="vusanalysis",
                requiresData=TRUE,
                ...)

            private$..predictor <- jmvcore::OptionVariable$new(
                "predictor",
                predictor,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..multiclass_outcome <- jmvcore::OptionVariable$new(
                "multiclass_outcome",
                multiclass_outcome,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..outcome_order <- jmvcore::OptionString$new(
                "outcome_order",
                outcome_order,
                default="")
            private$..vus_method <- jmvcore::OptionList$new(
                "vus_method",
                vus_method,
                options=list(
                    "mann_whitney",
                    "normal",
                    "bootstrap"),
                default="mann_whitney")
            private$..confidence_intervals <- jmvcore::OptionBool$new(
                "confidence_intervals",
                confidence_intervals,
                default=TRUE)
            private$..ci_method <- jmvcore::OptionList$new(
                "ci_method",
                ci_method,
                options=list(
                    "bootstrap",
                    "bca",
                    "asymptotic"),
                default="bootstrap")
            private$..bootstrap_samples <- jmvcore::OptionInteger$new(
                "bootstrap_samples",
                bootstrap_samples,
                default=1000,
                min=100,
                max=10000)
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.8,
                max=0.99)
            private$..hypothesis_test <- jmvcore::OptionBool$new(
                "hypothesis_test",
                hypothesis_test,
                default=TRUE)
            private$..test_method <- jmvcore::OptionList$new(
                "test_method",
                test_method,
                options=list(
                    "bootstrap",
                    "permutation",
                    "asymptotic"),
                default="bootstrap")
            private$..pairwise_auc <- jmvcore::OptionBool$new(
                "pairwise_auc",
                pairwise_auc,
                default=TRUE)
            private$..pairwise_ci <- jmvcore::OptionBool$new(
                "pairwise_ci",
                pairwise_ci,
                default=TRUE)
            private$..pairwise_tests <- jmvcore::OptionBool$new(
                "pairwise_tests",
                pairwise_tests,
                default=FALSE)
            private$..min_class_size <- jmvcore::OptionInteger$new(
                "min_class_size",
                min_class_size,
                default=10,
                min=5,
                max=50)
            private$..covariate_adjustment <- jmvcore::OptionBool$new(
                "covariate_adjustment",
                covariate_adjustment,
                default=FALSE)
            private$..covariates <- jmvcore::OptionVariables$new(
                "covariates",
                covariates,
                suggested=list(
                    "continuous",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..stratified_analysis <- jmvcore::OptionBool$new(
                "stratified_analysis",
                stratified_analysis,
                default=FALSE)
            private$..stratify_by <- jmvcore::OptionVariable$new(
                "stratify_by",
                stratify_by,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..plot_3d_surface <- jmvcore::OptionBool$new(
                "plot_3d_surface",
                plot_3d_surface,
                default=FALSE)
            private$..plot_pairwise_rocs <- jmvcore::OptionBool$new(
                "plot_pairwise_rocs",
                plot_pairwise_rocs,
                default=TRUE)
            private$..plot_class_distributions <- jmvcore::OptionBool$new(
                "plot_class_distributions",
                plot_class_distributions,
                default=TRUE)
            private$..plot_type <- jmvcore::OptionList$new(
                "plot_type",
                plot_type,
                options=list(
                    "boxplot",
                    "violin",
                    "density"),
                default="boxplot")
            private$..handle_ties <- jmvcore::OptionList$new(
                "handle_ties",
                handle_ties,
                options=list(
                    "average",
                    "random",
                    "conservative"),
                default="average")
            private$..random_seed <- jmvcore::OptionInteger$new(
                "random_seed",
                random_seed,
                default=12345,
                min=1,
                max=999999)

            self$.addOption(private$..predictor)
            self$.addOption(private$..multiclass_outcome)
            self$.addOption(private$..outcome_order)
            self$.addOption(private$..vus_method)
            self$.addOption(private$..confidence_intervals)
            self$.addOption(private$..ci_method)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..hypothesis_test)
            self$.addOption(private$..test_method)
            self$.addOption(private$..pairwise_auc)
            self$.addOption(private$..pairwise_ci)
            self$.addOption(private$..pairwise_tests)
            self$.addOption(private$..min_class_size)
            self$.addOption(private$..covariate_adjustment)
            self$.addOption(private$..covariates)
            self$.addOption(private$..stratified_analysis)
            self$.addOption(private$..stratify_by)
            self$.addOption(private$..plot_3d_surface)
            self$.addOption(private$..plot_pairwise_rocs)
            self$.addOption(private$..plot_class_distributions)
            self$.addOption(private$..plot_type)
            self$.addOption(private$..handle_ties)
            self$.addOption(private$..random_seed)
        }),
    active = list(
        predictor = function() private$..predictor$value,
        multiclass_outcome = function() private$..multiclass_outcome$value,
        outcome_order = function() private$..outcome_order$value,
        vus_method = function() private$..vus_method$value,
        confidence_intervals = function() private$..confidence_intervals$value,
        ci_method = function() private$..ci_method$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        confidence_level = function() private$..confidence_level$value,
        hypothesis_test = function() private$..hypothesis_test$value,
        test_method = function() private$..test_method$value,
        pairwise_auc = function() private$..pairwise_auc$value,
        pairwise_ci = function() private$..pairwise_ci$value,
        pairwise_tests = function() private$..pairwise_tests$value,
        min_class_size = function() private$..min_class_size$value,
        covariate_adjustment = function() private$..covariate_adjustment$value,
        covariates = function() private$..covariates$value,
        stratified_analysis = function() private$..stratified_analysis$value,
        stratify_by = function() private$..stratify_by$value,
        plot_3d_surface = function() private$..plot_3d_surface$value,
        plot_pairwise_rocs = function() private$..plot_pairwise_rocs$value,
        plot_class_distributions = function() private$..plot_class_distributions$value,
        plot_type = function() private$..plot_type$value,
        handle_ties = function() private$..handle_ties$value,
        random_seed = function() private$..random_seed$value),
    private = list(
        ..predictor = NA,
        ..multiclass_outcome = NA,
        ..outcome_order = NA,
        ..vus_method = NA,
        ..confidence_intervals = NA,
        ..ci_method = NA,
        ..bootstrap_samples = NA,
        ..confidence_level = NA,
        ..hypothesis_test = NA,
        ..test_method = NA,
        ..pairwise_auc = NA,
        ..pairwise_ci = NA,
        ..pairwise_tests = NA,
        ..min_class_size = NA,
        ..covariate_adjustment = NA,
        ..covariates = NA,
        ..stratified_analysis = NA,
        ..stratify_by = NA,
        ..plot_3d_surface = NA,
        ..plot_pairwise_rocs = NA,
        ..plot_class_distributions = NA,
        ..plot_type = NA,
        ..handle_ties = NA,
        ..random_seed = NA)
)

vusanalysisResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "vusanalysisResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        vusSummary = function() private$.items[["vusSummary"]],
        hypothesisTest = function() private$.items[["hypothesisTest"]],
        classBreakdown = function() private$.items[["classBreakdown"]],
        pairwiseAUC = function() private$.items[["pairwiseAUC"]],
        stratifiedVUS = function() private$.items[["stratifiedVUS"]],
        pairwiseROCPlot = function() private$.items[["pairwiseROCPlot"]],
        classDistributionPlot = function() private$.items[["classDistributionPlot"]],
        surface3DPlot = function() private$.items[["surface3DPlot"]],
        interpretation = function() private$.items[["interpretation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Volume Under ROC Surface (VUS) Analysis")
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="vusSummary",
                title="VUS Summary",
                visible=TRUE,
                rows=1,
                columns=list(
                    list(
                        `name`="n_classes", 
                        `title`="Number of Classes", 
                        `type`="integer"),
                    list(
                        `name`="total_n", 
                        `title`="Total N", 
                        `type`="integer"),
                    list(
                        `name`="vus", 
                        `title`="VUS", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="vus_se", 
                        `title`="SE", 
                        `type`="number"),
                    list(
                        `name`="ci_lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto", 
                        `visible`="(confidence_intervals)"),
                    list(
                        `name`="ci_upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto", 
                        `visible`="(confidence_intervals)"),
                    list(
                        `name`="null_vus", 
                        `title`="Null VUS (1/k!)", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="hypothesisTest",
                title="Hypothesis Test (VUS vs Chance)",
                visible="(hypothesis_test)",
                rows=1,
                columns=list(
                    list(
                        `name`="test_statistic", 
                        `title`="Test Statistic", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="P-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="test_method", 
                        `title`="Test Method", 
                        `type`="text"),
                    list(
                        `name`="conclusion", 
                        `title`="Conclusion (\u03B1=0.05)", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="classBreakdown",
                title="Class Breakdown",
                visible=TRUE,
                columns=list(
                    list(
                        `name`="class", 
                        `title`="Class", 
                        `type`="text"),
                    list(
                        `name`="class_order", 
                        `title`="Order", 
                        `type`="integer"),
                    list(
                        `name`="n", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="mean_predictor", 
                        `title`="Mean Predictor", 
                        `type`="number"),
                    list(
                        `name`="sd_predictor", 
                        `title`="SD Predictor", 
                        `type`="number"),
                    list(
                        `name`="median_predictor", 
                        `title`="Median Predictor", 
                        `type`="number"),
                    list(
                        `name`="min_predictor", 
                        `title`="Min", 
                        `type`="number"),
                    list(
                        `name`="max_predictor", 
                        `title`="Max", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="pairwiseAUC",
                title="Pairwise AUC Comparisons",
                visible="(pairwise_auc)",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="class1", 
                        `title`="Class 1", 
                        `type`="text"),
                    list(
                        `name`="class2", 
                        `title`="Class 2", 
                        `type`="text"),
                    list(
                        `name`="n1", 
                        `title`="N1", 
                        `type`="integer"),
                    list(
                        `name`="n2", 
                        `title`="N2", 
                        `type`="integer"),
                    list(
                        `name`="auc", 
                        `title`="AUC", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="auc_se", 
                        `title`="SE", 
                        `type`="number", 
                        `visible`="(pairwise_ci)"),
                    list(
                        `name`="ci_lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto", 
                        `visible`="(pairwise_ci)"),
                    list(
                        `name`="ci_upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto", 
                        `visible`="(pairwise_ci)"),
                    list(
                        `name`="p_value", 
                        `title`="P-value (H0: AUC=0.5)", 
                        `type`="number", 
                        `format`="zto,pvalue", 
                        `visible`="(pairwise_tests)"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="stratifiedVUS",
                title="Stratified VUS Analysis",
                visible="(stratified_analysis)",
                columns=list(
                    list(
                        `name`="stratum", 
                        `title`="Stratum", 
                        `type`="text"),
                    list(
                        `name`="n", 
                        `title`="N", 
                        `type`="integer"),
                    list(
                        `name`="n_classes", 
                        `title`="Classes Present", 
                        `type`="integer"),
                    list(
                        `name`="vus", 
                        `title`="VUS", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_lower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="ci_upper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="p_value", 
                        `title`="P-value vs Overall", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="pairwiseROCPlot",
                title="Pairwise ROC Curves",
                width=700,
                height=600,
                renderFun=".plotPairwiseROCs",
                visible="(plot_pairwise_rocs)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="classDistributionPlot",
                title="Predictor Distribution by Class",
                width=600,
                height=500,
                renderFun=".plotClassDistributions",
                visible="(plot_class_distributions)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="surface3DPlot",
                title="3D ROC Surface",
                width=700,
                height=700,
                renderFun=".plot3DSurface",
                visible="(plot_3d_surface)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="interpretation",
                title="Interpretation",
                visible=TRUE))}))

vusanalysisBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "vusanalysisBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "vusanalysis",
                version = c(0,0,32),
                options = options,
                results = vusanalysisResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Volume Under ROC Surface (VUS) Analysis
#'
#' Volume Under ROC Surface (VUS) analysis extends the traditional Area Under 
#' the ROC Curve (AUC) to diagnostic tests with three or more ordered classes. 
#' While binary ROC analysis calculates the area under a 2D curve, VUS 
#' calculates the volume under a 3D surface for multi-class problems. The VUS 
#' represents the probability that a randomly selected triple of observations 
#' (one from each class) will be correctly ordered by the diagnostic marker. 
#' VUS ranges from 0 to 1, where 0.5 indicates random classification (no 
#' discrimination), and 1 indicates perfect discrimination across all classes. 
#' This method is particularly valuable for tumor grading (Grade 1/2/3), 
#' disease staging (Stage I/II/III/IV), severity classification 
#' (mild/moderate/severe), and any diagnostic scenario where outcomes 
#' naturally fall into three or more ordered categories. The analysis provides 
#' pairwise AUC comparisons between adjacent classes, overall VUS with 
#' confidence intervals, and hypothesis testing against chance performance. 
#' Essential for validating biomarkers, imaging features, and AI models in 
#' multi-class clinicopathological applications where binary classification is 
#' insufficient.
#' 
#'
#' @examples
#' result <- vusanalysis(
#'     data = tumor_data,
#'     predictor = "biomarker_score",
#'     multiclass_outcome = "tumor_grade",
#'     outcome_order = c("Grade 1", "Grade 2", "Grade 3")
#' )
#'
#' @param data The data as a data frame.
#' @param predictor Continuous predictor variable (biomarker, risk score,
#'   imaging feature). Should be numeric with higher values generally indicating
#'   higher class membership.
#' @param multiclass_outcome Outcome variable with 3 or more ordered classes.
#'   Examples: tumor grade (1/2/3), disease stage (I/II/III/IV), severity
#'   (mild/moderate/severe).
#' @param outcome_order Comma-separated list specifying the order of outcome
#'   classes from low to high. Example: "Grade 1, Grade 2, Grade 3". If not
#'   specified, factor levels are used.
#' @param vus_method Method for VUS estimation. Mann-Whitney is most robust
#'   and recommended for general use. Normal theory assumes multivariate
#'   normality. Bootstrap provides non-parametric confidence intervals.
#' @param confidence_intervals Calculate confidence intervals for VUS using
#'   specified method.
#' @param ci_method Method for confidence interval calculation. Bootstrap is
#'   recommended for most applications. BCa provides bias-corrected intervals.
#' @param bootstrap_samples Number of bootstrap resamples for confidence
#'   intervals and hypothesis testing.
#' @param confidence_level Confidence level for interval estimation.
#' @param hypothesis_test Test null hypothesis: VUS = 1/6 (random
#'   classification for 3 classes). For k classes, null VUS = 1/k!
#' @param test_method Method for hypothesis testing. Bootstrap and permutation
#'   are robust to distributional assumptions.
#' @param pairwise_auc Calculate AUC for all pairwise class comparisons. Helps
#'   identify which class transitions are well-discriminated.
#' @param pairwise_ci Calculate confidence intervals for pairwise AUC
#'   comparisons.
#' @param pairwise_tests Test whether each pairwise AUC differs significantly
#'   from 0.5.
#' @param min_class_size Minimum number of observations required per class for
#'   analysis. Smaller classes may produce unstable estimates.
#' @param covariate_adjustment Adjust VUS for covariates (experimental
#'   feature). Useful for controlling confounding factors.
#' @param covariates Covariates for adjustment (age, sex, site, etc.).
#'   Requires covariate_adjustment = TRUE.
#' @param stratified_analysis Calculate VUS stratified by subgroups to assess
#'   consistency across populations.
#' @param stratify_by Variable for stratified analysis (e.g., age group,
#'   disease subtype).
#' @param plot_3d_surface Generate 3D visualization of ROC surface (requires
#'   additional packages). Warning: May be computationally intensive for large
#'   datasets.
#' @param plot_pairwise_rocs Plot ROC curves for all pairwise class
#'   comparisons.
#' @param plot_class_distributions Display predictor distributions by outcome
#'   class (box plots or density plots).
#' @param plot_type Type of plot for showing predictor distributions across
#'   classes.
#' @param handle_ties Method for handling tied predictor values. Average ranks
#'   is standard for Mann-Whitney based calculations.
#' @param random_seed Random seed for bootstrap and permutation procedures.
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$vusSummary} \tab \tab \tab \tab \tab Overall VUS with confidence intervals \cr
#'   \code{results$hypothesisTest} \tab \tab \tab \tab \tab Test whether VUS differs from random classification \cr
#'   \code{results$classBreakdown} \tab \tab \tab \tab \tab Sample sizes and summary statistics by class \cr
#'   \code{results$pairwiseAUC} \tab \tab \tab \tab \tab AUC for all pairwise class comparisons \cr
#'   \code{results$stratifiedVUS} \tab \tab \tab \tab \tab VUS by subgroup \cr
#'   \code{results$pairwiseROCPlot} \tab \tab \tab \tab \tab ROC curves for all pairwise class comparisons \cr
#'   \code{results$classDistributionPlot} \tab \tab \tab \tab \tab Distribution of predictor values across outcome classes \cr
#'   \code{results$surface3DPlot} \tab \tab \tab \tab \tab Three-dimensional ROC surface visualization \cr
#'   \code{results$interpretation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$vusSummary$asDF}
#'
#' \code{as.data.frame(results$vusSummary)}
#'
#' @export
vusanalysis <- function(
    data,
    predictor,
    multiclass_outcome,
    outcome_order = "",
    vus_method = "mann_whitney",
    confidence_intervals = TRUE,
    ci_method = "bootstrap",
    bootstrap_samples = 1000,
    confidence_level = 0.95,
    hypothesis_test = TRUE,
    test_method = "bootstrap",
    pairwise_auc = TRUE,
    pairwise_ci = TRUE,
    pairwise_tests = FALSE,
    min_class_size = 10,
    covariate_adjustment = FALSE,
    covariates,
    stratified_analysis = FALSE,
    stratify_by,
    plot_3d_surface = FALSE,
    plot_pairwise_rocs = TRUE,
    plot_class_distributions = TRUE,
    plot_type = "boxplot",
    handle_ties = "average",
    random_seed = 12345) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("vusanalysis requires jmvcore to be installed (restart may be required)")

    if ( ! missing(predictor)) predictor <- jmvcore::resolveQuo(jmvcore::enquo(predictor))
    if ( ! missing(multiclass_outcome)) multiclass_outcome <- jmvcore::resolveQuo(jmvcore::enquo(multiclass_outcome))
    if ( ! missing(covariates)) covariates <- jmvcore::resolveQuo(jmvcore::enquo(covariates))
    if ( ! missing(stratify_by)) stratify_by <- jmvcore::resolveQuo(jmvcore::enquo(stratify_by))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(predictor), predictor, NULL),
            `if`( ! missing(multiclass_outcome), multiclass_outcome, NULL),
            `if`( ! missing(covariates), covariates, NULL),
            `if`( ! missing(stratify_by), stratify_by, NULL))

    for (v in multiclass_outcome) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in stratify_by) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- vusanalysisOptions$new(
        predictor = predictor,
        multiclass_outcome = multiclass_outcome,
        outcome_order = outcome_order,
        vus_method = vus_method,
        confidence_intervals = confidence_intervals,
        ci_method = ci_method,
        bootstrap_samples = bootstrap_samples,
        confidence_level = confidence_level,
        hypothesis_test = hypothesis_test,
        test_method = test_method,
        pairwise_auc = pairwise_auc,
        pairwise_ci = pairwise_ci,
        pairwise_tests = pairwise_tests,
        min_class_size = min_class_size,
        covariate_adjustment = covariate_adjustment,
        covariates = covariates,
        stratified_analysis = stratified_analysis,
        stratify_by = stratify_by,
        plot_3d_surface = plot_3d_surface,
        plot_pairwise_rocs = plot_pairwise_rocs,
        plot_class_distributions = plot_class_distributions,
        plot_type = plot_type,
        handle_ties = handle_ties,
        random_seed = random_seed)

    analysis <- vusanalysisClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

