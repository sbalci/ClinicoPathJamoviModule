
# This file is automatically generated, you probably don't want to edit this

pathsamplingOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "pathsamplingOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            totalSamples = NULL,
            firstDetection = NULL,
            positiveCount = NULL,
            positiveSamplesList = NULL,
            sampleType = NULL,
            groupBy = NULL,
            targetConfidence = 0.95,
            maxSamples = 10,
            bootstrapIterations = 10000,
            showBinomialModel = TRUE,
            showBootstrap = TRUE,
            showDetectionCurve = TRUE,
            showSensitivityCI = TRUE,
            setSeed = TRUE,
            seedValue = 42,
            positiveCassettes = NULL,
            maxPositiveSingle = NULL,
            showTumorBurden = FALSE,
            showStageMigration = TRUE,
            showCorrelation = FALSE,
            showDistributionPattern = FALSE,
            distributionThreshold = 5,
            modelType = "binomial",
            totalPopulation = NULL,
            successStates = NULL,
            targetDetections = 1,
            showHypergeometric = FALSE,
            showBetaBinomial = FALSE,
            totalLymphNodes = NULL,
            positiveLymphNodes = NULL,
            showLNAnalysis = FALSE,
            lnrThreshold1 = 0.1,
            lnrThreshold2 = 0.3,
            showEffectSizes = FALSE,
            showOmentumAnalysis = FALSE,
            showClinicalSummary = TRUE,
            showGuidedChecklist = TRUE,
            showEmpiricalCumulative = FALSE,
            showSpatialClustering = FALSE,
            showStratifiedAnalysis = FALSE,
            showPopulationDetection = FALSE,
            showIncrementalYield = FALSE,
            showMultifocalAnalysis = FALSE,
            estimationMethod = "auto", ...) {

            super$initialize(
                package="ClinicoPath",
                name="pathsampling",
                requiresData=TRUE,
                ...)

            private$..totalSamples <- jmvcore::OptionVariable$new(
                "totalSamples",
                totalSamples,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..firstDetection <- jmvcore::OptionVariable$new(
                "firstDetection",
                firstDetection,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..positiveCount <- jmvcore::OptionVariable$new(
                "positiveCount",
                positiveCount,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..positiveSamplesList <- jmvcore::OptionVariable$new(
                "positiveSamplesList",
                positiveSamplesList,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..sampleType <- jmvcore::OptionVariable$new(
                "sampleType",
                sampleType,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..groupBy <- jmvcore::OptionVariable$new(
                "groupBy",
                groupBy,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..targetConfidence <- jmvcore::OptionNumber$new(
                "targetConfidence",
                targetConfidence,
                min=0.5,
                max=0.99,
                default=0.95)
            private$..maxSamples <- jmvcore::OptionInteger$new(
                "maxSamples",
                maxSamples,
                min=1,
                max=50,
                default=10)
            private$..bootstrapIterations <- jmvcore::OptionInteger$new(
                "bootstrapIterations",
                bootstrapIterations,
                min=100,
                max=100000,
                default=10000)
            private$..showBinomialModel <- jmvcore::OptionBool$new(
                "showBinomialModel",
                showBinomialModel,
                default=TRUE)
            private$..showBootstrap <- jmvcore::OptionBool$new(
                "showBootstrap",
                showBootstrap,
                default=TRUE)
            private$..showDetectionCurve <- jmvcore::OptionBool$new(
                "showDetectionCurve",
                showDetectionCurve,
                default=TRUE)
            private$..showSensitivityCI <- jmvcore::OptionBool$new(
                "showSensitivityCI",
                showSensitivityCI,
                default=TRUE)
            private$..setSeed <- jmvcore::OptionBool$new(
                "setSeed",
                setSeed,
                default=TRUE)
            private$..seedValue <- jmvcore::OptionInteger$new(
                "seedValue",
                seedValue,
                default=42,
                min=1)
            private$..positiveCassettes <- jmvcore::OptionVariable$new(
                "positiveCassettes",
                positiveCassettes,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..maxPositiveSingle <- jmvcore::OptionVariable$new(
                "maxPositiveSingle",
                maxPositiveSingle,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..showTumorBurden <- jmvcore::OptionBool$new(
                "showTumorBurden",
                showTumorBurden,
                default=FALSE)
            private$..showStageMigration <- jmvcore::OptionBool$new(
                "showStageMigration",
                showStageMigration,
                default=TRUE)
            private$..showCorrelation <- jmvcore::OptionBool$new(
                "showCorrelation",
                showCorrelation,
                default=FALSE)
            private$..showDistributionPattern <- jmvcore::OptionBool$new(
                "showDistributionPattern",
                showDistributionPattern,
                default=FALSE)
            private$..distributionThreshold <- jmvcore::OptionInteger$new(
                "distributionThreshold",
                distributionThreshold,
                min=1,
                max=20,
                default=5)
            private$..modelType <- jmvcore::OptionList$new(
                "modelType",
                modelType,
                options=list(
                    "binomial",
                    "hypergeometric",
                    "betabinomial"),
                default="binomial")
            private$..totalPopulation <- jmvcore::OptionVariable$new(
                "totalPopulation",
                totalPopulation,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..successStates <- jmvcore::OptionVariable$new(
                "successStates",
                successStates,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..targetDetections <- jmvcore::OptionInteger$new(
                "targetDetections",
                targetDetections,
                min=1,
                max=20,
                default=1)
            private$..showHypergeometric <- jmvcore::OptionBool$new(
                "showHypergeometric",
                showHypergeometric,
                default=FALSE)
            private$..showBetaBinomial <- jmvcore::OptionBool$new(
                "showBetaBinomial",
                showBetaBinomial,
                default=FALSE)
            private$..totalLymphNodes <- jmvcore::OptionVariable$new(
                "totalLymphNodes",
                totalLymphNodes,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..positiveLymphNodes <- jmvcore::OptionVariable$new(
                "positiveLymphNodes",
                positiveLymphNodes,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..showLNAnalysis <- jmvcore::OptionBool$new(
                "showLNAnalysis",
                showLNAnalysis,
                default=FALSE)
            private$..lnrThreshold1 <- jmvcore::OptionNumber$new(
                "lnrThreshold1",
                lnrThreshold1,
                min=0.01,
                max=1,
                default=0.1)
            private$..lnrThreshold2 <- jmvcore::OptionNumber$new(
                "lnrThreshold2",
                lnrThreshold2,
                min=0.01,
                max=1,
                default=0.3)
            private$..showEffectSizes <- jmvcore::OptionBool$new(
                "showEffectSizes",
                showEffectSizes,
                default=FALSE)
            private$..showOmentumAnalysis <- jmvcore::OptionBool$new(
                "showOmentumAnalysis",
                showOmentumAnalysis,
                default=FALSE)
            private$..showClinicalSummary <- jmvcore::OptionBool$new(
                "showClinicalSummary",
                showClinicalSummary,
                default=TRUE)
            private$..showGuidedChecklist <- jmvcore::OptionBool$new(
                "showGuidedChecklist",
                showGuidedChecklist,
                default=TRUE)
            private$..showEmpiricalCumulative <- jmvcore::OptionBool$new(
                "showEmpiricalCumulative",
                showEmpiricalCumulative,
                default=FALSE)
            private$..showSpatialClustering <- jmvcore::OptionBool$new(
                "showSpatialClustering",
                showSpatialClustering,
                default=FALSE)
            private$..showStratifiedAnalysis <- jmvcore::OptionBool$new(
                "showStratifiedAnalysis",
                showStratifiedAnalysis,
                default=FALSE)
            private$..showPopulationDetection <- jmvcore::OptionBool$new(
                "showPopulationDetection",
                showPopulationDetection,
                default=FALSE)
            private$..showIncrementalYield <- jmvcore::OptionBool$new(
                "showIncrementalYield",
                showIncrementalYield,
                default=FALSE)
            private$..showMultifocalAnalysis <- jmvcore::OptionBool$new(
                "showMultifocalAnalysis",
                showMultifocalAnalysis,
                default=FALSE)
            private$..estimationMethod <- jmvcore::OptionList$new(
                "estimationMethod",
                estimationMethod,
                options=list(
                    "auto",
                    "geometric",
                    "empirical"),
                default="auto")

            self$.addOption(private$..totalSamples)
            self$.addOption(private$..firstDetection)
            self$.addOption(private$..positiveCount)
            self$.addOption(private$..positiveSamplesList)
            self$.addOption(private$..sampleType)
            self$.addOption(private$..groupBy)
            self$.addOption(private$..targetConfidence)
            self$.addOption(private$..maxSamples)
            self$.addOption(private$..bootstrapIterations)
            self$.addOption(private$..showBinomialModel)
            self$.addOption(private$..showBootstrap)
            self$.addOption(private$..showDetectionCurve)
            self$.addOption(private$..showSensitivityCI)
            self$.addOption(private$..setSeed)
            self$.addOption(private$..seedValue)
            self$.addOption(private$..positiveCassettes)
            self$.addOption(private$..maxPositiveSingle)
            self$.addOption(private$..showTumorBurden)
            self$.addOption(private$..showStageMigration)
            self$.addOption(private$..showCorrelation)
            self$.addOption(private$..showDistributionPattern)
            self$.addOption(private$..distributionThreshold)
            self$.addOption(private$..modelType)
            self$.addOption(private$..totalPopulation)
            self$.addOption(private$..successStates)
            self$.addOption(private$..targetDetections)
            self$.addOption(private$..showHypergeometric)
            self$.addOption(private$..showBetaBinomial)
            self$.addOption(private$..totalLymphNodes)
            self$.addOption(private$..positiveLymphNodes)
            self$.addOption(private$..showLNAnalysis)
            self$.addOption(private$..lnrThreshold1)
            self$.addOption(private$..lnrThreshold2)
            self$.addOption(private$..showEffectSizes)
            self$.addOption(private$..showOmentumAnalysis)
            self$.addOption(private$..showClinicalSummary)
            self$.addOption(private$..showGuidedChecklist)
            self$.addOption(private$..showEmpiricalCumulative)
            self$.addOption(private$..showSpatialClustering)
            self$.addOption(private$..showStratifiedAnalysis)
            self$.addOption(private$..showPopulationDetection)
            self$.addOption(private$..showIncrementalYield)
            self$.addOption(private$..showMultifocalAnalysis)
            self$.addOption(private$..estimationMethod)
        }),
    active = list(
        totalSamples = function() private$..totalSamples$value,
        firstDetection = function() private$..firstDetection$value,
        positiveCount = function() private$..positiveCount$value,
        positiveSamplesList = function() private$..positiveSamplesList$value,
        sampleType = function() private$..sampleType$value,
        groupBy = function() private$..groupBy$value,
        targetConfidence = function() private$..targetConfidence$value,
        maxSamples = function() private$..maxSamples$value,
        bootstrapIterations = function() private$..bootstrapIterations$value,
        showBinomialModel = function() private$..showBinomialModel$value,
        showBootstrap = function() private$..showBootstrap$value,
        showDetectionCurve = function() private$..showDetectionCurve$value,
        showSensitivityCI = function() private$..showSensitivityCI$value,
        setSeed = function() private$..setSeed$value,
        seedValue = function() private$..seedValue$value,
        positiveCassettes = function() private$..positiveCassettes$value,
        maxPositiveSingle = function() private$..maxPositiveSingle$value,
        showTumorBurden = function() private$..showTumorBurden$value,
        showStageMigration = function() private$..showStageMigration$value,
        showCorrelation = function() private$..showCorrelation$value,
        showDistributionPattern = function() private$..showDistributionPattern$value,
        distributionThreshold = function() private$..distributionThreshold$value,
        modelType = function() private$..modelType$value,
        totalPopulation = function() private$..totalPopulation$value,
        successStates = function() private$..successStates$value,
        targetDetections = function() private$..targetDetections$value,
        showHypergeometric = function() private$..showHypergeometric$value,
        showBetaBinomial = function() private$..showBetaBinomial$value,
        totalLymphNodes = function() private$..totalLymphNodes$value,
        positiveLymphNodes = function() private$..positiveLymphNodes$value,
        showLNAnalysis = function() private$..showLNAnalysis$value,
        lnrThreshold1 = function() private$..lnrThreshold1$value,
        lnrThreshold2 = function() private$..lnrThreshold2$value,
        showEffectSizes = function() private$..showEffectSizes$value,
        showOmentumAnalysis = function() private$..showOmentumAnalysis$value,
        showClinicalSummary = function() private$..showClinicalSummary$value,
        showGuidedChecklist = function() private$..showGuidedChecklist$value,
        showEmpiricalCumulative = function() private$..showEmpiricalCumulative$value,
        showSpatialClustering = function() private$..showSpatialClustering$value,
        showStratifiedAnalysis = function() private$..showStratifiedAnalysis$value,
        showPopulationDetection = function() private$..showPopulationDetection$value,
        showIncrementalYield = function() private$..showIncrementalYield$value,
        showMultifocalAnalysis = function() private$..showMultifocalAnalysis$value,
        estimationMethod = function() private$..estimationMethod$value),
    private = list(
        ..totalSamples = NA,
        ..firstDetection = NA,
        ..positiveCount = NA,
        ..positiveSamplesList = NA,
        ..sampleType = NA,
        ..groupBy = NA,
        ..targetConfidence = NA,
        ..maxSamples = NA,
        ..bootstrapIterations = NA,
        ..showBinomialModel = NA,
        ..showBootstrap = NA,
        ..showDetectionCurve = NA,
        ..showSensitivityCI = NA,
        ..setSeed = NA,
        ..seedValue = NA,
        ..positiveCassettes = NA,
        ..maxPositiveSingle = NA,
        ..showTumorBurden = NA,
        ..showStageMigration = NA,
        ..showCorrelation = NA,
        ..showDistributionPattern = NA,
        ..distributionThreshold = NA,
        ..modelType = NA,
        ..totalPopulation = NA,
        ..successStates = NA,
        ..targetDetections = NA,
        ..showHypergeometric = NA,
        ..showBetaBinomial = NA,
        ..totalLymphNodes = NA,
        ..positiveLymphNodes = NA,
        ..showLNAnalysis = NA,
        ..lnrThreshold1 = NA,
        ..lnrThreshold2 = NA,
        ..showEffectSizes = NA,
        ..showOmentumAnalysis = NA,
        ..showClinicalSummary = NA,
        ..showGuidedChecklist = NA,
        ..showEmpiricalCumulative = NA,
        ..showSpatialClustering = NA,
        ..showStratifiedAnalysis = NA,
        ..showPopulationDetection = NA,
        ..showIncrementalYield = NA,
        ..showMultifocalAnalysis = NA,
        ..estimationMethod = NA)
)

pathsamplingResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "pathsamplingResults",
    inherit = jmvcore::Group,
    active = list(
        welcome = function() private$.items[["welcome"]],
        instructions = function() private$.items[["instructions"]],
        dataInfo = function() private$.items[["dataInfo"]],
        binomialText = function() private$.items[["binomialText"]],
        binomialTable = function() private$.items[["binomialTable"]],
        recommendTable = function() private$.items[["recommendTable"]],
        bootstrapText = function() private$.items[["bootstrapText"]],
        bootstrapTable = function() private$.items[["bootstrapTable"]],
        detectionCurve = function() private$.items[["detectionCurve"]],
        sensitivityPlot = function() private$.items[["sensitivityPlot"]],
        tumorBurdenText = function() private$.items[["tumorBurdenText"]],
        tumorBurdenInfo = function() private$.items[["tumorBurdenInfo"]],
        cassetteDistribution = function() private$.items[["cassetteDistribution"]],
        stageMigrationText = function() private$.items[["stageMigrationText"]],
        stageMigrationTable = function() private$.items[["stageMigrationTable"]],
        correlationText = function() private$.items[["correlationText"]],
        correlationStats = function() private$.items[["correlationStats"]],
        correlationPlot = function() private$.items[["correlationPlot"]],
        distributionPatternText = function() private$.items[["distributionPatternText"]],
        distributionPatternTable = function() private$.items[["distributionPatternTable"]],
        distributionComparisonTable = function() private$.items[["distributionComparisonTable"]],
        recommendText = function() private$.items[["recommendText"]],
        interpretText = function() private$.items[["interpretText"]],
        hypergeometricText = function() private$.items[["hypergeometricText"]],
        hypergeometricTable = function() private$.items[["hypergeometricTable"]],
        hyperRecommendTable = function() private$.items[["hyperRecommendTable"]],
        betaBinomialText = function() private$.items[["betaBinomialText"]],
        betaBinomialTable = function() private$.items[["betaBinomialTable"]],
        betaBinomialRecommendTable = function() private$.items[["betaBinomialRecommendTable"]],
        lnAnalysisText = function() private$.items[["lnAnalysisText"]],
        lnrClassification = function() private$.items[["lnrClassification"]],
        ajccNStage = function() private$.items[["ajccNStage"]],
        adequacyByELN = function() private$.items[["adequacyByELN"]],
        effectSizesText = function() private$.items[["effectSizesText"]],
        effectSizesTable = function() private$.items[["effectSizesTable"]],
        omentumText = function() private$.items[["omentumText"]],
        clinicalSummary = function() private$.items[["clinicalSummary"]],
        keyResults = function() private$.items[["keyResults"]],
        empiricalCumulativeText = function() private$.items[["empiricalCumulativeText"]],
        empiricalCumulativeTable = function() private$.items[["empiricalCumulativeTable"]],
        empiricalCumulativePlot = function() private$.items[["empiricalCumulativePlot"]],
        spatialClusteringText = function() private$.items[["spatialClusteringText"]],
        clusteringTable = function() private$.items[["clusteringTable"]],
        multifocalText = function() private$.items[["multifocalText"]],
        multifocalTable = function() private$.items[["multifocalTable"]],
        stratifiedText = function() private$.items[["stratifiedText"]],
        prevalenceTable = function() private$.items[["prevalenceTable"]],
        stratifiedDetectionTable = function() private$.items[["stratifiedDetectionTable"]],
        populationDetectionText = function() private$.items[["populationDetectionText"]],
        populationDetectionTable = function() private$.items[["populationDetectionTable"]],
        incrementalYieldText = function() private$.items[["incrementalYieldText"]],
        incrementalYieldTable = function() private$.items[["incrementalYieldTable"]],
        referencesText = function() private$.items[["referencesText"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Pathology Sampling Adequacy Analysis")
            self$add(jmvcore::Html$new(
                options=options,
                name="welcome",
                title=""))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Analysis Overview"))
            self$add(jmvcore::Table$new(
                options=options,
                name="dataInfo",
                title="Data Summary",
                clearWith=list(
                    "totalSamples",
                    "firstDetection"),
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="binomialText",
                title="Binomial Probability Model",
                visible="(showBinomialModel)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="binomialTable",
                title="Binomial Model Predictions",
                visible="(showBinomialModel)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Number of Samples", 
                        `type`="integer"),
                    list(
                        `name`="cumProb", 
                        `title`="Cumulative Detection Probability", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="marginalGain", 
                        `title`="Marginal Gain", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="recommendTable",
                title="Minimum Samples for Target Confidence",
                visible="(showBinomialModel)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "targetConfidence"),
                columns=list(
                    list(
                        `name`="confidence", 
                        `title`="Target Confidence", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="minSamples", 
                        `title`="Minimum Samples Required", 
                        `type`="integer"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="bootstrapText",
                title="Bootstrap Resampling Analysis",
                visible="(showBootstrap)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="bootstrapTable",
                title="Bootstrap Sensitivity Estimates",
                visible="(showBootstrap)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "maxSamples",
                    "bootstrapIterations"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Number of Samples", 
                        `type`="integer"),
                    list(
                        `name`="meanSens", 
                        `title`="Mean Sensitivity", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="ciLower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="ciUpper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="detectionCurve",
                title="Diagnostic Yield Curve",
                width=600,
                height=450,
                renderFun=".detectionCurve",
                visible="(showDetectionCurve)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="sensitivityPlot",
                title="Sensitivity with Confidence Intervals",
                width=600,
                height=450,
                renderFun=".sensitivityPlot",
                visible="(showSensitivityCI && showBootstrap)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="tumorBurdenText",
                title="Tumor Burden Analysis",
                visible="(showTumorBurden)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="tumorBurdenInfo",
                title="Cassette Positivity Statistics",
                visible="(showTumorBurden)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes"),
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="cassetteDistribution",
                title="Tumor Distribution Pattern",
                visible="(showTumorBurden)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes"),
                columns=list(
                    list(
                        `name`="pattern", 
                        `title`="Pattern", 
                        `type`="text"),
                    list(
                        `name`="count", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="stageMigrationText",
                title="Stage Migration Analysis",
                visible="(showStageMigration)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="stageMigrationTable",
                title="Detection Rates by Cassette Groups",
                visible="(showStageMigration)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes"),
                columns=list(
                    list(
                        `name`="cassettes", 
                        `title`="Cassettes Examined", 
                        `type`="text"),
                    list(
                        `name`="nCases", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="nPositive", 
                        `title`="Positive Cases", 
                        `type`="integer"),
                    list(
                        `name`="positivityRate", 
                        `title`="Positivity Rate", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="correlationText",
                title="Examined vs Positive Correlation",
                visible="(showCorrelation)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="correlationStats",
                title="Correlation Statistics",
                visible="(showCorrelation)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes"),
                columns=list(
                    list(
                        `name`="statistic", 
                        `title`="Statistic", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="correlationPlot",
                title="Examined vs Positive Cassettes",
                width=600,
                height=450,
                renderFun=".correlationPlot",
                visible="(showCorrelation)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="distributionPatternText",
                title="Distribution Pattern Analysis (Single vs Summed)",
                visible="(showDistributionPattern)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="distributionPatternTable",
                title="Distribution Pattern Classification",
                visible="(showDistributionPattern)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes",
                    "maxPositiveSingle",
                    "distributionThreshold"),
                columns=list(
                    list(
                        `name`="pattern", 
                        `title`="Distribution Pattern", 
                        `type`="text"),
                    list(
                        `name`="count", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="distributionComparisonTable",
                title="Single vs Summed Comparison",
                visible="(showDistributionPattern)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCassettes",
                    "maxPositiveSingle",
                    "distributionThreshold"),
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="recommendText",
                title="Clinical Recommendations"))
            self$add(jmvcore::Html$new(
                options=options,
                name="interpretText",
                title="Statistical Interpretation"))
            self$add(jmvcore::Html$new(
                options=options,
                name="hypergeometricText",
                title="Hypergeometric Probability Model",
                visible="(showHypergeometric)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="hypergeometricTable",
                title="Hypergeometric Model Predictions",
                visible="(showHypergeometric)",
                clearWith=list(
                    "totalPopulation",
                    "successStates",
                    "targetDetections",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Number of Samples", 
                        `type`="integer"),
                    list(
                        `name`="cumProb", 
                        `title`="P(detect \u2265k)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="marginalGain", 
                        `title`="Marginal Gain", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="hyperRecommendTable",
                title="Minimum Samples for Target Confidence (Hypergeometric)",
                visible="(showHypergeometric)",
                clearWith=list(
                    "totalPopulation",
                    "successStates",
                    "targetDetections",
                    "targetConfidence"),
                columns=list(
                    list(
                        `name`="confidence", 
                        `title`="Target Confidence", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="minSamples", 
                        `title`="Minimum Samples Required", 
                        `type`="integer"),
                    list(
                        `name`="expectedYield", 
                        `title`="Expected Detections", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="betaBinomialText",
                title="Beta-Binomial Probability Model",
                visible="(showBetaBinomial)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="betaBinomialTable",
                title="Beta-Binomial Model Predictions",
                visible="(showBetaBinomial)",
                clearWith=list(
                    "totalPopulation",
                    "successStates",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Number of Samples", 
                        `type`="integer"),
                    list(
                        `name`="cumProb", 
                        `title`="P(detect \u2265k)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="marginalGain", 
                        `title`="Marginal Gain", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="betaBinomialRecommendTable",
                title="Minimum Samples for Target Confidence (Beta-Binomial)",
                visible="(showBetaBinomial)",
                clearWith=list(
                    "totalPopulation",
                    "successStates",
                    "targetConfidence"),
                columns=list(
                    list(
                        `name`="confidence", 
                        `title`="Target Confidence", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="minSamples", 
                        `title`="Minimum Samples Required", 
                        `type`="integer"),
                    list(
                        `name`="expectedYield", 
                        `title`="Expected Detections", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="lnAnalysisText",
                title="Lymph Node Ratio and Staging Analysis",
                visible="(showLNAnalysis)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="lnrClassification",
                title="Lymph Node Ratio Classification",
                visible="(showLNAnalysis)",
                clearWith=list(
                    "totalPopulation",
                    "metastaticLN",
                    "lnrThreshold1",
                    "lnrThreshold2"),
                columns=list(
                    list(
                        `name`="lnrStage", 
                        `title`="LNR Stage", 
                        `type`="text"),
                    list(
                        `name`="lnrRange", 
                        `title`="LNR Range", 
                        `type`="text"),
                    list(
                        `name`="cases", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="medianELN", 
                        `title`="Median ELN", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="ajccNStage",
                title="AJCC N Stage Distribution",
                visible="(showLNAnalysis)",
                clearWith=list(
                    "metastaticLN"),
                columns=list(
                    list(
                        `name`="nStage", 
                        `title`="N Stage", 
                        `type`="text"),
                    list(
                        `name`="criteria", 
                        `title`="Criteria", 
                        `type`="text"),
                    list(
                        `name`="cases", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="medianELN", 
                        `title`="Median ELN", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="adequacyByELN",
                title="Adequacy Assessment by ELN Thresholds",
                visible="(showLNAnalysis)",
                clearWith=list(
                    "totalPopulation",
                    "metastaticLN"),
                columns=list(
                    list(
                        `name`="elnGroup", 
                        `title`="ELN Group", 
                        `type`="text"),
                    list(
                        `name`="cases", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="nPositive", 
                        `title`="N+ Cases", 
                        `type`="integer"),
                    list(
                        `name`="comment", 
                        `title`="Adequacy Comment", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="effectSizesText",
                title="Effect Size Measures",
                visible="(showEffectSizes)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="effectSizesTable",
                title="Effect Size Statistics",
                visible="(showEffectSizes)",
                clearWith=list(
                    "totalPopulation",
                    "metastaticLN"),
                columns=list(
                    list(
                        `name`="measure", 
                        `title`="Measure", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="omentumText",
                title="Omentum Sampling Literature",
                visible="(showOmentumAnalysis)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalSummary",
                title="Clinical Summary",
                visible="(showClinicalSummary)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="keyResults",
                title="Key Results Summary"))
            self$add(jmvcore::Html$new(
                options=options,
                name="empiricalCumulativeText",
                title="Empirical Cumulative Detection Analysis",
                visible="(showEmpiricalCumulative)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="empiricalCumulativeTable",
                title="Empirical Detection Rates by Sample Threshold",
                visible="(showEmpiricalCumulative)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "positiveCount"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Samples Examined", 
                        `type`="integer"),
                    list(
                        `name`="cumDetection", 
                        `title`="Cumulative Detection", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="ciLower", 
                        `title`="95% CI Lower", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="ciUpper", 
                        `title`="95% CI Upper", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="incrementalYield", 
                        `title`="Incremental Yield", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="empiricalCumulativePlot",
                title="Empirical Cumulative Detection Curve",
                width=600,
                height=450,
                renderFun=".empiricalCumulativePlot",
                visible="(showEmpiricalCumulative)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="spatialClusteringText",
                title="Spatial Clustering Analysis",
                visible="(showSpatialClustering)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="clusteringTable",
                title="Spatial Distribution Patterns",
                visible="(showSpatialClustering)",
                clearWith=list(
                    "totalSamples",
                    "positiveSamplesList"),
                columns=list(
                    list(
                        `name`="pattern", 
                        `title`="Pattern", 
                        `type`="text"),
                    list(
                        `name`="count", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="meanClusterIndex", 
                        `title`="Mean Clustering Index", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="multifocalText",
                title="Multifocal Detection Analysis",
                visible="(showMultifocalAnalysis)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="multifocalTable",
                title="Number of Foci Distribution",
                visible="(showMultifocalAnalysis)",
                clearWith=list(
                    "totalSamples",
                    "positiveSamplesList"),
                columns=list(
                    list(
                        `name`="fociCount", 
                        `title`="Number of Foci", 
                        `type`="text"),
                    list(
                        `name`="cases", 
                        `title`="Cases", 
                        `type`="integer"),
                    list(
                        `name`="percent", 
                        `title`="Percentage", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="meanFirstDetection", 
                        `title`="Mean First Detection", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="stratifiedText",
                title="Stratified Analysis by Sample Type",
                visible="(showStratifiedAnalysis)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="prevalenceTable",
                title="Prevalence by Sample Type",
                visible="(showStratifiedAnalysis)",
                clearWith=list(
                    "sampleType",
                    "firstDetection"),
                columns=list(
                    list(
                        `name`="sampleType", 
                        `title`="Sample Type", 
                        `type`="text"),
                    list(
                        `name`="totalCases", 
                        `title`="Total Cases", 
                        `type`="integer"),
                    list(
                        `name`="positiveCases", 
                        `title`="Positive Cases", 
                        `type`="integer"),
                    list(
                        `name`="prevalence", 
                        `title`="Prevalence", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="qEstimate", 
                        `title`="q (per-sample prob)", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="stratifiedDetectionTable",
                title="Detection Probability by Sample Type and Threshold",
                visible="(showStratifiedAnalysis)",
                clearWith=list(
                    "sampleType",
                    "firstDetection",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="sampleType", 
                        `title`="Sample Type", 
                        `type`="text"),
                    list(
                        `name`="nSamples", 
                        `title`="Samples", 
                        `type`="integer"),
                    list(
                        `name`="conditionalDetection", 
                        `title`="P(detect | present)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="populationDetection", 
                        `title`="P(detect overall)", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="populationDetectionText",
                title="Population-Level Detection Rates",
                visible="(showPopulationDetection)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="populationDetectionTable",
                title="Conditional vs Population Detection",
                visible="(showPopulationDetection)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="nSamples", 
                        `title`="Samples", 
                        `type`="integer"),
                    list(
                        `name`="prevalence", 
                        `title`="Prevalence", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="conditional", 
                        `title`="Sensitivity (given present)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="population", 
                        `title`="Detection Rate (overall)", 
                        `type`="number", 
                        `format`="pc"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="incrementalYieldText",
                title="Incremental Diagnostic Yield Analysis",
                visible="(showIncrementalYield)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="incrementalYieldTable",
                title="Marginal Benefit per Additional Sample",
                visible="(showIncrementalYield)",
                clearWith=list(
                    "totalSamples",
                    "firstDetection",
                    "maxSamples"),
                columns=list(
                    list(
                        `name`="fromSamples", 
                        `title`="From N Samples", 
                        `type`="integer"),
                    list(
                        `name`="toSamples", 
                        `title`="To N+1 Samples", 
                        `type`="integer"),
                    list(
                        `name`="incrementalDetection", 
                        `title`="Additional Detection Rate", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="casesDetected", 
                        `title`="Additional Cases per 100", 
                        `type`="number"),
                    list(
                        `name`="costBenefit", 
                        `title`="Cost-Benefit Rating", 
                        `type`="text"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="referencesText",
                title="Statistical Methods & References"))}))

pathsamplingBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "pathsamplingBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "pathsampling",
                version = c(1,0,0),
                options = options,
                results = pathsamplingResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Pathology Sampling Adequacy Analysis
#'
#' 
#' @param data .
#' @param totalSamples .
#' @param firstDetection .
#' @param positiveCount .
#' @param positiveSamplesList .
#' @param sampleType .
#' @param groupBy .
#' @param targetConfidence .
#' @param maxSamples .
#' @param bootstrapIterations .
#' @param showBinomialModel .
#' @param showBootstrap .
#' @param showDetectionCurve .
#' @param showSensitivityCI .
#' @param setSeed .
#' @param seedValue .
#' @param positiveCassettes .
#' @param maxPositiveSingle .
#' @param showTumorBurden .
#' @param showStageMigration .
#' @param showCorrelation .
#' @param showDistributionPattern .
#' @param distributionThreshold .
#' @param modelType .
#' @param totalPopulation .
#' @param successStates .
#' @param targetDetections .
#' @param showHypergeometric .
#' @param showBetaBinomial .
#' @param totalLymphNodes .
#' @param positiveLymphNodes .
#' @param showLNAnalysis .
#' @param lnrThreshold1 .
#' @param lnrThreshold2 .
#' @param showEffectSizes .
#' @param showOmentumAnalysis .
#' @param showClinicalSummary .
#' @param showGuidedChecklist .
#' @param showEmpiricalCumulative .
#' @param showSpatialClustering .
#' @param showStratifiedAnalysis .
#' @param showPopulationDetection .
#' @param showIncrementalYield .
#' @param showMultifocalAnalysis .
#' @param estimationMethod .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$welcome} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$dataInfo} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$binomialText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$binomialTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$recommendTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$bootstrapText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$bootstrapTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$detectionCurve} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$sensitivityPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$tumorBurdenText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$tumorBurdenInfo} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$cassetteDistribution} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stageMigrationText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$stageMigrationTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$correlationText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$correlationStats} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$correlationPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$distributionPatternText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$distributionPatternTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$distributionComparisonTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$recommendText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$interpretText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$hypergeometricText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$hypergeometricTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$hyperRecommendTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$betaBinomialText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$betaBinomialTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$betaBinomialRecommendTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$lnAnalysisText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$lnrClassification} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$ajccNStage} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$adequacyByELN} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$effectSizesText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$effectSizesTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$omentumText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$clinicalSummary} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$keyResults} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$empiricalCumulativeText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$empiricalCumulativeTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$empiricalCumulativePlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$spatialClusteringText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$clusteringTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$multifocalText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$multifocalTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stratifiedText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$prevalenceTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$stratifiedDetectionTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$populationDetectionText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$populationDetectionTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$incrementalYieldText} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$incrementalYieldTable} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$referencesText} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$dataInfo$asDF}
#'
#' \code{as.data.frame(results$dataInfo)}
#'
#' @export
pathsampling <- function(
    data,
    totalSamples,
    firstDetection,
    positiveCount,
    positiveSamplesList,
    sampleType,
    groupBy,
    targetConfidence = 0.95,
    maxSamples = 10,
    bootstrapIterations = 10000,
    showBinomialModel = TRUE,
    showBootstrap = TRUE,
    showDetectionCurve = TRUE,
    showSensitivityCI = TRUE,
    setSeed = TRUE,
    seedValue = 42,
    positiveCassettes,
    maxPositiveSingle,
    showTumorBurden = FALSE,
    showStageMigration = TRUE,
    showCorrelation = FALSE,
    showDistributionPattern = FALSE,
    distributionThreshold = 5,
    modelType = "binomial",
    totalPopulation,
    successStates,
    targetDetections = 1,
    showHypergeometric = FALSE,
    showBetaBinomial = FALSE,
    totalLymphNodes,
    positiveLymphNodes,
    showLNAnalysis = FALSE,
    lnrThreshold1 = 0.1,
    lnrThreshold2 = 0.3,
    showEffectSizes = FALSE,
    showOmentumAnalysis = FALSE,
    showClinicalSummary = TRUE,
    showGuidedChecklist = TRUE,
    showEmpiricalCumulative = FALSE,
    showSpatialClustering = FALSE,
    showStratifiedAnalysis = FALSE,
    showPopulationDetection = FALSE,
    showIncrementalYield = FALSE,
    showMultifocalAnalysis = FALSE,
    estimationMethod = "auto") {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("pathsampling requires jmvcore to be installed (restart may be required)")

    if ( ! missing(totalSamples)) totalSamples <- jmvcore::resolveQuo(jmvcore::enquo(totalSamples))
    if ( ! missing(firstDetection)) firstDetection <- jmvcore::resolveQuo(jmvcore::enquo(firstDetection))
    if ( ! missing(positiveCount)) positiveCount <- jmvcore::resolveQuo(jmvcore::enquo(positiveCount))
    if ( ! missing(positiveSamplesList)) positiveSamplesList <- jmvcore::resolveQuo(jmvcore::enquo(positiveSamplesList))
    if ( ! missing(sampleType)) sampleType <- jmvcore::resolveQuo(jmvcore::enquo(sampleType))
    if ( ! missing(groupBy)) groupBy <- jmvcore::resolveQuo(jmvcore::enquo(groupBy))
    if ( ! missing(positiveCassettes)) positiveCassettes <- jmvcore::resolveQuo(jmvcore::enquo(positiveCassettes))
    if ( ! missing(maxPositiveSingle)) maxPositiveSingle <- jmvcore::resolveQuo(jmvcore::enquo(maxPositiveSingle))
    if ( ! missing(totalPopulation)) totalPopulation <- jmvcore::resolveQuo(jmvcore::enquo(totalPopulation))
    if ( ! missing(successStates)) successStates <- jmvcore::resolveQuo(jmvcore::enquo(successStates))
    if ( ! missing(totalLymphNodes)) totalLymphNodes <- jmvcore::resolveQuo(jmvcore::enquo(totalLymphNodes))
    if ( ! missing(positiveLymphNodes)) positiveLymphNodes <- jmvcore::resolveQuo(jmvcore::enquo(positiveLymphNodes))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(totalSamples), totalSamples, NULL),
            `if`( ! missing(firstDetection), firstDetection, NULL),
            `if`( ! missing(positiveCount), positiveCount, NULL),
            `if`( ! missing(positiveSamplesList), positiveSamplesList, NULL),
            `if`( ! missing(sampleType), sampleType, NULL),
            `if`( ! missing(groupBy), groupBy, NULL),
            `if`( ! missing(positiveCassettes), positiveCassettes, NULL),
            `if`( ! missing(maxPositiveSingle), maxPositiveSingle, NULL),
            `if`( ! missing(totalPopulation), totalPopulation, NULL),
            `if`( ! missing(successStates), successStates, NULL),
            `if`( ! missing(totalLymphNodes), totalLymphNodes, NULL),
            `if`( ! missing(positiveLymphNodes), positiveLymphNodes, NULL))

    for (v in sampleType) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in groupBy) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- pathsamplingOptions$new(
        totalSamples = totalSamples,
        firstDetection = firstDetection,
        positiveCount = positiveCount,
        positiveSamplesList = positiveSamplesList,
        sampleType = sampleType,
        groupBy = groupBy,
        targetConfidence = targetConfidence,
        maxSamples = maxSamples,
        bootstrapIterations = bootstrapIterations,
        showBinomialModel = showBinomialModel,
        showBootstrap = showBootstrap,
        showDetectionCurve = showDetectionCurve,
        showSensitivityCI = showSensitivityCI,
        setSeed = setSeed,
        seedValue = seedValue,
        positiveCassettes = positiveCassettes,
        maxPositiveSingle = maxPositiveSingle,
        showTumorBurden = showTumorBurden,
        showStageMigration = showStageMigration,
        showCorrelation = showCorrelation,
        showDistributionPattern = showDistributionPattern,
        distributionThreshold = distributionThreshold,
        modelType = modelType,
        totalPopulation = totalPopulation,
        successStates = successStates,
        targetDetections = targetDetections,
        showHypergeometric = showHypergeometric,
        showBetaBinomial = showBetaBinomial,
        totalLymphNodes = totalLymphNodes,
        positiveLymphNodes = positiveLymphNodes,
        showLNAnalysis = showLNAnalysis,
        lnrThreshold1 = lnrThreshold1,
        lnrThreshold2 = lnrThreshold2,
        showEffectSizes = showEffectSizes,
        showOmentumAnalysis = showOmentumAnalysis,
        showClinicalSummary = showClinicalSummary,
        showGuidedChecklist = showGuidedChecklist,
        showEmpiricalCumulative = showEmpiricalCumulative,
        showSpatialClustering = showSpatialClustering,
        showStratifiedAnalysis = showStratifiedAnalysis,
        showPopulationDetection = showPopulationDetection,
        showIncrementalYield = showIncrementalYield,
        showMultifocalAnalysis = showMultifocalAnalysis,
        estimationMethod = estimationMethod)

    analysis <- pathsamplingClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

