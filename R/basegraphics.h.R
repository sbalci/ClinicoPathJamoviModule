
# This file is automatically generated, you probably don't want to edit this

basegraphicsOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "basegraphicsOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            plot_type = "scatter",
            x_var = NULL,
            y_var = NULL,
            group_var = NULL,
            main_title = "",
            x_label = "",
            y_label = "",
            point_type = "16",
            point_size = 1,
            color_scheme = "default",
            add_grid = TRUE,
            add_legend = TRUE,
            bins = 15,
            show_statistics = FALSE,
            custom_limits = FALSE,
            x_min = NULL,
            x_max = NULL,
            y_min = NULL,
            y_max = NULL, ...) {

            super$initialize(
                package="ClinicoPath",
                name="basegraphics",
                requiresData=TRUE,
                ...)

            private$..plot_type <- jmvcore::OptionList$new(
                "plot_type",
                plot_type,
                options=list(
                    "scatter",
                    "line",
                    "histogram",
                    "boxplot",
                    "barplot",
                    "density",
                    "pairs",
                    "matplot"),
                default="scatter")
            private$..x_var <- jmvcore::OptionVariable$new(
                "x_var",
                x_var,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..y_var <- jmvcore::OptionVariable$new(
                "y_var",
                y_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..group_var <- jmvcore::OptionVariable$new(
                "group_var",
                group_var,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor"))
            private$..main_title <- jmvcore::OptionString$new(
                "main_title",
                main_title,
                default="")
            private$..x_label <- jmvcore::OptionString$new(
                "x_label",
                x_label,
                default="")
            private$..y_label <- jmvcore::OptionString$new(
                "y_label",
                y_label,
                default="")
            private$..point_type <- jmvcore::OptionList$new(
                "point_type",
                point_type,
                options=list(
                    "1",
                    "2",
                    "3",
                    "4",
                    "5",
                    "15",
                    "16",
                    "17",
                    "18",
                    "19"),
                default="16")
            private$..point_size <- jmvcore::OptionNumber$new(
                "point_size",
                point_size,
                min=0.5,
                max=3,
                default=1)
            private$..color_scheme <- jmvcore::OptionList$new(
                "color_scheme",
                color_scheme,
                options=list(
                    "default",
                    "rainbow",
                    "heat",
                    "terrain",
                    "topo",
                    "cm"),
                default="default")
            private$..add_grid <- jmvcore::OptionBool$new(
                "add_grid",
                add_grid,
                default=TRUE)
            private$..add_legend <- jmvcore::OptionBool$new(
                "add_legend",
                add_legend,
                default=TRUE)
            private$..bins <- jmvcore::OptionNumber$new(
                "bins",
                bins,
                min=5,
                max=50,
                default=15)
            private$..show_statistics <- jmvcore::OptionBool$new(
                "show_statistics",
                show_statistics,
                default=FALSE)
            private$..custom_limits <- jmvcore::OptionBool$new(
                "custom_limits",
                custom_limits,
                default=FALSE)
            private$..x_min <- jmvcore::OptionNumber$new(
                "x_min",
                x_min)
            private$..x_max <- jmvcore::OptionNumber$new(
                "x_max",
                x_max)
            private$..y_min <- jmvcore::OptionNumber$new(
                "y_min",
                y_min)
            private$..y_max <- jmvcore::OptionNumber$new(
                "y_max",
                y_max)

            self$.addOption(private$..plot_type)
            self$.addOption(private$..x_var)
            self$.addOption(private$..y_var)
            self$.addOption(private$..group_var)
            self$.addOption(private$..main_title)
            self$.addOption(private$..x_label)
            self$.addOption(private$..y_label)
            self$.addOption(private$..point_type)
            self$.addOption(private$..point_size)
            self$.addOption(private$..color_scheme)
            self$.addOption(private$..add_grid)
            self$.addOption(private$..add_legend)
            self$.addOption(private$..bins)
            self$.addOption(private$..show_statistics)
            self$.addOption(private$..custom_limits)
            self$.addOption(private$..x_min)
            self$.addOption(private$..x_max)
            self$.addOption(private$..y_min)
            self$.addOption(private$..y_max)
        }),
    active = list(
        plot_type = function() private$..plot_type$value,
        x_var = function() private$..x_var$value,
        y_var = function() private$..y_var$value,
        group_var = function() private$..group_var$value,
        main_title = function() private$..main_title$value,
        x_label = function() private$..x_label$value,
        y_label = function() private$..y_label$value,
        point_type = function() private$..point_type$value,
        point_size = function() private$..point_size$value,
        color_scheme = function() private$..color_scheme$value,
        add_grid = function() private$..add_grid$value,
        add_legend = function() private$..add_legend$value,
        bins = function() private$..bins$value,
        show_statistics = function() private$..show_statistics$value,
        custom_limits = function() private$..custom_limits$value,
        x_min = function() private$..x_min$value,
        x_max = function() private$..x_max$value,
        y_min = function() private$..y_min$value,
        y_max = function() private$..y_max$value),
    private = list(
        ..plot_type = NA,
        ..x_var = NA,
        ..y_var = NA,
        ..group_var = NA,
        ..main_title = NA,
        ..x_label = NA,
        ..y_label = NA,
        ..point_type = NA,
        ..point_size = NA,
        ..color_scheme = NA,
        ..add_grid = NA,
        ..add_legend = NA,
        ..bins = NA,
        ..show_statistics = NA,
        ..custom_limits = NA,
        ..x_min = NA,
        ..x_max = NA,
        ..y_min = NA,
        ..y_max = NA)
)

basegraphicsResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "basegraphicsResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        plot_description = function() private$.items[["plot_description"]],
        base_plot = function() private$.items[["base_plot"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Base Graphics Visualization",
                refs=list(
                    "ClinicoPathJamoviModule",
                    "base",
                    "graphics",
                    "grDevices",
                    "janitor",
                    "labelled"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Html$new(
                options=options,
                name="plot_description",
                title="Plot Description",
                visible="(x_var && plot_type)",
                clearWith=list(
                    "plot_type",
                    "x_var",
                    "y_var",
                    "group_var")))
            self$add(jmvcore::Image$new(
                options=options,
                name="base_plot",
                title="Base R Graphics Plot",
                width=700,
                height=500,
                renderFun=".plot_base",
                visible="(x_var && plot_type)",
                clearWith=list(
                    "plot_type",
                    "x_var",
                    "y_var",
                    "group_var",
                    "main_title",
                    "x_label",
                    "y_label",
                    "point_type",
                    "point_size",
                    "color_scheme",
                    "add_grid",
                    "add_legend",
                    "bins",
                    "show_statistics",
                    "custom_limits",
                    "x_min",
                    "x_max",
                    "y_min",
                    "y_max")))}))

basegraphicsBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "basegraphicsBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "basegraphics",
                version = c(0,0,32),
                options = options,
                results = basegraphicsResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Base Graphics Visualization
#'
#' Base R graphics visualization module providing fast, blazing fast, and 
#' extremely customizable data visualization solutions using pure base R 
#' graphics.
#'
#' @examples
#' \donttest{
#' # Example usage:
#' # Scatter plot
#' plot(x, y, main="Scatter Plot", xlab="X Variable", ylab="Y Variable")
#' # Histogram
#' hist(data, main="Histogram", xlab="Values")
#' # Box plot
#' boxplot(data ~ group, main="Box Plot")
#'}
#' @param data The data as a data frame.
#' @param plot_type Type of base R plot to generate.
#' @param x_var Variable for x-axis.
#' @param y_var Variable for y-axis (continuous plots).
#' @param group_var Optional grouping variable for stratified plots.
#' @param main_title Main title for the plot.
#' @param x_label Label for x-axis.
#' @param y_label Label for y-axis.
#' @param point_type Point type for scatter plots (pch parameter).
#' @param point_size Size of points in plots (cex parameter).
#' @param color_scheme Color scheme for grouped plots.
#' @param add_grid Whether to add grid lines to the plot.
#' @param add_legend Whether to add legend for grouped plots.
#' @param bins Number of bins for histogram plots.
#' @param show_statistics Whether to display basic statistics on the plot.
#' @param custom_limits Whether to use custom axis limits.
#' @param x_min Minimum value for x-axis (when custom limits enabled).
#' @param x_max Maximum value for x-axis (when custom limits enabled).
#' @param y_min Minimum value for y-axis (when custom limits enabled).
#' @param y_max Maximum value for y-axis (when custom limits enabled).
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$plot_description} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$base_plot} \tab \tab \tab \tab \tab an image \cr
#' }
#'
#' @export
basegraphics <- function(
    data,
    plot_type = "scatter",
    x_var,
    y_var,
    group_var,
    main_title = "",
    x_label = "",
    y_label = "",
    point_type = "16",
    point_size = 1,
    color_scheme = "default",
    add_grid = TRUE,
    add_legend = TRUE,
    bins = 15,
    show_statistics = FALSE,
    custom_limits = FALSE,
    x_min,
    x_max,
    y_min,
    y_max) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("basegraphics requires jmvcore to be installed (restart may be required)")

    if ( ! missing(x_var)) x_var <- jmvcore::resolveQuo(jmvcore::enquo(x_var))
    if ( ! missing(y_var)) y_var <- jmvcore::resolveQuo(jmvcore::enquo(y_var))
    if ( ! missing(group_var)) group_var <- jmvcore::resolveQuo(jmvcore::enquo(group_var))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(x_var), x_var, NULL),
            `if`( ! missing(y_var), y_var, NULL),
            `if`( ! missing(group_var), group_var, NULL))

    for (v in group_var) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- basegraphicsOptions$new(
        plot_type = plot_type,
        x_var = x_var,
        y_var = y_var,
        group_var = group_var,
        main_title = main_title,
        x_label = x_label,
        y_label = y_label,
        point_type = point_type,
        point_size = point_size,
        color_scheme = color_scheme,
        add_grid = add_grid,
        add_legend = add_legend,
        bins = bins,
        show_statistics = show_statistics,
        custom_limits = custom_limits,
        x_min = x_min,
        x_max = x_max,
        y_min = y_min,
        y_max = y_max)

    analysis <- basegraphicsClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

