
# This file is automatically generated, you probably don't want to edit this

dynamicpredictionOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "dynamicpredictionOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            elapsedtime = NULL,
            outcome = NULL,
            baseline = NULL,
            longitudinal = NULL,
            time_var = NULL,
            subject_id = NULL,
            outcomeLevel = "1",
            prediction_horizon = 24,
            prediction_method = "landmark",
            landmark_times = "6,12,18",
            joint_model_type = "linear_mixed",
            biomarker_model = "linear",
            association_structure = "current_value",
            confidence_level = 0.95,
            mc_samples = 500,
            window_width = 6,
            show_prediction_table = TRUE,
            show_accuracy_metrics = TRUE,
            show_biomarker_effects = TRUE,
            show_model_comparison = FALSE,
            prediction_curves = TRUE,
            biomarker_trajectory = TRUE,
            accuracy_plot = FALSE,
            risk_stratification = FALSE,
            showSummaries = TRUE,
            showExplanations = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="dynamicprediction",
                requiresData=TRUE,
                ...)

            private$..elapsedtime <- jmvcore::OptionVariable$new(
                "elapsedtime",
                elapsedtime,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..outcome <- jmvcore::OptionVariable$new(
                "outcome",
                outcome,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..baseline <- jmvcore::OptionVariables$new(
                "baseline",
                baseline,
                suggested=list(
                    "continuous",
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..longitudinal <- jmvcore::OptionVariables$new(
                "longitudinal",
                longitudinal,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..time_var <- jmvcore::OptionVariable$new(
                "time_var",
                time_var,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..subject_id <- jmvcore::OptionVariable$new(
                "subject_id",
                subject_id,
                suggested=list(
                    "nominal",
                    "ordinal"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..outcomeLevel <- jmvcore::OptionString$new(
                "outcomeLevel",
                outcomeLevel,
                default="1")
            private$..prediction_horizon <- jmvcore::OptionNumber$new(
                "prediction_horizon",
                prediction_horizon,
                default=24,
                min=1)
            private$..prediction_method <- jmvcore::OptionList$new(
                "prediction_method",
                prediction_method,
                options=list(
                    "landmark",
                    "joint_modeling",
                    "dynamic_cox",
                    "super_learning"),
                default="landmark")
            private$..landmark_times <- jmvcore::OptionString$new(
                "landmark_times",
                landmark_times,
                default="6,12,18")
            private$..joint_model_type <- jmvcore::OptionList$new(
                "joint_model_type",
                joint_model_type,
                options=list(
                    "linear_mixed",
                    "spline_mixed",
                    "latent_class",
                    "shared_parameter"),
                default="linear_mixed")
            private$..biomarker_model <- jmvcore::OptionList$new(
                "biomarker_model",
                biomarker_model,
                options=list(
                    "linear",
                    "quadratic",
                    "spline",
                    "random_effects"),
                default="linear")
            private$..association_structure <- jmvcore::OptionList$new(
                "association_structure",
                association_structure,
                options=list(
                    "current_value",
                    "slope",
                    "cumulative",
                    "shared_random_effects"),
                default="current_value")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.5,
                max=0.99)
            private$..mc_samples <- jmvcore::OptionNumber$new(
                "mc_samples",
                mc_samples,
                default=500,
                min=100,
                max=2000)
            private$..window_width <- jmvcore::OptionNumber$new(
                "window_width",
                window_width,
                default=6,
                min=1)
            private$..show_prediction_table <- jmvcore::OptionBool$new(
                "show_prediction_table",
                show_prediction_table,
                default=TRUE)
            private$..show_accuracy_metrics <- jmvcore::OptionBool$new(
                "show_accuracy_metrics",
                show_accuracy_metrics,
                default=TRUE)
            private$..show_biomarker_effects <- jmvcore::OptionBool$new(
                "show_biomarker_effects",
                show_biomarker_effects,
                default=TRUE)
            private$..show_model_comparison <- jmvcore::OptionBool$new(
                "show_model_comparison",
                show_model_comparison,
                default=FALSE)
            private$..prediction_curves <- jmvcore::OptionBool$new(
                "prediction_curves",
                prediction_curves,
                default=TRUE)
            private$..biomarker_trajectory <- jmvcore::OptionBool$new(
                "biomarker_trajectory",
                biomarker_trajectory,
                default=TRUE)
            private$..accuracy_plot <- jmvcore::OptionBool$new(
                "accuracy_plot",
                accuracy_plot,
                default=FALSE)
            private$..risk_stratification <- jmvcore::OptionBool$new(
                "risk_stratification",
                risk_stratification,
                default=FALSE)
            private$..showSummaries <- jmvcore::OptionBool$new(
                "showSummaries",
                showSummaries,
                default=TRUE)
            private$..showExplanations <- jmvcore::OptionBool$new(
                "showExplanations",
                showExplanations,
                default=TRUE)

            self$.addOption(private$..elapsedtime)
            self$.addOption(private$..outcome)
            self$.addOption(private$..baseline)
            self$.addOption(private$..longitudinal)
            self$.addOption(private$..time_var)
            self$.addOption(private$..subject_id)
            self$.addOption(private$..outcomeLevel)
            self$.addOption(private$..prediction_horizon)
            self$.addOption(private$..prediction_method)
            self$.addOption(private$..landmark_times)
            self$.addOption(private$..joint_model_type)
            self$.addOption(private$..biomarker_model)
            self$.addOption(private$..association_structure)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..mc_samples)
            self$.addOption(private$..window_width)
            self$.addOption(private$..show_prediction_table)
            self$.addOption(private$..show_accuracy_metrics)
            self$.addOption(private$..show_biomarker_effects)
            self$.addOption(private$..show_model_comparison)
            self$.addOption(private$..prediction_curves)
            self$.addOption(private$..biomarker_trajectory)
            self$.addOption(private$..accuracy_plot)
            self$.addOption(private$..risk_stratification)
            self$.addOption(private$..showSummaries)
            self$.addOption(private$..showExplanations)
        }),
    active = list(
        elapsedtime = function() private$..elapsedtime$value,
        outcome = function() private$..outcome$value,
        baseline = function() private$..baseline$value,
        longitudinal = function() private$..longitudinal$value,
        time_var = function() private$..time_var$value,
        subject_id = function() private$..subject_id$value,
        outcomeLevel = function() private$..outcomeLevel$value,
        prediction_horizon = function() private$..prediction_horizon$value,
        prediction_method = function() private$..prediction_method$value,
        landmark_times = function() private$..landmark_times$value,
        joint_model_type = function() private$..joint_model_type$value,
        biomarker_model = function() private$..biomarker_model$value,
        association_structure = function() private$..association_structure$value,
        confidence_level = function() private$..confidence_level$value,
        mc_samples = function() private$..mc_samples$value,
        window_width = function() private$..window_width$value,
        show_prediction_table = function() private$..show_prediction_table$value,
        show_accuracy_metrics = function() private$..show_accuracy_metrics$value,
        show_biomarker_effects = function() private$..show_biomarker_effects$value,
        show_model_comparison = function() private$..show_model_comparison$value,
        prediction_curves = function() private$..prediction_curves$value,
        biomarker_trajectory = function() private$..biomarker_trajectory$value,
        accuracy_plot = function() private$..accuracy_plot$value,
        risk_stratification = function() private$..risk_stratification$value,
        showSummaries = function() private$..showSummaries$value,
        showExplanations = function() private$..showExplanations$value),
    private = list(
        ..elapsedtime = NA,
        ..outcome = NA,
        ..baseline = NA,
        ..longitudinal = NA,
        ..time_var = NA,
        ..subject_id = NA,
        ..outcomeLevel = NA,
        ..prediction_horizon = NA,
        ..prediction_method = NA,
        ..landmark_times = NA,
        ..joint_model_type = NA,
        ..biomarker_model = NA,
        ..association_structure = NA,
        ..confidence_level = NA,
        ..mc_samples = NA,
        ..window_width = NA,
        ..show_prediction_table = NA,
        ..show_accuracy_metrics = NA,
        ..show_biomarker_effects = NA,
        ..show_model_comparison = NA,
        ..prediction_curves = NA,
        ..biomarker_trajectory = NA,
        ..accuracy_plot = NA,
        ..risk_stratification = NA,
        ..showSummaries = NA,
        ..showExplanations = NA)
)

dynamicpredictionResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "dynamicpredictionResults",
    inherit = jmvcore::Group,
    active = list(
        todo = function() private$.items[["todo"]],
        predictionSummary = function() private$.items[["predictionSummary"]],
        accuracyMetrics = function() private$.items[["accuracyMetrics"]],
        biomarkerEffects = function() private$.items[["biomarkerEffects"]],
        modelComparison = function() private$.items[["modelComparison"]],
        landmarkAnalysis = function() private$.items[["landmarkAnalysis"]],
        jointModelResults = function() private$.items[["jointModelResults"]],
        trajectoryParameters = function() private$.items[["trajectoryParameters"]],
        methodologyExplanation = function() private$.items[["methodologyExplanation"]],
        analysisSummary = function() private$.items[["analysisSummary"]],
        predictionCurves = function() private$.items[["predictionCurves"]],
        biomarkerTrajectory = function() private$.items[["biomarkerTrajectory"]],
        accuracyPlot = function() private$.items[["accuracyPlot"]],
        riskStratification = function() private$.items[["riskStratification"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Dynamic Survival Prediction")
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="Analysis Complete",
                visible=FALSE))
            self$add(jmvcore::Table$new(
                options=options,
                name="predictionSummary",
                title="Dynamic Prediction Summary",
                visible="(show_prediction_table)",
                columns=list(
                    list(
                        `name`="subject_id", 
                        `title`="Subject ID", 
                        `type`="text"),
                    list(
                        `name`="prediction_time", 
                        `title`="Prediction Time", 
                        `type`="number"),
                    list(
                        `name`="survival_prob", 
                        `title`="Survival Probability", 
                        `type`="number"),
                    list(
                        `name`="risk_score", 
                        `title`="Risk Score", 
                        `type`="number"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number"),
                    list(
                        `name`="risk_category", 
                        `title`="Risk Category", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="accuracyMetrics",
                title="Prediction Accuracy Assessment",
                visible="(show_accuracy_metrics)",
                columns=list(
                    list(
                        `name`="prediction_window", 
                        `title`="Prediction Window", 
                        `type`="number"),
                    list(
                        `name`="c_index", 
                        `title`="C-Index", 
                        `type`="number"),
                    list(
                        `name`="auc", 
                        `title`="AUC", 
                        `type`="number"),
                    list(
                        `name`="brier_score", 
                        `title`="Brier Score", 
                        `type`="number"),
                    list(
                        `name`="calibration_slope", 
                        `title`="Calibration Slope", 
                        `type`="number"),
                    list(
                        `name`="calibration_intercept", 
                        `title`="Calibration Intercept", 
                        `type`="number"),
                    list(
                        `name`="n_predictions", 
                        `title`="N Predictions", 
                        `type`="integer"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="biomarkerEffects",
                title="Biomarker Effects on Survival",
                visible="(show_biomarker_effects)",
                columns=list(
                    list(
                        `name`="biomarker", 
                        `title`="Biomarker", 
                        `type`="text"),
                    list(
                        `name`="association_type", 
                        `title`="Association Type", 
                        `type`="text"),
                    list(
                        `name`="coefficient", 
                        `title`="Coefficient", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number"),
                    list(
                        `name`="z_value", 
                        `title`="z", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="p", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="hazard_ratio", 
                        `title`="Hazard Ratio", 
                        `type`="number"),
                    list(
                        `name`="hr_lower", 
                        `title`="HR Lower", 
                        `type`="number"),
                    list(
                        `name`="hr_upper", 
                        `title`="HR Upper", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelComparison",
                title="Dynamic Prediction Model Comparison",
                visible="(show_model_comparison)",
                columns=list(
                    list(
                        `name`="method", 
                        `title`="Method", 
                        `type`="text"),
                    list(
                        `name`="c_index_overall", 
                        `title`="Overall C-Index", 
                        `type`="number"),
                    list(
                        `name`="auc_mean", 
                        `title`="Mean AUC", 
                        `type`="number"),
                    list(
                        `name`="brier_mean", 
                        `title`="Mean Brier Score", 
                        `type`="number"),
                    list(
                        `name`="computation_time", 
                        `title`="Computation Time (s)", 
                        `type`="number"),
                    list(
                        `name`="complexity_score", 
                        `title`="Model Complexity", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="landmarkAnalysis",
                title="Landmark Analysis Results",
                visible="(prediction_method:landmark)",
                columns=list(
                    list(
                        `name`="landmark_time", 
                        `title`="Landmark Time", 
                        `type`="number"),
                    list(
                        `name`="n_at_risk", 
                        `title`="N at Risk", 
                        `type`="integer"),
                    list(
                        `name`="n_events", 
                        `title`="N Events", 
                        `type`="integer"),
                    list(
                        `name`="model_c_index", 
                        `title`="Model C-Index", 
                        `type`="number"),
                    list(
                        `name`="prediction_accuracy", 
                        `title`="Prediction Accuracy", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="jointModelResults",
                title="Joint Model Parameter Estimates",
                visible="(prediction_method:joint_modeling)",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="component", 
                        `title`="Component", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number"),
                    list(
                        `name`="se", 
                        `title`="SE", 
                        `type`="number"),
                    list(
                        `name`="t_value", 
                        `title`="t", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="p", 
                        `type`="number", 
                        `format`="zto,pvalue"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="trajectoryParameters",
                title="Biomarker Trajectory Parameters",
                columns=list(
                    list(
                        `name`="biomarker", 
                        `title`="Biomarker", 
                        `type`="text"),
                    list(
                        `name`="intercept", 
                        `title`="Intercept", 
                        `type`="number"),
                    list(
                        `name`="slope", 
                        `title`="Slope", 
                        `type`="number"),
                    list(
                        `name`="quadratic", 
                        `title`="Quadratic", 
                        `type`="number"),
                    list(
                        `name`="random_intercept_var", 
                        `title`="Rand. Intercept Var", 
                        `type`="number"),
                    list(
                        `name`="random_slope_var", 
                        `title`="Rand. Slope Var", 
                        `type`="number"),
                    list(
                        `name`="residual_var", 
                        `title`="Residual Var", 
                        `type`="number"))))
            self$add(jmvcore::Html$new(
                options=options,
                name="methodologyExplanation",
                title="Methodology Explanation",
                visible="(showExplanations)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="analysisSummary",
                title="Analysis Summary",
                visible="(showSummaries)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="predictionCurves",
                title="Dynamic Prediction Curves",
                width=700,
                height=500,
                requiresData=TRUE,
                visible="(prediction_curves)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="biomarkerTrajectory",
                title="Biomarker Trajectories",
                width=700,
                height=400,
                requiresData=TRUE,
                visible="(biomarker_trajectory)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="accuracyPlot",
                title="Prediction Accuracy Over Time",
                width=700,
                height=400,
                requiresData=TRUE,
                visible="(accuracy_plot)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="riskStratification",
                title="Risk Stratification",
                width=700,
                height=400,
                requiresData=TRUE,
                visible="(risk_stratification)"))}))

dynamicpredictionBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "dynamicpredictionBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "dynamicprediction",
                version = c(1,0,0),
                options = options,
                results = dynamicpredictionResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Dynamic Survival Prediction
#'
#' Dynamic prediction models provide updated survival predictions as new 
#' longitudinal data becomes available. This approach is particularly valuable 
#' when biomarker values change over time and influence prognosis. The 
#' analysis implements various dynamic prediction methods including landmark 
#' approaches, joint modeling, and dynamic Cox models, allowing for real-time 
#' risk assessment and personalized medicine applications.
#' 
#'
#' @examples
#' data \%>\%
#' dynamicprediction(
#'     elapsedtime = "time_to_event",
#'     outcome = "event_status",
#'     baseline = c("age", "stage"),
#'     longitudinal = c("biomarker", "treatment_response"),
#'     time_var = "measurement_time",
#'     prediction_horizon = 24
#' )
#'
#' @param data the data as a data frame
#' @param elapsedtime Time to event or censoring
#' @param outcome Event indicator (1 = event, 0 = censored)
#' @param baseline Baseline covariates that don't change over time
#' @param longitudinal Time-varying covariates (longitudinal biomarkers)
#' @param time_var Time of longitudinal measurements
#' @param subject_id Subject identifier for longitudinal data
#' @param outcomeLevel Level indicating event occurrence
#' @param prediction_horizon Time horizon for dynamic predictions (in time
#'   units)
#' @param prediction_method Method for dynamic prediction
#' @param landmark_times Comma-separated list of landmark time points for
#'   dynamic updating
#' @param joint_model_type Type of joint model for longitudinal and survival
#'   data
#' @param biomarker_model Model for longitudinal biomarker trajectory
#' @param association_structure How longitudinal process associates with
#'   survival
#' @param confidence_level Confidence level for prediction intervals
#' @param mc_samples Number of Monte Carlo samples for prediction uncertainty
#' @param window_width Width of prediction window for dynamic updating
#' @param show_prediction_table Display table of dynamic predictions
#' @param show_accuracy_metrics Display prediction accuracy assessment
#' @param show_biomarker_effects Display estimated effects of longitudinal
#'   biomarkers
#' @param show_model_comparison Compare different prediction methods
#' @param prediction_curves Display dynamic prediction curves over time
#' @param biomarker_trajectory Display individual biomarker trajectories
#' @param accuracy_plot Display prediction accuracy over time
#' @param risk_stratification Display risk stratification based on dynamic
#'   predictions
#' @param showSummaries Show comprehensive analysis summaries
#' @param showExplanations Show detailed methodology explanations
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$todo} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$predictionSummary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$accuracyMetrics} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$biomarkerEffects} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$modelComparison} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$landmarkAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$jointModelResults} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$trajectoryParameters} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$methodologyExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$analysisSummary} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$predictionCurves} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$biomarkerTrajectory} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$accuracyPlot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$riskStratification} \tab \tab \tab \tab \tab an image \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$predictionSummary$asDF}
#'
#' \code{as.data.frame(results$predictionSummary)}
#'
#' @export
dynamicprediction <- function(
    data,
    elapsedtime,
    outcome,
    baseline,
    longitudinal,
    time_var,
    subject_id,
    outcomeLevel = "1",
    prediction_horizon = 24,
    prediction_method = "landmark",
    landmark_times = "6,12,18",
    joint_model_type = "linear_mixed",
    biomarker_model = "linear",
    association_structure = "current_value",
    confidence_level = 0.95,
    mc_samples = 500,
    window_width = 6,
    show_prediction_table = TRUE,
    show_accuracy_metrics = TRUE,
    show_biomarker_effects = TRUE,
    show_model_comparison = FALSE,
    prediction_curves = TRUE,
    biomarker_trajectory = TRUE,
    accuracy_plot = FALSE,
    risk_stratification = FALSE,
    showSummaries = TRUE,
    showExplanations = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("dynamicprediction requires jmvcore to be installed (restart may be required)")

    if ( ! missing(elapsedtime)) elapsedtime <- jmvcore::resolveQuo(jmvcore::enquo(elapsedtime))
    if ( ! missing(outcome)) outcome <- jmvcore::resolveQuo(jmvcore::enquo(outcome))
    if ( ! missing(baseline)) baseline <- jmvcore::resolveQuo(jmvcore::enquo(baseline))
    if ( ! missing(longitudinal)) longitudinal <- jmvcore::resolveQuo(jmvcore::enquo(longitudinal))
    if ( ! missing(time_var)) time_var <- jmvcore::resolveQuo(jmvcore::enquo(time_var))
    if ( ! missing(subject_id)) subject_id <- jmvcore::resolveQuo(jmvcore::enquo(subject_id))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(elapsedtime), elapsedtime, NULL),
            `if`( ! missing(outcome), outcome, NULL),
            `if`( ! missing(baseline), baseline, NULL),
            `if`( ! missing(longitudinal), longitudinal, NULL),
            `if`( ! missing(time_var), time_var, NULL),
            `if`( ! missing(subject_id), subject_id, NULL))


    options <- dynamicpredictionOptions$new(
        elapsedtime = elapsedtime,
        outcome = outcome,
        baseline = baseline,
        longitudinal = longitudinal,
        time_var = time_var,
        subject_id = subject_id,
        outcomeLevel = outcomeLevel,
        prediction_horizon = prediction_horizon,
        prediction_method = prediction_method,
        landmark_times = landmark_times,
        joint_model_type = joint_model_type,
        biomarker_model = biomarker_model,
        association_structure = association_structure,
        confidence_level = confidence_level,
        mc_samples = mc_samples,
        window_width = window_width,
        show_prediction_table = show_prediction_table,
        show_accuracy_metrics = show_accuracy_metrics,
        show_biomarker_effects = show_biomarker_effects,
        show_model_comparison = show_model_comparison,
        prediction_curves = prediction_curves,
        biomarker_trajectory = biomarker_trajectory,
        accuracy_plot = accuracy_plot,
        risk_stratification = risk_stratification,
        showSummaries = showSummaries,
        showExplanations = showExplanations)

    analysis <- dynamicpredictionClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

