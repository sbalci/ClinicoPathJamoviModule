
# This file is automatically generated, you probably don't want to edit this

clinicalvalidationinteractiveOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalvalidationinteractiveOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            outcome = NULL,
            outcomeLevel = NULL,
            predictors = NULL,
            time_variable = NULL,
            clinical_preset = "custom",
            model_type = "logistic",
            validation_method = "bootstrap",
            bootstrap_samples = 1000,
            cv_folds = 10,
            cv_repeats = 3,
            holdout_proportion = 0.25,
            stratified_sampling = TRUE,
            clinical_context = "diagnosis",
            prevalence_adjustment = FALSE,
            population_prevalence = 10,
            cost_matrix = "equal",
            fn_fp_cost_ratio = 2,
            min_sensitivity = 0.8,
            min_specificity = 0.8,
            min_ppv = 0.7,
            min_npv = 0.9,
            auto_optimize_threshold = FALSE,
            optimization_metric = "youden",
            performance_metrics = "all",
            confidence_level = 0.95,
            show_realtime_metrics = TRUE,
            show_parameter_warnings = TRUE,
            show_clinical_guidance = TRUE,
            show_model_summary = TRUE,
            show_performance_table = TRUE,
            show_calibration_plot = TRUE,
            show_roc_curve = TRUE,
            show_threshold_optimization = FALSE,
            show_clinical_interpretation = TRUE,
            missing_data_handling = "complete_cases",
            set_seed = TRUE,
            seed_value = 42, ...) {

            super$initialize(
                package="ClinicoPath",
                name="clinicalvalidationinteractive",
                requiresData=TRUE,
                ...)

            private$..outcome <- jmvcore::OptionVariable$new(
                "outcome",
                outcome,
                suggested=list(
                    "ordinal",
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..outcomeLevel <- jmvcore::OptionLevel$new(
                "outcomeLevel",
                outcomeLevel,
                variable="(outcome)")
            private$..predictors <- jmvcore::OptionVariables$new(
                "predictors",
                predictors,
                suggested=list(
                    "continuous",
                    "ordinal",
                    "nominal"),
                permitted=list(
                    "numeric",
                    "factor"))
            private$..time_variable <- jmvcore::OptionVariable$new(
                "time_variable",
                time_variable,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"),
                default=NULL)
            private$..clinical_preset <- jmvcore::OptionList$new(
                "clinical_preset",
                clinical_preset,
                options=list(
                    "custom",
                    "diagnostic_biomarker",
                    "cancer_screening",
                    "cardiovascular_risk",
                    "infectious_disease",
                    "surgical_risk",
                    "treatment_response",
                    "histological_classification"),
                default="custom")
            private$..model_type <- jmvcore::OptionList$new(
                "model_type",
                model_type,
                options=list(
                    "logistic",
                    "cox",
                    "random_forest",
                    "svm",
                    "lda"),
                default="logistic")
            private$..validation_method <- jmvcore::OptionList$new(
                "validation_method",
                validation_method,
                options=list(
                    "bootstrap",
                    "cross_validation",
                    "repeated_cv",
                    "holdout",
                    "time_split"),
                default="bootstrap")
            private$..bootstrap_samples <- jmvcore::OptionInteger$new(
                "bootstrap_samples",
                bootstrap_samples,
                default=1000,
                min=100,
                max=5000)
            private$..cv_folds <- jmvcore::OptionInteger$new(
                "cv_folds",
                cv_folds,
                default=10,
                min=3,
                max=20)
            private$..cv_repeats <- jmvcore::OptionInteger$new(
                "cv_repeats",
                cv_repeats,
                default=3,
                min=1,
                max=10)
            private$..holdout_proportion <- jmvcore::OptionNumber$new(
                "holdout_proportion",
                holdout_proportion,
                default=0.25,
                min=0.1,
                max=0.4)
            private$..stratified_sampling <- jmvcore::OptionBool$new(
                "stratified_sampling",
                stratified_sampling,
                default=TRUE)
            private$..clinical_context <- jmvcore::OptionList$new(
                "clinical_context",
                clinical_context,
                options=list(
                    "diagnosis",
                    "screening",
                    "prognosis",
                    "treatment",
                    "risk",
                    "histological"),
                default="diagnosis")
            private$..prevalence_adjustment <- jmvcore::OptionBool$new(
                "prevalence_adjustment",
                prevalence_adjustment,
                default=FALSE)
            private$..population_prevalence <- jmvcore::OptionNumber$new(
                "population_prevalence",
                population_prevalence,
                default=10,
                min=0.1,
                max=50)
            private$..cost_matrix <- jmvcore::OptionList$new(
                "cost_matrix",
                cost_matrix,
                options=list(
                    "equal",
                    "screening",
                    "diagnosis",
                    "custom"),
                default="equal")
            private$..fn_fp_cost_ratio <- jmvcore::OptionNumber$new(
                "fn_fp_cost_ratio",
                fn_fp_cost_ratio,
                default=2,
                min=0.1,
                max=10)
            private$..min_sensitivity <- jmvcore::OptionNumber$new(
                "min_sensitivity",
                min_sensitivity,
                default=0.8,
                min=0.5,
                max=0.99)
            private$..min_specificity <- jmvcore::OptionNumber$new(
                "min_specificity",
                min_specificity,
                default=0.8,
                min=0.5,
                max=0.99)
            private$..min_ppv <- jmvcore::OptionNumber$new(
                "min_ppv",
                min_ppv,
                default=0.7,
                min=0.5,
                max=0.99)
            private$..min_npv <- jmvcore::OptionNumber$new(
                "min_npv",
                min_npv,
                default=0.9,
                min=0.5,
                max=0.99)
            private$..auto_optimize_threshold <- jmvcore::OptionBool$new(
                "auto_optimize_threshold",
                auto_optimize_threshold,
                default=FALSE)
            private$..optimization_metric <- jmvcore::OptionList$new(
                "optimization_metric",
                optimization_metric,
                options=list(
                    "youden",
                    "utility",
                    "f1",
                    "mcc",
                    "custom"),
                default="youden")
            private$..performance_metrics <- jmvcore::OptionList$new(
                "performance_metrics",
                performance_metrics,
                options=list(
                    "all",
                    "clinical",
                    "discrimination",
                    "calibration"),
                default="all")
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                default=0.95,
                min=0.8,
                max=0.99)
            private$..show_realtime_metrics <- jmvcore::OptionBool$new(
                "show_realtime_metrics",
                show_realtime_metrics,
                default=TRUE)
            private$..show_parameter_warnings <- jmvcore::OptionBool$new(
                "show_parameter_warnings",
                show_parameter_warnings,
                default=TRUE)
            private$..show_clinical_guidance <- jmvcore::OptionBool$new(
                "show_clinical_guidance",
                show_clinical_guidance,
                default=TRUE)
            private$..show_model_summary <- jmvcore::OptionBool$new(
                "show_model_summary",
                show_model_summary,
                default=TRUE)
            private$..show_performance_table <- jmvcore::OptionBool$new(
                "show_performance_table",
                show_performance_table,
                default=TRUE)
            private$..show_calibration_plot <- jmvcore::OptionBool$new(
                "show_calibration_plot",
                show_calibration_plot,
                default=TRUE)
            private$..show_roc_curve <- jmvcore::OptionBool$new(
                "show_roc_curve",
                show_roc_curve,
                default=TRUE)
            private$..show_threshold_optimization <- jmvcore::OptionBool$new(
                "show_threshold_optimization",
                show_threshold_optimization,
                default=FALSE)
            private$..show_clinical_interpretation <- jmvcore::OptionBool$new(
                "show_clinical_interpretation",
                show_clinical_interpretation,
                default=TRUE)
            private$..missing_data_handling <- jmvcore::OptionList$new(
                "missing_data_handling",
                missing_data_handling,
                options=list(
                    "complete_cases",
                    "imputation",
                    "indicator"),
                default="complete_cases")
            private$..set_seed <- jmvcore::OptionBool$new(
                "set_seed",
                set_seed,
                default=TRUE)
            private$..seed_value <- jmvcore::OptionInteger$new(
                "seed_value",
                seed_value,
                default=42,
                min=1,
                max=999999)

            self$.addOption(private$..outcome)
            self$.addOption(private$..outcomeLevel)
            self$.addOption(private$..predictors)
            self$.addOption(private$..time_variable)
            self$.addOption(private$..clinical_preset)
            self$.addOption(private$..model_type)
            self$.addOption(private$..validation_method)
            self$.addOption(private$..bootstrap_samples)
            self$.addOption(private$..cv_folds)
            self$.addOption(private$..cv_repeats)
            self$.addOption(private$..holdout_proportion)
            self$.addOption(private$..stratified_sampling)
            self$.addOption(private$..clinical_context)
            self$.addOption(private$..prevalence_adjustment)
            self$.addOption(private$..population_prevalence)
            self$.addOption(private$..cost_matrix)
            self$.addOption(private$..fn_fp_cost_ratio)
            self$.addOption(private$..min_sensitivity)
            self$.addOption(private$..min_specificity)
            self$.addOption(private$..min_ppv)
            self$.addOption(private$..min_npv)
            self$.addOption(private$..auto_optimize_threshold)
            self$.addOption(private$..optimization_metric)
            self$.addOption(private$..performance_metrics)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..show_realtime_metrics)
            self$.addOption(private$..show_parameter_warnings)
            self$.addOption(private$..show_clinical_guidance)
            self$.addOption(private$..show_model_summary)
            self$.addOption(private$..show_performance_table)
            self$.addOption(private$..show_calibration_plot)
            self$.addOption(private$..show_roc_curve)
            self$.addOption(private$..show_threshold_optimization)
            self$.addOption(private$..show_clinical_interpretation)
            self$.addOption(private$..missing_data_handling)
            self$.addOption(private$..set_seed)
            self$.addOption(private$..seed_value)
        }),
    active = list(
        outcome = function() private$..outcome$value,
        outcomeLevel = function() private$..outcomeLevel$value,
        predictors = function() private$..predictors$value,
        time_variable = function() private$..time_variable$value,
        clinical_preset = function() private$..clinical_preset$value,
        model_type = function() private$..model_type$value,
        validation_method = function() private$..validation_method$value,
        bootstrap_samples = function() private$..bootstrap_samples$value,
        cv_folds = function() private$..cv_folds$value,
        cv_repeats = function() private$..cv_repeats$value,
        holdout_proportion = function() private$..holdout_proportion$value,
        stratified_sampling = function() private$..stratified_sampling$value,
        clinical_context = function() private$..clinical_context$value,
        prevalence_adjustment = function() private$..prevalence_adjustment$value,
        population_prevalence = function() private$..population_prevalence$value,
        cost_matrix = function() private$..cost_matrix$value,
        fn_fp_cost_ratio = function() private$..fn_fp_cost_ratio$value,
        min_sensitivity = function() private$..min_sensitivity$value,
        min_specificity = function() private$..min_specificity$value,
        min_ppv = function() private$..min_ppv$value,
        min_npv = function() private$..min_npv$value,
        auto_optimize_threshold = function() private$..auto_optimize_threshold$value,
        optimization_metric = function() private$..optimization_metric$value,
        performance_metrics = function() private$..performance_metrics$value,
        confidence_level = function() private$..confidence_level$value,
        show_realtime_metrics = function() private$..show_realtime_metrics$value,
        show_parameter_warnings = function() private$..show_parameter_warnings$value,
        show_clinical_guidance = function() private$..show_clinical_guidance$value,
        show_model_summary = function() private$..show_model_summary$value,
        show_performance_table = function() private$..show_performance_table$value,
        show_calibration_plot = function() private$..show_calibration_plot$value,
        show_roc_curve = function() private$..show_roc_curve$value,
        show_threshold_optimization = function() private$..show_threshold_optimization$value,
        show_clinical_interpretation = function() private$..show_clinical_interpretation$value,
        missing_data_handling = function() private$..missing_data_handling$value,
        set_seed = function() private$..set_seed$value,
        seed_value = function() private$..seed_value$value),
    private = list(
        ..outcome = NA,
        ..outcomeLevel = NA,
        ..predictors = NA,
        ..time_variable = NA,
        ..clinical_preset = NA,
        ..model_type = NA,
        ..validation_method = NA,
        ..bootstrap_samples = NA,
        ..cv_folds = NA,
        ..cv_repeats = NA,
        ..holdout_proportion = NA,
        ..stratified_sampling = NA,
        ..clinical_context = NA,
        ..prevalence_adjustment = NA,
        ..population_prevalence = NA,
        ..cost_matrix = NA,
        ..fn_fp_cost_ratio = NA,
        ..min_sensitivity = NA,
        ..min_specificity = NA,
        ..min_ppv = NA,
        ..min_npv = NA,
        ..auto_optimize_threshold = NA,
        ..optimization_metric = NA,
        ..performance_metrics = NA,
        ..confidence_level = NA,
        ..show_realtime_metrics = NA,
        ..show_parameter_warnings = NA,
        ..show_clinical_guidance = NA,
        ..show_model_summary = NA,
        ..show_performance_table = NA,
        ..show_calibration_plot = NA,
        ..show_roc_curve = NA,
        ..show_threshold_optimization = NA,
        ..show_clinical_interpretation = NA,
        ..missing_data_handling = NA,
        ..set_seed = NA,
        ..seed_value = NA)
)

clinicalvalidationinteractiveResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalvalidationinteractiveResults",
    inherit = jmvcore::Group,
    active = list(
        modelSummary = function() private$.items[["modelSummary"]],
        validationResults = function() private$.items[["validationResults"]],
        performanceWarnings = function() private$.items[["performanceWarnings"]],
        prevalenceAnalysis = function() private$.items[["prevalenceAnalysis"]],
        thresholdOptimization = function() private$.items[["thresholdOptimization"]],
        calibrationAssessment = function() private$.items[["calibrationAssessment"]],
        clinicalGuidelines = function() private$.items[["clinicalGuidelines"]],
        rocCurve = function() private$.items[["rocCurve"]],
        calibrationPlot = function() private$.items[["calibrationPlot"]],
        thresholdPlot = function() private$.items[["thresholdPlot"]],
        validationCurves = function() private$.items[["validationCurves"]],
        realtimeMetrics = function() private$.items[["realtimeMetrics"]],
        interactiveGuidance = function() private$.items[["interactiveGuidance"]],
        parameterValidation = function() private$.items[["parameterValidation"]],
        exportSummary = function() private$.items[["exportSummary"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Interactive Clinical Model Validation")
            self$add(jmvcore::Table$new(
                options=options,
                name="modelSummary",
                title="Model Summary",
                clearWith=list(
                    "outcome",
                    "predictors",
                    "model_type",
                    "validation_method"),
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Clinical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="validationResults",
                title="Validation Performance Metrics",
                clearWith=list(
                    "outcome",
                    "predictors",
                    "validation_method",
                    "bootstrap_samples",
                    "cv_folds",
                    "clinical_preset"),
                columns=list(
                    list(
                        `name`="metric", 
                        `title`="Metric", 
                        `type`="text"),
                    list(
                        `name`="estimate", 
                        `title`="Estimate", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="lower_ci", 
                        `title`="Lower CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="upper_ci", 
                        `title`="Upper CI", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="clinical_threshold", 
                        `title`="Clinical Threshold", 
                        `type`="text"),
                    list(
                        `name`="meets_requirement", 
                        `title`="Meets Requirement", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="performanceWarnings",
                title="Performance Warnings & Recommendations",
                visible="(show_parameter_warnings)",
                columns=list(
                    list(
                        `name`="category", 
                        `title`="Category", 
                        `type`="text"),
                    list(
                        `name`="warning", 
                        `title`="Warning/Recommendation", 
                        `type`="text"),
                    list(
                        `name`="severity", 
                        `title`="Severity", 
                        `type`="text"),
                    list(
                        `name`="action", 
                        `title`="Suggested Action", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="prevalenceAnalysis",
                title="Prevalence Impact Analysis",
                visible="(prevalence_adjustment)",
                clearWith=list(
                    "population_prevalence",
                    "outcome",
                    "predictors"),
                columns=list(
                    list(
                        `name`="prevalence_scenario", 
                        `title`="Prevalence Scenario", 
                        `type`="text"),
                    list(
                        `name`="prevalence_value", 
                        `title`="Prevalence (%)", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="estimated_ppv", 
                        `title`="Estimated PPV", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="estimated_npv", 
                        `title`="Estimated NPV", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="clinical_utility", 
                        `title`="Clinical Utility Score", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="thresholdOptimization",
                title="Decision Threshold Optimization",
                visible="(auto_optimize_threshold)",
                clearWith=list(
                    "optimization_metric",
                    "cost_matrix",
                    "fn_fp_cost_ratio"),
                columns=list(
                    list(
                        `name`="optimization_criterion", 
                        `title`="Optimization Criterion", 
                        `type`="text"),
                    list(
                        `name`="optimal_threshold", 
                        `title`="Optimal Threshold", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="sensitivity_at_threshold", 
                        `title`="Sensitivity", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="specificity_at_threshold", 
                        `title`="Specificity", 
                        `type`="number", 
                        `format`="pc"),
                    list(
                        `name`="clinical_utility_score", 
                        `title`="Clinical Utility", 
                        `type`="number", 
                        `format`="zto"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="calibrationAssessment",
                title="Model Calibration Assessment",
                visible="(show_calibration_plot)",
                columns=list(
                    list(
                        `name`="calibration_method", 
                        `title`="Method", 
                        `type`="text"),
                    list(
                        `name`="statistic", 
                        `title`="Test Statistic", 
                        `type`="number"),
                    list(
                        `name`="p_value", 
                        `title`="p-value", 
                        `type`="number", 
                        `format`="zto,pvalue"),
                    list(
                        `name`="interpretation", 
                        `title`="Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="clinicalGuidelines",
                title="Clinical Decision Guidelines",
                visible="(show_clinical_interpretation)",
                columns=list(
                    list(
                        `name`="guideline_category", 
                        `title`="Category", 
                        `type`="text"),
                    list(
                        `name`="recommendation", 
                        `title`="Recommendation", 
                        `type`="text"),
                    list(
                        `name`="evidence_level", 
                        `title`="Evidence Level", 
                        `type`="text"),
                    list(
                        `name`="clinical_impact", 
                        `title`="Clinical Impact", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="rocCurve",
                title="ROC Curve with Optimal Thresholds",
                visible="(show_roc_curve)",
                requiresData=TRUE,
                clearWith=list(
                    "outcome",
                    "predictors",
                    "model_type",
                    "auto_optimize_threshold")))
            self$add(jmvcore::Image$new(
                options=options,
                name="calibrationPlot",
                title="Calibration Plot",
                visible="(show_calibration_plot)",
                requiresData=TRUE,
                clearWith=list(
                    "outcome",
                    "predictors",
                    "calibration_bins")))
            self$add(jmvcore::Image$new(
                options=options,
                name="thresholdPlot",
                title="Threshold Optimization Plot",
                visible="(show_threshold_optimization)",
                requiresData=TRUE,
                clearWith=list(
                    "optimization_metric",
                    "cost_matrix")))
            self$add(jmvcore::Image$new(
                options=options,
                name="validationCurves",
                title="Validation Learning Curves",
                visible="(show_validation_curves)",
                requiresData=TRUE,
                clearWith=list(
                    "validation_method",
                    "model_type")))
            self$add(jmvcore::Html$new(
                options=options,
                name="realtimeMetrics",
                title="Real-Time Performance Updates",
                visible="(show_realtime_metrics)",
                clearWith=list(
                    "outcome",
                    "predictors")))
            self$add(jmvcore::Html$new(
                options=options,
                name="interactiveGuidance",
                title="Interactive Clinical Guidance",
                visible="(show_clinical_guidance)",
                clearWith=list(
                    "clinical_context",
                    "clinical_preset")))
            self$add(jmvcore::Html$new(
                options=options,
                name="parameterValidation",
                title="Parameter Validation Status",
                visible="(show_parameter_warnings)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="exportSummary",
                title="Validation Report Summary"))}))

clinicalvalidationinteractiveBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "clinicalvalidationinteractiveBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "clinicalvalidationinteractive",
                version = c(0,0,1),
                options = options,
                results = clinicalvalidationinteractiveResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Interactive Clinical Model Validation
#'
#' Interactive clinical prediction model validation with real-time parameter 
#' validation, intelligent defaults, and guided workflows. Features automatic 
#' parameter correction, clinical scenario presets, and dynamic threshold 
#' optimization for medical research and diagnostic applications.
#' 
#'
#' @examples
#' # Interactive clinical validation with presets
#' clinical_validation_interactive(
#'     data = clinical_data,
#'     outcome = "diagnosis",
#'     predictors = c("biomarker1", "biomarker2", "age"),
#'     clinical_preset = "diagnostic_biomarker",
#'     auto_optimize = TRUE
#' )
#'
#' @param data The data as a data frame for clinical model validation.
#' @param outcome .
#' @param outcomeLevel .
#' @param predictors .
#' @param time_variable .
#' @param clinical_preset .
#' @param model_type .
#' @param validation_method .
#' @param bootstrap_samples .
#' @param cv_folds .
#' @param cv_repeats .
#' @param holdout_proportion .
#' @param stratified_sampling .
#' @param clinical_context .
#' @param prevalence_adjustment .
#' @param population_prevalence .
#' @param cost_matrix .
#' @param fn_fp_cost_ratio .
#' @param min_sensitivity .
#' @param min_specificity .
#' @param min_ppv .
#' @param min_npv .
#' @param auto_optimize_threshold .
#' @param optimization_metric .
#' @param performance_metrics .
#' @param confidence_level .
#' @param show_realtime_metrics .
#' @param show_parameter_warnings .
#' @param show_clinical_guidance .
#' @param show_model_summary .
#' @param show_performance_table .
#' @param show_calibration_plot .
#' @param show_roc_curve .
#' @param show_threshold_optimization .
#' @param show_clinical_interpretation .
#' @param missing_data_handling .
#' @param set_seed .
#' @param seed_value .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$modelSummary} \tab \tab \tab \tab \tab Summary of the fitted model \cr
#'   \code{results$validationResults} \tab \tab \tab \tab \tab Comprehensive validation performance metrics with confidence intervals \cr
#'   \code{results$performanceWarnings} \tab \tab \tab \tab \tab Real-time warnings and clinical recommendations \cr
#'   \code{results$prevalenceAnalysis} \tab \tab \tab \tab \tab Impact of disease prevalence on predictive values \cr
#'   \code{results$thresholdOptimization} \tab \tab \tab \tab \tab Optimal decision thresholds for different clinical scenarios \cr
#'   \code{results$calibrationAssessment} \tab \tab \tab \tab \tab Calibration performance metrics \cr
#'   \code{results$clinicalGuidelines} \tab \tab \tab \tab \tab Evidence-based clinical interpretation and recommendations \cr
#'   \code{results$rocCurve} \tab \tab \tab \tab \tab ROC curve showing optimal decision thresholds \cr
#'   \code{results$calibrationPlot} \tab \tab \tab \tab \tab Model calibration assessment plot \cr
#'   \code{results$thresholdPlot} \tab \tab \tab \tab \tab Performance metrics across decision thresholds \cr
#'   \code{results$validationCurves} \tab \tab \tab \tab \tab Learning curves showing model performance vs sample size \cr
#'   \code{results$realtimeMetrics} \tab \tab \tab \tab \tab Dynamic performance metric updates \cr
#'   \code{results$interactiveGuidance} \tab \tab \tab \tab \tab Dynamic clinical decision guidance \cr
#'   \code{results$parameterValidation} \tab \tab \tab \tab \tab Real-time parameter validation and warnings \cr
#'   \code{results$exportSummary} \tab \tab \tab \tab \tab Comprehensive validation summary for clinical reporting \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$modelSummary$asDF}
#'
#' \code{as.data.frame(results$modelSummary)}
#'
#' @export
clinicalvalidationinteractive <- function(
    data,
    outcome,
    outcomeLevel,
    predictors,
    time_variable = NULL,
    clinical_preset = "custom",
    model_type = "logistic",
    validation_method = "bootstrap",
    bootstrap_samples = 1000,
    cv_folds = 10,
    cv_repeats = 3,
    holdout_proportion = 0.25,
    stratified_sampling = TRUE,
    clinical_context = "diagnosis",
    prevalence_adjustment = FALSE,
    population_prevalence = 10,
    cost_matrix = "equal",
    fn_fp_cost_ratio = 2,
    min_sensitivity = 0.8,
    min_specificity = 0.8,
    min_ppv = 0.7,
    min_npv = 0.9,
    auto_optimize_threshold = FALSE,
    optimization_metric = "youden",
    performance_metrics = "all",
    confidence_level = 0.95,
    show_realtime_metrics = TRUE,
    show_parameter_warnings = TRUE,
    show_clinical_guidance = TRUE,
    show_model_summary = TRUE,
    show_performance_table = TRUE,
    show_calibration_plot = TRUE,
    show_roc_curve = TRUE,
    show_threshold_optimization = FALSE,
    show_clinical_interpretation = TRUE,
    missing_data_handling = "complete_cases",
    set_seed = TRUE,
    seed_value = 42) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("clinicalvalidationinteractive requires jmvcore to be installed (restart may be required)")

    if ( ! missing(outcome)) outcome <- jmvcore::resolveQuo(jmvcore::enquo(outcome))
    if ( ! missing(predictors)) predictors <- jmvcore::resolveQuo(jmvcore::enquo(predictors))
    if ( ! missing(time_variable)) time_variable <- jmvcore::resolveQuo(jmvcore::enquo(time_variable))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(outcome), outcome, NULL),
            `if`( ! missing(predictors), predictors, NULL),
            `if`( ! missing(time_variable), time_variable, NULL))

    for (v in outcome) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- clinicalvalidationinteractiveOptions$new(
        outcome = outcome,
        outcomeLevel = outcomeLevel,
        predictors = predictors,
        time_variable = time_variable,
        clinical_preset = clinical_preset,
        model_type = model_type,
        validation_method = validation_method,
        bootstrap_samples = bootstrap_samples,
        cv_folds = cv_folds,
        cv_repeats = cv_repeats,
        holdout_proportion = holdout_proportion,
        stratified_sampling = stratified_sampling,
        clinical_context = clinical_context,
        prevalence_adjustment = prevalence_adjustment,
        population_prevalence = population_prevalence,
        cost_matrix = cost_matrix,
        fn_fp_cost_ratio = fn_fp_cost_ratio,
        min_sensitivity = min_sensitivity,
        min_specificity = min_specificity,
        min_ppv = min_ppv,
        min_npv = min_npv,
        auto_optimize_threshold = auto_optimize_threshold,
        optimization_metric = optimization_metric,
        performance_metrics = performance_metrics,
        confidence_level = confidence_level,
        show_realtime_metrics = show_realtime_metrics,
        show_parameter_warnings = show_parameter_warnings,
        show_clinical_guidance = show_clinical_guidance,
        show_model_summary = show_model_summary,
        show_performance_table = show_performance_table,
        show_calibration_plot = show_calibration_plot,
        show_roc_curve = show_roc_curve,
        show_threshold_optimization = show_threshold_optimization,
        show_clinical_interpretation = show_clinical_interpretation,
        missing_data_handling = missing_data_handling,
        set_seed = set_seed,
        seed_value = seed_value)

    analysis <- clinicalvalidationinteractiveClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

