
# This file is automatically generated, you probably don't want to edit this

simpleSurvivalPowerOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "simpleSurvivalPowerOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            analysis_type = "sample_size",
            test_type = "log_rank",
            study_design = "two_arm_parallel",
            primary_endpoint = "overall_survival",
            effect_size_type = "hazard_ratio",
            effect_size = 0.75,
            alpha_level = 0.05,
            power_level = 0.8,
            allocation_ratio = 1,
            sample_size_input = 200,
            control_median_survival = 12,
            survival_distribution = "exponential",
            weibull_shape = 1,
            accrual_period = 24,
            follow_up_period = 12,
            accrual_pattern = "uniform",
            dropout_rate = 0.05,
            ni_margin = 1.25,
            ni_type = "relative_margin",
            competing_risk_rate = 0.1,
            competing_risk_hr = 1,
            rmst_tau = 36,
            rmst_difference = 3,
            snp_maf = 0.3,
            genetic_model = "additive",
            number_of_arms = 3,
            multiple_comparisons = "dunnett",
            interim_analyses = 0,
            alpha_spending = "none",
            stratification_factors = 0,
            cluster_size = 50,
            icc = 0.05,
            sensitivity_analysis = FALSE,
            simulation_runs = 10000, ...) {

            super$initialize(
                package="ClinicoPath",
                name="simpleSurvivalPower",
                requiresData=FALSE,
                ...)

            private$..analysis_type <- jmvcore::OptionList$new(
                "analysis_type",
                analysis_type,
                options=list(
                    "sample_size",
                    "power",
                    "effect_size",
                    "duration"),
                default="sample_size")
            private$..test_type <- jmvcore::OptionList$new(
                "test_type",
                test_type,
                options=list(
                    "log_rank",
                    "cox_regression",
                    "competing_risks",
                    "rmst_test",
                    "non_inferiority",
                    "snp_survival",
                    "weighted_log_rank"),
                default="log_rank")
            private$..study_design <- jmvcore::OptionList$new(
                "study_design",
                study_design,
                options=list(
                    "two_arm_parallel",
                    "multi_arm",
                    "crossover",
                    "cluster_randomized",
                    "stratified"),
                default="two_arm_parallel")
            private$..primary_endpoint <- jmvcore::OptionList$new(
                "primary_endpoint",
                primary_endpoint,
                options=list(
                    "overall_survival",
                    "disease_free_survival",
                    "progression_free_survival",
                    "time_to_event",
                    "composite_endpoint"),
                default="overall_survival")
            private$..effect_size_type <- jmvcore::OptionList$new(
                "effect_size_type",
                effect_size_type,
                options=list(
                    "hazard_ratio",
                    "median_ratio",
                    "rmst_difference",
                    "survival_difference"),
                default="hazard_ratio")
            private$..effect_size <- jmvcore::OptionNumber$new(
                "effect_size",
                effect_size,
                default=0.75,
                min=0.1,
                max=5)
            private$..alpha_level <- jmvcore::OptionNumber$new(
                "alpha_level",
                alpha_level,
                default=0.05,
                min=0.001,
                max=0.1)
            private$..power_level <- jmvcore::OptionNumber$new(
                "power_level",
                power_level,
                default=0.8,
                min=0.5,
                max=0.99)
            private$..allocation_ratio <- jmvcore::OptionNumber$new(
                "allocation_ratio",
                allocation_ratio,
                default=1,
                min=0.1,
                max=10)
            private$..sample_size_input <- jmvcore::OptionInteger$new(
                "sample_size_input",
                sample_size_input,
                default=200,
                min=10,
                max=100000)
            private$..control_median_survival <- jmvcore::OptionNumber$new(
                "control_median_survival",
                control_median_survival,
                default=12,
                min=1,
                max=240)
            private$..survival_distribution <- jmvcore::OptionList$new(
                "survival_distribution",
                survival_distribution,
                options=list(
                    "exponential",
                    "weibull",
                    "log_normal",
                    "piecewise_exponential"),
                default="exponential")
            private$..weibull_shape <- jmvcore::OptionNumber$new(
                "weibull_shape",
                weibull_shape,
                default=1,
                min=0.1,
                max=5)
            private$..accrual_period <- jmvcore::OptionNumber$new(
                "accrual_period",
                accrual_period,
                default=24,
                min=1,
                max=120)
            private$..follow_up_period <- jmvcore::OptionNumber$new(
                "follow_up_period",
                follow_up_period,
                default=12,
                min=0,
                max=120)
            private$..accrual_pattern <- jmvcore::OptionList$new(
                "accrual_pattern",
                accrual_pattern,
                options=list(
                    "uniform",
                    "linear_increasing",
                    "exponential",
                    "custom"),
                default="uniform")
            private$..dropout_rate <- jmvcore::OptionNumber$new(
                "dropout_rate",
                dropout_rate,
                default=0.05,
                min=0,
                max=0.5)
            private$..ni_margin <- jmvcore::OptionNumber$new(
                "ni_margin",
                ni_margin,
                default=1.25,
                min=1,
                max=2)
            private$..ni_type <- jmvcore::OptionList$new(
                "ni_type",
                ni_type,
                options=list(
                    "absolute_margin",
                    "relative_margin",
                    "retention_fraction"),
                default="relative_margin")
            private$..competing_risk_rate <- jmvcore::OptionNumber$new(
                "competing_risk_rate",
                competing_risk_rate,
                default=0.1,
                min=0,
                max=0.9)
            private$..competing_risk_hr <- jmvcore::OptionNumber$new(
                "competing_risk_hr",
                competing_risk_hr,
                default=1,
                min=0.1,
                max=5)
            private$..rmst_tau <- jmvcore::OptionNumber$new(
                "rmst_tau",
                rmst_tau,
                default=36,
                min=6,
                max=120)
            private$..rmst_difference <- jmvcore::OptionNumber$new(
                "rmst_difference",
                rmst_difference,
                default=3,
                min=0.1,
                max=60)
            private$..snp_maf <- jmvcore::OptionNumber$new(
                "snp_maf",
                snp_maf,
                default=0.3,
                min=0.01,
                max=0.5)
            private$..genetic_model <- jmvcore::OptionList$new(
                "genetic_model",
                genetic_model,
                options=list(
                    "additive",
                    "dominant",
                    "recessive"),
                default="additive")
            private$..number_of_arms <- jmvcore::OptionNumber$new(
                "number_of_arms",
                number_of_arms,
                default=3,
                min=2,
                max=10)
            private$..multiple_comparisons <- jmvcore::OptionList$new(
                "multiple_comparisons",
                multiple_comparisons,
                options=list(
                    "none",
                    "bonferroni",
                    "holm",
                    "dunnett"),
                default="dunnett")
            private$..interim_analyses <- jmvcore::OptionNumber$new(
                "interim_analyses",
                interim_analyses,
                default=0,
                min=0,
                max=5)
            private$..alpha_spending <- jmvcore::OptionList$new(
                "alpha_spending",
                alpha_spending,
                options=list(
                    "none",
                    "obrien_fleming",
                    "pocock"),
                default="none")
            private$..stratification_factors <- jmvcore::OptionNumber$new(
                "stratification_factors",
                stratification_factors,
                default=0,
                min=0,
                max=5)
            private$..cluster_size <- jmvcore::OptionNumber$new(
                "cluster_size",
                cluster_size,
                default=50,
                min=5,
                max=1000)
            private$..icc <- jmvcore::OptionNumber$new(
                "icc",
                icc,
                default=0.05,
                min=0,
                max=0.5)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=FALSE)
            private$..simulation_runs <- jmvcore::OptionNumber$new(
                "simulation_runs",
                simulation_runs,
                default=10000,
                min=1000,
                max=100000)

            self$.addOption(private$..analysis_type)
            self$.addOption(private$..test_type)
            self$.addOption(private$..study_design)
            self$.addOption(private$..primary_endpoint)
            self$.addOption(private$..effect_size_type)
            self$.addOption(private$..effect_size)
            self$.addOption(private$..alpha_level)
            self$.addOption(private$..power_level)
            self$.addOption(private$..allocation_ratio)
            self$.addOption(private$..sample_size_input)
            self$.addOption(private$..control_median_survival)
            self$.addOption(private$..survival_distribution)
            self$.addOption(private$..weibull_shape)
            self$.addOption(private$..accrual_period)
            self$.addOption(private$..follow_up_period)
            self$.addOption(private$..accrual_pattern)
            self$.addOption(private$..dropout_rate)
            self$.addOption(private$..ni_margin)
            self$.addOption(private$..ni_type)
            self$.addOption(private$..competing_risk_rate)
            self$.addOption(private$..competing_risk_hr)
            self$.addOption(private$..rmst_tau)
            self$.addOption(private$..rmst_difference)
            self$.addOption(private$..snp_maf)
            self$.addOption(private$..genetic_model)
            self$.addOption(private$..number_of_arms)
            self$.addOption(private$..multiple_comparisons)
            self$.addOption(private$..interim_analyses)
            self$.addOption(private$..alpha_spending)
            self$.addOption(private$..stratification_factors)
            self$.addOption(private$..cluster_size)
            self$.addOption(private$..icc)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..simulation_runs)
        }),
    active = list(
        analysis_type = function() private$..analysis_type$value,
        test_type = function() private$..test_type$value,
        study_design = function() private$..study_design$value,
        primary_endpoint = function() private$..primary_endpoint$value,
        effect_size_type = function() private$..effect_size_type$value,
        effect_size = function() private$..effect_size$value,
        alpha_level = function() private$..alpha_level$value,
        power_level = function() private$..power_level$value,
        allocation_ratio = function() private$..allocation_ratio$value,
        sample_size_input = function() private$..sample_size_input$value,
        control_median_survival = function() private$..control_median_survival$value,
        survival_distribution = function() private$..survival_distribution$value,
        weibull_shape = function() private$..weibull_shape$value,
        accrual_period = function() private$..accrual_period$value,
        follow_up_period = function() private$..follow_up_period$value,
        accrual_pattern = function() private$..accrual_pattern$value,
        dropout_rate = function() private$..dropout_rate$value,
        ni_margin = function() private$..ni_margin$value,
        ni_type = function() private$..ni_type$value,
        competing_risk_rate = function() private$..competing_risk_rate$value,
        competing_risk_hr = function() private$..competing_risk_hr$value,
        rmst_tau = function() private$..rmst_tau$value,
        rmst_difference = function() private$..rmst_difference$value,
        snp_maf = function() private$..snp_maf$value,
        genetic_model = function() private$..genetic_model$value,
        number_of_arms = function() private$..number_of_arms$value,
        multiple_comparisons = function() private$..multiple_comparisons$value,
        interim_analyses = function() private$..interim_analyses$value,
        alpha_spending = function() private$..alpha_spending$value,
        stratification_factors = function() private$..stratification_factors$value,
        cluster_size = function() private$..cluster_size$value,
        icc = function() private$..icc$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        simulation_runs = function() private$..simulation_runs$value),
    private = list(
        ..analysis_type = NA,
        ..test_type = NA,
        ..study_design = NA,
        ..primary_endpoint = NA,
        ..effect_size_type = NA,
        ..effect_size = NA,
        ..alpha_level = NA,
        ..power_level = NA,
        ..allocation_ratio = NA,
        ..sample_size_input = NA,
        ..control_median_survival = NA,
        ..survival_distribution = NA,
        ..weibull_shape = NA,
        ..accrual_period = NA,
        ..follow_up_period = NA,
        ..accrual_pattern = NA,
        ..dropout_rate = NA,
        ..ni_margin = NA,
        ..ni_type = NA,
        ..competing_risk_rate = NA,
        ..competing_risk_hr = NA,
        ..rmst_tau = NA,
        ..rmst_difference = NA,
        ..snp_maf = NA,
        ..genetic_model = NA,
        ..number_of_arms = NA,
        ..multiple_comparisons = NA,
        ..interim_analyses = NA,
        ..alpha_spending = NA,
        ..stratification_factors = NA,
        ..cluster_size = NA,
        ..icc = NA,
        ..sensitivity_analysis = NA,
        ..simulation_runs = NA)
)

simpleSurvivalPowerResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "simpleSurvivalPowerResults",
    inherit = jmvcore::Group,
    active = list(
        instructions = function() private$.items[["instructions"]],
        power_summary = function() private$.items[["power_summary"]],
        sample_size_results = function() private$.items[["sample_size_results"]],
        power_results = function() private$.items[["power_results"]],
        effect_size_results = function() private$.items[["effect_size_results"]],
        study_duration_results = function() private$.items[["study_duration_results"]],
        assumptions_table = function() private$.items[["assumptions_table"]],
        competing_risks_table = function() private$.items[["competing_risks_table"]],
        non_inferiority_table = function() private$.items[["non_inferiority_table"]],
        rmst_analysis_table = function() private$.items[["rmst_analysis_table"]],
        snp_analysis_table = function() private$.items[["snp_analysis_table"]],
        multi_arm_table = function() private$.items[["multi_arm_table"]],
        interim_analysis_table = function() private$.items[["interim_analysis_table"]],
        sensitivity_analysis_table = function() private$.items[["sensitivity_analysis_table"]],
        regulatory_table = function() private$.items[["regulatory_table"]],
        power_curve_plot = function() private$.items[["power_curve_plot"]],
        sample_size_plot = function() private$.items[["sample_size_plot"]],
        survival_curves_plot = function() private$.items[["survival_curves_plot"]],
        accrual_timeline_plot = function() private$.items[["accrual_timeline_plot"]],
        sensitivity_plot = function() private$.items[["sensitivity_plot"]],
        clinical_interpretation = function() private$.items[["clinical_interpretation"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Power Analysis & Sample Size Calculation",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="instructions",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Table$new(
                options=options,
                name="power_summary",
                title="Power Analysis Summary",
                rows=1,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="analysis_type", 
                        `title`="Analysis Type", 
                        `type`="text"),
                    list(
                        `name`="test_type", 
                        `title`="Statistical Test", 
                        `type`="text"),
                    list(
                        `name`="study_design", 
                        `title`="Study Design", 
                        `type`="text"),
                    list(
                        `name`="primary_endpoint", 
                        `title`="Primary Endpoint", 
                        `type`="text"),
                    list(
                        `name`="effect_size_type", 
                        `title`="Effect Size Type", 
                        `type`="text"),
                    list(
                        `name`="calculated_value", 
                        `title`="Calculated Value", 
                        `type`="text"),
                    list(
                        `name`="confidence_level", 
                        `title`="Confidence Level", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="sample_size_results",
                title="Sample Size Calculations",
                rows=0,
                visible="(analysis_type==\"sample_size\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="power_results",
                title="Power Analysis Results",
                rows=0,
                visible="(analysis_type==\"power\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="effect_size_results",
                title="Detectable Effect Size",
                rows=0,
                visible="(analysis_type==\"effect_size\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="study_duration_results",
                title="Study Duration Analysis",
                rows=0,
                visible="(analysis_type==\"duration\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="description", 
                        `title`="Description", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="assumptions_table",
                title="Statistical Assumptions",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="assumption", 
                        `title`="Assumption", 
                        `type`="text"),
                    list(
                        `name`="specification", 
                        `title`="Specification", 
                        `type`="text"),
                    list(
                        `name`="impact", 
                        `title`="Impact on Results", 
                        `type`="text"),
                    list(
                        `name`="recommendation", 
                        `title`="Recommendation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="competing_risks_table",
                title="Competing Risks Analysis",
                rows=0,
                visible="(test_type==\"competing_risks\")",
                columns=list(
                    list(
                        `name`="risk_type", 
                        `title`="Risk Type", 
                        `type`="text"),
                    list(
                        `name`="event_rate", 
                        `title`="Event Rate", 
                        `type`="number"),
                    list(
                        `name`="hazard_ratio", 
                        `title`="Hazard Ratio", 
                        `type`="number"),
                    list(
                        `name`="cumulative_incidence", 
                        `title`="Cumulative Incidence (%)", 
                        `type`="number"),
                    list(
                        `name`="required_events", 
                        `title`="Required Events", 
                        `type`="integer"),
                    list(
                        `name`="sample_size_impact", 
                        `title`="Sample Size Impact", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="non_inferiority_table",
                title="Non-inferiority Analysis",
                rows=0,
                visible="(test_type==\"non_inferiority\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="text"),
                    list(
                        `name`="margin_type", 
                        `title`="Margin Type", 
                        `type`="text"),
                    list(
                        `name`="clinical_interpretation", 
                        `title`="Clinical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="rmst_analysis_table",
                title="RMST Analysis Parameters",
                rows=0,
                visible="(test_type==\"rmst_test\")",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="control_group", 
                        `title`="Control Group", 
                        `type`="number"),
                    list(
                        `name`="treatment_group", 
                        `title`="Treatment Group", 
                        `type`="number"),
                    list(
                        `name`="difference", 
                        `title`="Difference", 
                        `type`="number"),
                    list(
                        `name`="confidence_interval", 
                        `title`="95% CI", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="snp_analysis_table",
                title="SNP-based Survival Analysis",
                rows=0,
                visible="(test_type==\"snp_survival\")",
                columns=list(
                    list(
                        `name`="genetic_model", 
                        `title`="Genetic Model", 
                        `type`="text"),
                    list(
                        `name`="maf", 
                        `title`="Minor Allele Frequency", 
                        `type`="number"),
                    list(
                        `name`="genotype_frequencies", 
                        `title`="Genotype Frequencies", 
                        `type`="text"),
                    list(
                        `name`="required_sample_size", 
                        `title`="Required Sample Size", 
                        `type`="integer"),
                    list(
                        `name`="power_by_genotype", 
                        `title`="Power by Genotype", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="multi_arm_table",
                title="Multi-arm Trial Analysis",
                rows=0,
                visible="(study_design==\"multi_arm\")",
                columns=list(
                    list(
                        `name`="comparison", 
                        `title`="Comparison", 
                        `type`="text"),
                    list(
                        `name`="sample_size_per_arm", 
                        `title`="Sample Size per Arm", 
                        `type`="integer"),
                    list(
                        `name`="adjusted_alpha", 
                        `title`="Adjusted Alpha", 
                        `type`="number"),
                    list(
                        `name`="power", 
                        `title`="Power (%)", 
                        `type`="number"),
                    list(
                        `name`="total_study_power", 
                        `title`="Overall Study Power (%)", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="interim_analysis_table",
                title="Interim Analysis Plan",
                rows=0,
                visible="(interim_analyses>0)",
                columns=list(
                    list(
                        `name`="analysis_number", 
                        `title`="Analysis", 
                        `type`="integer"),
                    list(
                        `name`="timing", 
                        `title`="Timing (% of events)", 
                        `type`="number"),
                    list(
                        `name`="alpha_spent", 
                        `title`="Alpha Spent", 
                        `type`="number"),
                    list(
                        `name`="boundary_value", 
                        `title`="Boundary Value", 
                        `type`="number"),
                    list(
                        `name`="conditional_power", 
                        `title`="Conditional Power (%)", 
                        `type`="number"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="sensitivity_analysis_table",
                title="Sensitivity Analysis",
                rows=0,
                visible="(sensitivity_analysis)",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="base_case", 
                        `title`="Base Case", 
                        `type`="text"),
                    list(
                        `name`="scenario_1", 
                        `title`="Optimistic", 
                        `type`="text"),
                    list(
                        `name`="scenario_2", 
                        `title`="Conservative", 
                        `type`="text"),
                    list(
                        `name`="impact_assessment", 
                        `title`="Impact Assessment", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="regulatory_table",
                title="Regulatory Considerations",
                rows=0,
                visible=TRUE,
                columns=list(
                    list(
                        `name`="regulatory_aspect", 
                        `title`="Regulatory Aspect", 
                        `type`="text"),
                    list(
                        `name`="requirement", 
                        `title`="Requirement", 
                        `type`="text"),
                    list(
                        `name`="compliance_status", 
                        `title`="Compliance Status", 
                        `type`="text"),
                    list(
                        `name`="recommendation", 
                        `title`="Recommendation", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="power_curve_plot",
                title="Power Curves",
                width=600,
                height=450,
                visible=TRUE,
                requiresData=FALSE,
                renderFun=".plot_power_curves"))
            self$add(jmvcore::Image$new(
                options=options,
                name="sample_size_plot",
                title="Sample Size by Effect Size",
                width=600,
                height=450,
                visible="(analysis_type==\"sample_size\")",
                requiresData=FALSE,
                renderFun=".plot_sample_size_curves"))
            self$add(jmvcore::Image$new(
                options=options,
                name="survival_curves_plot",
                title="Expected Survival Curves",
                width=600,
                height=450,
                visible=TRUE,
                requiresData=FALSE,
                renderFun=".plot_expected_survival"))
            self$add(jmvcore::Image$new(
                options=options,
                name="accrual_timeline_plot",
                title="Accrual and Event Timeline",
                width=600,
                height=450,
                visible=TRUE,
                requiresData=FALSE,
                renderFun=".plot_study_timeline"))
            self$add(jmvcore::Image$new(
                options=options,
                name="sensitivity_plot",
                title="Sensitivity Analysis",
                width=600,
                height=450,
                visible="(sensitivity_analysis)",
                requiresData=FALSE,
                renderFun=".plot_sensitivity_analysis"))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinical_interpretation",
                title="Clinical Interpretation and Recommendations",
                visible=TRUE))}))

simpleSurvivalPowerBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "simpleSurvivalPowerBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "simpleSurvivalPower",
                version = c(1,0,0),
                options = options,
                results = simpleSurvivalPowerResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = FALSE,
                requiresMissings = FALSE,
                weightsSupport = 'na')
        }))

#' Simple Survival Power Analysis (Basic)
#'
#' Simple power analysis and sample size calculation for survival studies.
#' User-friendly interface for basic survival power calculations with multiple 
#' statistical methods.
#' 
#' This function provides a streamlined approach to survival power analysis. 
#' For specialized needs,
#' consider the other power analysis functions: Classical, Competing Risks, 
#' Advanced, or Comprehensive.
#' 
#'
#' @examples
#' simpleSurvivalPower(
#'     test_type = "log_rank",
#'     effect_size = 0.75,
#'     alpha = 0.05,
#'     power = 0.80,
#'     allocation_ratio = 1,
#'     accrual_period = 24,
#'     follow_up_period = 36
#' )
#'
#' @param analysis_type Type of power analysis to perform
#' @param test_type Type of statistical test for power calculation
#' @param study_design Overall study design type
#' @param primary_endpoint Primary survival endpoint
#' @param effect_size_type Type of effect size specification
#' @param effect_size Expected effect size (HR, median ratio, or difference)
#' @param alpha_level Significance level (two-sided)
#' @param power_level Desired statistical power
#' @param allocation_ratio Ratio of control to experimental group sizes
#' @param sample_size_input Total sample size to use when calculating power,
#'   effect size, or duration
#' @param control_median_survival Expected median survival in control group
#' @param survival_distribution Assumed survival distribution
#' @param weibull_shape Shape parameter for Weibull distribution
#' @param accrual_period Patient recruitment period
#' @param follow_up_period Additional follow-up after recruitment ends
#' @param accrual_pattern Pattern of patient accrual over time
#' @param dropout_rate Annual rate of loss to follow-up
#' @param ni_margin Non-inferiority margin (hazard ratio scale)
#' @param ni_type Type of non-inferiority margin
#' @param competing_risk_rate Annual rate of competing risk events
#' @param competing_risk_hr Treatment effect on competing risks
#' @param rmst_tau Restriction time for RMST analysis
#' @param rmst_difference Expected difference in restricted mean survival time
#' @param snp_maf Minor allele frequency for SNP analysis
#' @param genetic_model Genetic inheritance model
#' @param number_of_arms Total number of treatment arms (including control)
#' @param multiple_comparisons Method for multiple comparisons adjustment
#' @param interim_analyses Number of planned interim analyses
#' @param alpha_spending Alpha spending function for interim analyses
#' @param stratification_factors Number of stratification factors
#' @param cluster_size Average cluster size for cluster randomized trials
#' @param icc ICC for cluster randomized trials
#' @param sensitivity_analysis Perform sensitivity analysis across parameter
#'   ranges
#' @param simulation_runs Number of simulation runs for complex calculations
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$instructions} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$power_summary} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$sample_size_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$power_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$effect_size_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$study_duration_results} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$assumptions_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$competing_risks_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$non_inferiority_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$rmst_analysis_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$snp_analysis_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$multi_arm_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$interim_analysis_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$sensitivity_analysis_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$regulatory_table} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$power_curve_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$sample_size_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$survival_curves_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$accrual_timeline_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$sensitivity_plot} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$clinical_interpretation} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$power_summary$asDF}
#'
#' \code{as.data.frame(results$power_summary)}
#'
#' @export
simpleSurvivalPower <- function(
    analysis_type = "sample_size",
    test_type = "log_rank",
    study_design = "two_arm_parallel",
    primary_endpoint = "overall_survival",
    effect_size_type = "hazard_ratio",
    effect_size = 0.75,
    alpha_level = 0.05,
    power_level = 0.8,
    allocation_ratio = 1,
    sample_size_input = 200,
    control_median_survival = 12,
    survival_distribution = "exponential",
    weibull_shape = 1,
    accrual_period = 24,
    follow_up_period = 12,
    accrual_pattern = "uniform",
    dropout_rate = 0.05,
    ni_margin = 1.25,
    ni_type = "relative_margin",
    competing_risk_rate = 0.1,
    competing_risk_hr = 1,
    rmst_tau = 36,
    rmst_difference = 3,
    snp_maf = 0.3,
    genetic_model = "additive",
    number_of_arms = 3,
    multiple_comparisons = "dunnett",
    interim_analyses = 0,
    alpha_spending = "none",
    stratification_factors = 0,
    cluster_size = 50,
    icc = 0.05,
    sensitivity_analysis = FALSE,
    simulation_runs = 10000) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("simpleSurvivalPower requires jmvcore to be installed (restart may be required)")


    options <- simpleSurvivalPowerOptions$new(
        analysis_type = analysis_type,
        test_type = test_type,
        study_design = study_design,
        primary_endpoint = primary_endpoint,
        effect_size_type = effect_size_type,
        effect_size = effect_size,
        alpha_level = alpha_level,
        power_level = power_level,
        allocation_ratio = allocation_ratio,
        sample_size_input = sample_size_input,
        control_median_survival = control_median_survival,
        survival_distribution = survival_distribution,
        weibull_shape = weibull_shape,
        accrual_period = accrual_period,
        follow_up_period = follow_up_period,
        accrual_pattern = accrual_pattern,
        dropout_rate = dropout_rate,
        ni_margin = ni_margin,
        ni_type = ni_type,
        competing_risk_rate = competing_risk_rate,
        competing_risk_hr = competing_risk_hr,
        rmst_tau = rmst_tau,
        rmst_difference = rmst_difference,
        snp_maf = snp_maf,
        genetic_model = genetic_model,
        number_of_arms = number_of_arms,
        multiple_comparisons = multiple_comparisons,
        interim_analyses = interim_analyses,
        alpha_spending = alpha_spending,
        stratification_factors = stratification_factors,
        cluster_size = cluster_size,
        icc = icc,
        sensitivity_analysis = sensitivity_analysis,
        simulation_runs = simulation_runs)

    analysis <- simpleSurvivalPowerClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

