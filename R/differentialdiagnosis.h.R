
# This file is automatically generated, you probably don't want to edit this

differentialdiagnosisOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "differentialdiagnosisOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            clinicalFindings = NULL,
            confirmedDiagnosis = NULL,
            demographicVars = NULL,
            labResults = NULL,
            imagingFindings = NULL,
            diagnostic_probability = TRUE,
            likelihood_ratios = TRUE,
            prevalence_adjustment = TRUE,
            differential_ranking = TRUE,
            bayesian_network = FALSE,
            reasoning_method = "naive_bayes",
            prevalence_source = "population_based",
            confidence_threshold = 0.5,
            max_diagnoses = 10,
            clinical_context = TRUE,
            uncertainty_analysis = TRUE,
            sensitivity_analysis = FALSE,
            confidence_level = 0.95,
            diagnostic_plots = TRUE,
            network_diagram = FALSE,
            probability_heatmap = FALSE,
            clinical_guidelines = TRUE,
            differential_explanation = TRUE, ...) {

            super$initialize(
                package="ClinicoPath",
                name="differentialdiagnosis",
                requiresData=TRUE,
                ...)

            private$..clinicalFindings <- jmvcore::OptionVariables$new(
                "clinicalFindings",
                clinicalFindings,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..confirmedDiagnosis <- jmvcore::OptionVariable$new(
                "confirmedDiagnosis",
                confirmedDiagnosis,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..demographicVars <- jmvcore::OptionVariables$new(
                "demographicVars",
                demographicVars,
                suggested=list(
                    "nominal",
                    "continuous"),
                permitted=list(
                    "factor",
                    "numeric"))
            private$..labResults <- jmvcore::OptionVariables$new(
                "labResults",
                labResults,
                suggested=list(
                    "continuous"),
                permitted=list(
                    "numeric"))
            private$..imagingFindings <- jmvcore::OptionVariables$new(
                "imagingFindings",
                imagingFindings,
                suggested=list(
                    "nominal"),
                permitted=list(
                    "factor"))
            private$..diagnostic_probability <- jmvcore::OptionBool$new(
                "diagnostic_probability",
                diagnostic_probability,
                default=TRUE)
            private$..likelihood_ratios <- jmvcore::OptionBool$new(
                "likelihood_ratios",
                likelihood_ratios,
                default=TRUE)
            private$..prevalence_adjustment <- jmvcore::OptionBool$new(
                "prevalence_adjustment",
                prevalence_adjustment,
                default=TRUE)
            private$..differential_ranking <- jmvcore::OptionBool$new(
                "differential_ranking",
                differential_ranking,
                default=TRUE)
            private$..bayesian_network <- jmvcore::OptionBool$new(
                "bayesian_network",
                bayesian_network,
                default=FALSE)
            private$..reasoning_method <- jmvcore::OptionList$new(
                "reasoning_method",
                reasoning_method,
                options=list(
                    "naive_bayes",
                    "bayesian_network",
                    "logistic_regression",
                    "random_forest"),
                default="naive_bayes")
            private$..prevalence_source <- jmvcore::OptionList$new(
                "prevalence_source",
                prevalence_source,
                options=list(
                    "population_based",
                    "clinical_cohort",
                    "literature_based",
                    "user_defined"),
                default="population_based")
            private$..confidence_threshold <- jmvcore::OptionNumber$new(
                "confidence_threshold",
                confidence_threshold,
                min=0.1,
                max=0.95,
                default=0.5)
            private$..max_diagnoses <- jmvcore::OptionInteger$new(
                "max_diagnoses",
                max_diagnoses,
                min=3,
                max=20,
                default=10)
            private$..clinical_context <- jmvcore::OptionBool$new(
                "clinical_context",
                clinical_context,
                default=TRUE)
            private$..uncertainty_analysis <- jmvcore::OptionBool$new(
                "uncertainty_analysis",
                uncertainty_analysis,
                default=TRUE)
            private$..sensitivity_analysis <- jmvcore::OptionBool$new(
                "sensitivity_analysis",
                sensitivity_analysis,
                default=FALSE)
            private$..confidence_level <- jmvcore::OptionNumber$new(
                "confidence_level",
                confidence_level,
                min=0.8,
                max=0.99,
                default=0.95)
            private$..diagnostic_plots <- jmvcore::OptionBool$new(
                "diagnostic_plots",
                diagnostic_plots,
                default=TRUE)
            private$..network_diagram <- jmvcore::OptionBool$new(
                "network_diagram",
                network_diagram,
                default=FALSE)
            private$..probability_heatmap <- jmvcore::OptionBool$new(
                "probability_heatmap",
                probability_heatmap,
                default=FALSE)
            private$..clinical_guidelines <- jmvcore::OptionBool$new(
                "clinical_guidelines",
                clinical_guidelines,
                default=TRUE)
            private$..differential_explanation <- jmvcore::OptionBool$new(
                "differential_explanation",
                differential_explanation,
                default=TRUE)

            self$.addOption(private$..clinicalFindings)
            self$.addOption(private$..confirmedDiagnosis)
            self$.addOption(private$..demographicVars)
            self$.addOption(private$..labResults)
            self$.addOption(private$..imagingFindings)
            self$.addOption(private$..diagnostic_probability)
            self$.addOption(private$..likelihood_ratios)
            self$.addOption(private$..prevalence_adjustment)
            self$.addOption(private$..differential_ranking)
            self$.addOption(private$..bayesian_network)
            self$.addOption(private$..reasoning_method)
            self$.addOption(private$..prevalence_source)
            self$.addOption(private$..confidence_threshold)
            self$.addOption(private$..max_diagnoses)
            self$.addOption(private$..clinical_context)
            self$.addOption(private$..uncertainty_analysis)
            self$.addOption(private$..sensitivity_analysis)
            self$.addOption(private$..confidence_level)
            self$.addOption(private$..diagnostic_plots)
            self$.addOption(private$..network_diagram)
            self$.addOption(private$..probability_heatmap)
            self$.addOption(private$..clinical_guidelines)
            self$.addOption(private$..differential_explanation)
        }),
    active = list(
        clinicalFindings = function() private$..clinicalFindings$value,
        confirmedDiagnosis = function() private$..confirmedDiagnosis$value,
        demographicVars = function() private$..demographicVars$value,
        labResults = function() private$..labResults$value,
        imagingFindings = function() private$..imagingFindings$value,
        diagnostic_probability = function() private$..diagnostic_probability$value,
        likelihood_ratios = function() private$..likelihood_ratios$value,
        prevalence_adjustment = function() private$..prevalence_adjustment$value,
        differential_ranking = function() private$..differential_ranking$value,
        bayesian_network = function() private$..bayesian_network$value,
        reasoning_method = function() private$..reasoning_method$value,
        prevalence_source = function() private$..prevalence_source$value,
        confidence_threshold = function() private$..confidence_threshold$value,
        max_diagnoses = function() private$..max_diagnoses$value,
        clinical_context = function() private$..clinical_context$value,
        uncertainty_analysis = function() private$..uncertainty_analysis$value,
        sensitivity_analysis = function() private$..sensitivity_analysis$value,
        confidence_level = function() private$..confidence_level$value,
        diagnostic_plots = function() private$..diagnostic_plots$value,
        network_diagram = function() private$..network_diagram$value,
        probability_heatmap = function() private$..probability_heatmap$value,
        clinical_guidelines = function() private$..clinical_guidelines$value,
        differential_explanation = function() private$..differential_explanation$value),
    private = list(
        ..clinicalFindings = NA,
        ..confirmedDiagnosis = NA,
        ..demographicVars = NA,
        ..labResults = NA,
        ..imagingFindings = NA,
        ..diagnostic_probability = NA,
        ..likelihood_ratios = NA,
        ..prevalence_adjustment = NA,
        ..differential_ranking = NA,
        ..bayesian_network = NA,
        ..reasoning_method = NA,
        ..prevalence_source = NA,
        ..confidence_threshold = NA,
        ..max_diagnoses = NA,
        ..clinical_context = NA,
        ..uncertainty_analysis = NA,
        ..sensitivity_analysis = NA,
        ..confidence_level = NA,
        ..diagnostic_plots = NA,
        ..network_diagram = NA,
        ..probability_heatmap = NA,
        ..clinical_guidelines = NA,
        ..differential_explanation = NA)
)

differentialdiagnosisResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "differentialdiagnosisResults",
    inherit = jmvcore::Group,
    active = list(
        todo = function() private$.items[["todo"]],
        summary = function() private$.items[["summary"]],
        diagnosticProbabilities = function() private$.items[["diagnosticProbabilities"]],
        likelihoodRatios = function() private$.items[["likelihoodRatios"]],
        bayesianAnalysis = function() private$.items[["bayesianAnalysis"]],
        uncertaintyAnalysis = function() private$.items[["uncertaintyAnalysis"]],
        clinicalContext = function() private$.items[["clinicalContext"]],
        sensitivityAnalysis = function() private$.items[["sensitivityAnalysis"]],
        modelPerformance = function() private$.items[["modelPerformance"]],
        diagnosticPlots = function() private$.items[["diagnosticPlots"]],
        networkDiagram = function() private$.items[["networkDiagram"]],
        probabilityHeatmap = function() private$.items[["probabilityHeatmap"]],
        clinicalGuidelines = function() private$.items[["clinicalGuidelines"]],
        differentialExplanation = function() private$.items[["differentialExplanation"]],
        technicalNotes = function() private$.items[["technicalNotes"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Differential Diagnosis Assistance",
                refs=list(
                    "ClinicoPathJamoviModule"))
            self$add(jmvcore::Html$new(
                options=options,
                name="todo",
                title="Instructions",
                visible=TRUE))
            self$add(jmvcore::Html$new(
                options=options,
                name="summary",
                title="Diagnostic Analysis Summary",
                visible="(diagnostic_probability || likelihood_ratios)"))
            self$add(jmvcore::Table$new(
                options=options,
                name="diagnosticProbabilities",
                title="Differential Diagnosis Rankings",
                visible="(differential_ranking)",
                columns=list(
                    list(
                        `name`="diagnosis", 
                        `title`="Diagnosis", 
                        `type`="text"),
                    list(
                        `name`="posterior_probability", 
                        `title`="Posterior Probability", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="prior_probability", 
                        `title`="Prior Probability", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="likelihood_ratio_positive", 
                        `title`="LR+", 
                        `type`="number"),
                    list(
                        `name`="likelihood_ratio_negative", 
                        `title`="LR-", 
                        `type`="number"),
                    list(
                        `name`="confidence_interval", 
                        `title`="95% Confidence Interval", 
                        `type`="text"),
                    list(
                        `name`="clinical_significance", 
                        `title`="Clinical Significance", 
                        `type`="text"),
                    list(
                        `name`="recommendation", 
                        `title`="Diagnostic Recommendation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="likelihoodRatios",
                title="Likelihood Ratio Analysis",
                visible="(likelihood_ratios)",
                columns=list(
                    list(
                        `name`="clinical_finding", 
                        `title`="Clinical Finding", 
                        `type`="text"),
                    list(
                        `name`="finding_present", 
                        `title`="Finding Present (LR+)", 
                        `type`="number"),
                    list(
                        `name`="finding_absent", 
                        `title`="Finding Absent (LR-)", 
                        `type`="number"),
                    list(
                        `name`="diagnostic_utility", 
                        `title`="Diagnostic Utility", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Clinical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="bayesianAnalysis",
                title="Bayesian Diagnostic Reasoning",
                visible="(diagnostic_probability)",
                columns=list(
                    list(
                        `name`="analysis_step", 
                        `title`="Reasoning Step", 
                        `type`="text"),
                    list(
                        `name`="prior_probability", 
                        `title`="Prior Probability", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="likelihood", 
                        `title`="Likelihood", 
                        `type`="number"),
                    list(
                        `name`="posterior_probability", 
                        `title`="Posterior Probability", 
                        `type`="number", 
                        `format`="zto"),
                    list(
                        `name`="evidence_strength", 
                        `title`="Evidence Strength", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="uncertaintyAnalysis",
                title="Diagnostic Uncertainty Assessment",
                visible="(uncertainty_analysis)",
                columns=list(
                    list(
                        `name`="uncertainty_source", 
                        `title`="Uncertainty Source", 
                        `type`="text"),
                    list(
                        `name`="uncertainty_level", 
                        `title`="Uncertainty Level", 
                        `type`="text"),
                    list(
                        `name`="impact_on_diagnosis", 
                        `title`="Impact on Diagnosis", 
                        `type`="text"),
                    list(
                        `name`="mitigation_strategy", 
                        `title`="Mitigation Strategy", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="clinicalContext",
                title="Clinical Context Integration",
                visible="(clinical_context)",
                columns=list(
                    list(
                        `name`="context_factor", 
                        `title`="Clinical Factor", 
                        `type`="text"),
                    list(
                        `name`="influence_on_probability", 
                        `title`="Probability Influence", 
                        `type`="text"),
                    list(
                        `name`="clinical_relevance", 
                        `title`="Clinical Relevance", 
                        `type`="text"),
                    list(
                        `name`="evidence_quality", 
                        `title`="Evidence Quality", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="sensitivityAnalysis",
                title="Diagnostic Sensitivity Analysis",
                visible="(sensitivity_analysis)",
                columns=list(
                    list(
                        `name`="parameter", 
                        `title`="Parameter", 
                        `type`="text"),
                    list(
                        `name`="base_case", 
                        `title`="Base Case", 
                        `type`="number"),
                    list(
                        `name`="low_estimate", 
                        `title`="Low Estimate", 
                        `type`="number"),
                    list(
                        `name`="high_estimate", 
                        `title`="High Estimate", 
                        `type`="number"),
                    list(
                        `name`="impact_range", 
                        `title`="Impact Range", 
                        `type`="text"))))
            self$add(jmvcore::Table$new(
                options=options,
                name="modelPerformance",
                title="Diagnostic Model Performance",
                visible="(confirmedDiagnosis && diagnostic_probability)",
                columns=list(
                    list(
                        `name`="performance_metric", 
                        `title`="Performance Metric", 
                        `type`="text"),
                    list(
                        `name`="value", 
                        `title`="Value", 
                        `type`="number"),
                    list(
                        `name`="confidence_interval", 
                        `title`="95% CI", 
                        `type`="text"),
                    list(
                        `name`="interpretation", 
                        `title`="Clinical Interpretation", 
                        `type`="text"))))
            self$add(jmvcore::Image$new(
                options=options,
                name="diagnosticPlots",
                title="Diagnostic Probability Plots",
                width=800,
                height=600,
                requiresData=TRUE,
                visible="(diagnostic_plots)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="networkDiagram",
                title="Diagnostic Relationship Network",
                width=700,
                height=500,
                requiresData=TRUE,
                visible="(network_diagram)"))
            self$add(jmvcore::Image$new(
                options=options,
                name="probabilityHeatmap",
                title="Probability Heatmap",
                width=800,
                height=400,
                requiresData=TRUE,
                visible="(probability_heatmap)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="clinicalGuidelines",
                title="Evidence-Based Diagnostic Guidelines",
                visible="(clinical_guidelines)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="differentialExplanation",
                title="Diagnostic Reasoning Explanation",
                visible="(differential_explanation)"))
            self$add(jmvcore::Html$new(
                options=options,
                name="technicalNotes",
                title="Technical Notes & Methodology",
                visible=FALSE))}))

differentialdiagnosisBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "differentialdiagnosisBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "ClinicoPath",
                name = "differentialdiagnosis",
                version = c(1,0,0),
                options = options,
                results = differentialdiagnosisResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = TRUE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Differential Diagnosis Assistance
#'
#' Differential Diagnosis Assistance provides Bayesian diagnostic reasoning 
#' with 
#' multi-factorial clinical presentation analysis to generate ranked 
#' differential 
#' diagnoses with likelihood ratios and diagnostic probabilities for 
#' evidence-based 
#' clinical decision support and diagnostic accuracy optimization.
#' 
#'
#' @examples
#' data('histopathology', package='ClinicoPath')
#'
#' # Basic differential diagnosis analysis
#' differentialdiagnosis(histopathology,
#'                     clinicalFindings = c('Symptom1', 'Symptom2'),
#'                     confirmedDiagnosis = 'Diagnosis',
#'                     diagnostic_probability = TRUE,
#'                     likelihood_ratios = TRUE)
#'
#' @param data .
#' @param clinicalFindings Clinical findings, symptoms, signs, and test
#'   results for diagnostic reasoning
#' @param confirmedDiagnosis Confirmed diagnosis variable for model training
#'   and validation (optional)
#' @param demographicVars Patient demographic variables (age, gender,
#'   ethnicity) affecting disease prevalence
#' @param labResults Laboratory test results for diagnostic probability
#'   calculation (optional)
#' @param imagingFindings Imaging findings and radiological results (optional)
#' @param diagnostic_probability Calculate Bayesian diagnostic probabilities
#'   for differential diagnoses
#' @param likelihood_ratios Calculate positive and negative likelihood ratios
#'   for diagnostic tests
#' @param prevalence_adjustment Adjust probabilities based on disease
#'   prevalence and demographics
#' @param differential_ranking Rank differential diagnoses by probability and
#'   clinical significance
#' @param bayesian_network Advanced Bayesian network modeling for complex
#'   diagnostic relationships
#' @param reasoning_method Statistical method for diagnostic probability
#'   calculation
#' @param prevalence_source Source of disease prevalence estimates for prior
#'   probability calculation
#' @param confidence_threshold Minimum confidence threshold for diagnostic
#'   recommendations
#' @param max_diagnoses Maximum number of differential diagnoses to display in
#'   results
#' @param clinical_context Integrate clinical context and patient history in
#'   diagnostic reasoning
#' @param uncertainty_analysis Analyze and report diagnostic uncertainty and
#'   confidence intervals
#' @param sensitivity_analysis Perform sensitivity analysis for key diagnostic
#'   parameters
#' @param confidence_level Confidence level for diagnostic probability
#'   intervals
#' @param diagnostic_plots Create diagnostic probability and likelihood ratio
#'   visualizations
#' @param network_diagram Create network diagram of diagnostic relationships
#' @param probability_heatmap Create heatmap of diagnostic probabilities
#'   across findings
#' @param clinical_guidelines Integrate evidence-based diagnostic guidelines
#'   and recommendations
#' @param differential_explanation Provide detailed explanation of diagnostic
#'   reasoning process
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$todo} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$summary} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$diagnosticProbabilities} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$likelihoodRatios} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$bayesianAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$uncertaintyAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$clinicalContext} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$sensitivityAnalysis} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$modelPerformance} \tab \tab \tab \tab \tab a table \cr
#'   \code{results$diagnosticPlots} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$networkDiagram} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$probabilityHeatmap} \tab \tab \tab \tab \tab an image \cr
#'   \code{results$clinicalGuidelines} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$differentialExplanation} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$technicalNotes} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' Tables can be converted to data frames with \code{asDF} or \code{\link{as.data.frame}}. For example:
#'
#' \code{results$diagnosticProbabilities$asDF}
#'
#' \code{as.data.frame(results$diagnosticProbabilities)}
#'
#' @export
differentialdiagnosis <- function(
    data,
    clinicalFindings,
    confirmedDiagnosis,
    demographicVars,
    labResults,
    imagingFindings,
    diagnostic_probability = TRUE,
    likelihood_ratios = TRUE,
    prevalence_adjustment = TRUE,
    differential_ranking = TRUE,
    bayesian_network = FALSE,
    reasoning_method = "naive_bayes",
    prevalence_source = "population_based",
    confidence_threshold = 0.5,
    max_diagnoses = 10,
    clinical_context = TRUE,
    uncertainty_analysis = TRUE,
    sensitivity_analysis = FALSE,
    confidence_level = 0.95,
    diagnostic_plots = TRUE,
    network_diagram = FALSE,
    probability_heatmap = FALSE,
    clinical_guidelines = TRUE,
    differential_explanation = TRUE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("differentialdiagnosis requires jmvcore to be installed (restart may be required)")

    if ( ! missing(clinicalFindings)) clinicalFindings <- jmvcore::resolveQuo(jmvcore::enquo(clinicalFindings))
    if ( ! missing(confirmedDiagnosis)) confirmedDiagnosis <- jmvcore::resolveQuo(jmvcore::enquo(confirmedDiagnosis))
    if ( ! missing(demographicVars)) demographicVars <- jmvcore::resolveQuo(jmvcore::enquo(demographicVars))
    if ( ! missing(labResults)) labResults <- jmvcore::resolveQuo(jmvcore::enquo(labResults))
    if ( ! missing(imagingFindings)) imagingFindings <- jmvcore::resolveQuo(jmvcore::enquo(imagingFindings))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(clinicalFindings), clinicalFindings, NULL),
            `if`( ! missing(confirmedDiagnosis), confirmedDiagnosis, NULL),
            `if`( ! missing(demographicVars), demographicVars, NULL),
            `if`( ! missing(labResults), labResults, NULL),
            `if`( ! missing(imagingFindings), imagingFindings, NULL))

    for (v in confirmedDiagnosis) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])
    for (v in imagingFindings) if (v %in% names(data)) data[[v]] <- as.factor(data[[v]])

    options <- differentialdiagnosisOptions$new(
        clinicalFindings = clinicalFindings,
        confirmedDiagnosis = confirmedDiagnosis,
        demographicVars = demographicVars,
        labResults = labResults,
        imagingFindings = imagingFindings,
        diagnostic_probability = diagnostic_probability,
        likelihood_ratios = likelihood_ratios,
        prevalence_adjustment = prevalence_adjustment,
        differential_ranking = differential_ranking,
        bayesian_network = bayesian_network,
        reasoning_method = reasoning_method,
        prevalence_source = prevalence_source,
        confidence_threshold = confidence_threshold,
        max_diagnoses = max_diagnoses,
        clinical_context = clinical_context,
        uncertainty_analysis = uncertainty_analysis,
        sensitivity_analysis = sensitivity_analysis,
        confidence_level = confidence_level,
        diagnostic_plots = diagnostic_plots,
        network_diagram = network_diagram,
        probability_heatmap = probability_heatmap,
        clinical_guidelines = clinical_guidelines,
        differential_explanation = differential_explanation)

    analysis <- differentialdiagnosisClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

